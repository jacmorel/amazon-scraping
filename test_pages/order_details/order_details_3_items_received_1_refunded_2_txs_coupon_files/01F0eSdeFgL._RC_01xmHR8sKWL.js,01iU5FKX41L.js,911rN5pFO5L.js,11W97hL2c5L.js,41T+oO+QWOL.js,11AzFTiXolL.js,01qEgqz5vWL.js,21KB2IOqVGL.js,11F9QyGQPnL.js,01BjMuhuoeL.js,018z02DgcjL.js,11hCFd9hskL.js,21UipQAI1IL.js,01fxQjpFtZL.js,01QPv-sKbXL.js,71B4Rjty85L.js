(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PayAtStore","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PayAtStoreComponent",["components/SimplePaymentOptionListItemComponent"],function(a){return a.extend({_getContainerElement:function(){return this.getDOMElement("pasContainer")}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-PIX","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/PIXComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({initialize:function(b,a){this.setDisabled(a.data.isPIXDisabled)},bindToEvents:function(){var a=
this;a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("pixContainer")}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PSE","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PSEComponent",["component"],function(a){return a.extend({initialize:function(){console.log("PSEComponent initialized!")}})})})()});
/* ******** */
(function(E){var p=window.AmazonUIPageJS||window.P,r=p._namespace||p.attributeErrors,I=r?r("APXWidgetsAssets@PaymentsPortalWidgets2","APXWidgetsAssets"):p;I.guardFatal?I.guardFatal(E)(I,window):I.execute(function(){E(I,window)})})(function(E,p,r){(function(){function I(c){for(var g=document.querySelectorAll("div[data-a-input-name]"),f=1,h=1,l=1,b={},e=0,n=0;n<g.length;n++)for(var q=g[n].querySelectorAll("input"),a=0;a<q.length;a++)if(q[a].offsetParent&&!q[a].disabled){var k=q[a].value,d={},x=q[a].name;
if(k||"ppw-instrumentRowSelection"!==x){k=k.split("\x26");for(x=0;x<k.length;x++){var v=k[x].split("\x3d");d[v[0]]=v[1]}if("paymentMethod"in d)switch(d.paymentMethod){case "CC":if("EMI"===d.instrumentId||"AmazonCredit"===d.instrumentId){b[d.instrumentId]=f;f+=1;"AmazonCredit"===d.instrumentId&&(e+=1);continue}k=document.querySelectorAll("div[data-instrument-id\x3d'"+d.instrumentId+"']");if(k!==r&&null!==k&&0<k.length)k=k[0];else continue;k=k.getElementsByClassName("pmts-cc-issuer-name");if(k!==r&&
null!==k&&0<k.length)k=k[0].innerHTML,String(k).includes("Amazon Pay")&&(e+=1);else continue;k in b?(b[k+h]=f,h+=1):b[k]=f;f+=1;break;case "UnifiedPaymentsInterface":k=g[n].getAttribute("aria-label");if(null===k||k===r)continue;"Other UPI Apps"!==k&&(d=k.includes("*")?k.indexOf("*"):k.length,k="UPI-2P-".concat(k.substring(0,d)),e+=1);k in b?(b[k+l]=f,l+=1):b[k]=f;f+=1;break;case "NB":b.NB=f;f+=1;break;case "NetBanking":b.NB=f;f+=1;break;case "APB":b.APB=f;e+=1;f+=1;break;case "COD":b.COD=f;f+=1;break;
case "AmazonProductVoucher":b.AmazonProductVoucher=f,e+=1,f+=1}}else b["Other UPI Apps / NetBanking"]=f,f+=1}f=Object.keys(b).length;g=f-e;c.widget.publishSuccessSushiMetrics({ActionParentValueType:"DisplayedPaymentInstrumentsCount",ActionParentValue:f,ActionType:"LoadStartWidget",ActionValueType:"PaymentInstrumentsDisplayRank",ActionValue:b});c.widget.publishSuccessSushiMetrics({ActionValue:g,ActionValueType:"3PInstrumentsCount",ActionType:"LoadStartWidget"});c.widget.publishSuccessSushiMetrics({ActionValue:e,
ActionValueType:"APPInstrumentsCount",ActionType:"LoadStartWidget"})}var m=PaymentsPortal2.modules.define;m("TransitionMetricsConstants",[],function(){return{SEPARATOR:"-to-",ADD_NEW_PAYMENT_METHOD_LINK:"AddNewPaymentMethodLink",REGISTRATION_LANDING_VIEW:"RegistrationLandingView",CARD_REGISTRATION_FORM_VIEW:"CardRegistrationForm",ADD_PM_LINK_CLICK_STORAGE_KEY:"apx:spps:AddNewPaymentMethodLinkClicked:"}});m("components/AddAddressComponent","css-utils jQuery form-component lang AUI!P aui-helper".split(" "),
function(c,g,f,h,l,b){return f.extend({initialize:function(b,n){this._addressListSize=n.data.addressListSize;this._fieldsToDisable=n.data.fieldsToDisable},bindToElements:function(){this.getDOMElement("addAddressSubmitButton").closest("form").submit(h.bind(this.onAddAddressSubmitButton,this))},onAddAddressSubmitButton:function(b){return 0===this.form.validateForm().length},_fillForm:function(b){var e=this;b=g.parseJSON(b);h.forEachKeyValue(b,function(b,a){b&&a&&e.getDOMElement(b).val(a)})},bindToEvents:function(){var b=
this;b.widget.on("fillAddressForm",b,function(e){b._fillForm(e.addressJsonData)});0<b._fieldsToDisable.length&&(b._disableFieldsInList(),0===b._addressListSize&&b._hideFields(b._fieldsToDisable))},_hideFields:function(b){h.forEach(b,function(b){b=g("[id\x3d"+b+"]");c.hideElement(b)})},_disableFieldsInList:function(){c.hideElement(g("[name\x3d'ppw-postalCode']"));h.forEach(this._fieldsToDisable,function(b){b="ppw-".concat(b);b=g("[name\x3d"+b+"]");c.makeTextInputReadOnly(b)})}})});m("components/AddressUIAddAddressComponent",
["component","lang","jQuery"],function(c,g,f){return c.extend({bindToEvents:function(){var c=this;c.widget.onAui("addrui-widgets-addr-suggestion-event-edit-button-clicked",function(){var l=c.getDOMElement("addressUIAddAddressWidgetWrapperForm"),b=f("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:AddressUIEditAddressEvent",value:"submit"});l.append(b)})}})});m("components/LookupAddressComponent",["css-utils","jQuery","form-component","lang"],function(c,g,f,h){return f.extend({initialize:function(c,
b){this._addressLiseSize=b.data.addressListSize},_fillAddressFormByLookupAddress:function(){var c=this.form.fields.lookupDropDown;c=this.form.getFormValues()[c.defaultParameterName];this.widget.trigger("fillAddressForm",{addressJsonData:c})},bindToElements:function(){c.showElement(g(this.getDOMElement("lookupAddressSection")));var l=this.form.fields.lookupDropDown,b=h.bind(this._fillAddressFormByLookupAddress,this);this.form.bindToParameter(l.defaultParameterName,"change",b);1>=this._addressLiseSize&&
c.hideElement(g("[data-a-class\x3d'ppw-lookup-mx-dropdown']"))}})});m("components/AddressSuggestionComponent",["component","lang"],function(c,g){return c.extend({})});m("components/AddAmazonPayCodeComponent",["events/form-submitted-event","form-component","lang","jQuery","css-utils"],function(c,g,f,h,l){return g.extend({initialize:function(b,e){this._action=e.data.action},bindToElements:function(){this.getDOMElement("pmts-add-amazon-paycode-continue-button").click(f.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var b=this;this.widget.on(c,b,function(e){e.action===b._action&&b.getDOMElement("pmts-add-amazon-paycode-form").submit()})},_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var e=this.getFormSubmissionParameters("pmts-add-amazon-paycode-container");this.widget.trigger(c,{submissionParameters:e,event:b,action:this._action})}else b.preventDefault()}})});m("components/AddAmazonPayCodeWorkflowComponent",["component"],function(c){return c});m("components/AddBancontactComponent",
["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(c,g,f,h,l){return f.extend({initialize:function(b,e){this.$addBancontactPopover=this.getDOMElement(this.data.addBancontactPopoverJSBinding);this.$addBancontactSubmitButton=this.getDOMElement(this.data.addBancontactSubmitButtonJSBinding)},_initPopoverState:function(){this.data.hasErrors&&this.$addBancontactPopover.trigger("click")},bindToElements:function(){this.$addBancontactSubmitButton.click(h.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(b){this._initPopoverState()});b.widget.on(c,b,function(e){e.action===b.data.action&&b.getDOMElement(b.data.addBancontactFormJSBinding).submit()})},_handleFormSubmission:function(b){var e=this.getFormSubmissionParameters(this.data.addBancontactBodyJSBinding);this.closeAddBancontactPopover();this.widget.trigger(c,{event:b,submissionParameters:e,action:this.data.action})},closeAddBancontactPopover:function(){var b=
this.data.addBancontactPopoverName;l.when("a-modal").execute(function(e){e&&(e=e.get(b))&&e.hide()})}})});m("components/AddBankAccountComponent","css-utils jQuery form-component lang AUI!P clog modal-popover events/close-secure-container-event events/display-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent AddPaymentInstrumentStorageConsentHelper".split(" "),function(c,g,f,h,l,b,e,n,q,a,k,d){var x=null;return f.extend(d,{_hasErrors:!1,_creatablePaymentMethods:[],
_isSecureRegistrationPageTriggerShown:!1,initialize:function(a,d){this._deviceType=a.options.deviceType;this._isDesktop="desktop"===a.options.deviceType;this._hasErrors=d.data.hasErrors;this._isAnyIBAN=!!d.data.isAnyIBAN;this._bankAccountCategory=d.data.bankAccountCategory;this._addButtonJSBinding=d.data.addButtonJSBinding;this._isAccountNumberPrefixRequired=d.data.isAccountNumberPrefixRequired;this._isTaxIdRequired=d.data.isTaxIdRequired;this._creatablePaymentMethods=d.data.creatablePaymentMethods;
this._isSecureRegistrationPageTriggerShown=d.data.isSecureRegistrationPageTriggerShown;this._isSecureRegistrationWidget=d.data.isSecureRegistrationWidget;this._isPersonalCheckingAccount=d.data.isPersonalCheckingAccount;this._action=d.data.action;this._disablePasteForAccountNumber=d.data.disablePasteForAccountNumber;this._disablePasteForBankCode=d.data.disablePasteForBankCode;this._disablePasteForBranchCode=d.data.disablePasteForBranchCode;this._disablePasteForTaxId=d.data.disablePasteForTaxId;this._accountNumberPaddingLength=
d.data.accountNumberPaddingLength;this._shouldRenderInPopover=d.data.shouldRenderInPopover;this._loadJPBankListFromAssetEnabled=d.data.loadJPBankListFromAssetEnabled;this._secureIframeName=d.data.secureIframeName;this._declarativeActionName=d.data.declarativeActionName;this._enableEnterBankAccountTwice=d.data.enableEnterBankAccountTwice;this._shouldFillRoutingNumberFromBankAndBranchCode=d.data.shouldFillRoutingNumberFromBankAndBranchCode;this._delimiterForFillingRoutingNumberFromBankCodeAndBranchCode=
d.data.delimiterForFillingRoutingNumberFromBankCodeAndBranchCode;this._shouldRenderInPopover&&(this.popover=new e(a,d,this))},_initPopoverState:function(){"true"===this._hasErrors&&(this.getDOMElement("bankAccountPopoverLink").trigger("click"),this.widget.trigger(q))},_maybeSetCountryCode:function(){if(this._isAnyIBAN){var a=g.trim(this.getDOMElement("addBankAccountNumber").val()).substring(0,2);this.getDOMElement("countryCode").val(a)}},_stripHyphenTaxId:function(){if(this._isTaxIdRequired){var a=
this.getDOMElement("addBankTaxIdentificationNumber").val();a&&(a=a.replace(/-/g,""),this.getDOMElement("addBankTaxIdentificationNumber").val(a))}},_stripNonAlphaNumericFromRoutingNumber:function(){var a=this.getDOMElement("addBankAccountRoutingNumber").val();a&&(a=a.replace(/[\W_]/g,""),this.getDOMElement("addBankAccountRoutingNumber").val(a))},_prefixBankAccountNumber:function(){if(this._isAccountNumberPrefixRequired){var a="SAVINGS"===this.form.getAUITagHelperForParameter("accountType").val()?"1":
"2",d=a+this.getDOMElement("addBankAccountNumber").val();this.getDOMElement("addBankAccountNumber").val(d);a+=this.getDOMElement("confirmBankAccountNumber").val();this.getDOMElement("confirmBankAccountNumber").val(a)}},_padBankAccountNumber:function(){if(0<this._accountNumberPaddingLength){var a=this.getDOMElement("addBankAccountNumber").val();a=h.leftPad(a,this._accountNumberPaddingLength,"0");this.getDOMElement("addBankAccountNumber").val(a);a=this.getDOMElement("confirmBankAccountNumber").val();
a=h.leftPad(a,this._accountNumberPaddingLength,"0");this.getDOMElement("confirmBankAccountNumber").val(a)}},handleAddBankAccountDOMEvent:function(){var a=this.form.validateForm();d.blameFormField.apply(this,[a]);if(0===a.length)this._maybeSetCountryCode(),this._padBankAccountNumber(),this._prefixBankAccountNumber(),this._stripHyphenTaxId(),this._stripNonAlphaNumericFromRoutingNumber(),a=this.getDOMElement(this._addButtonJSBinding).closest("form").serializeArray(),this.widget.trigger("newBankAccountFormSubmitted",
{submissionParameters:a,bankAccountCategory:this._bankAccountCategory,action:this._action}),this.closeAddBankAccountPopover({});else{var k=this;h.forEach(a,function(a){k.widget.publishFailureSushiMetrics({ActionType:"AddBankAccount",ActionValueType:"ErrorField",ActionValue:a.field})})}return!1},closeAddBankAccountPopover:function(a){this.widget.trigger(n,a);l.when("a-modal").execute(function(a){a&&(a=a.get("pmtsAddBankAccountPopover"))&&a.hide()})},bindToElements:function(){var a=this;c.showElement(g(this.getDOMElement("confirmAccountNumberSection")));
this.getDOMElement(this._addButtonJSBinding).click(h.bind(this.handleAddBankAccountDOMEvent,this));this.getDOMElement(this._addButtonJSBinding).click(function(){a.widget.publishSuccessSushiMetrics({ActionType:"AddBankAccount",ActionValueType:"AddMethod",ActionValue:"AddBankAccountButtonClicked"})});this.getDOMElement("newBankAccountCancelButton").click(function(){a.closeAddBankAccountPopover({force:!0});a.widget.publishSuccessSushiMetrics({ActionType:"CancelAddBankAccount",ActionValueType:"Click",
ActionValue:"CancelButtonClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:a._purchaseId})});this._enableEnterBankAccountTwice&&this.getDOMElement("addBankAccountNumber").bind("cut copy paste",function(a){a.preventDefault()});this._disablePasteForAccountNumber&&(this.getDOMElement("addBankAccountNumber").bind("paste",function(a){a.preventDefault()}),this.getDOMElement("confirmBankAccountNumber").bind("paste",function(a){a.preventDefault()}));this._disablePasteForTaxId&&(this.getDOMElement("addBankTaxIdentificationNumber").bind("paste",
function(a){a.preventDefault()}),this.getDOMElement("confirmTaxIdNumber").bind("paste",function(a){a.preventDefault()}));this._disablePasteForBankCode&&this.getDOMElement("bankCode").bind("paste",function(a){a.preventDefault()});this._disablePasteForBranchCode&&this.getDOMElement("branchCode").bind("paste",function(a){a.preventDefault()});this._loadJPBankListFromAssetEnabled&&g("[name\x3d'ppw-bankNameDropdown']").change(function(){a._changeBankCodeDropdown()});this._isSecureRegistrationPageTriggerShown?
this._bindAddBankAccountTrigger():this._bindNonSecureAddBankAccountTrigger();d.bindToElements.apply(this)},bindToEvents:function(){var a=this;l.when("A","ready").execute(function(d){d.on("a:button-group:accountTypeToggleGroup:toggle",function(d){a.getDOMElement("accountType").val(d.selectedButton.buttonName)})});this._loadJPBankListFromAssetEnabled&&(b.logCounterMetric({feature:"JPPersonalAddBankLoadSuccess",resource:"_Count"}),l.when("a-dropdown","jp-bank-list").execute(function(d,k){k=Object.entries(k.getTopBanks()).map(function(a){return{value:a[0],
text:a[1]}});d.getSelect("pmts-bank-name-dropdown-native-id").addOptions(k,0);c.hideElement(g("#bank-code-input-section"));c.showElement(a.getDOMElement("bankNameDropdown"));b.logCounterMetric({feature:"AddBankJPBankListAssetLoadSuccess",resource:"_Count"})}),l.when("jp-bank-list").execute(function(d){a.getDOMElement("bankName").keyup(function(){a._changeBankNameSuggestions(d.getAllBanks());g(".pmts-add-bank-account-bank-name-option").bind("click",function(d){a._selectBankFromSuggestion(this)})})}));
a.widget.on("newBankAccountFormSubmitted",a,function(d){if(d.bankAccountCategory===this._bankAccountCategory){d=g(a.getDOMElement(this._addButtonJSBinding)).closest("form");if(this._shouldFillRoutingNumberFromBankAndBranchCode){var k=g("\x3cinput\x3e").attr({type:"hidden",name:"addBankAccountRoutingNumber",value:this.getDOMElement("bankCode").val()+this._delimiterForFillingRoutingNumberFromBankCodeAndBranchCode+this.getDOMElement("branchCode").val()});d.append(k)}d.submit();this._addBankAccountFormSubmitMetric()}});
a.widget.on("componentsInitialized",a,function(a){this._initPopoverState()});this.widget.on(k,this,function(d){x&&d.data&&"BA"===d.data.paymentMethod&&(b.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+a._deviceType,resource:"_Count"}),b.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:x}),x=null);b.publishMetrics()});if(this._shouldRenderInPopover)this.widget.on("pmts-add-bank-js-popover-cancel-event",this,function(a){this.getDOMElement("pmts-add-bank-js-popover-cancel-form").submit()})},
_bindAddBankAccountTrigger:function(){var d=this,k=this._declarativeActionName;l.when("A").execute(function(e){e.declarative(k,"click",function(){x=(new Date).getTime();b.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+d._deviceType,resource:"_Count"});d.widget.publishSuccessSushiMetrics({ActionType:"StartAddBankAccount",ActionValueType:"Click",ActionValue:"SecureAddBankAccountLinkClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:d._purchaseId});d.widget.trigger(a,{postData:{hideAddPaymentInstrumentHeader:!0,
creatablePaymentMethods:d._creatablePaymentMethods,iFrameName:d._secureIframeName}})})})},_changeBankCodeDropdown:function(){this.getDOMElement("bankCode").val("");var a=g("[name\x3d'ppw-bankNameDropdown']").val();"Other"===a?(c.hideElement(this.getDOMElement("bankNameDropdown")),c.showElement(this.getDOMElement("bankName")),c.showElement(this.getDOMElement("bankName").parent()),this.getDOMElement("bankName").focus()):this.getDOMElement("bankCode").val(a)},_changeBankNameSuggestions:function(a){this._clearBankSuggestions();
var d=this.getDOMElement("bankName").val().toUpperCase();if(""!==d){var k=0,b;for(b in a){var e=a[b];-1<e.toUpperCase().indexOf(d)&&(this._displayBankSuggestion(b,e),k++);if(5<=k)break}}},_clearBankSuggestions:function(){this.getDOMElement("bankCode").val("");g("#bank-name-options-box").children().first().html("");c.hideElement(g("#bank-name-options-box"))},_displayBankSuggestion:function(a,d){c.showElement(g("#bank-name-options-box"));var k=g("#bank-name-option-template").clone();k.removeAttr("id");
k.removeClass("aok-hidden");k.html(d);k.attr("data-bankcode",a);g("#bank-name-options-box").children().first().append(k)},_selectBankFromSuggestion:function(a){this._clearBankSuggestions();this.getDOMElement("bankCode").val(a.dataset.bankcode);this.getDOMElement("bankName").val(a.innerHTML)},_bindNonSecureAddBankAccountTrigger:function(){l.when("A").execute(function(a){a.declarative("a-modal","click",function(){b.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",resource:"_Count"})})})},
_addBankAccountFormSubmitMetric:function(){b.logCounterMetric({feature:this._isSecureRegistrationWidget?"BA_SecureRegistrationFormSubmitted":"BA_NonSecureRegistrationFormSubmitted",resource:"_Count"})}})});m("components/AddBankAccountWorkflowComponent",["component","lang","AUI!P","mash-helper"],function(c,g,f,h){return c.extend({initialize:function(c,b){this._isSecureRegistrationWidget=b.data.isSecureRegistrationWidget;this._isRequestForMobileApp=b.data.isRequestForMobileApp;this._dispatcherSecurePaymentMethodAddedEvent=
b.data.dispatcherSecurePaymentMethodAddedEvent},bindToEvents:function(){var c=this;this.widget.on("WidgetAction",this,function(b){"add-payment-instrument"===b.widgetActionType&&"add-bank-account-workflow-complete"===b.widgetAction&&c._isSecureRegistrationWidget&&c._isRequestForMobileApp&&h.dispatchEvent(c._dispatcherSecurePaymentMethodAddedEvent,{paymentInstrumentId:b.paymentInstrumentId,widgetAction:b.widgetAction,walletId:b.walletId})})}})});m("components/AddConsumerInvoicingComponent",["events/form-submitted-event",
"form-component","lang","jQuery","css-utils"],function(c,g,f,h,l){return g.extend({initialize:function(b,e){this._action=e.data.action;this._addConsumerInvoicingFormCssName=e.data.addConsumerInvoicingFormCssName;this._addConsumerInvoicingHiddenIsRequiredCssName=e.data.addConsumerInvoicingHiddenIsRequiredCssName;this._addConsumerInvoicingRequiredForCssName=e.data.addConsumerInvoicingRequiredForCssName;this._addConsumerInvoicingHiddenFieldCssName=e.data.addConsumerInvoicingHiddenFieldCssName;this.$addCiSubmitButton=
this.getDOMElement("pmts-add-consumer-invoicing-continue-button");this.$addCiSCountriesDropdown=this.getDOMElement("pmts-add-consumer-invoicing-countries-dropdown")},bindToElements:function(){var b=this;h("[name\x3d'ppw-birthDateDay']").change(function(){b.populateDateOfBirth()});h("[name\x3d'ppw-birthDateMonth']").change(function(){b.populateDateOfBirth()});h("[name\x3d'ppw-birthDateYear']").change(function(){b.populateDateOfBirth()});this.$addCiSubmitButton.click(f.bind(this._handleFormSubmission,
this));this.$addCiSCountriesDropdown.change(f.bind(this._clickedDropdown,this))},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(b){this.$addCiSCountriesDropdown.change()});this.widget.on(c,this,function(b){b.action===this._action&&this.getDOMElement("pmts-add-consumer-invoicing-form").submit()})},_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var e=this.getFormSubmissionParameters("pmts-add-consumer-invoicing-container");this.widget.trigger(c,
{submissionParameters:e,event:b,action:this._action})}else b.preventDefault()},_clickedDropdown:function(b){function e(a,d,b){b||(d?l.showElement(a):l.hideElement(a));a.each(function(){var a=h(this).find("."+n._addConsumerInvoicingHiddenIsRequiredCssName);a.length&&a.val(d)})}var n=this,c=n._addConsumerInvoicingRequiredForCssName+b.target.value;b=h("form."+n._addConsumerInvoicingFormCssName+" ."+c).not("."+n._addConsumerInvoicingHiddenFieldCssName);var a=h("form."+n._addConsumerInvoicingFormCssName+
" ."+c).filter("."+n._addConsumerInvoicingHiddenFieldCssName);c=h("form."+n._addConsumerInvoicingFormCssName+' [class*\x3d"'+n._addConsumerInvoicingRequiredForCssName+'"]').not("."+c);e(c,!1,!1);e(b,!0,!1);e(a,!0,!0)},populateDateOfBirth:function(){var b=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateDay']").val()),e=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateMonth']").val()),n=h("[name\x3d'ppw-birthDateYear']").val();b&&e&&n&&(b=b+"."+e+"."+n,h("[name\x3d__sif_encrypted_invoicing_date_of_birth]").val(b))},
formatDayAndMonth:function(b){return b&&1===b.length?"0"+b:b}})});m("components/AddConsumerInvoicingWorkflowComponent","jQuery component aui-helper AUI!P clog events/close-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent".split(" "),function(c,g,f,h,l,b,e,n){var q=null;return g.extend({_creatablePaymentMethods:[],_isSecureRegistrationEnabledForCI:!1,initialize:function(a,k){this._deviceType=a.options.deviceType;this.$addConsumerInvoicingPopoverTriggerLink=this.getDOMElement("addConsumerInvoicingPopoverTriggerLink");
this.$UseSelectedAddressButtonSelector=k.data.useSelectedAddressCompactButtonSelector||"#addConsumerInvoicingPopoverId .pmts-use-selected-address";this.$AddAddressButtonSelector=k.data.addAddressCompactButtonSelector||"#addConsumerInvoicingPopoverId .pmts-save-address";this.isExpanded=k.data.isExpanded||!1;this._isDesktop="desktop"===a.options.deviceType;this._creatablePaymentMethods=k.data.creatablePaymentMethods;this._isSecureRegistrationEnabledForCI=k.data.isSecureRegistrationEnabledForCI},_initPopoverState:function(){this.refreshAddConsumerInvoicingPopover();
this.isExpanded&&this.widget.trigger("openAddConsumerInvoicingPopover")},bindToElements:function(){this._isSecureRegistrationEnabledForCI?this._bindAddConsumerInvoicingTrigger():this._bindNonSecureAddConsumerInvoicingTrigger()},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(a){this._initPopoverState()});c(this.$AddAddressButtonSelector).click(function(k){a.closeAddConsumerInvoicingPopover()});c(this.$UseSelectedAddressButtonSelector).click(function(k){a.closeAddConsumerInvoicingPopover()});
a.widget.on("showAddConsumerInvoicingSleeve",a,function(k){k=c(".pmts-add-consumer-invoicing-container");f.getExpanderHelper(k).isExpanded()||k.find(".a-expander-header").click();a.widget.scrollToElement(k)});a.widget.on("openAddConsumerInvoicingPopover",a,function(k){a.$addConsumerInvoicingPopoverTriggerLink.trigger("click")});a.widget.on(n,this,function(k){q&&k.data&&"CI"===k.data.paymentMethod&&(l.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+a._deviceType,resource:"_Count"}),l.logLatencyMetric({feature:"SecureRegistrationLoadTime",
resource:"_Latency",startTime:q}),q=null);l.publishMetrics()})},_bindAddConsumerInvoicingTrigger:function(){var a=this;a._isDesktop&&h.when("A").execute(function(k){k.declarative("add-consumer-invoicing-action-name","click",function(){q=(new Date).getTime();l.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+a._deviceType,resource:"_Count"});a.widget.trigger(e,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:a._creatablePaymentMethods}})})})},_bindNonSecureAddConsumerInvoicingTrigger:function(){h.when("A").execute(function(a){a.declarative("a-modal",
"click",function(){l.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",resource:"_Count"})})})},refreshAddConsumerInvoicingPopover:function(){h.when("a-modal").execute(function(a){a&&(a=a.get("addConsumerInvoicingPopover"))&&a.isActive()&&a.refresh()})},closeAddConsumerInvoicingPopover:function(){this._isSecureRegistrationEnabledForCI?this.widget.trigger(b):h.when("a-modal").execute(function(a){a&&(a=a.get("addConsumerInvoicingPopover"))&&a.hide()})}})});m("components/AddCreditCardComponent",
"css-utils jQuery form-component form-helper lang AUI!P clog mock-helper keyboard cc-spacing aui-helper events/form-submitted-event events/close-add-credit-card-form-event events/close-secure-container-event events/display-secure-container-event events/MPCIntegrationCompletedEvent events/MPCIntegrationInitializedEvent events/postToSecureIframeEvent events/secureIframeLoadedEvent events/CreditCardNumberResetEvent AddPaymentInstrumentStorageConsentHelper cvv-rate-limiting-inline-message-helper cc-validation-inline-message-helper cc-holder-name-validation-inline-message-helper validation-functions events/InstrumentRowSelectedEvent mash-helper TransitionMetricsConstants apx3-register-experience-provider metrics-helper".split(" "),
function(c,g,f,h,l,b,e,n,q,a,k,d,x,v,u,D,t,m,A,G,z,w,B,y,C,H,L,K,J,E){var F=/^[0-9]+$/,M=null;return f.extend(z,{_hasErrors:!1,_issuer:"",_isCombineAddCCAndDCEnabled:!1,_isCvvForMbcc:!1,_isMbcc:!1,_issuersRequirePostalCode:[],_issuersRequireSecurityToken:[],_issuersHaveNoExpiration:[],_ccScannerParams:r,_ccTapToAddParams:r,_debitCardConfiguration:r,_debitCardSBIMaestroValue:"",_creatablePaymentMethods:[],_isCCSyncVerificationEnabled:!1,_isCreditCardAdditionsBlocked:!1,_isCreditCardCVVVerificationFailed:!1,
_isSynchronousVerificationCardAdditionComplete:!1,_isRequestForMobileApp:!1,_clientId:"",_warningBrands:[],_warningCategory:"",_cardType:"",_isRenderBlockCardRegistrationIMB:!1,_isBlockCardRegistration:!1,_rateLimitDurationInSeconds:0,_selectedDebitCardIssuingBank:r,_isMCXRegistrationEnabled:!1,_isDynamicRateLimitMessage:!1,_tapToAddNullField:"NULL_FIELD",_brandRequiringCVVAuthenticationList:[],_isGPACVVEnabledForCardRegistrationOption:!1,initialize:function(a,d){this._deviceType=a.options.deviceType;
this._isDesktop="desktop"===a.options.deviceType;this._isMobile="mobile"===a.options.deviceType;this.getDOMElement("warningMessagesBoxContainer")&&c.hideElement(this.getDOMElement("warningMessagesBoxContainer"));this._isCombineAddCCAndDCEnabled=d.data.isCombineAddCCAndDCEnabled;this._hasErrors=d.data.hasErrors;this._isCvvForMbcc=d.data.isCvvForMbcc;this._issuersRequirePostalCode=d.data.issuersRequirePostalCode;this._issuersRequireSecurityToken=d.data.issuersRequireSecurityToken;this._issuersHaveNoExpiration=
d.data.issuersHaveNoExpiration;this._isMbcc=d.data.isAddingMbcc;this.updateMbccFields(this._isMbcc);this._creatablePaymentMethods=d.data.creatablePaymentMethods;this._isSecureRegistrationPageTriggerShown=d.data.isSecureRegistrationPageTriggerShown;this._isSecureRegistrationWidget=d.data.isSecureRegistrationWidget;this._secureIframeName=d.data.secureIframeName;this._isMCXRegistrationEnabled=d.data.isMCXRegistrationEnabled||!1;this._addButtonJSBinding=d.data.addButtonJSBinding||"newCreditCardSubmitButton";
this._addFormJSBinding=d.data.addFormJSBinding||"pmts-add-creditcard-form";this._action=d.data.action||"add-credit-card";this._accountHolderNameBinding=d.data.addAccountHolderNameBinding||"accountHolderName";this._addNameOnAccountCheckboxBinding=d.data.addNameOnAccountCheckboxBinding||"getNameOnAccount";this._addCardNumberBinding=d.data.addCardNumberBinding||"addCreditCardNumber";this._addFormContainerJSBinding=d.data.addFormContainerJSBinding||"addCreditCardContainer";this._isINMarketplace=!!d.data.isINMarketplace;
this._clearPrePopulatedAccountNameBinding=d.data.clearPrePopulatedAccountNameBinding;this._secondaryFormFieldsJSBindElementReference=d.data.secondaryFormFieldsJSBindElementReference;this._hideSecondaryFormFields=d.data.hideSecondaryFormFields;this._showExpiryDateTextInputField=d.data.showExpiryDateTextInputField;this._expiryDateTextInputBinding=d.data.expiryDateTextInputBinding;this._showIssuerImageOnTextInputField=d.data.showIssuerImageOnTextInputField;this._blankIssuerImageURL=d.data.blankIssuerImageURL;
this._debitCardConfiguration=d.data.debitCardConfiguration;this._debitCardSBIMaestroValue=d.data.debitCardSBIMaestroValue;this._placementType=d.data.placementType;this._JsBindingExpirationDateLabel=d.data.JsBindingExpirationDateLabel;this._JsBindingExpirationMonthDropdown=d.data.JsBindingExpirationMonthDropdown;this._JsBindingExpirationYearDropdown=d.data.JsBindingExpirationYearDropdown;this._suppressExpirationForInternationalMaestro=d.data.suppressExpirationForInternationalMaestro;this.form.formModel.registerAdditionalData("issuerFn",
l.bind(this.getIssuer,this));this.form.formModel.registerAdditionalData("isMbccFn",l.bind(this.getIsMbcc,this));this.form.formModel.registerAdditionalData("isCvvForMbcc",this._isCvvForMbcc);this.form.formModel.registerAdditionalData("isSBIMaestroFn",l.bind(this.getIsSBIMaestro,this));this._isCCSyncVerificationEnabled=d.data.isCCSyncVerificationEnabled||!1;this._isCreditCardAdditionsBlocked=d.data.creditCardAdditionsBlocked||!1;this._isCreditCardCVVVerificationFailed=d.data.creditCardCVVVerificationFailed||
!1;this._isSynchronousVerificationCardAdditionComplete=d.data.synchronousVerificationCardAdditionComplete;this._isRequestForMobileApp=d.data.isRequestForMobileApp||!1;this._clientId=d.data.clientId;this._declarativeActionName=d.data.declarativeActionName;this._warningBrands=d.data.warningBrands;this._warningCategory=d.data.warningCategory;this._isRenderBlockCardRegistrationIMB=d.data.isRenderBlockCardRegistrationIMB;this._addCreditCardTurnOffIMBJSBinding=d.data.addCreditCardTurnOffIMBJSBinding;this._addPNCCardTurnOffIMBJSBinding=
d.data.addPNCCardTurnOffIMBJSBinding;this._rateLimitDurationInSeconds=d.data.rateLimitDurationInSeconds||0;this._isDynamicRateLimitMessage=d.data.isDynamicRateLimitMessage;this._brandRequiringCVVAuthenticationList=d.data.brandRequiringCVVAuthenticationList;this._isGPACVVEnabledForCardRegistrationOption=d.data.isGPACVVEnabledForCardRegistrationOption;this._isApx3RegisterDesktopEnabled=d.data.isApx3RegisterDesktopEnabled;this._apx3RegisterFeatureWeblabName=d.data.apx3RegisterFeatureWeblabName;this._apx3RegisterFeatureWeblabTreatment=
d.data.apx3RegisterFeatureWeblabTreatment;this._isRequestForMobileApp&&this._isSecureRegistrationWidget&&L.dispatchEvent("DisableCheckoutRefreshEvent",{})},_initPopoverState:function(){"true"!==this._hasErrors||this._isCreditCardAdditionsBlocked||(this.getDOMElement("creditCardPopoverLink").trigger("click"),this.widget.trigger(u))},_isMPCIntegrationTypeSupported:function(a){return"cc_integ"===a},handleAddCardLikeDOMEvent:function(a){var k=this;if(this._isRenderBlockCardRegistrationIMB&&this._isBlockCardRegistration)return!1;
if(this._isCCSyncVerificationEnabled){var n;g("img.pmts-loading-async-widget-spinner-viewport-centered")&&0!==g("img.pmts-loading-async-widget-spinner-viewport-centered").length?n=g("img.pmts-loading-async-widget-spinner-viewport-centered"):g("img.pmts-loading-async-widget-spinner-centered")&&0!==g("img.pmts-loading-async-widget-spinner-centered").length?n=g("img.pmts-loading-async-widget-spinner-centered"):g("img.pmts-loading-async-spinner-small")&&0!==g("img.pmts-loading-async-spinner-small").length&&
(n=g("img.pmts-loading-async-spinner-small"));if(n!==r){var c=n.attr("src");n.attr("src","https://images-na.ssl-images-amazon.com/images/G/01/payments-portal/r1/loading-verifying-your-card-spinner.gif");this.widget.on("submitFormAjaxCompleted",this,function(){n.attr("src",c)})}}var f=this.form.validateForm();z.blameFormField.apply(this,[f]);this._isMCXRegistrationEnabled&&this._toggleAddCardButtonDisabled(0<f.length);0===f.length?(this._formSubmissionEventObj={submissionParameters:this.getFormSubmissionParameters(this._addFormContainerJSBinding),
action:this._action,event:a},l.isDefined(this._formSubmissionEventObj.submissionParameters)&&l.isDefined(this._formSubmissionEventObj.submissionParameters[1])&&(this._formSubmissionEventObj.submissionParameters[1].value=this._formSubmissionEventObj.submissionParameters[1].value.replace(/\s/g,"")),this._isMPCIntegrationRequired?b.when(this._mpcPopoverAction,"jQuery","ready").execute(function(a,b){(a=a.get(b("#"+k._mpcPopoverActionId)))?(e.logCounterMetric({feature:"MpcPromptClicked."+k._integrationType,
resource:"_Count"}),k._mpcInitializedTime&&e.logLatencyMetric({feature:"MpcInitializationTilClickSpan."+k._integrationType,resource:"_Latency",startTime:k._mpcInitializedTime}),e.publishMetrics(),a.show()):k.widget.trigger(d,k._formSubmissionEventObj)}):this.widget.trigger(d,this._formSubmissionEventObj)):l.forEach(f,function(a){k.widget.publishFailureSushiMetrics({ActionType:"AddCreditCard",ActionValueType:"ErrorField",ActionValue:a.field})});return!1},clearPrepopulatedAccountHolderName:function(){this.getDOMElement(this._accountHolderNameBinding).val("");
this.getDOMElement(this._accountHolderNameBinding)[0].placeholder=this.widget.getLocalizedString("pmts_portal_add_credit_card_name_label")},closeAddCreditCardPopover:function(a){this.widget.trigger(v,a);this.widget.trigger(x);this._isCCSyncVerificationEnabled&&this._isSecureRegistrationWidget&&p.parent.postMessage(JSON.stringify({event:{name:"apx:iframe:close",data:{iFrameName:this._secureIframeName}}}),"*")},generateValidCardNumber:function(a){a=a.replace(/\s/g,"").substring(0,8);for(var d=16-(a.length+
1),k=0;k<d;k++)a=a.concat(Math.floor(10*Math.random()));d=0;for(var b=a.length-1;0<=b;b--)k=parseInt(a.charAt(b),10),0===b%2&&(k*=2,k=9<k?k-9:k),d+=k;return a=a.concat(10-d%10)},bindRealTimeErrorMessages:function(){for(var a=0;a<this.form.formModel.constraints.length;a++){if(this.form.formModel.constraints[a].metaData.textChangeTrigger){var d=this.getDOMElement(this.form.formModel.constraints[a].metaData.inputFieldName),k=this.form.formModel.constraints[a].metaData;this.bindFieldToEventListener(d,
k,"input",this)}this.form.formModel.constraints[a].metaData.focusChangeTrigger&&(d=this.getDOMElement(this.form.formModel.constraints[a].metaData.inputFieldName),k=this.form.formModel.constraints[a].metaData,this.bindFieldToEventListener(d,k,"focusout",this))}},bindFieldToEventListener:function(a,d,k,b){a.bind(k,function(){for(var a=0;a<b.form.formModel.constraints.length;a++){var k=b.form.formModel.constraints[a].metaData;k.id===d.id?k.prioritized=!0:k.inputFieldName===d.inputFieldName&&(k.textChangeTrigger===
d.textChangeTrigger||k.focusChangeTrigger===d.focusChangeTrigger?k.prioritized=!0:(k.prioritized=!1,b.form.clearLowPrioField(b.form.formModel.constraints[a].metaData)))}a=b.form.validateField(d);b._toggleAddCardButtonDisabled(a)})},bindToElements:function(){var d=this;d.getDOMElement("addCardLearnMoreLink").click(function(){d.widget.publishSuccessSushiMetrics({ActionValue:"Click",ActionValueType:"LearnMorePopover",ActionParentValue:"LearnMoreOnAddCards",ActionParentValueType:"LearnMoreLinkPosition"})});
this.getDOMElement(this._addButtonJSBinding).click(l.bind(this.handleAddCardLikeDOMEvent,this));this.getDOMElement(this._addButtonJSBinding).click(function(){d.widget.publishSuccessSushiMetrics({ActionType:"AddCreditCard",ActionValueType:"AddMethod",ActionValue:"AddCreditCardButtonClicked"})});this.getDOMElement("newCreditCardCancelButton").click(function(){d.closeAddCreditCardPopover({force:!0});d.widget.publishSuccessSushiMetrics({ActionType:"CancelAddCreditCard",ActionValueType:"Click",ActionValue:"CancelButtonClicked",
ActionParentValueType:"PurchaseDocument",ActionParentValue:d._purchaseId})});this._isSecureRegistrationPageTriggerShown?this._bindAddCreditCardTrigger():this._bindNonSecureAddCreditCardTrigger();this.getDOMElement(this._clearPrePopulatedAccountNameBinding).click(l.bind(this.clearPrepopulatedAccountHolderName,this));var k=this.getDOMElement(this._accountHolderNameBinding),b=this.getDOMElement(this._addNameOnAccountCheckboxBinding),e=this.getDOMElement(this._addCardNumberBinding),n=this.getDOMElement(this._expiryDateTextInputBinding);
this._showIssuerImageOnTextInputField&&c.setElementBackgroundImage(e,this._blankIssuerImageURL,"no-repeat 96% center");b.bind("change",function(a){g(this).is(":checked")?k.val(b.val()):k.val("")});this._secondaryFormFieldsJSBindElementReference&&this._hideSecondaryFormFields&&e.focus(function(a){(a=d.getDOMElement(d._secondaryFormFieldsJSBindElementReference))&&c.showElement(a)});this.bindRealTimeErrorMessages();var f,h;e.keydown(function(a){f=this.value;h=this.selectionStart});this._isCombineAddCCAndDCEnabled||
this._isMCXRegistrationEnabled?e.bind("paste",function(k){p.setTimeout(function(a){a=e.val().replace(/\s/g,"");F.test(a)&&8<=a.length&&(a=d.generateValidCardNumber(a),d.widget.trigger("creditCardNumberChanged",{creditCardNumber:a,placementType:d._placementType}))},1);this.value=a.fixSpacing(this.value);c.hideElement(d.getDOMElement("CardScannerWrapperJSBinding"))}):e.change(function(k){d.widget.trigger("creditCardNumberChanged",{creditCardNumber:this.value,placementType:d._placementType});this.value=
a.fixSpacing(this.value)});this._isMCXRegistrationEnabled&&(e.change(function(){if(8<this.value.length){var k=d.generateValidCardNumber(this.value);d.widget.trigger("creditCardNumberChanged",{creditCardNumber:k,placementType:d._placementType})}this.value=a.fixSpacing(this.value)}),e.keyup(function(){0<this.value.length?c.hideElement(d.getDOMElement("CardScannerWrapperJSBinding")):(c.showElement(d.getDOMElement("CardScannerWrapperJSBinding")),d.widget.trigger("creditCardNumberChanged",{creditCardNumber:"",
placementType:d._placementType}))}));e.keyup(function(k){"number"!==this.type&&this.value!==f&&(k=this.selectionStart,this.value=a.fixSpacing(this.value),k=a.fixCaret(k,this.value,f,h),this.setSelectionRange(k,k));k=e.val().replace(/\s/g,"");(d._isCombineAddCCAndDCEnabled||d._isMCXRegistrationEnabled)&&F.test(k)&&8===k.length&&(k=d.generateValidCardNumber(this.value),d.widget.trigger("creditCardNumberChanged",{creditCardNumber:k,placementType:d._placementType}))});this._showExpiryDateTextInputField&&
this._expiryDateTextInputBinding&&n.keydown(function(a){a.preventDefault();var d=a.keyCode;if(d<=q.keys.VK_NINE&&d>=q.keys.VK_ZERO||d===q.keys.VK_BACKSPACE||d===q.keys.VK_DELETE){var k=a.target.selectionStart,b=a.target.selectionEnd,e=this.value;d===q.keys.VK_BACKSPACE&&k===b?e=2<k&&5>=k?e[0]+e.slice(2,e.length):e.slice(0,k-1)+e.slice(b,e.length):d!==q.keys.VK_BACKSPACE&&d!==q.keys.VK_DELETE||k===b?d!==q.keys.VK_BACKSPACE&&d!==q.keys.VK_DELETE&&(e=e.slice(0,k)+a.originalEvent.key+e.slice(b,e.length)):
e=e.slice(0,k)+e.slice(b,e.length);e=e.replace(/\D/g,"");"1"<e[0]&&(e="0"+e);"1"===e[0]&&"2"<e[1]?e="3">e[2]?e[0]+e.slice(2,e.length):"3">e[3]?e[0]+e.slice(3,e.length):e[0]:"0"===e[0]&&"0"===e[1]&&(e="0"<e[2]?e[0]+e.slice(2,e.length):"0"<e[3]?e[0]+e.slice(3,e.length):e[0]);2<=e.length&&(e=e.slice(0,2)+" / "+e.slice(2,4));this.value=e;n.trigger("input",{})}});k.bind("change",function(a){a=k.val();d.widget.trigger("accountHolderNameChange",{accountHolderName:a})});this._isCCSyncVerificationEnabled&&
this._isSynchronousVerificationCardAdditionComplete&&this._isSecureRegistrationPageTriggerShown&&this.closeAddCreditCardPopover({});this._isCreditCardAdditionsBlocked&&this.widget.trigger("creditCardAdditionsBlockedEvent",{deviceType:this._deviceType,isSecureRegistration:this._isSecureRegistrationWidget||this._isSecureRegistrationPageTriggerShown,isCreditCardCVVVerificationFailed:this._isCreditCardCVVVerificationFailed,rateLimitDurationInSeconds:this._rateLimitDurationInSeconds,isDynamicRateLimitMessage:this._isDynamicRateLimitMessage});
this._isCCSyncVerificationEnabled&&this._isCreditCardCVVVerificationFailed&&this._setVerificationFailedErrorMessageHeader();z.bindToElements.apply(this)},_setVerificationFailedErrorMessageHeader:function(){var a=g(".pmts-add-credit-card-component-container");a&&(a=a.find(".a-alert-error"))&&a.find(".a-alert-heading")&&1===a.find(".a-alert-heading").length&&a.find(".a-alert-heading").html(this.widget.getLocalizedString("pmts_portal_add_credit_card_verify_failed_heading"))},bindToEvents:function(){var a=
this;this.widget.on(d,this,function(d){if(d.action===this._action){this._recordCCScannerMetrics(d.submissionParameters);d&&d.submissionParameters&&(this._recordCCTapToAddMetrics(d.submissionParameters),a._ccTapToAddParams=null);var k=g(this.getDOMElement(this._addButtonJSBinding)).closest("form"),b=this.getDOMElement(this._addButtonJSBinding),e;l.forEach(d.submissionParameters,function(a,d){"ppw-accountHolderName"===a.name&&(e=a.value)});k.append(this._buildHiddenInput("__sif_encrypted_hba_account_holder_name",
e));b.find("input").each(function(a,d){h.ensureWidgetEventInput(k,d.name)});d=k.find("input[type\x3d'hidden'][name\x3d'ppw-issuer']");0<d.length?d.val(this._issuer):k.append(this._buildHiddenInput("ppw-issuer",this._issuer));n.mocked(this,this._action,function(){k.submit()});this._isCCSyncVerificationEnabled||this.closeAddCreditCardPopover({});this._addCreditCardFormSubmitMetric()}});this.widget.on("accountHolderNameChange",this,function(d){var k=a.getDOMElement(a._addNameOnAccountCheckboxBinding);
g.trim(d.accountHolderName)!==k.val()?k.prop("checked",!1):k.prop("checked",!0)});a.widget.on("resetAccountHolderNameCheckbox",a,function(){a.getDOMElement(a._addNameOnAccountCheckboxBinding).prop("checked",!1);a.getDOMElement(a._accountHolderNameBinding).val("")});this.widget.on("creditCardIssuerDetermined",this,function(d){this._issuer=d.issuer;this._isMbcc="true"===d.isMbcc;this._cardType=d.cardType;this._isBlockCardRegistration="true"===d.isBlockCardRegistration;if(this._showIssuerImageOnTextInputField&&
d.issuerImage){var k=this.getDOMElement(this._addCardNumberBinding);c.setElementBackgroundImage(k,d.issuerImage)}-1!==g.inArray(this._issuer,this._warningBrands)&&'"CREDIT"'===this._cardType&&(c.showElement(g(".apx-add-payment-inline-warning-message")),a.widget.publishSuccessSushiMetrics({ActionType:this._warningCategory||"WarningCategoryUndefined",ActionValueType:"Messaging",ActionValue:"Add-PM"}));this._isCCSyncVerificationEnabled&&(d.cvvHelpPopoverDescriptionStringId&&(k=a.widget.getLocalizedString(d.cvvHelpPopoverDescriptionStringId),
this.getDOMElement("CardSecurityCodeHelpDescription").text(k)),d.cvvHelpPopoverImageURL&&this.getDOMElement("CardSecurityCodeHelpImage").attr("src",d.cvvHelpPopoverImageURL));this._updateCreditCardFields()});this.widget.on("cardTypeDetermined",this,function(a){a='"DEBIT"'===a;c.toggleElement(this.getDOMElement("warningMessagesBoxContainer"),a)});this.widget.on(G,this,function(a){this._issuer="";this._isBlockCardRegistration=this._isMbcc=!1;c.hideElement(g(".apx-add-payment-inline-warning-message"));
this._showIssuerImageOnTextInputField&&(a=this.getDOMElement(this._addCardNumberBinding),c.setElementBackgroundImage(a,this._blankIssuerImageURL));this._updateCreditCardFields()});this.widget.on("addCreditCardScannerInfo",this,function(d){this._ccScannerParams=d;d.accountHolderName&&this.getDOMElement("accountHolderName").val(d.accountHolderName);d.creditCardNumber&&(c.hideElement(a.getDOMElement("CardScannerWrapperJSBinding")),this._populateCreditCardNumber(d.creditCardNumber));d.expirationDate&&
this._populateCreditCardExpiryDate(d.expirationDate.month,d.expirationDate.year);this._isMCXRegistrationEnabled&&(d=this.form.validateForm(),z.blameFormField.apply(this,[d]),this._toggleAddCardButtonDisabled(0<d.length))});this.widget.on("addCreditCardTapInfo",this,function(a){this._ccTapToAddParams=a;this._validateInputForTapSuccessEvent(a)?(this._displayTapToAddAlert("warning",a.successAlertMessage),a.cardInfo.creditCardNumber!==this._tapToAddNullField&&this._populateCreditCardNumber(a.cardInfo.creditCardNumber),
a.cardInfo.cardHolderName!==this._tapToAddNullField&&this._populateCreditCardHolderName(a.cardInfo.cardHolderName),this._populateCreditCardExpiryDate(a.cardInfo.expirationMonth,a.cardInfo.expirationYear),this._publishLatencyMetricsForTapToAdd("CardTapped_Latency",a.startTimeAfterCardTapped,a.processIsolation),this._publishLatencyMetricsForTapToAdd("Overall_Latency",a.startTimeAtButtonClick,a.processIsolation),this._publishCounterMetricsForTapToAdd("CreditCardInfo_Populated",a.processIsolation)):this._publishCounterMetricsForTapToAdd("SuccessEventObjInvalid",
a.processIsolation);this._emitMetricsForTapSuccessEvent(a)});this.widget.on("tapToAddCardFailureEvent",this,function(a){a&&a.failureAlertMessage?this._displayTapToAddAlert("error",a.failureAlertMessage):this._publishCounterMetricsForTapToAdd("FailureEventObjInvalid",a.processIsolation);this._emitMetricsForTapFailureEvent(a)});this.widget.on("debitCardTypeSelected",this,function(a){this._selectedDebitCardIssuingBank=a.selectedBank;this._updateCreditCardFields()});this.widget.on("showAddConsumerInvoicingSleeve",
this,function(a){a=g(".pmts-mobile-add-credit-card-container");k.getExpanderHelper(a).isExpanded()&&a.find(".a-expander-header").click()});this.widget.on("componentsInitialized",this,function(a){this._initPopoverState();this._isMCXRegistrationEnabled&&this._toggleAddCardButtonDisabled(!0)});this.widget.on(x,this,function(){b.when("a-modal").execute(function(a){a&&(a=a.get("pmtsAddCreditCardPopover"))&&a.hide()})});this.widget.on(t,this,function(d){a._isMPCIntegrationTypeSupported(d.integType)&&(a._isMPCIntegrationRequired=
!0,a._integrationType=d.integType,a._mpcInitializedTime=d.initializedTime,a._mpcPopoverAction=d.mpcPopoverAction,a._mpcPopoverActionId=d.mpcPopoverActionId)});this.widget.on(D,this,function(k){a._isMPCIntegrationTypeSupported(k.integType)&&(a._isMPCIntegrationRequired=!1,a._formSubmissionEventObj&&this.widget.trigger(d,this._formSubmissionEventObj))});this.widget.on(A,this,function(d){d.data&&"CC"===d.data.paymentMethod&&(d.clickData&&d.clickData.startTimestamp&&d.clickData.startTimestampSource&&
e.logLatencyMetric({feature:d.clickData.startTimestampSource+K.SEPARATOR+K.CARD_REGISTRATION_FORM_VIEW,resource:"_Latency",startTime:d.clickData.startTimestamp}),e.logCounterMetric({feature:"CardSecureRegistrationLoadSuccess_"+a._getDeviceType(),resource:"_Count"}),M&&(e.logLatencyMetric({feature:"CardSecureRegistrationLoadTime",resource:"_Latency",startTime:M}),M=null));e.publishMetrics()});this.widget.on("creditCardAdditionsBlockedEvent",this,function(a){this._displayCardAdditionsBlockedUI(a.isSecureRegistration,
a.deviceType,a.isCreditCardCVVVerificationFailed,a.rateLimitDurationInSeconds,a.isDynamicRateLimitMessage)});this.widget.on("triggerAddCardFlow",this,function(){a._isSecureRegistrationPageTriggerShown?this.getDOMElement("AddCreditCardContentTrigger").trigger("click"):(a.widget.trigger(H,{instrumentId:"SelectableAddCreditCard"}),g(".pmts-add-credit-card-component-container").get(0).scrollIntoView())})},_getDeviceType:function(){return this._isRequestForMobileApp?"mobileapp":this._isMobile?"mobileweb":
this._deviceType},_buildHiddenInput:function(a,d){return g("\x3cinput\x3e").attr({type:"hidden",name:a,value:d})},_emitMetricsForTapFailureEvent:function(a){this._publishCounterMetricsForTapToAdd("FailureEventReceived",a.processIsolation);a?a.failureAlertMessage||this._publishCounterMetricsForTapToAdd("FailureEventAlertMessageNull",a.processIsolation):this._publishCounterMetricsForTapToAdd("FailureEventObjNull",a.processIsolation)},_validateInputForTapSuccessEvent:function(a){return a&&a.cardInfo&&
a.cardInfo.creditCardNumber&&a.cardInfo.expirationMonth&&a.cardInfo.expirationYear&&a.cardInfo.cardHolderName&&a.successAlertMessage?!0:!1},_emitMetricsForTapSuccessEvent:function(a){this._publishCounterMetricsForTapToAdd("SuccessEventReceived",a.processIsolation);a?(a.successAlertMessage||this._publishCounterMetricsForTapToAdd("SuccessEventAlertMessageNull",a.processIsolation),a.cardInfo||this._publishCounterMetricsForTapToAdd("SuccessEventObjCardInfoNull",a.processIsolation)):this._publishCounterMetricsForTapToAdd("SuccessEventObjNull",
a.processIsolation)},_displayTapToAddAlert:function(a,d){c.showElement(this.getDOMElement("tapToAddAlert"));b.when("a-alert").execute(function(k){k("#tap-to-add-alert-id").type(a).text(d).show()})},_publishCounterMetricsForTapToAdd:function(a,d){var k="AddCreditCard_TapToAdd_";d&&(k+="PI_");e.logCounterMetric({feature:k+a,resource:"_Count"});e.publishMetrics()},_publishLatencyMetricsForTapToAdd:function(a,d,k){var b="AddCreditCard_TapToAdd_";k&&(b+="PI_");e.logLatencyMetric({feature:b+a,resource:"_Latency",
startTime:d});e.publishMetrics()},_populateCreditCardNumber:function(a){this.getDOMElement("addCreditCardNumber").val(a);this.widget.trigger("creditCardNumberChanged",{creditCardNumber:a,placementType:self._placementType})},_populateCreditCardExpiryDate:function(a,d){this._showExpiryDateTextInputField&&this._expiryDateTextInputBinding?this.getDOMElement(this._expiryDateTextInputBinding).val(a+" / "+d%100):(this.form.getAUITagHelperForParameter("expirationDate_month").val(a),this.form.getAUITagHelperForParameter("expirationDate_year").val(d))},
_populateCreditCardHolderName:function(a){this.getDOMElement(this._accountHolderNameBinding).val(a)},_displayCardAdditionsBlockedUI:function(a,d,e,n,l){var f=this.widget.getLocalizedString("pm_add_card_rate_limit_and"),q=this.widget.getLocalizedString("pm_add_card_rate_limit_hours"),h=this.widget.getLocalizedString("pm_add_card_rate_limit_hour"),z=this.widget.getLocalizedString("pm_add_card_rate_limit_minute"),x=this.widget.getLocalizedString("pm_add_card_rate_limit_minutes");if(0<g(".pmts-add-credit-card-component-container").length){var t=
g(".pmts-add-credit-card-component-container");0<t.find("form").length&&c.hideElement(t.find("form"));if(this._isRequestForMobileApp&&a&&("YA:MPO"===this._clientId||"YA:OneClick"===this._clientId||"Checkout"===this._clientId||"YA:Wallet"===this._clientId)){0<n&&(l?w.displayTimer(n,f,q,h,z,x):w.display(n));var v=this;b.when("A","mash").execute(function(a,d){d.dispatchEvent({type:"BlockCardAdditionsEvent",detail:{isCreditCardCVVVerificationFailed:v._isCreditCardCVVVerificationFailed,rateLimitDurationInSeconds:n,
andString:f,hoursString:q,hourString:h,minuteString:z,minutesString:x,isDynamicRateLimitMessage:l}});(v._isCreditCardCVVVerificationFailed||v._isSecureRegistrationWidget)&&d.navstack.begin().back().end()})}else a?b.when("A","ready").execute(function(a){p.parent.postMessage(JSON.stringify({event:{name:"apx:add-payment-method:BlockCardAdditionsEvent",data:{iFrameName:this._secureIframeName,isCreditCardCVVVerificationFailed:e,rateLimitDurationInSeconds:n,andString:f,hoursString:q,hourString:h,minuteString:z,
minutesString:x,isDynamicRateLimitMessage:l}}}),"*")}):("mobile"===d&&0<g(".a-expander-header.pmts-mobile-add-credit-card-header").length?(a=g(".a-expander-header.pmts-mobile-add-credit-card-header"),k.getExpanderHelper(a).isExpanded()||a.click(),a.addClass("pmts-add-cc-link-disabled")):("desktop"===d||"tablet"===d)&&0<g(".a-expander-header.pmts-add-new-card").length&&(a=g(".a-expander-header.pmts-add-new-card"),k.getExpanderHelper(a).isExpanded()||a.click(),a.addClass("pmts-add-cc-link-disabled")),
e?1===t.find(".pmts-add-cc-alert-container").length&&t.find(".pmts-add-cc-alert-container").removeClass("a-hidden aok-hidden"):0<n?l?w.displayTimer(n,f,q,h,z,x):w.display(n):1===t.find(".pmts-add-cc-info-container").length&&t.find(".pmts-add-cc-info-container").removeClass("a-hidden aok-hidden"))}},_recordCCScannerMetrics:function(a){if(this._ccScannerParams){var d={};l.forEach(a,function(a,k){d[a.name]=g.trim(a.value)});d["ppw-accountHolderName"]===this._ccScannerParams.accountHolderName&&e.logCounterMetric({feature:"CreditCardScannerAccountHolderNameEvent",
resource:"_SuccessCount"});d.addCreditCardNumber===this._ccScannerParams.creditCardNumber&&e.logCounterMetric({feature:"CreditCardScannerPANEvent",resource:"_SuccessCount"});d["ppw-expirationDate_month"]===this._ccScannerParams.expirationDate.month&&d["ppw-expirationDate_year"]===this._ccScannerParams.expirationDate.year&&e.logCounterMetric({feature:"CreditCardScannerExpirationDateEvent",resource:"_SuccessCount"});this._ccScannerParams=null}},_isCCInfoModified:function(a,d,k){a===d?(this._publishCounterMetricsForTapToAdd(k+
"_Accurate",this._ccTapToAddParams.processIsolation),a=!1):(this._publishCounterMetricsForTapToAdd(k+"_Modified",this._ccTapToAddParams.processIsolation),a=!0);return a},_recordCCTapToAddMetrics:function(a){if(this._validateInputForTapSuccessEvent(this._ccTapToAddParams)&&a){var d={};l.forEach(a,function(a,k){d[a.name]=g.trim(a.value)});a=this._isCCInfoModified(d.addCreditCardNumber,this._ccTapToAddParams.cardInfo.creditCardNumber,"CreditCardNumber");var k=this._isCCInfoModified(d["ppw-expirationDate_month"],
this._ccTapToAddParams.cardInfo.expirationMonth,"CreditCardExpiryMonth"),b=this._isCCInfoModified(d["ppw-expirationDate_year"],this._ccTapToAddParams.cardInfo.expirationYear,"CreditCardExpiryYear");a||k||b?this._publishCounterMetricsForTapToAdd("CreditCardInfo_Modified",this._ccTapToAddParams.processIsolation):this._publishCounterMetricsForTapToAdd("CreditCardInfo_Accurate",this._ccTapToAddParams.processIsolation)}},_updateCreditCardFields:function(){this.toggleExpirationDates(this._issuer);this.toggleExpirationDatesWithNoExpiryInfo(this._issuer);
this._isRenderBlockCardRegistrationIMB&&(this.toggleTurnOffIMB(this._isBlockCardRegistration),c.toggleDisabledElement(this.getDOMElement(this._addButtonJSBinding),!this._isBlockCardRegistration));this.triggerBehaviourForElements(this._issuer);this.toggleExpiryMonthAndYearByIssuer(this._issuer);this.updateMbccFields(this._isMbcc);this._updateRealtimeValidation()},triggerBehaviourForElements:function(a){if("add-debit-card"===this._action){var d=this.form.fields.addCreditCardVerificationNumber_VDC.fieldRequiredParameterName;
var k=this.form.fields.addCreditCardPostalCode_VDC.fieldRequiredParameterName}else"add-emi-credit-card"===this._action?(d=this.form.fields.addCreditCardVerificationNumber_VCC.fieldRequiredParameterName,k=this.form.fields.addCreditCardPostalCode_EMI.fieldRequiredParameterName):(d=this.form.fields.addCreditCardVerificationNumber.fieldRequiredParameterName,k=this.form.fields.addCreditCardPostalCode.fieldRequiredParameterName);this._isINMarketplace&&(a||this._selectedDebitCardIssuingBank)?-1!==g.inArray(a,
this._issuersRequirePostalCode)?(this.showPostalCodeRow(),this.hideCVVRow(),this.form.getAUITagHelperForParameter(d).val(!1),this.form.getAUITagHelperForParameter(k).val(!0)):-1!==g.inArray(a,this._issuersRequireSecurityToken)?(this.hidePostalCodeRow(),this.showCVVRow(),this.form.getAUITagHelperForParameter(d).val(!0),this.toggleExpiryMonthAndYear(!0),this.form.getAUITagHelperForParameter(k).val(!1)):this._isCombineAddCCAndDCEnabled?(this.hideCVVRow(),this.form.getAUITagHelperForParameter(d).val(!1),
"BFL"===a&&this.toggleExpiryMonthAndYear(!0)):"add-debit-card"===this._action&&this._selectedDebitCardIssuingBank in this._debitCardConfiguration&&(this.toggleCVVRow(this._debitCardConfiguration[this._selectedDebitCardIssuingBank].showCvv),this.toggleExpiryMonthAndYear(this._debitCardConfiguration[this._selectedDebitCardIssuingBank].showExpiry)):this._isGPACVVEnabledForCardRegistrationOption&&(a&&-1==g.inArray(a,this._brandRequiringCVVAuthenticationList)?(this.hideCVVRow(),this.form.getAUITagHelperForParameter(d).val(!1)):
a&&-1!==g.inArray(a,this._brandRequiringCVVAuthenticationList)&&(this.showRequiredCVVRow(),this.form.getAUITagHelperForParameter(d).val(!0)))},showCVVRow:function(){null!=g(".addCreditCardVerificationNumberRow")&&c.showElement(g(".addCreditCardVerificationNumberRow"))},showRequiredCVVRow:function(){this._isMCXRegistrationEnabled&&null!=g(".mcx-cvv-input")?c.showElement(g(".mcx-cvv-input")):null!=g(".addCreditCardRequiredVerificationNumberRow")&&c.showElement(g(".addCreditCardRequiredVerificationNumberRow"))},
hideCVVRow:function(){null!=g(".addCreditCardVerificationNumberRow")&&c.hideElement(g(".addCreditCardVerificationNumberRow"));null!=g(".addCreditCardRequiredVerificationNumberRow")&&c.hideElement(g(".addCreditCardRequiredVerificationNumberRow"));null!=g(".mcx-cvv-input")&&c.hideElement(g(".mcx-cvv-input"))},toggleExpiryMonthAndYearByIssuer:function(a){"InternationalMaestro"===a&&this._suppressExpirationForInternationalMaestro&&this.toggleExpiryMonthAndYear(!1)},toggleExpiryMonthAndYear:function(a){c.toggleElement(this.getDOMElement(this._JsBindingExpirationDateLabel),
a);c.toggleElement(this.getDOMElement(this._JsBindingExpirationMonthDropdown),a);c.toggleElement(this.getDOMElement(this._JsBindingExpirationYearDropdown),a);if("add-debit-card"===this._action){var d=this.form.fields.expirationDate_VDC.monthParameterName;var k=this.form.fields.expirationDate_VDC.yearParameterName}else"add-credit-card"===this._action&&(d=this.form.fields.expirationDate.monthParameterName,k=this.form.fields.expirationDate.yearParameterName);a?(this.form.getAUITagHelperForParameter(d).val("01"),
this.form.getAUITagHelperForParameter(k).val((new Date).getUTCFullYear())):(this.form.getAUITagHelperForParameter(d).val("12"),this.form.getAUITagHelperForParameter(k).val((new Date).getUTCFullYear()+19))},toggleCVVRow:function(a){null!=g(".addCreditCardVerificationNumberRow")&&(c.toggleElement(g(".addCreditCardVerificationNumberRow"),a),this.form.getAUITagHelperForParameter(this.form.fields.addCreditCardVerificationNumber_VDC.fieldRequiredParameterName).val(a))},showPostalCodeRow:function(){null!=
g(".addCreditCardPostalCodeRow")&&c.showElement(g(".addCreditCardPostalCodeRow"))},hidePostalCodeRow:function(){null!=g(".addCreditCardPostalCodeRow")&&c.hideElement(g(".addCreditCardPostalCodeRow"))},updateMbccFields:function(a){var d=this.form.fields;this._isCvvForMbcc&&d.mobileNumber&&d.addCreditCardVerificationNumber&&(c.toggleElement(this.getDOMElement("addCreditCardMbccFields"),a),this.form.getAUITagHelperForParameter(d.mobileNumber.fieldRequiredParameterName).val(a),this.form.getAUITagHelperForParameter(d.addCreditCardVerificationNumber.fieldRequiredParameterName).val(a))},
toggleExpirationDates:function(a){var d=this;a=-1!==g.inArray(a,this._issuersHaveNoExpiration);g(".pmts-expiry-month").toggleClass("a-button-disabled",a);g("[name\x3d'ppw-expirationDate_month']").prop("disabled",a);g(".pmts-expiry-year").toggleClass("a-button-disabled",a);g("[name\x3d'ppw-expirationDate_year']").prop("disabled",a);g(".apx-expiry-combinedMonthYear").toggleClass("a-form-disabled",a);g("[name\x3d'ppw-expirationDate_combinedMonthYear']").prop("disabled",a);a&&(g('[name\x3d"addCreditCardNumber"]').trigger("click"),
l.forEach(d.form.formModel.constraints,function(a){"CreditCardExpirationConstraint"===a.validation&&d.form.formModel.constraints.splice(g.inArray(a,d.form.formModel.constraints),1)}))},toggleExpirationDatesWithNoExpiryInfo:function(a){a=-1!==g.inArray(a,this._issuersHaveNoExpiration);g("#add-credit-card-expiry-date-input-id").toggleClass("aok-hidden",a);g("#add-credit-card-no-expiry-date-info-id").toggleClass("aok-hidden",!a)},toggleTurnOffIMB:function(a){c.toggleElement(this.getDOMElement(this._addCreditCardTurnOffIMBJSBinding),
!a);c.toggleElement(this.getDOMElement(this._addPNCCardTurnOffIMBJSBinding),a)},getIssuer:function(){return this._issuer},getIsMbcc:function(){return this._isMbcc},getIsSBIMaestro:function(){if(this._selectedDebitCardIssuingBank)return this._selectedDebitCardIssuingBank===this._debitCardSBIMaestroValue},_bindAddCreditCardTrigger:function(){var a=this,d=a._isMCXRegistrationEnabled?"add-credit-card-mcx-action-name":this._declarativeActionName;b.when("A").execute(function(k){k.declarative(d,"click",
function(){M=(new Date).getTime();e.logCounterMetric({feature:"CardSecureRegistrationLinkClicked_"+a._getDeviceType(),resource:"_Count"});a.widget.publishSuccessSushiMetrics({ActionType:"StartAddCreditCard",ActionValueType:"Click",ActionValue:"SecureAddCreditCardLinkClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:a._purchaseId});J.publishAddPaymentLinkClickedMetrics(a._getDeviceType(),a._apx3RegisterFeatureWeblabName,a._apx3RegisterFeatureWeblabTreatment,r);a._isApx3RegisterDesktopEnabled?
(E.emitCounterMetric("NavigateToUpxRegistration",[a._getDeviceType()],!1),J.webPostToSecureIframe(a.widget,a._secureIframeName,{startTimestamp:M,startTimestampSource:K.ADD_NEW_PAYMENT_METHOD_LINK})):a.widget.trigger(m,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:a._creatablePaymentMethods,iFrameName:a._secureIframeName}})})})},_bindNonSecureAddCreditCardTrigger:function(){b.when("A").execute(function(a){a.declarative("a-modal","click",function(){e.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",
resource:"_Count"})})})},_addCreditCardFormSubmitMetric:function(){e.logCounterMetric({feature:this._isSecureRegistrationWidget?"CC_SecureRegistrationFormSubmitted":"CC_NonSecureRegistrationFormSubmitted",resource:"_Count"})},_toggleAddCardButtonDisabled:function(a){if(this._isMCXRegistrationEnabled){var d=this.getDOMElement(this._addButtonJSBinding);d.toggleClass("a-button-disabled",a);d.css("pointer-events",a?"none":"auto")}},_updateRealtimeValidation:function(){if(this._isMCXRegistrationEnabled){this._toggleExpirationDateValidation(this._issuer);
var a=this.form.validateForm(!0);this._toggleAddCardButtonDisabled(0<a.length)}},_toggleExpirationDateValidation:function(a){var d=this,k=d._issuersHaveNoExpiration.includes(a);l.forEach(d.form.formModel.constraints,function(a){d.form.isMCXValidationConstraint(a)&&"expirationDate"==a.field&&(a.metaData.disabled=k)})}})});m("components/AddCreditCardWorkflowComponent","css-utils jQuery component lang events/InstrumentRowSelectedEvent AUI!P mash-helper clog events/postToSecureIframeEvent mixins/secure-container-support".split(" "),
function(c,g,f,h,l,b,e,n,q,a){return f.extend(a,{initialize:function(a,d){this._inPickAddressWorkflow=d.data.inPickAddressWorkflow;this.addCardIntermittentStepRemoved=d.data.addCardIntermittentStepRemoved;this._isSelectableTemplate=d.data.isSelectableTemplate;this._isSecureRegistrationWidget=d.data.isSecureRegistrationWidget;this._isRequestForMobileApp=d.data.isRequestForMobileApp;this._listenerSecurePaymentMethodAddedEvent=d.data.listenerSecurePaymentMethodAddedEvent;this._dispatcherSecurePaymentMethodAddedEvent=
d.data.dispatcherSecurePaymentMethodAddedEvent;this._isAddCreditCardWorkflowWidget=d.data.isAddCreditCardWorkflowWidget;this._secureIframeName=d.data.secureIframeName;this._isCCSyncVerificationEnabled=d.data.isCCSyncVerificationEnabled;this._dynamicContinueEnabled=d.data.dynamicContinueEnabled;this._shouldApplyRateLimitLogic=d.data.shouldAppendRateLimitAlertBox;this._isDynamicRateLimitMessage=d.data.isDynamicRateLimitMessage;this._isNomenclatureWave2Enabled=d.data.isNomenclatureWave2Enabled;this._shouldProceedToSPC=
d.data.shouldProceedToSPC;this._isSelectableTemplate&&!this._inPickAddressWorkflow&&(c.toggleElement(this.getDOMElement("selectableAddCreditCardWorkflowStateBody"),!1),c.toggleElement(this.getDOMElement("selectableAddDebitCardWorkflowStateBody"),!1),c.toggleElement(this.getDOMElement("selectableEmiAddCreditCardWorkflowStateBody"),!1));this.data.placementType!==r?(this._isDebit="DebitCard"===this.data.placementType,this._isEmi="EmiCreditCard"===this.data.placementType):(this._isDebit=this.data.isDebit,
this._isEmi=!1);this._creatablePaymentMethods=this._isDebit?"DC":"CC";var k=this;k._isRequestForMobileApp&&k._isAddCreditCardWorkflowWidget&&(e.addEventListener(k._listenerSecurePaymentMethodAddedEvent,function(a){k._addEventListenerAddCCWorkflowHandler(a)}),e.setBookmark("addccworkflow-widget"));k._isRequestForMobileApp&&(k._isCCSyncVerificationEnabled||this._shouldApplyRateLimitLogic)&&e.addEventListener("BlockCardAdditionsEvent",function(a){if(p.app&&p.app.willReappear){var d=p.app.willReappear;
delete p.app.willReappear}p.setTimeout(function(){p.app&&d&&(p.app.willReappear=d)},100);p.parent.postMessage(JSON.stringify({event:{name:"apx:add-payment-method:BlockCardAdditionsEvent",data:{iFrameName:k._secureIframeName,isCreditCardCVVVerificationFailed:a.detail.isCreditCardCVVVerificationFailed,rateLimitDurationInSeconds:a.detail.rateLimitDurationInSeconds,andString:a.detail.rateLimitAndString,hoursString:a.detail.rateLimitHoursString,hourString:a.detail.rateLimitHourString,minuteString:a.detail.rateLimitMinuteString,
minutesString:a.detail.rateLimitMinutesString,isDynamicRateLimitMessage:a.detail.isDynamicRateLimitMessage}}}),"*")})},_addEventListenerAddCCWorkflowHandler:function(a){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(a.detail.paymentInstrumentId,a.detail.widgetAction,a.detail.walletId):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a.detail.paymentInstrumentId,"ppw-widgetAction":a.detail.widgetAction,
"ppw-maybeWalletId":a.detail.walletId});e.backToBookmark("addccworkflow-widget")},bindToElements:function(){var a=this;a.getDOMElement("useECardLink").bind("click",function(d){a.widget.trigger("useECardEvent");c.showElement(g(a.getDOMElement("eCardHelp")));return!1})},bindToEvents:function(){this._isAddCreditCardWorkflowWidget&&this.widget.trigger(q,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:this._creatablePaymentMethods,iFrameName:this._secureIframeName}});this.widget.on("componentsInitialized",
this,function(){this._isSelectableTemplate&&this._inPickAddressWorkflow&&(this._isDebit?this._triggerSelectableAddDebitCardSelected():this._isEmi?this.widget.trigger("selectableAddEmiCardSelectedOnInitialize"):this.widget.trigger(l,{instrumentId:"SelectableAddCreditCard"}))});this.widget.on("selectableAddCreditCardSelected",this,function(){this.addCardIntermittentStepRemoved||c.toggleElement(this.getDOMElement("selectableAddCreditCardWorkflowStateBody"),!0)});this.widget.on("selectableAddCreditCardDeselected",
this,function(){c.toggleElement(this.getDOMElement("selectableAddCreditCardWorkflowStateBody"),!1)});this.widget.on("selectableAddDebitCardSelected",this,function(){this.addCardIntermittentStepRemoved||c.toggleElement(this.getDOMElement("selectableAddDebitCardWorkflowStateBody"),!0)});this.widget.on("selectableAddDebitCardDeselected",this,function(){c.toggleElement(this.getDOMElement("selectableAddDebitCardWorkflowStateBody"),!1)});this.widget.on("selectableEmiAddCreditCardSelected",this,function(){this.addCardIntermittentStepRemoved||
c.toggleElement(this.getDOMElement("selectableEmiAddCreditCardWorkflowStateBody"),!0)});this.widget.on("selectableEmiAddCreditCardDeselected",this,function(){c.toggleElement(this.getDOMElement("selectableEmiAddCreditCardWorkflowStateBody"),!1)});this.widget.on("selectableAddCreditCardSelected",this,function(){this._isNomenclatureWave2Enabled&&b.when("A","ready").execute(function(a){a=a.$;a(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!1);this.addCardIntermittentStepRemoved||
a(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-shrunk",!1)})});this.widget.on("selectableAddCreditCardDeselected",this,function(){this._isNomenclatureWave2Enabled&&b.when("A","ready").execute(function(a){a=a.$;a(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!1);this.addCardIntermittentStepRemoved||(a(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!0),
a(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-shrunk",!0))})});var a=this;this.widget.on("WidgetAction",this,function(d){"add-payment-instrument"===d.widgetActionType&&"add-credit-card-workflow-complete"===d.widgetAction&&a._isSecureRegistrationWidget&&a._isRequestForMobileApp&&(d.interstitialPageUrl?(console.log("Dispatching Update Everywhere event: interstitial URL [",d.interstitialPageUrl,"]"),e.dispatchEvent("LaunchUpdateEverywhereEvent",{interstitialPageUrl:d.interstitialPageUrl})):
this._shouldProceedToSPC?e.dispatchEvent(a._dispatcherSecurePaymentMethodAddedEvent,{paymentInstrumentId:d.paymentInstrumentId,widgetAction:d.widgetAction,walletId:d.walletId,instrumentRegistrationType:d.instrumentRegistrationType,paymentMethod:d.paymentMethod,canProceedToSPC:d.canProceedToSPC,issuer:d.issuer,executionStartTime:d.executionStartTime}):e.dispatchEvent(a._dispatcherSecurePaymentMethodAddedEvent,{paymentInstrumentId:d.paymentInstrumentId,widgetAction:d.widgetAction,walletId:d.walletId}),
n.logCounterMetric({feature:"CardRegistrationSuccess_mobileapp",resource:"_Count"}),n.publishMetrics())})},_triggerSelectableAddDebitCardSelected:function(){this.widget.trigger("selectableAddDebitCardSelectedOnInitialize",{inPickAddressWorkflow:this._inPickAddressWorkflow})}})});m("components/AddDebitCardWorkflowComponent",["component"],function(c){return c.extend({})});m("events/CreditCardIssuerDeterminedEvent",["public-event-registry"],function(c){c.register("creditCardIssuerDetermined");return"creditCardIssuerDetermined"});
m("events/CreditCardNumberResetEvent",["public-event-registry"],function(c){c.register("creditCardNumberReset");return"creditCardNumberReset"});m("components/AddCardAuthComponent","events/form-submitted-event jQuery css-utils form-component mini-browser-helper lang clog AUI!P mash-helper modal-popover".split(" "),function(c,g,f,h,l,b,e,n,q,a){var k={width:600,height:650};return h.extend({initialize:function(d,k){this._interstitialPageUrl=k.data.originUri+k.data.interstitialPageUrl;this._isMiniBrowserEnabled=
k.data.isMiniBrowserEnabled;this._instrumentId=k.data.instrumentId;this._widgetAction=k.data.widgetAction;this._isRequestForMobileApp=k.data.isRequestForMobileApp;this._clientReferenceId=k.data.clientReferenceId;this._executionStatus=k.data.executionStatus;this._shouldRenderInPopover=k.data.shouldRenderInPopover;this._isLandingPageEnabled=k.data.isLandingPageEnabled;this._redirectionUseCase=k.data.redirectionUseCase;this._retries=0;this._shouldRenderInPopover&&(this.popover=new a(d,k,this));"add-card-auth-start"===
this._widgetAction?this._isRequestForMobileApp?"VerifyAtWallet"===this._redirectionUseCase?p.location.href=this._interstitialPageUrl:q.setUrlInCurrentWebview(this._interstitialPageUrl):this._isMiniBrowserEnabled?this._isMiniBrowserEnabled&&!this._isLandingPageEnabled&&(this._swapToSpinnerSection(),this._openAddCardAuthMiniBrowserWindow(this._interstitialPageUrl)):p.location.href=this._interstitialPageUrl:"add-card-auth-polling"===this._widgetAction&&("SUCCESS"===this._executionStatus?this._swapToSuccessSection():
"FAILURE"===this._executionStatus?this._swapToFailureSection():(this._swapToSpinnerSection(),this._pollAuthenticationSourceForNextAction()))},bindToEvents:function(){this.widget.on("add-card-auth-popover-closed",this,function(a){this.getDOMElement("pmts-add-card-auth-popover-cancel-form").submit()})},bindToElements:function(){var a=this;n.when("A","a-modal","ready").execute(function(d,k){a.getDOMElement("apx-add-card-auth-modal-go-button").click(function(){a._swapToSpinnerSection();a._openAddCardAuthMiniBrowserWindow(a._interstitialPageUrl)})});
n.when("A","a-modal","ready").execute(function(d,k){a.getDOMElement("apx-add-card-post-auth-skip-button").click(function(){a._setAndCheckIsElementDisabled("apx-add-card-post-auth-skip-button")||(a._hidePopoverModal(),a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"AddCardAuthCancelEvent","ppw-reason":"ManualClose","ppw-paymentMethodId":a._instrumentId,"ppw-widgetAction":a._widgetAction}))})});n.when("A","a-modal","ready").execute(function(d,k){a.getDOMElement("apx-add-card-post-auth-continue-button").click(function(){a._setAndCheckIsElementDisabled("apx-add-card-post-auth-continue-button")||
(a._hidePopoverModal(),a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"AddCardAuthCompleteEvent","ppw-paymentMethodId":a._instrumentId,"ppw-widgetAction":a._widgetAction}))})});n.when("A","a-modal").execute(function(a){a.on("a:popover:dismiss:apx-add-card-auth-modal",function(a){e.logCounterMetric({feature:"AddCardAuth.cardAuthenticationCancelled",resource:"_Count"});e.publishMetrics()})})},_setAndCheckIsElementDisabled:function(a){if(this.getDOMElement(a).attr("class")&&
this.getDOMElement(a).attr("class").split(" ").includes("a-button-disabled"))return!0;this.getDOMElement(a).addClass("a-button-disabled");return!1},_hidePopoverModal:function(){n.when("a-modal").execute(function(a){a&&(a=a.get("apx-add-card-auth-modal"))&&a.hide()})},_swapToSuccessSection:function(){this._hideSpinnerSection();var a=this.getDOMElement("apx-add-card-auth-modal-content"),k=this.getDOMElement("apx-add-card-post-auth-success-content");a&&f.hideElement(a);k&&f.showElement(k)},_swapToFailureSection:function(){this._hideSpinnerSection();
var a=this.getDOMElement("apx-add-card-auth-modal-content"),k=this.getDOMElement("apx-add-card-post-auth-failure-content");a&&f.hideElement(a);k&&f.showElement(k)},_swapToSpinnerSection:function(){var a=this.getDOMElement("apx-add-card-auth-modal-content"),k=this.getDOMElement("AddCardAuthSpinner");a&&f.hideElement(a);k&&f.showElement(k)},_hideSpinnerSection:function(){var a=this.getDOMElement("AddCardAuthSpinner");a&&f.hideElement(a)},_openAddCardAuthMiniBrowserWindow:function(a){this._add_card_auth_browser_window=
l.openInMiniBrowser(a,"apx-add-card-auth-mini-window",k);this._add_card_auth_browser_window.focus();this._monitorAddCardAuthMiniBrowserWindow()},_monitorAddCardAuthMiniBrowserWindow:function(){p.clearTimeout(this._add_card_auth_window_timer);!this._add_card_auth_browser_window||this._add_card_auth_browser_window.closed?this._pollAuthenticationSourceForNextAction():this._add_card_auth_window_timer=setTimeout(this._monitorAddCardAuthMiniBrowserWindow.bind(this),100)},_sendCompleteContinueEvent:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"AddCardAuthCompleteEvent","ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})},_pollAuthenticationSourceForNextAction:function(){var a=this;a.widget.continueRequest({"ppw-widgetEvent":"AddCardAuthPollEvent","ppw-widgetState":a.widget.options.serializedState,"ppw-clientReferenceId":a._clientReferenceId},{success:function(d){d=d.additionalWidgetResponseData.additionalData;a._retries++;d&&"PENDING"===d.status&&5>a._retries?p.setTimeout(b.bind(a._pollAuthenticationSourceForNextAction(),
a),200):d&&"APPROVED"===d.status?a._swapToSuccessSection():a._swapToFailureSection()},error:function(d){a._hidePopoverModal();a._sendCompleteContinueEvent()}})}})});m("events/close-add-credit-card-form-event",["public-event-registry"],function(c){c.register("CloseAddCreditCardFormEvent");return"CloseAddCreditCardFormEvent"});m("components/AddMessageBasedDebitCardComponent",["jQuery","css-utils","component","AUI!P"],function(c,g,f,h){return f.extend({redirectUrl:null,additionalPostData:null,isAmazonApp:!1,
initialize:function(c,b){this.redirectUrl=b.data.redirectUrl;this.additionalPostData=b.data.additionalPostData;this.isAmazonApp=b.data.isAmazonApp},handleAddMBDCEvent:function(){var c=this;c.isAmazonApp?h.when("mash").execute(function(b){b.showEmbeddedBrowser({targetURL:c.redirectUrl,method:"POST",postParameters:c.additionalPostData,successCallback:function(){}})}):c.getDOMElement("addDebitCardRedirectionForm")[0].submit()},closeMBDCPopover:function(){function c(b){b&&(b=b.get("pmtsAddMessageBasedDebitCardPopover"))&&
b.hide()}h.when("a-modal").execute(function(b){c(b)});h.when("a-secondary-view").execute(function(b){c(b)})},bindToElements:function(){var c=this;this.widget.onAui("a:declarative:apx-display-add-mbdc-message:click",function(){g.hideElement(c.getDOMElement("addDebitCardRedirectionForm"));g.showElement(c.getDOMElement("addMbdcMessage"))});c.getDOMElement("addMessageBasedDebitCardButton").bind("click",function(b){c.handleAddMBDCEvent()});c.getDOMElement("addMBDCConfirmButton").bind("click",function(b){c.closeMBDCPopover()})}})});
m("components/AddElectronicBenefitTransferComponent","events/form-submitted-event jQuery form-component lang AUI!P clog events/close-secure-container-event events/display-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent".split(" "),function(c,g,f,h,l,b,e,n,q,a){var k=null;return f.extend({_creatablePaymentMethods:[],_isSecureRegistrationEnabledForEBT:!1,initialize:function(a,k){this._deviceType=a.options.deviceType;this._isDesktop="desktop"===a.options.deviceType;
this._action=k.data.action;this._hasErrors=k.data.hasErrors;this.$accountHolderNameInput=this.getDOMElement("accountHolderName");this.$useNameOnAccountCheckbox=this.getDOMElement("getNameOnAccount");this.$addEbtSubmitButton=this.getDOMElement("new-EBT-submit-button");this.$addEbtPopoverTrigger=this.getDOMElement("EbtPopoverLink");this._creatablePaymentMethods=k.data.creatablePaymentMethods;this._isSecureRegistrationEnabledForEBT=k.data.isSecureRegistrationEnabledForEBT},bindToElements:function(){this.getDOMElement("new-EBT-cancel-button").click(h.bind(this.closeAddEbtPopover,
this));this.$addEbtSubmitButton.click(h.bind(this._handleFormSubmission,this));var a=this;this.$useNameOnAccountCheckbox.bind("change",function(d){d=this.checked?a.$useNameOnAccountCheckbox.val():"";a.$accountHolderNameInput.val(d)});this.$accountHolderNameInput.bind("change",function(d){a.widget.trigger("accountHolderNameChange",{accountHolderName:a.$accountHolderNameInput.val()})});this._isSecureRegistrationEnabledForEBT?this._bindAddEBTTrigger():this._bindNonSecureAddEBTTrigger()},bindToEvents:function(){this.widget.on("componentsInitialized",
this,function(){"true"===this._hasErrors&&(this.$addEbtPopoverTrigger.trigger("click"),this.widget.trigger(n))});this.widget.on(c,this,function(a){if(a.action===this._action){a=this.getDOMElement("pmts-add-ebt-form");var d=this._getRegistrationCount();d=g("\x3cinput\x3e").attr({type:"hidden",name:"ppw-ebtRegistrationCount",value:d.toString()});a.append(d);d=g("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:AddElectronicBenefitTransferEvent",value:"submit"});a.append(d);a.submit();this._addEBTFormSubmitMetric()}});
this.widget.on("accountHolderNameChange",this,function(a){a=g.trim(a.accountHolderName)===this.$useNameOnAccountCheckbox.val();this.$useNameOnAccountCheckbox.prop("checked",a)});this.widget.on(a,this,function(a){k&&a.data&&"EBT"===a.data.paymentMethod&&(b.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+self._deviceType,resource:"_Count"}),b.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:k}),k=null);b.publishMetrics()})},_getRegistrationCount:function(){try{var a=
p.sessionStorage.getItem("ebtCount")||"0";var k=parseInt(a,10)+1;p.sessionStorage.setItem("ebtCount",k.toString())}catch(v){k=0}return k},_handleFormSubmission:function(a){if(0===this.form.validateForm().length){var d=this.getFormSubmissionParameters("pmts-add-ebt-form-container");this.closeAddEbtPopover();this.widget.trigger(c,{submissionParameters:d,event:a,action:this._action})}else a.preventDefault()},closeAddEbtPopover:function(){this._isSecureRegistrationEnabledForEBT?this.widget.trigger(e):
l.when("a-modal").execute(function(a){a&&(a=a.get("pmtsAddEbtPopover"))&&a.hide()})},_bindAddEBTTrigger:function(){var a=this;a._isDesktop&&l.when("A").execute(function(d){d.declarative("add-ebt-action-name","click",function(){k=(new Date).getTime();b.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+a._deviceType,resource:"_Count"});a.widget.trigger(q,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:a._creatablePaymentMethods}})})})},_bindNonSecureAddEBTTrigger:function(){l.when("A").execute(function(a){a.declarative("a-modal",
"click",function(){b.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",resource:"_Count"})})})},_addEBTFormSubmitMetric:function(){b.logCounterMetric({feature:this._isSecureRegistrationEnabledForEBT?"EBT_SecureRegistrationFormSubmitted":"EBT_NonSecureRegistrationFormSubmitted",resource:"_Count"})}})});m("components/AddElectronicBenefitTransferWorkflowComponent",["component"],function(c){return c});m("components/AddHBAComponent","events/form-submitted-event form-component lang AUI!P jQuery cc-spacing clog events/close-secure-container-event events/display-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent".split(" "),
function(c,g,f,h,l,b,e,n,q,a,k){var d=null;return g.extend({_creatablePaymentMethods:[],_isSecureRegistrationEnabledForHBA:!1,initialize:function(a,d){this._deviceType=a.options.deviceType;this._isDesktop="desktop"===a.options.deviceType;this.$accountHolderNameInput=this.getDOMElement("apx-js-bind-account-holder-name-input-healthbenefitscard");this.$useNameOnAccountCheckbox=this.getDOMElement("getNameOnAccount_HBA");this.$addHbaPopoverTrigger=this.getDOMElement("PopoverLinkhealthbenefitscard");this.$addCardNumberBinding=
this.getDOMElement("addCreditCardNumber");this._creatablePaymentMethods=d.data.creatablePaymentMethods;this._isSecureRegistrationEnabledForHBA=d.data.isSecureRegistrationEnabledForHBA},bindToElements:function(){var a=this;this.getDOMElement("apx-js-bind-cancel-add-card-button-healthbenefitscard").click(f.bind(this.closeAddHbaPopover,this));this.getDOMElement("apx-js-bind-add-card-button-healthbenefitscard").click(f.bind(this._handleFormSubmission,this));this.$useNameOnAccountCheckbox.bind("change",
function(d){d=this.checked?a.$useNameOnAccountCheckbox.val():"";a.$accountHolderNameInput.val(d)});this.$accountHolderNameInput.bind("change",function(d){l.trim(a.$accountHolderNameInput.val())!==a.$useNameOnAccountCheckbox.val()?a.$useNameOnAccountCheckbox.prop("checked",!1):a.$useNameOnAccountCheckbox.prop("checked",!0)});this._isSecureRegistrationEnabledForHBA?this._bindAddHBATrigger():this._bindNonSecureAddHBATrigger()},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(){"true"===
this.data.hasErrors&&(this.$addHbaPopoverTrigger.trigger("click"),this.widget.trigger(q))});this.widget.on(c,this,function(a){if(a.action===this.data.action){a=this.getDOMElement("apx-js-bind-add-card-form-healthbenefitscard");var d=l("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:AddHBAEvent",value:"submit"});a.append(d);a.submit();this._addHBAFormSubmitMetric()}});var a,n;this.$addCardNumberBinding.keydown(function(d){a=this.value;n=this.selectionStart});this.$addCardNumberBinding.change(function(a){this.value=
b.fixSpacing(this.value)});this.$addCardNumberBinding.keyup(function(d){"number"!==this.type&&this.value!==a&&(d=this.selectionStart,this.value=b.fixSpacing(this.value),d=b.fixCaret(d,this.value,a,n),this.setSelectionRange(d,d))});this.widget.on(k,this,function(a){d&&a.data&&"HBA"===a.data.paymentMethod&&(e.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+self._deviceType,resource:"_Count"}),e.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:d}),d=null);
e.publishMetrics()})},_handleFormSubmission:function(a){if(0===this.form.validateForm().length){var d=this.getFormSubmissionParameters("apx-js-bind-add-card-container-healthbenefitscard");this.closeAddHbaPopover();this.widget.trigger(c,{queryParameters:this.data.queryParams,submissionParameters:d,event:a,action:this.data.action})}else a.preventDefault()},closeAddHbaPopover:function(){this._isSecureRegistrationEnabledForHBA?this.widget.trigger(n):h.when("a-modal").execute(function(a){a&&(a=a.get("apx-add-card-popover-healthbenefitscard"))&&
a.hide()})},_bindAddHBATrigger:function(){var k=this;k._isDesktop&&h.when("A").execute(function(b){b.declarative("add-hba-action-name","click",function(){d=(new Date).getTime();e.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+k._deviceType,resource:"_Count"});k.widget.trigger(a,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:k._creatablePaymentMethods}})})})},_bindNonSecureAddHBATrigger:function(){h.when("A").execute(function(a){a.declarative("a-modal","click",function(){e.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",
resource:"_Count"})})})},_addHBAFormSubmitMetric:function(){e.logCounterMetric({feature:this._isSecureRegistrationEnabledForHBA?"HBA_SecureRegistrationFormSubmitted":"HBA_NonSecureRegistrationFormSubmitted",resource:"_Count"})}})});m("components/AddHBAWorkflowComponent",["component"],function(c){return c});m("components/AddIDealComponent","events/form-submitted-event jQuery form-component lang AUI!P events/ExpandIdealEvent clog".split(" "),function(c,g,f,h,l,b,e){return f.extend({_hasErrors:!1,initialize:function(b,
e){this._action=e.data.action;this._hasErrors=e.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("iDealPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addIDealSubmitButton").click(h.bind(this._handleFormSubmission,this))},bindToEvents:function(){var e=this;e.widget.on("componentsInitialized",e,function(b){this._initPopoverState()});e.widget.on(b,e,function(b){b=g(e.getDOMElement("addIdealComponent"));b.length&&b.click();e._publishCounterMetricsForIdeal("ExpandIdealRegistrationSleeve");
e._publishBIMetricForIdeal("ExpandIdealRegistrationSleeve","Status","Success")});e.widget.on(c,e,function(b){b.action===e._action&&g(e.getDOMElement("addIDealForm")).submit()})},_handleFormSubmission:function(b){var e=this.form.validateForm(),a=this.getFormSubmissionParameters("addIDealFormContainer");0===e.length?(this.widget.trigger(c,{event:b,submissionParameters:a,action:this._action}),this.closeAddIDealPopover(),this._publishCounterMetricsForIdeal("AddIdealBankAdded"),this._publishBIMetricForIdeal("AddIdealBankAdded",
"Status","Success")):b.preventDefault()},closeAddIDealPopover:function(){l.when("a-modal").execute(function(b){b&&(b=b.get("pmtsAddIDealPopover"))&&b.hide()})},_publishCounterMetricsForIdeal:function(b){e.logCounterMetric({feature:b,resource:"_Count"});e.publishMetrics()},_publishBIMetricForIdeal:function(b,e,a){this.widget.publishSuccessSushiMetrics({ActionType:b,ActionValueType:e,ActionValue:a})}})});m("events/ExpandIdealEvent",["public-event-registry"],function(c){c.register("ExpandIdealEvent");
return"ExpandIdealEvent"});m("components/AdditionalLinkComponent",["component"],function(c){return c});m("components/AddP24Component",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(c,g,f,h,l){return f.extend({_hasErrors:!1,initialize:function(b,e){this._action=e.data.action;this._hasErrors=e.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("addP24PopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addP24SubmitButton").click(h.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(b){this._initPopoverState()});b.widget.on(c,b,function(e){e.action===b._action&&g(b.getDOMElement("addP24Form")).submit()})},_handleFormSubmission:function(b){var e=this.form.validateForm(),n=this.getFormSubmissionParameters("addP24FormContainer");0===e.length?(this.widget.trigger(c,{event:b,submissionParameters:n,action:this._action}),this.closeAddP24Popover()):b.preventDefault()},closeAddP24Popover:function(){l.when("a-modal").execute(function(b){b&&
(b=b.get("addP24Popover"))&&b.hide()})}})});m("components/AddPayerComponent","events/form-submitted-event form-component lang jQuery css-utils clog aui-helper".split(" "),function(c,g,f,h,l,b,e){return g.extend({formatDayAndMonth:function(b){return b&&1===b.length?"0"+b:b},populateBirthDate:function(){var b=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateDay']").val()),e=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateMonth']").val()),a=h("[name\x3d'ppw-birthDateYear']").val();b&&e&&a&&(b=a+"-"+
e+"-"+b,h("[name\x3d'ppw-birthDate']").val(b))},initialize:function(b,e){this._action=e.data.action;this._refundToAlternatePaymentMethodConsentRequired=e.data.refundToAlternatePaymentMethodConsentRequired},bindToElements:function(){var b=this;h("[name\x3d'ppw-birthDateDay']").change(function(){b.populateBirthDate()});h("[name\x3d'ppw-birthDateMonth']").change(function(){b.populateBirthDate()});h("[name\x3d'ppw-birthDateYear']").change(function(){b.populateBirthDate()});h(".pmts-add-amazon-paycode-header").click(f.bind(this.publishClickMetrics,
this));this._refundToAlternatePaymentMethodConsentRequired&&(this._disablePayerSubmitButton(),h("#pmts-refund-consent-checkbox").click(f.bind(this.togglePayerSubmitButton,this)));this.getDOMElement("pmts-payer-continue-button").click(f.bind(this._handleFormSubmission,this))},bindToEvents:function(){var b=this;this.widget.on(c,b,function(e){e.action===b._action&&b.getDOMElement("pmts-payer-form").submit()})},togglePayerSubmitButton:function(){h("#pmts-refund-consent-checkbox").is(":checked")?this._enablePayerSubmitButton():
this._disablePayerSubmitButton()},_disablePayerSubmitButton:function(){this.getDOMElement("pmts-payer-continue-button").attr("disabled","disabled");this.getDOMElement("pmts-payer-continue-button").addClass("a-button-disabled")},_enablePayerSubmitButton:function(){this.getDOMElement("pmts-payer-continue-button").removeAttr("disabled");this.getDOMElement("pmts-payer-continue-button").removeClass("a-button-disabled")},publishClickMetrics:function(c){c=h(c.currentTarget);c=e.getExpanderHelper(c);c.getContainer();
c.isExpanded()||(b.logCounterMetric({feature:"AddPayerFormExpandedEvent",resource:"_Count"}),b.publishMetrics(),this.widget.publishSuccessSushiMetrics({ActionType:"AddPayerFormExpandedEvent",ActionValueType:"AddPayerActionType",ActionValue:this._action}))},_handleFormSubmission:function(b){var e=this.form.validateForm();if(this._refundToAlternatePaymentMethodConsentRequired&&this.getDOMElement("pmts-payer-continue-button").hasClass("a-button-disabled"))b.preventDefault();else if(0===e.length){e=this.getFormSubmissionParameters("pmts-payer-form-container");
for(var a=0;a<e.length;a++)"ppw-widgetEvent:ChangeAddressContEvent"===e[a].name&&(e[a].name="ppw-widgetEvent:PayerContButtonEvent");this.widget.trigger(c,{queryParameters:this.data.queryParams,submissionParameters:e,event:b,action:this._action})}else b.preventDefault()}})});m("components/AddPayerWorkflowComponent",["jQuery","component","aui-helper","AUI!P","clog"],function(c,g,f,h,l){return g.extend({initialize:function(){this.$addAmazonPayCodeButtonSelector="#addAmazonPayCodePopoverId .pmts-button-input"},
bindToEvents:function(){var b=this;c(this.$addAmazonPayCodeButtonSelector).click(function(e){b.publishAddPaycodeWithoutPayerMetrics(e);b.continueAddAmazonPayCodePopover()})},continueAddAmazonPayCodePopover:function(){h.when("a-modal").execute(function(b){b&&(b=b.get("addAmazonPayCodePopover"))&&b.hide()})},publishAddPaycodeWithoutPayerMetrics:function(b){l.logCounterMetric({feature:"AddAmazonPayCodeWithoutPayerEvent",resource:"_Count"});l.publishMetrics();this.widget.publishSuccessSushiMetrics({ActionType:"AddAmazonPayCodeWithoutPayerEvent",
ActionValueType:"AddAmazonPayCodeWithoutPayerType",ActionValue:this._action})}})});m("components/AddPaymentInstrumentComponent","css-utils component mash-helper metrics-helper storage-helper mixins/secure-container-support events/postToSecureIframeEvent events/AddPaymentInstrumentLinkSelectedEvent events/ShowAddPaymentInstrumentPage TransitionMetricsConstants clog events/ExpandIdealEvent AUI!P apx3-register-experience-provider".split(" "),function(c,g,f,h,l,b,e,n,q,a,k,d,x,v){return g.extend(b,{_showSecondaryView:!1,
_deviceType:"Desktop",_creatablePaymentMethods:[],_isSkipAddCreditCardWeblabEnabled:!1,_includeAPX3Register:"none",_apx3RegisterSsnapUrl:"",_apx3RegisterHowToOpenSsnapUrl:"",initialize:function(a,d){this._showSecondaryView=d.data.showSecondaryView;this._deviceType=d.data.deviceType;this._mobileNonSecondaryView=(this._isMobile="MobileApp"===this._deviceType||"Mobile"===this._deviceType)&&!this._showSecondaryView;this._isRequestForMobileApp=d.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=
d.data.securePaymentMethodAddedEvent;this._isStandaloneAddPIWidget=d.data.isStandaloneAddPIWidget;this._dynamicContinueEnabled=d.data.dynamicContinueEnabled;this._shouldDisableAutoScreenShot=d.data.shouldDisableAutoScreenShot;this._creatablePaymentMethods=d.data.creatablePaymentMethods;this._isSkipAddCreditCardWeblabEnabled=d.data.isSkipAddCreditCardWeblabEnabled;this._secureIframeName=d.data.secureIframeName;this._includeAPX3Register=d.data.includeAPX3Register||"none";this._apx3RegisterSsnapUrl=
d.data.apx3RegisterSsnapUrl;this._apx3RegisterHowToOpenSsnapUrl=d.data.apx3RegisterHowToOpenSsnapUrl;this._apx3RegisterFeatureWeblabName=d.data.apx3RegisterFeatureWeblabName;this._apx3RegisterFeatureWeblabTreatment=d.data.apx3RegisterFeatureWeblabTreatment;this._shouldTriggerWeblabClientSide=d.data.shouldTriggerWeblabClientSide;this._mobileOsType=d.data.mobileOsType;var k=this;if(k._shouldDisableAutoScreenShot)try{f.disableAutoScreenShot()}catch(F){k.widget.publishFailureSushiMetrics({ActionType:"AddPaymentInstrument",
ActionValueType:"DisableAutoScreenShot",ActionValue:"ErrorThrown"})}k._isRequestForMobileApp&&k._isStandaloneAddPIWidget&&(f.addEventListener(k._securePaymentMethodAddedEvent,function(a){k._addEventListenerAddPIHandler(a)}),f.setBookmark("addpi-widget"))},_addEventListenerAddPIHandler:function(a){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(a.detail.paymentInstrumentId,a.detail.widgetAction,a.detail.walletId):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a.detail.paymentInstrumentId,"ppw-widgetAction":a.detail.widgetAction,"ppw-maybeWalletId":a.detail.walletId});f.backToBookmark("addpi-widget")},bindToElements:function(){var d=this;d.getDOMElement("add-new-payment-method").click(function(k){var b=Date.now(),e=d._apx3RegisterSsnapUrl;e&&(e=v.attachTransitionTimeStampToSnapUrl(e,"AddNewPaymentMethodLink",b));l.putInSession(a.ADD_PM_LINK_CLICK_STORAGE_KEY+d.widget.widgetInstanceId,
{startTimestamp:b,startTimestampSource:"AddNewPaymentMethodLink"});h.recordResourceMetric("AddPaymentLinkClicked","_Count",1);h.publishMetricsWithDimensions(d._getMobileOsTypeDimensionQueryParam());d._isMobile&&v.publishAddPaymentLinkClickedMetrics(d._deviceType,d._apx3RegisterFeatureWeblabName,d._apx3RegisterFeatureWeblabTreatment,d._getMobileOsTypeDimensionQueryParam());d._shouldTriggerWeblabClientSide&&d._apx3RegisterFeatureWeblabName&&d._apx3RegisterFeatureWeblabTreatment?(v.triggerWeblabOnClientSide(d._apx3RegisterFeatureWeblabName,
d._apx3RegisterFeatureWeblabTreatment,"ClientSideAPX3Register"),h.recordResourceMetric("ClientSideAPX3RegisterWeblabTriggerNotEnabled","_Count",0)):h.recordResourceMetric("ClientSideAPX3RegisterWeblabTriggerNotEnabled","_Count",1);h.publishMetricsWithDimensions(d._getMobileOsTypeDimensionQueryParam());if("all"===d._includeAPX3Register){k.preventDefault();k=!1;h.recordResourceMetric("NavigateToIrisRegistrationApp","_Count",1);h.publishMetricsWithDimensions(d._getMobileOsTypeDimensionQueryParam());
try{"MashNavigate"===d._apx3RegisterHowToOpenSsnapUrl?v.nativeMashNavigate(e,d._getMobileOsTypeDimensionQueryParam()):"AssignHrefThenHidePageSpinner"===d._apx3RegisterHowToOpenSsnapUrl?v.nativeAssignHrefThenHidePageSpinner(e,d._getMobileOsTypeDimensionQueryParam()):"AssignHref"===d._apx3RegisterHowToOpenSsnapUrl?v.nativeAssignHrefNavigate(e,!0,d._getMobileOsTypeDimensionQueryParam()):v.nativeAssignHrefNavigate(e,!1,d._getMobileOsTypeDimensionQueryParam())}catch(A){k=!0,d.widget.trigger(q)}finally{h.recordResourceMetric("NavigateToIrisRegistrationFailed",
"_Count",k?1:0),h.publishMetricsWithDimensions(d._getMobileOsTypeDimensionQueryParam())}}else h.recordResourceMetric("NavigateToIrisRegistrationApp","_Count",0),h.publishMetricsWithDimensions(d._getMobileOsTypeDimensionQueryParam()),""!==d._apx3RegisterSsnapUrl?h.recordResourceMetric("AddPaymentLinkClickedAfterAPX3NativeDisabled","_Count",1):h.recordResourceMetric("AddPaymentLinkClickedAfterAPX3NativeDisabled","_Count",0),h.publishMetricsWithDimensions(d._getMobileOsTypeDimensionQueryParam()),d.widget.trigger(q,
{isForAPX3Register:"web"===d._includeAPX3Register||"all"===d._includeAPX3Register,startTimestamp:b,startTimestampSource:"AddNewPaymentMethodLink"}),d._mobileNonSecondaryView&&k.preventDefault()});this._showSecondaryView&&this.registerSecondaryView("add-new-payment-method-declarative-action")},_getMobileOsTypeDimensionQueryParam:function(){return this._mobileOsType?{"class":this._mobileOsType}:null},bindToEvents:function(){var b=this;b.widget.on(q,b,function(n){b._mobileNonSecondaryView&&(c.showElement(b.getDOMElement("add-payment-instrument-page")),
c.hideElement(b.getDOMElement("add-new-payment-method")),c.hideElement(b.getDOMElement("mcx-paying-with-title")),b.widget.forceToScrollToTopOfThePage(),b.widget.trigger("RecordMaybeIneligiblePaymentMethodDisplayedMetricEvent"),k.logLatencyMetric({feature:n.startTimestampSource+a.SEPARATOR+a.REGISTRATION_LANDING_VIEW,resource:"_Latency",startTime:n.startTimestamp}));if(b._isSkipAddCreditCardWeblabEnabled){var l=1===b._creatablePaymentMethods.length,g=b._creatablePaymentMethods.includes("CC");l&&g?
(c.showElement(b.getDOMElement("add-new-payment-method")),c.hideElement(b.getDOMElement("add-payment-instrument-page")),b.widget.trigger(e,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:b._creatablePaymentMethods,iFrameName:b._secureIframeName}})):(c.hideElement(b.getDOMElement("add-new-payment-method")),c.showElement(b.getDOMElement("add-payment-instrument-page")))}(n||{}).isForAPX3Register&&(c.showElement(b.getDOMElement("add-new-payment-method")),c.hideElement(b.getDOMElement("add-payment-instrument-page")),
f.publishCountMetrics("NavigateToIrisRegistrationMobileWeb"),v.webPostToSecureIframe(b.widget,b._secureIframeName,n));null!=n&&null!=n.category&&"IDEAL"===n.category&&(c.showElement(b.getDOMElement("add-payment-instrument-page")),c.hideElement(b.getDOMElement("add-new-payment-method")),b.widget.trigger(d))});b.widget.on(n,b,function(a){c.hideElement(b.getDOMElement("add-payment-instrument-page"));c.showElement(b.getDOMElement("add-pm-full-page-"+a.paymentMethodIdentifier));b.widget.forceToScrollToTopOfThePage()})}})});
m("events/AddPaymentInstrumentLinkSelectedEvent",["public-event-registry"],function(c){c.register("AddPaymentInstrumentLinkSelectedEvent");return"AddPaymentInstrumentLinkSelectedEvent"});m("events/ShowAddPaymentInstrumentPage",["public-event-registry"],function(c){c.register("showAddPaymentInstrumentPage");return"showAddPaymentInstrumentPage"});m("components/AddStoreCardAdvertisementComponent",["component","jQuery","lang"],function(c){return c.extend({bindToElements:function(){var c=this;this.getDOMElement("AddStoreCardLearnMoreLink").click(function(){c.widget.publishSuccessSushiMetrics({ActionType:"RedirectLearnMoreStoreCard",
ActionValueType:"Click",ActionValue:"RedirectLearnMoreClicked"})})}})});m("components/AsyncWidgetSpinnerComponent",["components/SpinnerComponent","events/spinner-events"],function(c,g){return c.extend({widgetDone:!1,keepSpinnerOnWidgetDone:!1,keepSpinnerOnSubmitFormAjaxCompleted:!1,initialize:function(c,g){this.keepSpinnerOnWidgetDone=g.data.keepSpinnerOnWidgetDone;this.keepSpinnerOnSubmitFormAjaxCompleted=g.data.keepSpinnerOnSubmitFormAjaxCompleted},bindToEvents:function(){this.widget.on("submitFormAjaxStarted",
this,function(){this.widget.trigger(g.showSpinner)});this.widget.on(g.showSpinner,this,function(){this._show(this._spinnerName)});this.widget.on("submitFormAjaxCompleted",this,function(){this.keepSpinnerOnSubmitFormAjaxCompleted||this.widgetDone&&this.keepSpinnerOnWidgetDone||this.widget.trigger(g.hideSpinner)});this.widget.on(g.hideSpinner,this,function(){this._hide(this._spinnerName)});this.widget.on("Done",this,function(){this.widgetDone=!0})}})});m("components/SpinnerComponent",["component","css-utils",
"lang"],function(c,g,f){var h=[];return c.extend({initialize:function(c,b){this._spinnerName=b.data.spinnerName;h.push(this)},spinnerInstance:function(c){var b=this,e=f.filter(h,function(e){return e.data.spinnerName===c&&e.widget.widgetInstanceId===b.widget.widgetInstanceId});return(e&&e[e.length-1]||b).getDOMElement(b._spinnerName)},_show:function(c){g.showElement(this.spinnerInstance(c))},_hide:function(c){g.hideElement(this.spinnerInstance(c))},bindToEvents:function(){var c=this;c.widget.on("SpinnerChangeAppearanceEvent",
c,function(b){b.spinnerName===c._spinnerName&&(b.display?c._show():c._hide())})}})});m("components/CVVAuthenticateComponent","css-utils jQuery form-component lang AUI!P clog ExecutionsWidgetUtils".split(" "),function(c,g,f,h,l,b,e){return f.extend({initialize:function(b,e){this.isRegistrationUseCase=e.data.isRegistrationUseCase;this.cvvCocoonBlob=e.data.cvvCocoonBlob;this.authenticationSourceId=e.data.authenticationSourceId;this._clientId=e.data.clientId;this.dynamicContinueFormDescription=e.data.dynamicContinueFormDescription;
this.maxCVVLength=e.data.maxCVVLength;this.isCvvAuthenticateEventNameDifferentiationEnabled=e.data.isCvvAuthenticateEventNameDifferentiationEnabled;this.retries=0;this.isRegistrationUseCase&&this._initiateCVVAuthentication("CVVAuthenticateEvent");c.hideElement(this.getDOMElement("CVVAuthenticateSpinner"))},_handleFormSubmission:function(){b.logCounterMetric({feature:"CVVAuthenticateConfirmButtonClicked",resource:"_Count"});b.publishMetrics();0===this.form.validateForm().length&&this.widget.trigger("cvvAuthenticateFormSubmitted")},
_handleCancelClick:function(){this.fireCVVAuthenticateCompleteEvent("CVVAuthenticateCancelEvent")},_pollCVVAuthenticationStatus:function(){this.isCvvAuthenticateEventNameDifferentiationEnabled?this._initiateCVVAuthentication("CVVAuthenticatePollEvent"):this._initiateCVVAuthentication("CVVAuthenticateEvent")},_initiateCVVAuthentication:function(e){var c=this;e={addCreditCardVerificationNumber:c.form.getFormValues().addCreditCardVerificationNumber,"ppw-widgetEvent":e,"ppw-widgetState":c.widget.options.serializedState,
"ppw-cvvCocoonBlob":c.cvvCocoonBlob};c.authenticationSourceId&&(e["ppw-authenticationSourceId"]=c.authenticationSourceId);c.widget.continueRequest(e,{success:function(a){a=a.additionalWidgetResponseData.additionalData;c.retries++;15<=c.retries&&(b.logCounterMetric({feature:"CVVAuthenticateReachRetryLimit",resource:"_Count"}),b.publishMetrics());c.authenticationSourceId=a.authenticationSourceId;a&&("PENDING"===a.status||"UNSTARTED"===a.status)&&15>c.retries?p.setTimeout(h.bind(c._pollCVVAuthenticationStatus,
c),200):(a&&"PENDING"===a.status?(c.showCVVErrorAndHideAuthenticationSpinner(),c.fireCVVAuthenticateCompleteEvent("CVVAuthenticatePendingEvent")):a&&"APPROVED"===a.status?c.fireCVVAuthenticateCompleteEvent("CVVAuthenticateApprovedEvent"):(c.showCVVErrorAndHideAuthenticationSpinner(),c.fireCVVAuthenticateCompleteEvent("CVVAuthenticateDeclinedEvent")),delete c.authenticationSourceId)},error:function(a){c.showCVVErrorAndHideAuthenticationSpinner();c.fireCVVAuthenticateCompleteEvent("CVVAuthenticateDeclinedEvent")}})},
fireCVVAuthenticateCompleteEvent:function(b){this.isRegistrationUseCase?this.widget.continueRequest({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":b},{success:this.widget.createAjaxContinueSuccessHandler()}):e.dynamicContinueWithEvent(b,this.widget.options.serializedState,[{name:"ppw-authenticateSourceId",value:this.authenticationSourceId},{name:"ppw-clientId",value:this._clientId}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},showCVVErrorAndHideAuthenticationSpinner:function(){},
bindToElements:function(){var b=this,e=this.getDOMElement("cvv-authenticate-input-box"),a=this.getDOMElement("ConfirmCVVButton");this.getDOMElement("ConfirmCVVButton").click(h.bind(this._handleFormSubmission,this));this.getDOMElement("cancel-confirm-CVV-button").click(h.bind(this._handleCancelClick,this));e.bind("input keyup",function(){e.val().length==b.maxCVVLength?a.removeClass("a-button-disabled"):a.addClass("a-button-disabled")})},bindToEvents:function(){var b=this;b.widget.on("cvvAuthenticateFormSubmitted",
b,function(){c.showElement(this.getDOMElement("CVVAuthenticateSpinner"));b._initiateCVVAuthentication("CVVAuthenticateEvent")})}})});m("components/BackToCartComponent",["component"],function(c){return c.extend({_getBackToCartLink:function(){return this.getDOMElement("pmtsBackToCartLink")},_makeTransition:function(c){p.location=c},bindToElements:function(){var c=this,f=c._getBackToCartLink();0<f.length&&f.click(function(){c.widget.trigger("BackToCartRequested");return!1})},bindToEvents:function(){var c=
this;c.widget.on("BackToCartRequested",c,function(f){f=c._getBackToCartLink().attr("href");c._makeTransition(f)})}})});m("components/BankAccountAddressChallengeComponent","events/InstrumentRowSelectedEvent lang css-utils server jQuery form-component validation-functions keyboard public-event-registry events/PaymentMethodChallengedEvent attributes".split(" "),function(c,g,f,h,l,b,e,n,q,a,k){return b.extend(k,{_addressChallenge:!0,_accountNumberTail:"",_instrumentId:"",_isStandalone:null,initialize:function(d,
k){q.register(a.eventName);this._accountNumberTail=k.data.accountNumberTail;this._instrumentId=k.data.instrumentId;this._isStandalone=k.data.isStandalone;this.form.formModel.registerAdditionalData("accountNumberTail",this._accountNumberTail)},bindToElements:function(){var a=this;a.getDOMElement("bankAccountAddressChallengeVerifyButton").click(function(d){d.preventDefault();a.verifyButtonClicked()});a.getDOMElement("addressChallengeBankRoutingNumber").keypress(function(d){d.which===n.keys.VK_RETURN&&
(d.preventDefault(),a.verifyButtonClicked())})},bindToEvents:function(){this.widget.on("initializeRecommendedInstrument",this,function(a){this._toggleAddressChallengeFormOnInstrumentSelection(a)});this.widget.on(c,this,function(a){this._toggleAddressChallengeFormOnInstrumentSelection(a)})},verifyButtonClicked:function(){0===this.form.validateForm().length&&this._confirmInstrument()},_toggleAddressChallengeFormOnInstrumentSelection:function(a){a.instrumentId===this._instrumentId&&this._addressChallenge?
this._toggleAddressChallengeForm(!0):this._toggleAddressChallengeForm(!1)},_confirmInstrument:function(){var a=this;a.form.resetErrors();var k=a.form.getFormValues();k={"ppw-widgetEvent":"ConfirmBankAccountEvent","ppw-instrumentId":a._instrumentId,addBankAccountNumber:k.addBankAccountNumber,addBankAccountRoutingNumber:k.addBankAccountRoutingNumber,"ppw-widgetState":a.widget.options.serializedState};var b={success:g.bind(a._onConfirmBankAccountSuccess,a),error:function(){a.widget.trigger(c,{instrumentId:a._instrumentId})},
resumeContinueQueueOnError:!0};a.widget.submitFormAJAX(k,b)},_onConfirmBankAccountSuccess:function(a){a=a.additionalWidgetResponseData.additionalData;if("ok"===a.status)this._bankAccountAddressChallengePassed();else{a=a.errors?a.errors.split(","):[];var d=[];g.forEach(a,function(a){d.push({messageStringId:a})});this.form.renderErrorMessages(this.form._getLocalizedErrorMessages(d))}this.widget.trigger(c,{instrumentId:this._instrumentId})},_bankAccountAddressChallengePassed:function(){this._addressChallenge=
!1;this.widget.trigger(a.eventName,a.successStatus);this.form.clearValidationErrors();this._toggleAddressChallengeForm(!1);this.getDOMElement("addressChallengeBankAccountNumber").remove();this.getDOMElement("addressChallengeBankRoutingNumber").remove();this.widget.trigger("bankAccountAddressChallengePassed",{instrumentId:this.data.instrumentId})},_toggleAddressChallengeForm:function(d){f.toggleElement(this.getDOMElement("bankAccountAddressChallengeForm"),d);d&&(this.widget.trigger(a.eventName,a.showStatus),
this.widget.publishSuccessSushiMetrics({ActionType:"ShowBankAccountAddressChallenge",ActionValueType:"PaymentInstrument",ActionValue:this._instrumentId}))}})});m("components/BillingAddressComponent",["component"],function(c){return c.extend({_getChangeAddressLink:function(){return this.getDOMElement("pmtsChangeAddressLink")},_makeTransition:function(c){p.location=c},bindToElements:function(){var c=this,f=c._getChangeAddressLink();0<f.length&&f.click(function(){c.widget.trigger("ChangeBillingAddressRequested");
return!1})},bindToEvents:function(){var c=this;c.widget.on("ChangeBillingAddressRequested",c,function(f){f=c._getChangeAddressLink().attr("href");c._makeTransition(f)})}})});m("components/CardScanComponent","css-utils jQuery component lang clog scanner-helper".split(" "),function(c,g,f,h,l,b){return f.extend({bindToElements:function(){var e=this;e.getDOMElement("addCreditCardScanningButton").click(function(){e._countCreditCardScannerEvent();e.widget.publishSuccessSushiMetrics({ActionType:"AddCreditCard",
ActionValueType:"AddMethod",ActionValue:"CardScan"});b.handleCardScanDOMEvent(h.bind(e._addCreditCardSuccessCallback,e),h.bind(e._failureCallback,e),b.CARD_TYPE_CREDIT)});e.getDOMElement("addressChallengeScanningButton").click(function(){e._countCreditCardScannerEvent();b.handleCardScanDOMEvent(h.bind(e._challengeCreditCardSuccessCallback,e),h.bind(e._failureCallback,e),b.CARD_TYPE_CREDIT)})},_countCreditCardScannerEvent:function(){l.logCounterMetric({feature:"CreditCardScannerEvent",resource:"_Count"})},
_addCreditCardSuccessCallback:function(b){var e=this;e._sharedSuccessCallback(b,function(b){e._displayFailureMessages(b);e.widget.trigger("addCreditCardScannerInfo",b)})},_challengeCreditCardSuccessCallback:function(b){var e=this;e._sharedSuccessCallback(b,function(b){c.hideElement(e.getDOMElement("addressChallengeScanningButton"));e.widget.trigger("addressChallengeCreditCardInfo",b);e.widget.trigger("addressChallengeConfirmButtonClicked")})},_sharedSuccessCallback:function(b,c){this.widget.trigger("resetAccountHolderNameCheckbox");
b&&b.cardData&&(b=b.cardData,c({accountHolderName:this._processAccountHolderName(b),creditCardNumber:this._processCreditCardNumber(b),expirationDate:this._processExpirationDate(b)}))},_failureCallback:function(b){this.widget.log({creditCardScannerError:b});l.logCounterMetric({feature:"CreditCardScannerEvent",resource:"_ErrorCount"})},_processCreditCardNumber:function(b){if(g.isArray(b.number)&&b.number.length)return l.logCounterMetric({feature:"CreditCardScannerPANEvent",resource:"_Count"}),g.trim(b.number[0].value)},
_processAccountHolderName:function(b){if(g.isArray(b.name)&&b.name.length)return l.logCounterMetric({feature:"CreditCardScannerAccountHolderNameEvent",resource:"_Count"}),g.trim(b.name[0].value)},_processExpirationDate:function(b){if(g.isArray(b.expirationMonth)&&g.isArray(b.expirationYear)&&b.expirationMonth.length&&b.expirationYear.length){l.logCounterMetric({feature:"CreditCardScannerExpirationDateEvent",resource:"_Count"});var e=parseInt(b.expirationYear[0].value,10);100>e&&(e+=2E3);if(e>=(new Date).getFullYear())return{month:""+
parseInt(b.expirationMonth[0].value,10),year:""+e}}},_displayFailureMessages:function(b){var e=!1;b.accountHolderName||(c.showElement(g(this.getDOMElement("cardScanningMissingName"))),e=!0);b.creditCardNumber||(c.showElement(g(this.getDOMElement("cardScanningMissingNumber"))),e=!0);b.expirationDate||(c.showElement(g(this.getDOMElement("cardScanningMissingExpDate"))),e=!0);e&&c.showElement(g(this.getDOMElement("cardScanningFailureMessages")))}})});m("scanner-helper",["AUI!P"],function(c){return{CARD_TYPE_CREDIT:1,
CARD_TYPE_GIFT:2,handleCardScanDOMEvent:function(g,f,h){if(p.app&&p.app.willReappear){var l=p.app.willReappear;delete p.app.willReappear}var b=function(){p.setTimeout(function(){p.app&&l&&(p.app.willReappear=l)},100)};c.when("mash").execute(function(e){e.showCardScanner({cardTypes:[h],failCallback:function(){f();b()},successCallback:function(e){g(e);b()}})})}}});m("components/ChallengeInstrumentSelectComponent",["css-utils","jQuery","component","events/ShowAddPaymentInstrumentPage"],function(c,g,
f,h){return f.extend({_showSecondaryView:!1,_deviceType:"desktop",initialize:function(c,b){this._showSecondaryView=b.data.showSecondaryView;this._deviceType=c.options.deviceType},bindToEvents:function(){var l=this;l.widget.on("ContinueButtonClicked",l,function(b){l.widget.trigger("ManualFormSubmission")});l.widget.on("CompleteWidget",l,function(b){l.widget.trigger("ManualFormSubmission")});l.widget.on("SecondaryContinueButtonClicked",l,function(b){l.widget.trigger("ManualFormSubmission")});l.widget.on("ManualFormSubmission",
l,function(){l.getDOMElement("challenge-instrument-select-form-to-submit").append("\x3cinput name\x3dppw-widgetEvent value\x3dPreferencePaymentOptionSelectionEvent type\x3dhidden /\x3e").submit()});l.widget.on(h,l,function(b){"mobile"===l._deviceType&&"false"===l._showSecondaryView&&(c.hideElement(l.getDOMElement("payselect-title")),c.hideElement(l.getDOMElement("payment-option-list-page")),c.hideElement(l.getDOMElement("secondary-mobile-continue-button")))})}})});m("components/ChallengePaymentMethodComponent",
["component","jQuery"],function(c,g){return c.extend({paymentMethodId:"",initialize:function(c,g){this.paymentMethodId=g.data.paymentMethodId?g.data.paymentMethodId:""},bindToElements:function(){var c=this;c.getDOMElement("challengePaymentMethodMobileSubmitButton").click(function(f){f.preventDefault();c.triggerExpirationDateValidated()})},bindToEvents:function(){this.widget.on("addressChallengeValidate",this,function(){this.triggerExpirationDateValidated()})},triggerExpirationDateValidated:function(){this.widget.trigger("expirationDateValidated",
{instrumentId:this.paymentMethodId,isExpirationDateValid:!0})}})});m("components/OTPVerificationComponent","component lang jQuery AUI!P css-utils events/spinner-events clog".split(" "),function(c,g,f,h,l,b,e){return c.extend({initialize:function(){this.widgetContainerId=this.getDOMElement(this.data.cvfWidgetContainerJSElementBinding).attr("id");this.data.autoLoad&&(this.data.newOTPVerificationFlowEnabled!==r&&this.data.newOTPVerificationFlowEnabled?this.loadNewCVFWidget():this.loadOldCVFWidget())},
confirmNewCVFWorkflowCompletionClaimToken:function(e){var c=this;this.widget.trigger(b.showSpinner);this.widget.continueRequest({"ppw-claimToken":e,"ppw-widgetEvent":"OneTimePasswordVerifyClaimTokenEvent","ppw-widgetState":this.getWidgetState(this.data.cvfWidgetContainerJSElementBinding)},{success:g.bind(function(a){this.widget.trigger(b.hideSpinner);a=a.additionalWidgetResponseData.additionalData;"false"===a.verified?(c.data.requestToken=a.requestToken,c.loadNewCVFWidget()):c.widget.trigger("OTPVerificationSuccessful")},
this),error:g.bind(function(){c.widget.trigger(b.hideSpinner);c.toggleJSDisabledMessage(!0)},this)})},confirmOldCVFWorkflowCompletionClaimToken:function(c){var n=this;h.when("A").execute(function(a){n.widget.trigger(b.showSpinner)});this.widget.continueRequest({"ppw-claimToken":c,"ppw-widgetEvent":"OneTimePasswordVerifyClaimTokenEvent","ppw-widgetState":this.getWidgetState(this.data.cvfWidgetContainerJSElementBinding)},{success:function(a){a=a.additionalWidgetResponseData.additionalData;if("false"===
a.verified)switch(a.errorName){case "authentication_required":n.emitOTPVerificationFailedEvent("authentication");e.logCounterMetric({feature:"OTPVerificationFailedEventTypeAuthentication",resource:"_ErrorCount"});e.publishMetrics();break;case "temporarily_unavailable":n.emitOTPVerificationFailedEvent("connection");break;case "expired":n.emitOTPVerificationFailedEvent("expiration-or-excessive-attempts");break;case "verification_error":n.emitOTPVerificationFailedEvent("throttle");break;default:case "access_denied":case "invalid_request":n.emitOTPVerificationFailedEvent("implementation")}},
error:function(){n.emitOTPVerificationFailedEvent("connection")},complete:function(){h.when("A").execute(function(a){n.widget.trigger(b.hideSpinner)})}})},bindToEvents:function(){var b=this;this.widget.on("otpVerificationLoadWorkflow",this,function(e){e.identifier===b.data.otpVerificationComponentIdentifier&&(b.data.newOTPVerificationFlowEnabled!==r&&b.data.newOTPVerificationFlowEnabled?b.loadNewCVFWidget():b.loadOldCVFWidget())})},loadNewCVFWidget:function(){var b=this;h.when("A","cvf","ready").execute(function(e,
a){b.toggleJSDisabledMessage(!1);a.create({target:f("#"+b.widgetContainerId),requestToken:b.data.requestToken,onSuccess:g.bind(b.confirmNewCVFWorkflowCompletionClaimToken,b),onError:function(a){b.toggleJSDisabledMessage(!0)},autoStart:!1}).start()})},loadOldCVFWidget:function(){var e=this;h.when("A","cvf","ready").execute(function(c,a){a.create({target:f("#"+e.widgetContainerId),requestToken:e.data.requestToken,onSuccess:g.bind(e.confirmOldCVFWorkflowCompletionClaimToken,e),onError:function(a){e.emitOTPVerificationFailedEvent("connection")},
autoStart:!1}).start();if(e.data.disableContinueButtonDuringVerificationWorkflow){e.widget.trigger(b.showSpinner);var k=p.setInterval(function(){f(".cvf-widget-section-js").length&&(e.widget.trigger(b.hideSpinner),e._triggerBackingInstrumentSelectedEvent(),p.clearInterval(k))},0)}})},toggleJSDisabledMessage:function(b){l.toggleElement(f(this.getDOMElement("jsDisabledMessage")),b)},emitOTPVerificationFailedEvent:function(b){this.widget.trigger("otpVerificationFailed",{failureType:b,challengeType:this.data.challengeType})},
_triggerBackingInstrumentSelectedEvent:function(){var b=this.widget.getLocalizedString("pmts_portal_otp_required_for_cod");this.widget.trigger("backingInstrumentSelected",{errors:b?b:null})}})});m("components/DeleteInstrumentComponent",["modal-popover","component","AUI!P","lang"],function(c,g,f,h){return g.extend({initialize:function(l,b){var e=this;b.data.shouldRenderInPopover&&(e.popover=new c(l,b,e));b.data.isJPPersonalBankAccount&&f.when("A","jp-bank-list","ready").execute(function(b,c){b=c.getBankNameByCode(e.getDOMElement("delete-bank-name-field").attr("data-bankCode"));
b!==r&&(e.getDOMElement("delete-bank-name-field")[0].innerHTML=b)})},bindToEvents:function(){this.widget.on("mpo-delete-popover-closed",this,function(c){this.getDOMElement("pmts-mpo-js-delete-popover-cancel-form").submit()})}})});m("components/PopoverComponent",["modal-popover","component","jQuery"],function(c,g,f){return g.extend({initialize:function(f,l){l.data.isInPopover&&(this.popover=new c(f,l,this))},bindToEvents:function(){this.widget.on("pmts-popover-selected-popover-closed",this,function(c){this.getDOMElement("pmts-popover-component-js-popover-cancel-form").submit()})}})});
m("components/SetAddressLabelComponent",["component"],function(c){return c.extend({})});m("components/SetDeliveryOptionComponent",["css-utils","form-component","lang","jQuery"],function(c,g,f,h){return g.extend({initialize:function(c,b){},bindToElements:function(){this._getShippingMethodRows().click(f.bind(this._triggerShippingMethodRowSelectedEvent,this))},bindToEvents:function(){var c=this;c.widget.on("shippingMethodRowSelected",c,function(b){var e=c._getShippingMethodRows();f.forEach(e,function(e){c._shippingMethodRowSelected(h(e),
b.shippingMethodId)},c)})},_getShippingMethodRows:function(){return this.getDOMElementsByPrefix("shippingMethodSelectionRow-")},_triggerShippingMethodRowSelectedEvent:function(c){c=h(c.currentTarget).data("shipping-method-id");this.widget.trigger("shippingMethodRowSelected",{shippingMethodId:c})},_shippingMethodRowSelected:function(c,b){var e=c.data("shipping-method-id"),n=c.find("input[type\x3dradio]");b===e?this._updateStylingOfCurrentRow(c,"pmts-selected","pmts-box",n,!0):this._updateStylingOfCurrentRow(c,
"pmts-box","pmts-selected",n,!1)},_updateStylingOfCurrentRow:function(c,b,e,n,f){c.removeClass(e);c.hasClass(b)||c.addClass(b);n.prop("checked",f)}})});m("components/ContinueButtonComponent","css-utils jQuery lang continuable-component events/SelectablePaymentOptionEvents events/SetPaymentPlanSelectContinueEvent clog form-helper".split(" "),function(c,g,f,h,l,b,e,n){return h.extend({initialize:function(b,a){this.isOneClickReviewOrderMessage=a.data.isOneClickReviewOrderMessage;this.continueButton=
(this.isSecondaryButton=a.data.isSecondaryButton)?"secondary-continue-button":"continue-button";this.isUpiIssuanceEnabled=a.data.isUpiIssuanceEnabled;this.isPaylastEnabled=a.data.isPaylastEnabled;this.isViewDetailsPopoverEnabled=a.data.isViewDetailsPopoverEnabled},popoverMessage:"",popover:null,shouldRecordInitialPreselection:!0,initiallySelectedInstruments:"",_handleClickEvent:function(b){b=this.isSecondaryButton?"SecondaryContinueButtonClicked":"ContinueButtonClicked";this.isViewDetailsPopoverEnabled&&
this.widget.trigger("hideViewDetailsPopover");this.widget.log({eventName:!0});var a=0;f.forEach(g("input[type\x3dradio][name\x3dppw-instrumentRowSelection]"),function(b){b.checked&&a++});0===a&&e.logCounterMetric({feature:"ContinueButtonClickedWithoutPaymentMethods",resource:"_Count"});e.logCounterMetric({feature:"ContinueButtonClicked",resource:"_Count"});e.publishMetrics();this.getContinuable()?this.widget.trigger(b):this.data.alwaysEnableContinueButtonOnMobile&&this.widget.trigger("ContinueButtonClickedWithInvalidPaymentPlanEvent",
{message:this.popoverMessage});return!1},_handlePaymentPlanSelected:function(b,a){this.popoverMessage=a;this.popover.auiShow(!b,{inlineContent:this.popoverMessage})},_toggleContinueButtonStyling:function(b){this.data.disableContinueButtonOnlyOnMouseover||this.data.alwaysEnableContinueButtonOnMobile||this._toggleContinueButtonStylingDefault(b)},_toggleContinueButtonStylingDefault:function(b){this.getDOMElement(this.continueButton).toggleClass("a-button-disabled",!b)},_handleMouseoverEvent:function(b){b=
this.getContinuable();this._toggleContinueButtonStyling(b);this.popover.customShow(!b,{literalContent:this.popoverMessage})},_handleMouseoutEvent:function(b){this.popover.customShow(!1,{literalContent:this.popoverMessage})},_handleMouseoverEventDisableOnlyOnHover:function(b){this.getDOMElement(this.continueButton).toggleClass("a-button-disabled",!this.getContinuable());this.popover.customShow(!this.getContinuable(),{literalContent:this.popoverMessage})},_handleMouseoutEventDisableOnlyOnHover:function(b){this.popover.customShow(!1,
{literalContent:this.popoverMessage});this.getDOMElement(this.continueButton).removeClass("a-button-disabled")},_handleFocusinEventDisableOnlyOnHover:function(b){this.popover.customShow(!this.getContinuable,{literalContent:this.popoverMessage})},_handleFocusoutEventDisableOnlyOnHover:function(b){this.popover.customShow(!1,{literalContent:this.popoverMessage})},_changeTextOnContinueButton:function(b){this.getDOMElement("ContinueButtonText")&&(this.getDOMElement("ContinueButtonText")[0].innerHTML=this.widget.getLocalizedString(b))},
_changeTextOnContinueButtonWithParameters:function(b,a){this.getDOMElement("ContinueButtonText")&&(this.getDOMElement("ContinueButtonText")[0].innerHTML=this.widget.getLocalizedString(b,a))},_getSelectedInstruments:function(b){return b["ppw-instrumentRowSelection"]+b["ppw-APBSelection"]+b["ppw-productVoucherBalanceSelection"]},bindToElements:function(){this.getDOMElement(this.continueButton).click(f.bind(this._handleClickEvent,this));this.data.disableContinueButtonOnlyOnMouseover?(this.getDOMElement(this.continueButton).mouseover(f.bind(this._handleMouseoverEventDisableOnlyOnHover,
this)),this.getDOMElement(this.continueButton).mouseout(f.bind(this._handleMouseoutEventDisableOnlyOnHover,this)),this.getDOMElement(this.continueButton).focusin(f.bind(this._handleFocusinEventDisableOnlyOnHover,this)),this.getDOMElement(this.continueButton).focusout(f.bind(this._handleFocusoutEventDisableOnlyOnHover,this))):(this.getDOMElement(this.continueButton).mouseover(f.bind(this._handleMouseoverEvent,this)),this.getDOMElement(this.continueButton).mouseout(f.bind(this._handleMouseoutEvent,
this)),this.getDOMElement(this.continueButton).focusin(f.bind(this._handleMouseoverEvent,this)),this.getDOMElement(this.continueButton).focusout(f.bind(this._handleMouseoutEvent,this)))},bindToEvents:function(){this.widget.on(l.PaymentPlanSelected,this,function(a){"pmts-portal-mobile-continue-button"===this.getDOMElement(this.continueButton).find("input").data("button-id")?(this._toggleContinueButtonStyling(this.getContinuable()),this.popoverMessage=a.message):(this._toggleContinueButtonStyling(a.isValid),
this._handlePaymentPlanSelected(a.isValid,a.message));var b=n.serializeObject(g(".pmts-select-payment-instrument-form").closest("form").clone());this.shouldRecordInitialPreselection&&(this.shouldRecordInitialPreselection=!1,this.initiallySelectedInstruments=this._getSelectedInstruments(b));b=b["ppw-instrumentRowSelection"];this.widget.log({event:l.PaymentPlanSelected,details:{isValid:a.isValid,isInstrumentIdPresent:b!==r&&null!==b}})});this.widget.on(b,this,function(){var a=n.serializeObject(g(".pmts-select-payment-instrument-form").closest("form").clone());
a=this._getSelectedInstruments(a);e.logCounterMetric({feature:"CustomerContinuedWithPreselectedInstruments",resource:"_Count",amount:"string"===typeof this.initiallySelectedInstruments&&this.initiallySelectedInstruments.match(a)?1:0});e.publishMetrics()});this.widget.on("selectableDebitCardSelectedDisableContinue",this,function(){this._toggleContinueButtonStyling(!1)});this.widget.on("selectableAddCreditCardSelected",this,function(){this._toggleContinueButtonStyling(!1)});this.widget.on("apbSelectionChanged",
this,function(){this.getContinuable()||""!==this.popoverMessage||(this.popoverMessage=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"))});this.widget.on("SetContinueButtonTextToPlaceOrder",this,function(){this.isPaylastEnabled&&this._changeTextOnContinueButton("apx_continue_text_place_order")});this.widget.on("SetContinueButtonTextToPlaceOrderAndPay",this,function(){this.isPaylastEnabled&&this._changeTextOnContinueButton("apx_continue_text_place_order_and_pay")});
this.widget.on("setContinueButtonText",this,function(a){a.stringId&&(a.parameters?this._changeTextOnContinueButtonWithParameters(a.stringId,a.parameters):this._changeTextOnContinueButton(a.stringId))});if(this.isOneClickReviewOrderMessage)this.widget.on("backingInstrumentSelected",this,function(a){c.toggleElement(this.getDOMElement("sidebarContinueButtonMessage"),!!a.isEligibleForTfx)});if(this.isUpiIssuanceEnabled){var f=this;this.widget.on("UpiRedirectionRequiredEvent",this,function(a){"pmts-portal-mobile-continue-button"===
f.getDOMElement(f.continueButton).find("input").data("button-id")?f._toggleContinueButtonStyling(f.getContinuable()):(f._toggleContinueButtonStyling(!0),f._handlePaymentPlanSelected(!0,null))})}}})});m("components/CreatePlanFromPreferencesComponent",["component","lang"],function(c,g){return c.extend({})});m("components/CVVVerifyComponent",["css-utils","jQuery","form-component","lang","AUI!P"],function(c,g,f,h,l){return f.extend({_hasErrors:!1,initialize:function(b,e){this._hasErrors=e.data.hasErrors;
this.declinedCount=0},handleCVVVerifyDOMEvent:function(){0===this.form.validateForm().length&&(this.getDOMElement("cvvVerifySubmitButton"),this.getDOMElement("pmts-cvv-verify-form"),this.widget.trigger("cvvVerifyFormSubmitted"));return!1},_pollForVerificationStatus:function(){var b=this,e=b.form.getFormValues();e={"ppw-selectedInstrumentId":e.selectedInstrumentId,addCreditCardVerificationNumber:e.addCreditCardVerificationNumber,"ppw-widgetEvent":"CvvVerifyEvent","ppw-widgetState":b.widget.options.serializedState,
"ppw-declinedCount":b.declinedCount};b._verificationId&&(e["ppw-verificationId"]=b._verificationId);b.widget.trigger("submitFormAjaxStarted");b.widget.continueRequest(e,{success:function(e){e=e.additionalWidgetResponseData.additionalData;b.retries?b.retries++:b.retries=1;e&&"VerificationPending"===e.status&&5>b.retries?(b._verificationId=e.verificationId,p.setTimeout(h.bind(b._pollForVerificationStatus,b),2E3)):("VerificationDeclined"===e.status&&(b.declinedCount?b.declinedCount++:b.declinedCount=
1),delete b._verificationId,delete b.retries,b.widget.trigger("submitFormAjaxCompleted"),e.errors&&(e.errors=JSON.parse(e.errors),b.form.renderErrorMessages(e.errors)))}})},bindToElements:function(){this.getDOMElement("cvvVerifySubmitButton").click(h.bind(this.handleCVVVerifyDOMEvent,this))},bindToEvents:function(){var b=this;b.widget.on("cvvVerifyFormSubmitted",b,function(){b._pollForVerificationStatus()});b.widget.on("UpdateWidget",b,function(e){e&&(e=g.parseJSON(e),"CVVVerifyComponent"===e.componentName&&
b.form.renderErrorMessages(e.errors))})},buildHiddenInput:function(b,e){return g("\x3cinput\x3e").attr({type:"hidden",name:b,value:e})}})});m("components/DebugConsoleComponent",["jQuery","component","lang"],function(c,g,f){return g.extend({initialize:function(){this.eventCount=0;this.lastEventTime=r},bindToEvents:function(){var g=this,l=g.getDOMElement(g.data.javaScriptClearEventLogElementReference),b=g.getDOMElement(g.data.javaScriptForceContinueElementReference),e=g.getDOMElement(g.data.javaScriptEventSectionElementReference);
l.click(function(b){e.empty();g.lastEventTime=r;return!1});b.click(function(b){g.widget.trigger("ContinueButtonClicked");return!1});g.widget.on("all",g,function(b,l){var a=++this.eventCount;g.widget.clientSideEventsHandler(b,l);a=f.leftPad(a,3,"0")+" "+b+" -\x3e "+JSON.stringify(l);var k=c("\x3ca\x3e",{text:"[Replay]",href:"#",click:function(){g.widget.trigger(b,l);return!1}}),d=new Date;1E3<d-g.lastEventTime&&e.prepend("\x3cbr /\x3e");g.lastEventTime=d;e.prepend(" "+a+"\x3cbr /\x3e");e.prepend(k)})}})});
m("components/DeleteAndUpdateEverywhereComponent",["modal-popover","component","lang","css-utils","attributes"],function(c,g,f,h,l){return g.extend(l,{initialize:function(b,e){e.data.shouldRenderInPopover&&(this.popover=new c(b,e,this));this.set("removeAndUpdateButtonEnabledAttribute",!0);this.watch("removeAndUpdateButtonEnabledAttribute",this,function(b){this.widget.log({updateButtonEnabled:b});b?h.enableElement(this.getDOMElement("apx-delete-and-ue-remove-and-update-button")):h.disableElement(this.getDOMElement("apx-delete-and-ue-remove-and-update-button"))})},
bindToElements:function(){var b=this;b.getDOMElement("apx-delete-and-ue-remove-and-update-button").click(f.bind(b._handleClickReplaceAndUpdateEvent,b));b.getDOMElement("apx-delete-and-ue-cancel-button").click(function(){b.getDOMElement("apx-delete-and-ue-cancel-button-form").submit()});b.getDOMElement("apx-delete-and-skip-ue-button").click(function(){b.getDOMElement("apx-delete-and-skip-ue-button-form").submit()})},bindToEvents:function(){var b=this;b.widget.on("apx-delete-and-update-everywhere-popover-closed",
b,function(){b.getDOMElement("apx-delete-and-update-everywhere-popover-cancel-form").submit()});b.widget.on("componentsInitialized",b,function(){b.data&&b.data.recommendedInstrumentId?b._checkInstrumentErrorsAndUpdateButton({instrumentId:b.data.recommendedInstrumentId,errors:null}):b.set("removeAndUpdateButtonEnabledAttribute",!1)});b.widget.on("backingInstrumentSelected",this,function(e){e=e&&e.instrumentId?e:null;b._checkInstrumentErrorsAndUpdateButton(e)})},_checkInstrumentErrorsAndUpdateButton:function(b){b=
b?this._firstElement(b.errors):this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.set("removeAndUpdateButtonEnabledAttribute",!b)},_handleClickReplaceAndUpdateEvent:function(){this.get("removeAndUpdateButtonEnabledAttribute")&&this.widget.trigger("submitSelectInstrumentForm")},_firstElement:function(b){return f.isArray(b)&&0<b.length?b[0]:null}})});m("components/ConfirmDeviceDataSourceComponent",["component"],function(c){return c.extend({bindToEvents:function(){var c=
this;this.widget.on("componentsInitialized",this,function(){p.parent.PaymentsPortal2&&p.parent.PaymentsPortal2.modules&&p.parent.PaymentsPortal2.modules.when(["events"],function(f){f.trigger("DeviceDataCollectionResponseConfirmed",c.data.deviceDataCollectionStatus)})})}})});m("components/GenerateDeviceDataCollectionUrlComponent",["component","ExecutionsWidgetUtils","events"],function(c,g,f){return c.extend({bindToEvents:function(){var c=this;this.widget.on("componentsInitialized",this,function(){g.continueRequestWithPolling({widget:c.widget,
inputData:{"ppw-widgetEvent":"GenerateDeviceDataCollectionUrlEvent","ppw-widgetState":c.widget.options.serializedState},isResponseExpectedFn:function(c){return c.deviceDataCollectionUrl!==r},onSuccessFn:function(f){g.buildContinueForm(f.redirectHttpMethod,f.deviceDataCollectionUrl,JSON.parse(f.redirectParameters),c.widget.getRootDOMElements().last()).attr("target","deviceDataCollectionIFrame").submit()},retryLimit:3,retryFailedFn:function(){c._triggerDeviceDataCollectionCompleteEvent("REJECTED")}})});
f.on("DeviceDataCollectionResponseConfirmed",this,function(f){c._triggerDeviceDataCollectionCompleteEvent(f)})},_triggerDeviceDataCollectionCompleteEvent:function(c){this.widget.submitFormAJAX({"ppw-widgetEvent":"ConfirmDeviceDataSourceCompleteEvent","ppw-widgetState":this.widget.options.serializedState,"ppw-status":c,"ppw-javaEnabled":p&&p.navigator&&p.navigator.javaEnabled(),"ppw-language":p&&p.navigator&&p.navigator.language,"ppw-screenColorDepth":p&&p.screen&&p.screen.colorDepth,"ppw-screenHeight":p&&
p.screen&&p.screen.height,"ppw-screenWidth":p&&p.screen&&p.screen.width,"ppw-timeZone":(new Date).getTimezoneOffset()})}})});m("components/DynamicSelectablePaymentOptionListComponent","css-utils continuable-component lang jQuery events/SelectablePaymentOptionEvents components/SelectablePaymentOptionListComponent".split(" "),function(c,g,f,h,l,b){return b.extend({initialize:function(b,c){}})});m("ExecutionsComponent","component jQuery ExecutionsWidgetUtils css-utils AUI!P mash-helper clog lang sdk-client events/spinner-events metrics-helper url-helper storage-helper count-down-timer-helper".split(" "),
function(c,g,f,h,l,b,e,n,q,a,k,d,x,v){var u;return c.extend({POLLING_RETRY_LIMIT:15,POLLING_RETRY_DELAY:1E3,WEBSOCKET_CONNECTION_LIMIT_IN_MILLIS:15E3,DEFAULT_EXECUTION_PENDING_REASON:"pendingForProcessorResponse",initialize:function(a,d){this._isRequestForMobileApp=d.data.isRequestForMobileApp;this.canUseWebSocket=d.data.canUseWebSocket;this.wsConnectUrl=d.data.wsConnectUrl;this.paymentMethodMetricSuffix=[d.data.paymentMethodCategory,d.data.paymentMethodBrand].filter(Boolean).join(".");this.widgetStateFromJsData=
a.options.serializedState;this.dynamicContinueFormDescription=d.data.dynamicContinueFormDescription;this.pollForThirdPartyResponseStatus=d.data.pollForThirdPartyResponseStatus;this.thirdPartyResponseStatus=d.data.thirdPartyResponseStatus;this.pollingForResponse=d.data.pollingForResponse;this.useInline=d.data.useInline;this.deviceType=a.options.deviceType;this.showModal=d.data.showModal;this.openRedirectUrlInExternalBrowser=d.data.openRedirectUrlInExternalBrowser;this.isGatewayRedirectionHistoryCleared=
d.data.isGatewayRedirectionHistoryCleared;this.openRedirectUrlInThirdPartyApp=d.data.openRedirectUrlInThirdPartyApp;this.navigateToGatewayEnabled=d.data.navigateToGatewayEnabled;this.showMashRedirectFallbackTemplate=d.data.showMashRedirectFallbackTemplate;this.isCancelTransactionEventRequired=d.data.isCancelTransactionEventRequired;this.redirectUrl=d.data.redirectUrl;this.httpMethod=d.data.httpMethod;this.postData=d.data.postData;this.challengeRenderer=d.data.challengeRenderer;this.jwtToken=d.data.jwtToken;
this.canSkip3DRedirection=this.isSafeTrue(d.data.canSkip3DRedirection);this.shouldSkipRedirection=this.isSafeTrue(d.data.shouldSkipRedirection);this.isExternalRedirectionRequired=this.isSafeTrue(d.data.isExternalRedirectionRequired);this.isFundingSourceStatusPendingExternalAction=this.isSafeTrue(d.data.isFundingSourceStatusPendingExternalAction);this.showSpinnerPollingForResponseRedirectionTemplate=this.isSafeTrue(d.data.isExternalRedirectionRequired);this.pollingForResponseTimeout=d.data.pollingForResponseTimeout;
this.executionStatusPollingLimit=parseInt(d.data.executionStatusPollingLimit,10);this.pollingRetryDelay=parseInt(d.data.pollingRetryDelay,10);this.customerAbandonedTimeout=parseInt(d.data.customerAbandonedTimeout,10);this.browserData={"ppw-javaEnabled":p&&p.navigator&&p.navigator.javaEnabled(),"ppw-language":p&&p.navigator&&p.navigator.language,"ppw-screenColorDepth":p&&p.screen&&p.screen.colorDepth,"ppw-screenHeight":p&&p.screen&&p.screen.height,"ppw-screenWidth":p&&p.screen&&p.screen.width,"ppw-timeZone":(new Date).getTimezoneOffset()};
this.enableMfaSyncShadow=d.data.enableMfaSyncShadow||!1;this.mashShowEmbeddedBrowserEnabled=d.data.mashShowEmbeddedBrowserEnabled;this.disableDeeplinkingInMashEmbeddedBrowser=d.data.disableDeeplinkingInMashEmbeddedBrowser;this.isSprintWeblabDialedUp=d.data.isSprintWeblabDialedUp;this.sdkFallbackPerformed=!1;this.setAsDefaultAfterTerminalStatus=d.data.setAsDefaultAfterTerminalStatus;this.enableLinkErrorPageAfterTerminalStatus=d.data.enableLinkErrorPageAfterTerminalStatus;this.showIncentiveMessagingIfToggleUnChecked=
d.data.showIncentiveMessagingIfToggleUnChecked;this.terminalStatus=d.data.terminalStatus;this.reason=d.data.reason;this.terminalStatusState=d.data.terminalStatusState;this.loadSetAsDefaultState=d.data.loadSetAsDefaultState;this.loadLinkErrorState=d.data.loadLinkErrorState;this.interstitialAbortedEmitted=this.cancelButtonClicked=!1;this.navigateBackAfterShowEmbeddedBrowser=d.data.navigateBackAfterShowEmbeddedBrowser;this.displayTimer=d.data.displayTimer;this.countdownTimerIntervalId=0;this.displayTimer&&
this.renderCountDownTimer()},renderCountDownTimer:function(){var a=this.executionStatusPollingLimit*this.pollingRetryDelay,d=(new Date).getTime();this.countdownTimerIntervalId=v.startCountDownTimer(this,a+d,this._updateCountDownTimer,this._terminalEventOnCountDownTimerExpiry);a=this.getDOMElement("apx-count-down-timer-container");h.showElement(a)},_updateCountDownTimer:function(a,d){a.getDOMElement("apx-count-down-timer-label").html(d)},_terminalEventOnCountDownTimerExpiry:function(a){f.dynamicContinueWithEvent("TerminalStatusEvent",
a.widgetStateFromJsData,[{name:"ppw-terminalState",value:"FAILURE"},{name:"ppw-reason",value:"CountDownTimerExpiredReason"}],a.dynamicContinueFormDescription,a.widget.getRootDOMElements().last())},bindToElements:function(){var a=this;a._bindInterstitialCancelHandler();a.registerIframeLoadEvent();a.getDOMElement("apx-set-as-default-continue").click(function(){var d=[{name:"ppw-invokeSetAsDefault",value:g('[name\x3d"apx-set-as-default-toggle"]').is(":checked").toString()},{name:"ppw-terminalState",
value:a.terminalStatus},{name:"ppw-reason",value:a.reason}];f.dynamicContinueWithEvent("CompleteSetAsDefaultEvent",a.widgetStateFromJsData,d,a.dynamicContinueFormDescription,a.widget.getRootDOMElements().last())});if(a.showIncentiveMessagingIfToggleUnChecked)a.widget.onAui("a:switch:apx-set-as-default-toggle:flip",function(){g('[name\x3d"apx-set-as-default-toggle"]').is(":checked")?(h.toggleElement(a.getDOMElement("apx-set-as-default-incentive-message"),!1),e.logCounterMetric({feature:"hideToggleDisabledMessaging",
resource:"_Count"})):(h.toggleElement(a.getDOMElement("apx-set-as-default-incentive-message"),!0),e.logCounterMetric({feature:"showToggleDisabledMessaging",resource:"_Count"}));e.publishMetrics()});a.getDOMElement("apx-link-error-cancel").click(function(){f.dynamicContinueWithEvent("TerminalStatusEvent",a.widgetStateFromJsData,[{name:"ppw-terminalState",value:a.terminalStatus},{name:"ppw-reason",value:"customerCanceled"}],a.dynamicContinueFormDescription,a.widget.getRootDOMElements().last())});a.getDOMElement("pmts-executions-mash-fallback-cancel-button").click(function(){h.disableElement(a.getDOMElement("pmts-executions-mash-fallback-cancel-button"));
a._initiateCancelTransaction(a,"customerCancelledAppNotInstalled")})},_initiateCancelTransaction:function(a,d){a.isCancelTransactionEventRequired?f.dynamicContinueWithEvent("CancelTransactionEvent",a.widget.options.serializedState,[{name:"ppw-reason",value:d}],a.dynamicContinueFormDescription,a.widget.getRootDOMElements().last()):a.triggerWidgetActionWithStatus("FAILURE",d)},_handleCancelButtonClicked:function(a){this.cancelButtonClicked||this._thirdPartyInvoked()||!this.startTimeBeforeGru||(k.emitLatencyMetric("InterstitialCancelled",
this.startTimeBeforeGru,[this._getDeviceType(),this.paymentMethodMetricSuffix],!1),this.cancelButtonClicked=!0);h.disableElement(this.getDOMElement("apx-executions-redirection-cancel-button"));this._initiateCancelTransaction(this,"customerCanceled")},_thirdPartyInvoked:function(){return"true"===x.getFromSession(this._thirdPartyInvokedKey())},_thirdPartyInvokedKey:function(){return"ThirdPartyInvoked-"+d.getParameterFromCurrentURL("startWidgetContextId")},_emitMetricsWhenInterstitialAborted:function(){this.interstitialAbortedEmitted||
this._thirdPartyInvoked()||this.cancelButtonClicked||!this.startTimeBeforeGru||(k.emitLatencyMetric("InterstitialAborted",this.startTimeBeforeGru,[this._getDeviceType(),this.paymentMethodMetricSuffix],!1),this.interstitialAbortedEmitted=!0)},_handleInterstitialAborted:function(){this._emitMetricsWhenInterstitialAborted();u&&u()},_bindInterstitialCancelHandler:function(){this._isRequestForMobileApp?p.app&&!u&&(u=p.app.willDisappear,p.app.willDisappear=n.bind(this._handleInterstitialAborted,this)):
p.addEventListener("beforeunload",n.bind(this._handleInterstitialAborted,this));this.getDOMElement("apx-executions-redirection-cancel-button").click(n.bind(this._handleCancelButtonClicked,this))},bindToEvents:function(){var a=this;a.showModal&&a.loadModal();f.addHostedContinueWidgetHandler(a,"pmts-executions-inline-frame",function(d){a.thirdPartyResponseStatus?d(a.thirdPartyResponseStatus):a.pollForThirdPartyResponseStatus&&a.continueRequest({inputData:{"ppw-widgetEvent":"ThirdPartyResponseEvent",
"ppw-widgetState":a.widgetStateFromJsData},isResponseAsExpectedFn:function(a){return"undefined"!==typeof a.thirdPartyResponseStatus},onSuccessFn:function(a){d(a.thirdPartyResponseStatus)},onErrorFn:function(){d("FAILURE")}})},function(d){f.dynamicContinueWithEvent("MessageProcessedEvent",a.widgetStateFromJsData,[{name:"ppw-messageProcessedResponse",value:d}],a.dynamicContinueFormDescription,a.widget.getRootDOMElements().last())},function(d){a.messageProcessedContinue(d,a.showSpinnerPollingForResponseRedirectionTemplate)});
a.thirdPartyResponseStatus||a.pollForThirdPartyResponseStatus||a.loadSetAsDefaultState||a.loadLinkErrorState||(a.setAsDefaultAfterTerminalStatus&&a.terminalStatusState&&"SUCCESS"===a.terminalStatus?a.triggerDisplaySetAsDefault():a.enableLinkErrorPageAfterTerminalStatus&&a.terminalStatusState&&"FAILURE"===a.terminalStatus?a.triggerLinkErrorPage():a.redirectUrl?a.showThirdPartyPage():a.pollingForResponse?a.messageProcessedContinue("APPROVED",a.showSpinnerPollingForResponseRedirectionTemplate):a.triggerGetRedirectUrlEvent());
a.widget.on("WidgetAction",a,function(d){"execution"===d.widgetActionType&&"result-received"===d.widgetAction&&(a.setAsDefaultAfterTerminalStatus&&"SUCCESS"===d.executionStatus||a.enableLinkErrorPageAfterTerminalStatus&&"FAILURE"===d.executionStatus?a.widget.submitFormAJAX({"ppw-widgetState":a.widgetStateFromJsData,"ppw-widgetEvent":"TerminalStatusEvent","ppw-terminalState":d.executionStatus,"ppw-reason":null==d.reason?"":d.reason,"ppw-authenticationSourceId":d.sourceId}):(d=[{name:"ppw-terminalState",
value:d.executionStatus},{name:"ppw-reason",value:d.reason},{name:"ppw-authenticateSourceId",value:d.sourceId},{name:"ppw-clientId",value:d.clientId},{name:"ppw-maybeRemainingBalance",value:d.remainingBalance},{name:"ppw-maybeChargeIdempotencyKey",value:d.chargeIdempotencyKey}],"WebSDK"===this.challengeRenderer?(e.logCounterMetric({feature:"TerminalStatusContinueFormSubmittedForWebSDK",resource:"_Count"}),this.publishLatencyMetrics("GruEventToSdkTerminalEvent",a.startTimeBeforeGru)):this.publishLatencyMetrics("GruEventToExternalTerminalEvent",
a.startTimeBeforeGru),e.logCounterMetric({feature:"TerminalStatusContinueFormSubmitted",resource:"_Count"}),f.dynamicContinueWithEvent("TerminalStatusEvent",a.widgetStateFromJsData,d,a.dynamicContinueFormDescription,a.widget.getRootDOMElements().last())))})},triggerDisplaySetAsDefault:function(){f.dynamicContinueWithEvent("DisplaySetAsDefaultEvent",this.widgetStateFromJsData,[{name:"ppw-terminalState",value:this.terminalStatus},{name:"ppw-reason",value:this.reason}],this.dynamicContinueFormDescription,
this.widget.getRootDOMElements().last())},triggerLinkErrorPage:function(){this.isCustomerCanceledInTerminalStatusEventPage()||f.dynamicContinueWithEvent("customerCanceled"===this.reason?"TerminalStatusEvent":"DisplayLinkErrorEvent",this.widgetStateFromJsData,[{name:"ppw-terminalState",value:this.terminalStatus},{name:"ppw-reason",value:this.reason}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},isCustomerCanceledInTerminalStatusEventPage:function(){try{var a=this.getCurrentLocation(),
d=a.origin+a.pathname,b=new URLSearchParams(a.search);return d===(new URL(this.dynamicContinueFormDescription.action)).href&&b.get("ppw-terminalState")===this.terminalStatus&&"customerCanceled"===b.get("ppw-reason")&&"TerminalStatusEvent"===b.get("ppw-widgetEvent")}catch(A){return!1}},getCurrentLocation:function(){return p&&p.location},display3PActionInformationTemplate:function(a){var d=this.getDOMElement("pmts-executions-async-spinner-polling-for-action"),b=this.getDOMElement("pmts-executions-async-spinner-polling-for-response");
"PendingExternalAction"===a&&(h.hideElement(d),h.showElement(b))},triggerGetRedirectUrlEvent:function(){var a=this;e.logCounterMetric({feature:"GetRedirectUrl",resource:"_Count"});e.publishMetrics();a.startTimeBeforeGru=(new Date).getTime();h.hideElement(a.getDOMElement("pmts-executions-entry-view-section"));h.hideElement(a.getDOMElement("pmts-executions-show-fallback"));h.showElement(a.getDOMElement("pmts-executions-async-spinner-polling-for-action"));a.continueRequest({inputData:{"ppw-widgetEvent":"GetRedirectUrlEvent",
"ppw-widgetState":a.widgetStateFromJsData},isResponseAsExpectedFn:function(d){d.widgetState&&(a.widgetStateFromJsData=d.widgetState,a.reason=d.reason);a.isFundingSourceStatusPendingExternalAction&&a.display3PActionInformationTemplate(a.reason);return d.redirectUrl||a.canSkip3DRedirection&&a.isSafeTrue(d.shouldSkipRedirection)||!a.isExternalRedirectionRequired&&a.isSafeTrue(d.shouldSkipRedirection)||a._isTerminalStatus(d.executionStatus)},onErrorFn:function(){e.logCounterMetric({feature:"GetRedirectUrl",
resource:"_ErrorCount"});e.publishMetrics();a.triggerFailureWidgetAction()},onSuccessFn:function(d){if(d.redirectUrl){k.emitLatencyMetric("ReceiveURLSinceGRU",a.startTimeBeforeGru,[a._getDeviceType(),a.paymentMethodMetricSuffix],!1);a.redirectUrl=d.redirectUrl;a.challengeRenderer=d.challengeRenderer;a.jwtToken=d.jwtToken;a.triggerRedirectUrlAvailableEvent(d);a.httpMethod=d.httpMethod;d.postData&&(a.postData=JSON.parse(d.postData));if(d.additionalRedirectionDetails){a.additionalRedirectionDetails=
JSON.parse(d.additionalRedirectionDetails);var b=a.getDOMElement("pmts-executions-inline-frame");b.css("height",a.additionalRedirectionDetails.height);b.css("width",a.additionalRedirectionDetails.width)}a.useInline=d.useInline;a.showThirdPartyPage()}else a.canSkip3DRedirection&&a.isSafeTrue(d.shouldSkipRedirection)?a.skipRedirection(a.showSpinnerPollingForResponseRedirectionTemplate):!a.isExternalRedirectionRequired&&a.isSafeTrue(d.shouldSkipRedirection)&&a.skipRedirection(a.showSpinnerPollingForResponseRedirectionTemplate)},
retryLimit:this.executionStatusPollingLimit,retryDelayFn:function(){return a.POLLING_RETRY_DELAY}})},createFreshLoadListenerForBrowserFlow:function(){this.getDOMElement("pmts-executions-inline-frame").unbind("load");this.registerIframeLoadEvent()},triggerAuthenticationFallback:function(){this.createFreshLoadListenerForBrowserFlow();var a=this;a.sdkFallbackPerformed?(e.logCounterMetric({feature:"sdkFallbackCountExceeded",resource:"_Count"}),e.publishMetrics(),a.triggerWidgetActionWithStatus("FAILURE")):
(a.sdkFallbackPerformed=!0,a.widget.continueRequest({"ppw-widgetEvent":"PrepareAuthenticationSourceForFallbackEvent","ppw-widgetState":this.widgetStateFromJsData},{success:function(){e.logCounterMetric({feature:"sdkFallbackTriggeredGRU",resource:"_Count"});a.triggerGetRedirectUrlEvent()},error:function(){e.logCounterMetric({feature:"sdkFallbackEventFailed",resource:"_Count"});a.triggerWidgetActionWithStatus("FAILURE")}}))},triggerRedirectUrlAvailableEvent:function(a){this.isSprintWeblabDialedUp&&
this.widget.trigger("redirectUrlAvailable",{continueWidgetResponse:a})},sdkIframeLoadingErrorAction:function(){e.logCounterMetric({feature:"sdkIframeLoadingError",resource:"_Count"});e.publishMetrics();this.SDKCallback.call(this,{status:"FallbackRequiredError"})},registerIframeLoadEvent:function(){var a=this;a.getDOMElement("pmts-executions-inline-frame").load(function(){if(a.startTimeBeforeBankPageRedirection){a.publishLatencyMetrics("GruEventToExternalBankPageLoad",a.startTimeBeforeGru);e.logLatencyMetric({feature:"ThirdPartyPageLoad",
resource:"_Latency",startTime:a.startTimeBeforeBankPageRedirection});var d=(new Date).getTime()-a.startTimeBeforeBankPageRedirection;e.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"ThirdPartyPageLoad",ActionValueType:"Latency_Milliseconds",ActionValue:d});a.startTimeBeforeBankPageRedirection=null}})},showThirdPartyPage:function(){var a=this;k.emitLatencyMetric("ShowThirdPartySinceGRU",a.startTimeBeforeGru,[a._getDeviceType(),a.paymentMethodMetricSuffix],!1);var d=function(){b.navigateToUrl("/")};
if("WebSDK"===this.challengeRenderer){e.logCounterMetric({feature:"sdkFlowTriggered",resource:"_Count"});e.publishMetrics();this.publishLatencyMetrics("GruEventForSdkFlow",this.startTimeBeforeGru);var c=this.getDOMElement("pmts-executions-inline-frame"),f=setTimeout(a.sdkIframeLoadingErrorAction.bind(a),5E3),l={showSdkHeader:!1,url:a.redirectUrl,token:a.jwtToken,intermediateStatusFilter:["ChallengeScreenRendered"]};c.load(function(){clearTimeout(f);try{q.authenticate(l,a.SDKCallback.bind(a),c.get(0).contentWindow),
e.logCounterMetric({feature:"sdkLibLoad",resource:"_Count"}),e.publishMetrics()}catch(B){e.logCounterMetric({feature:"sdkFlowError",resource:"_Count"}),e.publishMetrics(),a.SDKCallback.call(a,{status:"FallbackRequiredError"})}});c.attr("src",this.redirectUrl)}else if(this.openRedirectUrlInThirdPartyApp){var n="GET"===this.httpMethod?r:this.postData;d={openIn:r,httpMethod:this.httpMethod,additionalPostData:n};n=function(){};this.showMashRedirectFallbackTemplate?(d.openIn="showFallbackTemplate",n=this.triggerRedirectionToFallbackPage):
this.openRedirectUrlInExternalBrowser?d.openIn="externalBrowser":this.mashShowEmbeddedBrowserEnabled&&(d.openIn="embeddedBrowser");var g=function(){};this.navigateToGatewayEnabled&&(g=this.navigateToGateway);b.launchIntentURL(this.redirectUrl,d,g,this,n,this.paymentMethodMetricSuffix)}else this.openRedirectUrlInExternalBrowser?(this.isGatewayRedirectionHistoryCleared?b.openInExternalBrowser(this.redirectUrl,d,d):this.openInExternalBrowser(),k.emitCounterMetric("showThirdPartyExternalPageRedirect",
[this.paymentMethodMetricSuffix])):this.useInline?(this.publishLatencyMetrics("GruEventForExternalFlow",this.startTimeBeforeGru),this.submitForm("pmts-executions-inline-frame"),this.startTimeBeforeBankPageRedirection=(new Date).getTime(),h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action")),h.showElement(this.getDOMElement("pmts-executions-entry-view-section")),k.emitCounterMetric("showThirdPartyInLinePageRedirect",[a._getDeviceType(),this.paymentMethodMetricSuffix])):
this.mashShowEmbeddedBrowserEnabled?(k.emitCounterMetric("showEmbeddedBrowserForRedirect",[this.paymentMethodMetricSuffix]),n="GET"===this.httpMethod?r:this.postData,b.showEmbeddedBrowser(this.redirectUrl,this.httpMethod,n,function(){},function(){b.publishOpenBrowserFailureMetric(!0,this.paymentMethodMetricSuffix)},d,!this.disableDeeplinkingInMashEmbeddedBrowser)):(k.emitCounterMetric("formSubmitForRedirect",[a._getDeviceType(),this.paymentMethodMetricSuffix]),this.submitForm());x.putInSession(a._thirdPartyInvokedKey(),
"true");0<this.customerAbandonedTimeout&&(this.customerAbandonedTimeoutId=this.handleTimeout("FAILURE","customerAbandonedResponse",this.customerAbandonedTimeout))},_getDeviceType:function(){return this._isRequestForMobileApp?"mobileapp":this.deviceType},triggerRedirectionToFallbackPage:function(a){h.hideElement(a.getDOMElement("pmts-executions-async-spinner-polling-for-action"));h.showElement(a.getDOMElement("pmts-executions-show-fallback"));e.logCounterMetric({feature:"showMashRedirectFallbackTemplateMetric",
resource:"_Count"});e.publishMetrics()},enableEntryView:function(){h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action"));h.showElement(this.getDOMElement("pmts-executions-entry-view-section"))},SDKCallback:function(a){"ChallengeScreenRendered"===a.status?(e.logCounterMetric({feature:"sdkChallengeScreenLoaded",resource:"_Count"}),e.publishMetrics(),this.publishLatencyMetrics("GruEventToSdkChallengeScreenRendered",this.startTimeBeforeGru),this.enableEntryView.call(this)):
"AuthenticationSuccess"===a.status?(e.logCounterMetric({feature:"sdkTerminatedWithSuccess",resource:"_Count"}),e.publishMetrics(),this.publishLatencyMetrics("GruEventToSdkAuthNSuccess",this.startTimeBeforeGru),this.messageProcessedContinue("APPROVED",self.showSpinnerPollingForResponseRedirectionTemplate)):"AuthenticationFailure"===a.status?(e.logCounterMetric({feature:"sdkTerminatedWithFailure",resource:"_Count"}),e.publishMetrics(),this.publishLatencyMetrics("GruEventToSdkAuthNFailure",this.startTimeBeforeGru),
this.triggerWidgetActionWithStatus("FAILURE","incorrectPinCode")):"FallbackRequiredError"===a.status&&(e.logCounterMetric({feature:"sdkTriggeredFallback",resource:"_Count"}),e.publishMetrics(),this.triggerAuthenticationFallback())},openInExternalBrowser:function(){var a=this;l.when("mash").execute(function(d){d.openInExternalBrowser({url:a.redirectUrl,successCallback:function(){a.navigateToGateway()},failCallback:function(){a.navigateToGateway()}})})},navigateToGateway:function(){l.when("mash").execute(function(a){a.navstack.begin().replace({url:p.location.origin}).end()})},
submitForm:function(a){var d=f.buildContinueForm(this.httpMethod,this.redirectUrl,this.postData,this.widget.getRootDOMElements().last());a&&d.attr("target",a);this.isSprintWeblabDialedUp?d[0]&&d[0].submit():d.submit()},continueRequest:function(a){this.canUseWebSocket?this.continueRequestWithWebSocket(a):this.continueRequestWithPolling(a)},continueRequestWithWebSocket:function(a){var d=this;a.retryOnFail=!1;var b=new WebSocket(d.wsConnectUrl);b.onopen=function(){p.setTimeout(function(){b.close();a.retryOnFail=
!0;a.retryLimit=1;d.continueRequestWithPolling(a)},d.WEBSOCKET_CONNECTION_LIMIT_IN_MILLIS);d.continueRequestWithPolling(a)};b.onmessage=function(k){b.close();k=JSON.parse(k.data);d.triggerWidgetActionWithStatus(k.executionStatus);if(a.isResponseAsExpectedFn(k))a.onSuccessFn(k)}},continueRequestWithPolling:function(a){var d=this;g.extend(a.inputData,d.browserData);f.continueRequestWithPolling({widget:d.widget,inputData:a.inputData,retryOnFail:a.retryOnFail,isResponseExpectedFn:a.isResponseAsExpectedFn,
onSuccessFn:a.onSuccessFn,retryFailedFn:function(){d.enableMfaSyncShadow?d.triggerWidgetActionWithStatus("SUCCESS","MfaSyncShadowTimeoutGetRedirectUrl"):d.triggerWidgetActionWithStatus("FAILURE",d.DEFAULT_EXECUTION_PENDING_REASON);a.inputData.hasOwnProperty("ppw-widgetEvent")&&(e.logCounterMetric({feature:a.inputData["ppw-widgetEvent"]+"Timeout",resource:"_Count"}),e.publishMetrics())},onErrorFn:a.onErrorFn||g.proxy(d.triggerFailureWidgetAction,d),retryLimit:a.retryLimit,retryDelayFn:a.retryDelayFn})},
messageProcessedContinue:function(a,d){var b;this.pollingForResponseTimeout&&(b=this.handleTimeout("FAILURE",this.DEFAULT_EXECUTION_PENDING_REASON,this.pollingForResponseTimeout));this.customerAbandonedTimeoutId&&p.clearTimeout(this.customerAbandonedTimeoutId);this.isSafeTrue(d)?(h.hideElement(this.getDOMElement("pmts-executions-entry-view-section")),h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action")),h.showElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-response"))):
(h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-response")),h.showElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action")));this.continueRequest({inputData:{"ppw-widgetEvent":"MessageProcessedEvent","ppw-widgetState":this.widgetStateFromJsData,"ppw-messageProcessedResponse":a},isResponseAsExpectedFn:function(a){return a.executionStatus},onSuccessFn:function(){b&&p.clearTimeout(b)},retryLimit:this.executionStatusPollingLimit})},skipRedirection:function(a){this.isSafeTrue(a)&&
h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action"));this.isExternalRedirectionRequired?this.messageProcessedContinue("APPROVED",a):this.nonAjaxMessageProcessedContinue()},nonAjaxMessageProcessedContinue:function(){f.dynamicContinueWithEvent("MessageProcessedEvent",this.widgetStateFromJsData,[{name:"ppw-messageProcessedResponse",value:"APPROVED"}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},handleTimeout:function(a,d,b){var k=this;
e.logCounterMetric({feature:"PollingThirdPartyResponseTimeout",resource:"_Count"});e.publishMetrics();return p.setTimeout(function(){k.triggerWidgetActionWithStatus(a,d)},b)},loadModal:function(){var a=this;"mobile"===a.deviceType?l.when("A","a-sheet","ready").execute(function(d,b){d.on("a:sheet:beforeHide:pmts-executions-bottom-sheet",function(d){a.triggerFailureWidgetAction()});a.getDOMElement("pmts-executions-bottom-sheet-trigger").click()}):l.when("A","a-modal","ready").execute(function(d,b){d.on("a:popover:beforeHide:pmts-executions-popover",
function(d){a.triggerFailureWidgetAction()});a.getDOMElement("pmts-executions-modal-trigger").click()})},triggerFailureWidgetAction:function(){this.triggerWidgetActionWithStatus("FAILURE")},triggerWidgetActionWithStatus:function(a,d){this.widget.widgetAction({widgetActionType:"execution",widgetAction:"result-received",executionStatus:a,reason:d})},_isTerminalStatus:function(a){return a&&-1!==["FAILURE","SUCCESS"].indexOf(a.toUpperCase())},isSafeTrue:function(a){return n.isDefined(a)&&"true"===a.toString()},
publishLatencyMetrics:function(a,d){d?e.logLatencyMetric({feature:a,resource:"_Latency",startTime:d}):e.logCounterMetric({feature:a+"_StartTimeNull",resource:"_Count"});e.publishMetrics()}})});m("ExecutionsWidgetUtils",["jQuery","lang"],function(c,g){var f={POLLING_FOR_ACTION_VIEW_EVENT:"pollingForActionViewEvent",POLLING_FOR_RESPONSE_VIEW_EVENT:"pollingForResponseViewEvent",ENTRY_VIEW_EVENT:"entryViewEvent",continueRequestWithPolling:function(c){this.widget=c.widget;this.inputData=c.inputData;this.onErrorFn=
c.onErrorFn||g.NOOP;this.onSuccessFn=c.onSuccessFn||g.NOOP;this.isResponseExpectedFn=c.isResponseExpectedFn||function(){return!0};this.retryFailedFn=c.retryFailedFn||c.onErrorFn;this.retryLimit=isNaN(c.retryLimit)?15:c.retryLimit;this.retryDelayFn=c.retryDelayFn||function(){return 1E3};this.retryOnFail=c.retryOnFail!==r?c.retryOnFail:!0;this.continueRequest(0)},continueRequest:function(c){var f=this;f.widget.continueRequest(f.inputData,{headers:{"executions-widget-ajax-continue-attempt-count":c},
retryDelayFn:f.retryDelayFn,success:function(b){var e=b.additionalWidgetResponseData.additionalData;if(f.isResponseExpectedFn(e))f.onSuccessFn(e);else f.retryOnFail&&(c<f.retryLimit?p.setTimeout(function(){var e=b.additionalWidgetResponseData.additionalData.widgetState;e&&(f.inputData["ppw-widgetState"]=e);f.continueRequest(++c)},f.retryDelayFn(c)):f.retryFailedFn(b))},error:f.onErrorFn})},addHostedContinueWidgetHandler:function(c,f,b,e,n){c.widget.on("componentsInitialized",c,function(){b(function(b){p.frameElement&&
p.frameElement.name===f?(p.parent.PaymentsPortal2.modules.when(["global-event-bus"],function(a){a.trigger("thirdPartyResponseStatusEvent",{status:b})}),p.parent.PaymentsPortal2.modules.when(["events"],function(a){a.trigger("thirdPartyResponseStatusEvent",{status:b})})):e(b)})});p.PaymentsPortal2.modules.when(["global-event-bus"],function(b){b.on("thirdPartyResponseStatusEvent",c,function(a){n(a.status)})})},dynamicContinueWithEvent:function(f,l,b,e,n,q){var a=this,k=c("\x3cform\x3e").attr({method:q?
q:"get",action:e.action,id:"pmts-dynamic-continue"});b.push({name:"ppw-widgetEvent",value:f},{name:"ppw-widgetState",value:l});g.forEach(e.inputs,function(a){b.push({name:a.name,value:a.value[0]})});g.forEach(b,function(d){k.append(a.buildHiddenInput(d.name,d.value))});n.append(k);k.submit()},buildContinueForm:function(g,l,b,e){g=c("\x3cform\x3e").attr({method:g,action:l,id:"pmts-form-continue"});for(var n in b)g.append(f.buildHiddenInput(n,b[n]));e.append(g);return g},buildHiddenInput:function(f,
g){return c("\x3cinput\x3e").attr({type:"hidden",name:f,value:g})}};return f});m("components/AuthorizePaymentMethodComponent",["ExecutionsComponent"],function(c){return c.extend({initialize:function(c,f){this.DEFAULT_EXECUTION_PENDING_REASON=f.data.defaultExecutionPendingReason;this.POLLING_RETRY_DELAY=f.data.pollingRetryDelay}})});m("components/AuthorizePaymentsComponent",["ExecutionsComponent"],function(c){return c});m("components/ChargeComponent",["PollingComponent"],function(c){return c});m("components/MfaComponent",
["ExecutionsComponent"],function(c){return c});m("PollingComponent",["component","jQuery","ExecutionsWidgetUtils"],function(c,g,f){var h=["APPROVED","FAILURE"];return c.extend({initialize:function(c,b){this.widgetStateFromJsData=c.options.serializedState;this.executionStatus=b.data.executionStatus;this.dynamicContinueFormDescription=b.data.dynamicContinueFormDescription;this.pollingForResponseTimeout=b.data.pollingForResponseTimeout||15E3},bindToEvents:function(){var c=this,b=p.setTimeout(function(){c.terminatePolling({executionStatus:"FAILURE",
reason:"timeout"})},c.pollingForResponseTimeout);h.includes(c.executionStatus.toUpperCase())?c.terminatePolling({executionStatus:c.executionStatus,widgetState:c.widgetStateFromJsData}):f.continueRequestWithPolling({widget:c.widget,inputData:{"ppw-widgetState":c.widgetStateFromJsData},isResponseExpectedFn:c.isResponseAsExpectedFn,onSuccessFn:function(e){c.terminatePolling(e,b)},retryFailedFn:function(e){c.terminatePolling(e,b)},onErrorFn:function(e){c.terminatePolling(e,b)},retryLimit:15,retryDelayFn:function(){return 1E3}})},
isResponseAsExpectedFn:function(c){return c.executionStatus&&h.includes(c.executionStatus.toUpperCase())},terminatePolling:function(c,b){b&&p.clearTimeout(b);f.dynamicContinueWithEvent("TerminalStatusEvent",c.widgetState||this.widgetStateFromJsData,[{name:"ppw-terminalState",value:c.executionStatus},{name:"ppw-reason",value:c.reason}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())}})});m("fetch-balance",[],function(){return{fetchBalance:function(c){this.widget=c.widget;
this.instrumentId=c.instrumentId;this.eventName=c.eventName;this.successView=c.successView;this.failureView=c.failureView;this.pendingView=c.pendingView;this.numberOfRetries=c.numberOfRetries||2;this.retryDelayInMs=c.retryDelayInMs||500;this.pendingView();this.fetchBalanceWithRetry(0)},fetchBalanceWithRetry:function(c){var g=this,f={"ppw-widgetEvent":g.eventName,"ppw-instrumentId":g.instrumentId,"ppw-widgetState":g.widget.options.serializedState};c++;g.widget.continueRequest(f,{success:function(f){g.handleSuccess(f,
c)},error:function(){g.failureView()}})},handleSuccess:function(c,g){var f=this,h=c.additionalWidgetResponseData.additionalData;f._balanceStatus=h.balanceStatus;var l=h.fetchedBalance;h=h.fetchedBalanceCurrency;g<f.numberOfRetries?"Success"===f._balanceStatus?f.successView(l,h):p.setTimeout(function(){var b=c.additionalWidgetResponseData.additionalData.widgetState;b&&(f.inputData["ppw-widgetState"]=b);f.fetchBalanceWithRetry(g)},f.retryDelayInMs):"Success"===f._balanceStatus?f.successView(l,h):f.failureView()}}});
m("components/IdentifyCreditCardComponent",["css-utils","component","lang"],function(c,g,f){return g.extend({bindToEvents:function(){if(this.data.enable)this.widget.on("creditCardNumberChanged",this,function(c){c.placementType===this.data.placementType&&this._resetAndValidate(c.creditCardNumber)&&this.widget.continueRequest({addCreditCardNumber:c.creditCardNumber,"ppw-widgetEvent":"IdentifyCreditCardEvent","ppw-widgetState":this.widget.options.serializedState},{success:f.bind(function(c){c=c.additionalWidgetResponseData.additionalData;
c.issuerImage&&c.issuerDisplayName&&(this.data.renderImagePlaceholder&&this._setAndShowIssuerLogo(c.issuerImage,c.issuerDisplayName),this.widget.trigger("creditCardIssuerDetermined",c));c.cardType&&"true"===c.debitCardWarningEnabled&&this.widget.trigger("cardTypeDetermined",c.cardType)},this),error:f.bind(function(c){this._hideIssuerLogo()},this)})})},_resetAndValidate:function(c){this._hideIssuerLogo();this.widget.trigger("creditCardNumberReset");return!!c},_setAndShowIssuerLogo:function(f,g){this.getDOMElement("addCCIssuerLogo").attr({src:f,
alt:g});c.showElement(this.getDOMElement("addCCIssuerLogo"))},_hideIssuerLogo:function(){c.hideElement(this.getDOMElement("addCCIssuerLogo"))}})});m("components/InlineContinueButtonComponent",["components/ContinueButtonComponent","tooltip"],function(c,g){return c.extend({initialize:function(c,h){this.popover=new g(this.getDOMElement("continue-button"),{position:"triggerTop",closeButton:!1},{position:"triggerTop"})}})});m("components/ManageBackupPaymentMethodsComponent",["component","css-utils","lang"],
function(c,g,f){return c.extend({initialize:function(c,f){g.showElement(this.getDOMElement("pmts-bpm-toggle"));g.hideElement(this.getDOMElement("pmts-bpm-nonjs-button"))},bindToElements:function(){var c=this;c.widget.onAui("a:switch:pmts-bpm-toggle:flip",function(f){c.getDOMElement("pmts-bpm-form").append("\x3cinput name\x3dppw-widgetEvent value\x3dUpdateBPMAccountLevelPreferenceEvent type\x3dhidden /\x3e").append("\x3cinput name\x3dppw-isBackupPaymentMethodEnabled value\x3d"+f.switchState.isOn.toString()+
" type\x3dhidden /\x3e").submit();c.widget.publishSuccessSushiMetrics({ActionType:"ToggleManageBackupPaymentMethods",ActionValueType:"EnableBPM",ActionValue:f.switchState.isOn.toString()})})}})});m("components/ManageOneClickComponent",["component","mash-helper","mixins/secure-container-support"],function(c,g,f){return c.extend(f,{initialize:function(c,f){this._isRequestForMobileApp=f.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=f.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=
f.data.dynamicContinueEnabled;var b=this;b._isRequestForMobileApp&&(g.addEventListener(b._securePaymentMethodAddedEvent,function(e){b._addEventListenerOneClickHandler(e)}),g.setBookmark("oneclick-widget"))},_addEventListenerOneClickHandler:function(c){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(c.detail.paymentInstrumentId,c.detail.widgetAction):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent",
"ppw-paymentMethodId":c.detail.paymentInstrumentId,"ppw-widgetAction":c.detail.widgetAction});g.backToBookmark("oneclick-widget")}})});m("components/ManageAllDevicesComponent",["component"],function(c){return c.extend({initialize:function(c,f){this.browserUbid=f.data.browserUbid},bindToElements:function(){var c=this;this.widget.onAui("a:switch:pmts-toggle-this-browser:flip",function(f){c.widget.submitFormAJAX({"ppw-ubid":c.browserUbid,"ppw-isOneClickEnabled":f.switchState.isOn.toString(),"ppw-widgetEvent":"UpdateBrowserOneClickStatusEvent",
"ppw-widgetState":c.widget.options.serializedState})})}})});m("components/ManageOneClickDevicesComponent",["component","css-utils","lang","jQuery"],function(c,g,f,h){return c.extend({bindToEvents:function(){this.getDOMElementsByPrefix("JsBindingTurnOffButton-").click(f.bind(this._turnOffButtonClicked,this))},_turnOffButtonClicked:function(c){var b=this,e=h(c.currentTarget).find("input"),f=e.data("ubid");e=e.data("device-name");c.preventDefault();this.widget.submitFormAJAX({"ppw-ubid":f,"ppw-deviceName":e,
"ppw-widgetEvent":"DisableDeviceEvent","ppw-widgetState":b.widget.options.serializedState},{success:function(c){var a=c.additionalWidgetResponseData.additionalData;a&&c.additionalWidgetResponseData.additionalData.disabledDeviceUbid&&(c=b.getDOMElement("JsBindingTurnOffButton-".concat(a.disabledDeviceUbid)),a=b.getDOMElement("JsBindingDisabledUnit-".concat(a.disabledDeviceUbid)),g.hideElement(c),g.showElement(a))}})}})});m("components/OneClickListItemComponent",["component","jQuery"],function(c,g){return c.extend({initialize:function(c,
g){},bindToElements:function(){var c=this,g=c.getDOMElement("oneClickDropDownFormAddressId"),l=c.getDOMElement("pmts-change-dropdown-status-text");g.bind("change",function(){l&&(this.checked?l.removeClass("a-color-tertiary"):l.addClass("a-color-tertiary"));c.widget.continueRequest({"ppw-widgetEvent":"UpdateOneClickEnabledEvent","ppw-addressId":this.value,"ppw-isEnabled":this.checked.toString(),"ppw-widgetState":c.getWidgetState("oneClickDropDownFormAddressId")},{success:c.widget.createAjaxContinueSuccessHandler()})})}})});
m("events/ManagePaymentMethodsEvent",["public-event-registry"],function(c){c.register("ManagePaymentMethodsEvent");return"ManagePaymentMethodsEvent"});m("components/ManagePaymentMethodsComponent","workflow-component events/ManagePaymentMethodsEvent AddPaymentMethodTouchLinkSupport AUI!P mash-helper mixins/secure-container-support css-utils jQuery clog lang".split(" "),function(c,g,f,h,l,b,e,n,q,a){return c.extend(f,b,{initialize:function(a,d){this._isRequestForMobileApp=d.data.isRequestForMobileApp;
this._securePaymentMethodAddedEvent=d.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=d.data.dynamicContinueEnabled;this._bulkRemovalFeatureEnabled=d.data.bulkRemovalFeatureEnabled;this._currentCardsSizeInInstrumentList=d.data.currentCardsSizeInInstrumentList;this._bulkRemovalUpperLimitSize=d.data.bulkRemovalUpperLimitSize;var b=this;b._isRequestForMobileApp&&(l.addEventListener(b._securePaymentMethodAddedEvent,function(a){b._addEventListenerMPMHandler(a)}),l.setBookmark("mpo-widget"))},
_addEventListenerMPMHandler:function(a){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(a.detail.paymentInstrumentId,a.detail.widgetAction):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a.detail.paymentInstrumentId,"ppw-widgetAction":a.detail.widgetAction});l.backToBookmark("mpo-widget")},_addEventListenerBulkSelectCheckbox:function(a,d){var b=0;n.each(a,function(a,d){d.checked&&
b++});b===this._bulkRemovalUpperLimitSize&&d.currentTarget.checked&&n.each(a,function(a,d){d.checked||(d.disabled=!0)});b!==this._bulkRemovalUpperLimitSize-1||d.currentTarget.checked||n.each(a,function(a,d){d.checked||(d.disabled=!1)})},bindToEvents:function(){var b=this;c.prototype.bindToEvents.apply(this);if(b._bulkRemovalFeatureEnabled){var d=n("div.apx-mpo-bulk-removal-checkbox input[name*\x3d'bulkremovalselectedcheckbox']");0===d.length&&0<b._currentCardsSizeInInstrumentList&&(q.logCounterMetric({feature:"QueryBulkRemovalCheckboxesFailed",
resource:"_Count"}),q.publishMetrics());n.each(d,function(k,c){a.addEventListener(c,"click",function(a){b._addEventListenerBulkSelectCheckbox(d,a)})});b.getDOMElement("apx-mpo-bulk-removal-select-top-cards-event").bind("click",function(a){a.preventDefault();n.each(d,function(a,d){!d.checked&&!d.disabled&&a<b._bulkRemovalUpperLimitSize&&d.click()});e.hideElement(b.getDOMElement("apx-mpo-bulk-removal-select-top-cards-event"));e.showElement(b.getDOMElement("apx-mpo-bulk-removal-remove-top-top-event"))});
b.getDOMElement("apx-mpo-bulk-removal-remove-top-top-event").bind("click",function(a){a.preventDefault();n.each(d,function(a,d){d.checked&&d.click()});e.showElement(b.getDOMElement("apx-mpo-bulk-removal-select-top-cards-event"));e.hideElement(b.getDOMElement("apx-mpo-bulk-removal-remove-top-top-event"))});b.getDOMElement("apx-mpo-bulk-removal-submit-event").bind("click",function(a){var b=!0;n.each(d,function(a,d){d.checked&&(b=!1)});b&&a.preventDefault()})}if(null!=this.data.paymentMethodsManagementData)this.widget.on("componentsInitialized",
this,function(){b.widget.trigger(g,b.data.paymentMethodsManagementData)})},bindToElements:function(){f.bindToElements.apply(this)}})});m("components/CBCCRegistrationComponent",["component","server","AUI!P","lang"],function(c,g,f,h){return c.extend({handleApxClaimOwnershipLink:function(c){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"StartClaimOwnershipEvent","ppw-instrumentId":c})},bindToEvents:function(){var c=this,b=c.data.instrumentId;c.getDOMElement("pmts-CBCCAPXClaimOwnership-link-id").bind("click",
function(e){c.handleApxClaimOwnershipLink(b)})}})});m("components/EditInstrumentComponent",["modal-popover","component","lang"],function(c,g,f){return g.extend({initialize:function(f,g){g.data.shouldRenderInPopover&&(this.popover=new c(f,g,this))},bindToEvents:function(){this.widget.on("mpo-edit-popover-closed",this,function(c){this.getDOMElement("pmts-mpo-js-edit-popover-cancel-form").submit()})}})});m("events/DeleteDisabledInfoLinkClickedEvent",[],function(){return"DeleteDisabledInfoLinkClicked"});
m("components/InstrumentListComponent",["component","lang"],function(c,g){return c.extend({})});m("components/InstrumentListItemComponent",["events/DeleteDisabledInfoLinkClickedEvent","public-event-registry","component","lang","metrics-helper"],function(c,g,f,h,l){return f.extend({initialize:function(b,e){g.register(c)},_triggerDeleteDisabledInfoLinkClickedEvent:function(){this.widget.trigger(c)},bindToElements:function(){var b=this,c=this.getDOMElement("deleteDisabledInfoLink");l.publishOnClickSuccessSushiMetrics(b,
[{JsBindElementId:"gc-reload-link",MetricsObject:{ActionType:"GCReloadLink"}},{JsBindElementId:"gc-redeem-link",MetricsObject:{ActionType:"GCRedeemLink"}}]);c&&c.click(h.bind(this._triggerDeleteDisabledInfoLinkClickedEvent,this));b.getDOMElement("ZipBalanceMPORefresh").find(".pmts-zip-balance-mpo-refresh-link").click(function(){b.widget.trigger("ZipBalanceMPORefresh")})},bindToEvents:function(){var b=this;b.widget.on("ZipBalanceMPORefresh",b,function(c){b.widget.submitFormAJAX({"ppw-widgetState":b.widget.options.serializedState,
"ppw-widgetEvent":"ZipBalanceMPORefreshEvent"})})}})});m("components/ViewMandateComponent",["modal-popover","component"],function(c,g){return g.extend({initialize:function(f,g){g.data.shouldRenderInPopover&&(this.popover=new c(f,g,this))},bindToEvents:function(){this.widget.on("dd-mandate-popover-closed",this,function(c){this.getDOMElement("js-mandate-popover-cancel").submit()})}})});m("events/MPCIntegrationCompletedEvent",["public-event-registry"],function(c){c.register("MPCIntegrationCompletedEvent");
return"MPCIntegrationCompletedEvent"});m("events/MPCIntegrationInitializedEvent",["public-event-registry"],function(c){c.register("MPCIntegrationInitializedEvent");return"MPCIntegrationInitializedEvent"});m("components/MobilePhoneCollectionComponent","css-utils jQuery component events/MPCIntegrationCompletedEvent events/MPCIntegrationInitializedEvent lang AUI!P clog aui-helper".split(" "),function(c,g,f,h,l,b,e,n,q){return f.extend({_integrationType:r,_mpcCVF:r,$mpcCVFContainer:null,$mpcContainer:null,
$mpcCVFVerificationResultsContainer:null,$mpcErrorSection:null,$mpcTouchlink:null,$mpcPromptTitle:null,$mpcSkipTouchlink:null,$isClosedBySkip:!1,initialize:function(a,b){this.$mpcCVFContainer=this.getDOMElement("mpc-cvf-container");this.$mpcCVFVerificationResultsContainer=this.getDOMElement("mpc-cvf-results-container");this.$mpcErrorSection=this.getDOMElement("mpc-error-section");this.$mpcTouchlink=this.getDOMElement("mpc-touchlink");this.$mpcPromptTitle=this.getDOMElement("mpc-link-prompt-title");
this.$mpcSkipTouchlink=this.getDOMElement("mpc-skip-touchlink");this._integrationType=b.data.integType;this._popoverAction=this.getDOMElement("collect-new-mobile-declarative-action").data("action");this._popoverActionId=this.getDOMElement("collect-new-mobile-declarative-action").attr("id");this._initializedTime=(new Date).getTime();"cc_nudge"!==this._integrationType&&"cc_integ"!==this._integrationType&&"pi_nudge"!==this._integrationType||this.startMobilePhoneCollectionCVFWidget()},getCvfCurrentState:function(){if(this.$mpcCVFContainer){var a=
this.$mpcCVFContainer.find("[name\x3d'cvf_phone_num']");var b=this.$mpcCVFContainer.find("[name\x3d'code']")}else return"Init";return a&&a[0]&&(a[0].value||""===a[0].value)?"OnPhoneNum":b&&b[0]&&(b[0].value||""===b[0].value)?"OnOtp":"Unknown"},publishCvfExitMetric:function(a,b){switch(b){case "OnPhoneNum":n.logCounterMetric({feature:a+b+"."+this._integrationType,resource:"_Count"});break;case "OnOtp":n.logCounterMetric({feature:a+b+"."+this._integrationType,resource:"_Count"});break;case "Unknown":n.logCounterMetric({feature:a+
"Unknown."+this._integrationType,resource:"_Count"})}n.publishMetrics()},bindToElements:function(){var a=this;this.getDOMElement("mpc-close-button").click(function(){a.widget.trigger(h,{integType:a._integrationType})});this.getDOMElement("mpc-touchlink").click(function(){n.logCounterMetric({feature:"MpcPromptClicked."+a._integrationType,resource:"_Count"});a._initializedTime&&n.logLatencyMetric({feature:"MpcInitializationTilClickSpan."+a._integrationType,resource:"_Latency",startTime:a._initializedTime});
n.publishMetrics()});this.$mpcSkipTouchlink.click(function(){a.$isClosedBySkip=!0;a.publishCvfExitMetric("MpcCollectionSkipped.",a.getCvfCurrentState());a.widget.trigger(h,{integType:a._integrationType})})},bindToEvents:function(){var a=this;e.when("A","a-popover","ready").execute(function(b,d){b.on("a:popover:afterHide:collect-new-mobile-popover",function(){!1===a.$isClosedBySkip&&a.publishCvfExitMetric("MpcCollectionAbandoned.",a.getCvfCurrentState())})});this.widget.on(l,this,function(b){"pi_nudge"!==
a._integrationType&&"cc_nudge"!==a._integrationType||c.showElement(a.getDOMElement("mpc-touchlink"))});this.widget.on(h,this,function(){a.togglePopover(!1)})},togglePopover:function(a){var b=this;this._popoverAction&&e.when(this._popoverAction,"jQuery","ready").execute(function(d,k){(d=d.get(k("#"+b._popoverActionId)))&&(a?d.show():d.hide())})},onMobilePhoneCollectionOTPVerificationSuccess:function(a){n.logCounterMetric({feature:"MpcCollectionCompleted."+this._integrationType,resource:"_Count"});
n.publishMetrics();this.widget.trigger(h,{integType:this._integrationType});if("pi_nudge"===this._integrationType||"cc_nudge"===this._integrationType)c.hideElement(this.$mpcTouchlink),c.hideElement(this.$mpcPromptTitle)},onMobilePhoneCollectionOTPVerificationFailed:function(a){c.hideElement(this.$mpcCVFContainer);c.showElement(this.$mpcCVFVerificationResultsContainer);a&&this.$mpcErrorSection.find(".a-alert-content").text(a)},startMobilePhoneCollectionCVFWidget:function(){var a=this;e.when("cvf",
"ready").execute(function(k){a._mpcCVF=k.create({target:a.$mpcCVFContainer,requestToken:a.data.requestToken,onSuccess:b.bind(a.onMobilePhoneCollectionOTPVerificationSuccess,a),onError:b.bind(a.onMobilePhoneCollectionOTPVerificationFailed,a),autoStart:!1});a._mpcCVF&&(a.widget.trigger(l,{integType:a._integrationType,initializedTime:a._initializedTime,mpcPopoverAction:a._popoverAction,mpcPopoverActionId:a._popoverActionId}),a._mpcCVF.start())})}})});m("components/OneTimePasswordComponent",["form-component",
"lang"],function(c,g){return c.extend({initialize:function(c,g){this._resendDelaySeconds=g.data.resendOTPDelay;this._maxOTPInputLength=g.data.maxOTPLength;this._resendWaitMessageElement=this.getDOMElement("OneTimePasswordResendWaitMessageJSBinding");this._resendDelaySeconds&&0<this._resendWaitMessageElement.length&&this._startResendWaitTimer(this._resendDelaySeconds);this._oneTimePasswordInputBox=this.getDOMElement("OneTimePasswordInputBoxJSBinding");this._confirmOTPForm=this.getDOMElement("OneTimePasswordFormJSBinding");
this._resendWaitTimer=this.getDOMElement("OneTimePasswordResendWaitTimerJSBinding");this._oneTimePasswordSubmitButton=this.getDOMElement("OneTimePasswordContinueButtonJSBinding")},bindToElements:function(){this._oneTimePasswordSubmitButton.click(g.bind(this._handleConfirmOTPFormSubmission,this))},bindToEvents:function(){var c=this;c._oneTimePasswordInputBox.keypress(function(f){if(!(48<=f.which&&57>=f.which||8===f.which||13===f.which)||c._maxOTPInputLength&&c._oneTimePasswordInputBox.val().length>=
c._maxOTPInputLength)return!1});c._oneTimePasswordInputBox.bind("paste",function(f){f.preventDefault();var g=c._oneTimePasswordInputBox.val();f=f.clipboardData?f.clipboardData.getData("text/plain"):f.originalEvent.clipboardData.getData("text/plain");var b=g+f;c._maxOTPInputLength&&(f=f.substring(0,c._maxOTPInputLength-g.length),b=g+f);/^[0-9]*$/.test(b)&&c._oneTimePasswordInputBox.val(b)})},_handleConfirmOTPFormSubmission:function(c){0===this.form.validateForm().length?this._confirmOTPForm.submit():
c.preventDefault()},_startResendWaitTimer:function(c){var f=(new Date).getTime();this._startCountDown(this,1E3*c+f,this._updateCountDownTimer,this._terminalEventOnCountDownTimerExpiry)},_startCountDown:function(c,g,l,b){c.resendWaitTimerIntervalID=setInterval(function(){var e=(new Date).getTime();e=g-e;var f=Math.floor(e/1E3).toString().padStart(2,"0");0>e?(clearInterval(c.resendWaitTimerIntervalID),b(c)):l(c,f)},1E3)},_updateCountDownTimer:function(c,g){c._resendWaitTimer.html(g)},_terminalEventOnCountDownTimerExpiry:function(c){c._placeElementOffScreen(c.getDOMElement("OneTimePasswordResendWaitMessageJSBinding"));
c._placeElementOnScreen(c.getDOMElement("OneTimePasswordResendButtonMessageJSBinding"))},_placeElementOffScreen:function(c){c.get(0).classList.contains("aok-offscreen")||c.get(0).classList.add("aok-offscreen")},_placeElementOnScreen:function(c){c.get(0).classList.remove("aok-offscreen")}})});m("components/OrderSummaryComponent",["component","lang","css-utils"],function(c,g,f){var h=!1;return c.extend({initialize:function(c,b){h=b.data.isDynamicOrderSummaryEnabled},bindToEvents:function(){var c=this;
this.widget.on("installmentOptionChanged",this,function(b){var e=c.getDOMElement("installmentSectionTitle"),g=c.getDOMElement("installmentSectionBreakdown");b&&b.summaryDisplay?(g.html(b.summaryDisplay),b=c.widget.getLocalizedString("apx_order_summary_installments_title"),e.html(b),f.showElement(e),f.showElement(g)):(e.html(""),g.html(""),f.hideElement(e),f.hideElement(g))})},bindToElements:function(){this.getDOMElement("apx-order-summary-view-details").click(g.bind(this._handleOrderSummaryUpdate,
this));this.getDOMElement("apx-order-summary-api-error-retry-button").click(g.bind(this._handleOrderSummaryUpdate,this))},_handleOrderSummaryUpdate:function(c){var b=this,e=b.getDOMElement("apx-order-summary-content"),g=b.getDOMElement("apx-order-summary-spinner"),l=b.getDOMElement("apx-order-summary-grand-total-section"),a=b.getDOMElement("apx-order-summary-api-error");h&&(f.toggleElement(g,!0),f.toggleElement(e,!1),f.toggleElement(l,!1),f.toggleElement(a,!1),b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,
"ppw-widgetEvent":"FetchOrderSummaryDataEvent"},{success:function(c){try{var d=JSON.parse(c.additionalWidgetResponseData.additionalData.subtotals),k=JSON.parse(c.additionalWidgetResponseData.additionalData.grandTotal),n=b.getDOMElement("apx-order-summary-subtotal-template").clone(!0);e.html(n);for(var h in d){var q=d[h].subTotalInfo.stringId,t=n.clone(!0).attr("id",q),m=t.find(".apx-subtotal-label-text"),p=t.find(".apx-subtotal-amount-value");m.html(b.widget.getLocalizedString(q));"INR"===d[h].subTotalInfo.currency.unit?
(f.toggleElement(t.find(".inr-currency-symbol"),!0),p.html(d[h].subTotalInfo.currency.value)):p.html(d[h].subTotalInfo.currency.displayString);f.toggleElement(t,!0);e.append(t)}var r=k.grandTotalInfo.stringId;b.getDOMElement(r+"_label").innerHTML=b.widget.getLocalizedString(r);"INR"===k.grandTotalInfo.currency.unit?(b.getDOMElement(r+"_amount").innerHTML=k.grandTotalInfo.currency.value,b.getDOMElement("displayedOrderTotalAmount_amount").innerHTML=k.grandTotalInfo.currency.value):(b.getDOMElement(r+
"_amount").innerHTML=k.grandTotalInfo.currency.displayString,b.getDOMElement("displayedOrderTotalAmount_amount").innerHTML=k.grandTotalInfo.currency.displayString);f.toggleElement(e,!0);f.toggleElement(l,!0);f.toggleElement(a,!1);f.toggleElement(g,!1)}catch(z){f.toggleElement(g,!1),f.toggleElement(a,!0),f.toggleElement(g,!1)}},error:function(){f.toggleElement(g,!1);f.toggleElement(a,!0)}}))}})});m("components/PayerComponent",["events/form-submitted-event","form-component","lang","jQuery","css-utils"],
function(c,g,f,h,l){return g.extend({formatDayAndMonth:function(b){return b&&1===b.length?"0"+b:b},populateBirthDate:function(){var b=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateDay']").val()),c=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateMonth']").val()),f=h("[name\x3d'ppw-birthDateYear']").val();b&&c&&f&&(b=f+"-"+c+"-"+b,h("[name\x3d'ppw-birthDate']").val(b))},initialize:function(b,c){this._action=c.data.action},bindToElements:function(){var b=this;h("[name\x3d'ppw-birthDateDay']").change(function(){b.populateBirthDate()});
h("[name\x3d'ppw-birthDateMonth']").change(function(){b.populateBirthDate()});h("[name\x3d'ppw-birthDateYear']").change(function(){b.populateBirthDate()});this.getDOMElement("pmts-payer-continue-button").click(f.bind(this._handleFormSubmission,this))},bindToEvents:function(){var b=this;this.widget.on(c,b,function(c){c.action===b._action&&b.getDOMElement("pmts-payer-form").submit()})},_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var e=this.getFormSubmissionParameters("pmts-payer-form-container");
this.widget.trigger(c,{queryParameters:this.data.queryParams,submissionParameters:e,event:b,action:this._action})}else b.preventDefault()}})});m("components/PaymentInstrumentComponent",["component"],function(c){return c.extend({_getChangePaymentInstrument:function(){return this.getDOMElement("pmtsChangePaymentInstrument")},_makeTransition:function(c){p.location=c},bindToElements:function(){var c=this,f=c._getChangePaymentInstrument();0<f.length&&f.click(function(){c.widget.trigger("ChangePaymentInstrumentRequested");
return!1})},bindToEvents:function(){var c=this;c.widget.on("ChangePaymentInstrumentRequested",c,function(f){f=c._getChangePaymentInstrument().attr("href");c._makeTransition(f)})}})});m("components/PaymentLocationBaseWorkflowComponent",["component"],function(c){return c});m("components/PaymentMethodConsentWorkflowComponent",["component"],function(c){return c});m("components/PaymentMethodStorageBlanketConsentComponent","component css-utils jQuery lang clog AUI!P".split(" "),function(c,g,f,h,l,b){return c.extend({_initPopoverState:function(){this.getDOMElement("apx-desktop-consent-blanket-view-modal-js-bind-element").trigger("click");
g.hideElement(this.getDOMElement("apx-desktop-selective-consent-view-template-binding"))},_hidePopoverModal:function(){b.when("a-modal").execute(function(b){b&&(b=b.get("apx-desktop-storage-consent-blanket-view-modal-popover-name"))&&(b.unlock(100),b.hide())})},bindToEvents:function(){var b=this;f(".apx-mobile-storage-consent-blanket-view-learn-more-css-class").bind("click",function(){l.logCounterMetric({feature:"PaymentMethodStorageBlanketConsent.LearnMoreLinkClicked",resource:"_Count"});l.publishMetrics()});
b.widget.on("componentsInitialized",b,function(b){this._initPopoverState()});f(".pmts-link-button-desktop-no-padding").bind("click",function(){b._hidePopoverModal();l.logCounterMetric({feature:"PaymentMethodStorageBlanketConsent.SkipForNowClicked",resource:"_Count"});l.publishMetrics()})},bindToElements:function(){var c=this;c.getDOMElement("apx-desktop-select-which-to-keep-button-binding").click(function(){g.showElement(c.getDOMElement("apx-desktop-selective-consent-view-template-binding"));g.hideElement(c.getDOMElement("apx-desktop-blanket-consent-view-template-binding"));
c.widget.publishSuccessSushiMetrics({ActionType:"PaymentMethodStorageSelectiveConsentEvent",ActionValueType:"View",ActionValue:"PaymentMethodStorageConsent.SelectiveConsentView"});l.logCounterMetric({feature:"PaymentMethodStorageConsent.SelectWhichToKeepClicked",resource:"_Count"});l.publishMetrics()});c.getDOMElement("apx-storage-consent-keep-all-button-binding").click(function(){c._hidePopoverModal()});c.getDOMElement("apx-storage-consent-save-preference-button-binding").click(function(){c._hidePopoverModal()});
b.when("a-modal","ready").execute(function(b){(b=b.get("apx-desktop-storage-consent-blanket-view-modal-popover-name"))&&b.lock(100)})}})});m("components/PaymentMethodStorageSelectiveConsentComponent","component css-utils jQuery lang clog AUI!P".split(" "),function(c,g,f,h,l,b){return c.extend({_initPopoverState:function(){this.getDOMElement("apx-desktop-consent-selective-view-modal-js-bind-element").trigger("click")},_hidePopoverModal:function(){b.when("a-modal").execute(function(b){if(b){var c=b.get("apx-desktop-storage-consent-selective-view-modal-popover-name");
c&&(c.unlock(100),c.hide());if(b=b.get("apx-desktop-storage-consent-blanket-view-modal-popover-name"))b.unlock(100),b.hide()}})},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(b){this._initPopoverState()});var c=f("div.apx-pmts-storageconsent-checkbox input[name*\x3d'selectedcheckbox']");b.getDOMElement("payment-method-selective-consent-select-all-preferences").bind("click",function(b){b.preventDefault();f.each(c,function(a,b){b.checked||b.click()});l.logCounterMetric({feature:"PaymentMethodStorageSelectiveConsent.SelectAllClicked",
resource:"_Count"});l.publishMetrics()});f(".apx-mobile-storage-consent-selective-view-learn-more-css-class").bind("click",function(){l.logCounterMetric({feature:"PaymentMethodStorageSelectiveConsent.LearnMoreLinkClicked",resource:"_Count"});l.publishMetrics()});f(".pmts-link-button-desktop-no-padding").bind("click",function(){b._hidePopoverModal();l.logCounterMetric({feature:"PaymentMethodStorageSelectiveConsent.SkipForNowClicked",resource:"_Count"});l.publishMetrics()})},bindToElements:function(){var c=
this;c.getDOMElement("apx-storage-consent-save-preference-button-binding").click(function(){c._hidePopoverModal()});b.when("a-modal","ready").execute(function(b){(b=b.get("apx-desktop-storage-consent-selective-view-modal-popover-name"))&&b.lock(100)})}})});m("components/PaymentStoreLocationComponent",["component","lang"],function(c,g){return c.extend({initialize:function(c,g){this._storeLinkWidgetEventName=g.data.storeLinkWidgetEventName;this._redirectUrl=g.data.redirectUrl;this._storeLocationId=
g.data.storeLocationId},bindToElements:function(){this.getDOMElement("pmts-payments-store-link-"+this._storeLocationId).click(g.bind(this._onLinkClick,this))},_onLinkClick:function(){this._storeLinkWidgetEventName?this.widget.trigger(this._storeLinkWidgetEventName,{redirectUrl:this._redirectUrl}):this.getCurrentLocation().href=this._redirectUrl},getCurrentLocation:function(){return p&&p.location}})});m("components/ViewMandatePayNowComponent",["component"],function(c){return c.extend({})});m("components/PointsAccountComponent",
["css-utils","jQuery","form-component","lang"],function(c,g,f,h){return f.extend({pointsField:"points",initialize:function(f,b){this._isDisplayingSubmitButton=!c.hasAUIHiddenClass(this.getDOMElement("pointsAccountSubmitButton"))&&c.hasAUIHiddenClass(this.getDOMElement("pointsAccountAppliedMessage"))},_validationToErrorMap:{IsNumberFieldConstraint:"pointsAccountErrorInvalidFormat",LessThanEqualFieldConstraint:"pointsAccountErrorGreaterThanEligible",GreaterThanEqualFieldConstraint:"pointsAccountErrorLessThanZero"},
_getErrorMessageContainer:function(){return this.getDOMElement("errorMessages")},_resetFormErrorMessages:function(){var f=this;c.hideElement(f._getErrorMessageContainer());c.hideElement(g(".pmts-points-account-server-message"));h.forEachKeyValue(f._validationToErrorMap,function(b,c){f.form.resetErrorMessage(f.pointsField,f.getDOMElement(c))},f)},_displayFormErrorMessages:function(f){0!==f.length&&(f=f[0],f.field===this.pointsField&&(f=this.getDOMElement(this._validationToErrorMap[f.validation]),this.form.displayErrorMessage(this.pointsField,
f)),c.showElement(this._getErrorMessageContainer()))},_handlePointsAccountDOMEvent:function(){this._resetFormErrorMessages();var c=this.form.validateForm();0===c.length?this.widget.trigger("PointsAccountSubmitted",{points:this.getDOMElement(this.pointsField).val(),submissionParameters:this.getDOMElement("pointsAccountSubmitButton").closest("form").serializeArray()}):this._displayFormErrorMessages(c);return!1},bindToElements:function(){var f=this;f.bindFormSubmissionHandler("pointsAccountSubmitButton",
f.pointsField,f._handlePointsAccountDOMEvent);f.getDOMElement(f.pointsField).bind("change keyup",function(b){f._isDisplayingSubmitButton||(c.hideElement(f.getDOMElement("pointsAccountAppliedMessage")),c.showElement(f.getDOMElement("pointsAccountSubmitButton")))})},bindToEvents:function(){var c=this;c.widget.on("PointsAccountSubmitted",c,function(b){g(c.getDOMElement("pointsAccountSubmitButton")).closest("form").submit()})}})});m("components/GenerateQrCodeComponent","component css-utils lang clog ExecutionsWidgetUtils events/QrCodeGeneratedEvent count-down-timer-helper".split(" "),
function(c,g,f,h,l,b,e){return c.extend({initialize:function(b,c){this.countdownTimerIntervalId=0;this.dynamicContinueFormDescription=c.data.dynamicContinueFormDescription;this.executionStatusPollingRetryLimit=parseInt(c.data.executionStatusPollingRetryLimit,10);this.pollingRetryDelay=parseInt(c.data.pollingRetryDelay,10);this.executionMetricsPrefix=c.data.executionMetricsPrefix;this.cancelTransactionEventEnabled=c.data.cancelTransactionEventEnabled},bindToEvents:function(){var c=this;this.widget.on("componentsInitialized",
this,function(){g.showElement(c.getDOMElement("pmts-executions-async-spinner-polling-for-action"));c.GENERATE_QR_CODE_START_TIME=(new Date).getTime();l.continueRequestWithPolling({widget:c.widget,inputData:{"ppw-widgetEvent":"GenerateQrCodeEvent","ppw-widgetState":c.widget.options.serializedState,"ppw-javaEnabled":p&&p.navigator&&p.navigator.javaEnabled(),"ppw-language":p&&p.navigator&&p.navigator.language,"ppw-screenColorDepth":p&&p.screen&&p.screen.colorDepth,"ppw-screenHeight":p&&p.screen&&p.screen.height,
"ppw-screenWidth":p&&p.screen&&p.screen.width,"ppw-timeZone":(new Date).getTimezoneOffset()},isResponseExpectedFn:function(b){return b.qrCodeUrl!==r||b.qrCodeImageBase64String!==r},onSuccessFn:function(n){c.widget.trigger(b);g.hideElement(c.getDOMElement("pmts-executions-async-spinner-polling-for-action"));c._publishLatencyMetric("GenerateQrCodePollingTime",c.GENERATE_QR_CODE_START_TIME);var a=c.getDOMElement("qr-code-text-copy-button");a&&g.showElement(a);n.qrCodeImageBase64String!==r&&(a=c.getDOMElement("qrCode-image"),
a.attr("src","data:image/png;base64,"+n.qrCodeImageBase64String),g.showElement(a),a=c.getDOMElement("qrCode-image-container"),g.showElement(a));if("CustomerPaymentReference"==n.category)c._hydrateCustomerPaymentReferenceFields(n);else{(a=c.getDOMElement("apx-qrcodeurl-text-display"))&&n.qrCodeUrl?a.val(n.qrCodeUrl):a&&n.customerPaymentReference&&a.val(n.customerPaymentReference);if(a=c.getDOMElement("qrCode-wallet-payment-link"))a.attr("href",n.qrCodeUrl),g.showElement(a);g.showElement(c.getDOMElement("qrCode-cancel-container"));
n.expirationTimeInMillis!==r&&(n=parseInt(n.expirationTimeInMillis,10),c.countdownTimerIntervalId=e.startCountDownTimer(c,n,c._triggerUpdateCountDownTimer,c._triggerTerminalEventOnCountDownTimerExpiry),n=c.getDOMElement("qrCode-count-down-timer-container"),g.showElement(n),c._publishCounterMetric("QrCodeCountDownTimerRenderedCount"));c.CONFIRM_QR_CODE_START_TIME=(new Date).getTime();p.setTimeout(f.bind(c._pollForFundingSourceStatus,c),1E4)}},retryFailedFn:function(){c._fireWidgetCompletedEvent("GenerateQrCodeUrlRetriesExhausted")},
retryLimit:15})})},bindToElements:function(){var b=this;this.getDOMElement("qr-code-text-copy-button").click(function(){var c=b.getDOMElement("apx-qrcodeurl-text-display"),a=c.val();1!=b.getDOMElement("qrCode-cpr-qr-base-64-text").length||"undefined"!==typeof a&&""!==a||(c=b.getDOMElement("qrCode-cpr-qr-base-64-text"),a=c.text());c.select();p&&p.navigator&&p.navigator.clipboard.writeText(a)});this.getDOMElement("qrCode-cancel-button").click(f.bind(b._fireWidgetCompletedEvent,b,"CustomerCancelledTransaction"))},
_pollForFundingSourceStatus:function(){var b=this;l.continueRequestWithPolling({widget:b.widget,inputData:{"ppw-widgetEvent":"ConfirmQrCodeEvent","ppw-widgetState":b.widget.options.serializedState},retryDelayFn:function(){return b.pollingRetryDelay},isResponseExpectedFn:function(b){return"true"===b.fundingSourceInTerminalState},onSuccessFn:function(){b._publishLatencyMetric("ConfirmQrCodePollingTime",b.CONFIRM_QR_CODE_START_TIME);clearInterval(b.countdownTimerIntervalId);b._fireConfirmQrCodeCompletedEvent("TerminalStateReached")},
retryFailedFn:function(){clearInterval(b.countdownTimerIntervalId);b._fireWidgetCompletedEvent("ConfirmQRCodeRetriesExhausted")},retryLimit:b.executionStatusPollingRetryLimit})},_fireWidgetCompletedEvent:function(b){this.cancelTransactionEventEnabled?this._fireCancelTransactionEvent(b):this._fireConfirmQrCodeCompletedEvent(b)},_fireConfirmQrCodeCompletedEvent:function(b){l.dynamicContinueWithEvent("ConfirmQrCodeCompletedEvent",this.widget.options.serializedState,[{name:"ppw-reason",value:b}],this.dynamicContinueFormDescription,
this.widget.getRootDOMElements().last())},_fireCancelTransactionEvent:function(b){g.hideElement(this.getDOMElement("qrCode-count-down-timer-container"));g.hideElement(this.getDOMElement("qrCode-image-container"));g.hideElement(this.getDOMElement("qrCode-cancel-container"));this.getDOMElement("qrCode-polling-connection-info-label").html(this.widget.getLocalizedString("apx_default_verify_payment_status_message"));g.showElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action"));
l.dynamicContinueWithEvent("CancelTransactionEvent",this.widget.options.serializedState,[{name:"ppw-reason",value:b}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},_hydrateCustomerPaymentReferenceFields:function(b){var c=this.getDOMElement("qrCode-cpr-info-section");g.showElement(c);b.customerPaymentReferenceDueDate!==r&&this.getDOMElement("qrCode-cpr-due-date").text(b.customerPaymentReferenceDueDate);b.orderValue!==r&&this.getDOMElement("qrCode-cpr-order-value").text(b.orderValue);
if(b.scanCodeType!==r)switch(c=this.getDOMElement("qrCode-cpr-qr-base-64-text"),b.scanCodeType){case "BARCODE":b.customerPaymentReference!==r&&(c.text(b.customerPaymentReference),b=this.getDOMElement("qrCode-cpr-barcode-footer-images-section"),c=this.getDOMElement("qrCode-cpr-barcode-shop-footer-section"),g.showElement(b),g.showElement(c));break;default:b.qrCodeUrl!==r&&c.text(b.qrCodeUrl)}b=this.getDOMElement("qrCode-cpr-loading-box");g.hideElement(b);b=this.getDOMElement("qrCode-cpr-qr-section");
g.showElement(b)},_triggerUpdateCountDownTimer:function(b,c){b.getDOMElement("qrCode-count-down-timer-label").html(c)},_triggerTerminalEventOnCountDownTimerExpiry:function(b){b._fireWidgetCompletedEvent("CountDownTimerExpired")},_publishLatencyMetric:function(b,c){h.logLatencyMetric({feature:this._getMetricName(b),resource:"_Latency",startTime:c});h.publishMetrics()},_publishCounterMetric:function(b){h.logCounterMetric({feature:this._getMetricName(b),resource:"_Count"});h.publishMetrics()},_getMetricName:function(b){return[this.executionMetricsPrefix,
b].join(".")}})});m("components/PayWithQrCodeComponent",["component","css-utils","events/QrCodeGeneratedEvent"],function(c,g,f){return c.extend({initialize:function(c,f){},bindToEvents:function(){var c=this;c.widget.on(f,c,function(){g.hideElement(c.getDOMElement("qrCode-box-header"))})}})});m("events/QrCodeGeneratedEvent",["public-event-registry"],function(c){c.register("QrCodeGeneratedEvent");return"QrCodeGeneratedEvent"});m("components/RedeemClaimCodeComponent","css-utils jQuery form-component lang clog scanner-helper AUI!P".split(" "),
function(c,g,f,h,l,b,e){return f.extend({_scannedClaimCode:r,initialize:function(b,c){this.giftCardRegex=c.data.giftCardRegex;this.scannerEnabled=c.data.scannerEnabled;this._shouldDisplayMCXModernFrame=c.data.shouldDisplayMCXModernFrame;this.claimCodeApplyPressed=c.data.claimCodeApplyPressed;this.$claimCode=this.getDOMElement("claimCode");this.$claimCodeSubmitButton=this.getDOMElement("claimCodeSubmitButton");this.$toggleSwitch=this.getDOMElement("claimCodeToggleSwitch");this.$claimCodeFormContainer=
this.getDOMElement("claimCodeFormContainer");this.$errorMessageContainer=this.getDOMElement("claimCodeErrorMessageContainer");this.$successMessageContainer=this.getDOMElement("claimCodeSuccessMessageContainer");this.$inputField=this.$claimCodeFormContainer.find("input");this.$arrowIcon=this.getDOMElement("mcx-arrow-submit-icon");this.$scanIcon=this.getDOMElement("mcx-camera-scan-icon");this.$toggleSwitchCheckbox=this.getDOMElement("claimCodeToggleSwitch").find("input").prop("name");this.scannerEnabled&&
this._toggleSubmitButton();this._shouldDisplayMCXModernFrame&&this.$claimCode.val("")},bindToElements:function(){var c=this;c.bindFormSubmissionHandler("claimCodeSubmitButton","claimCode",c.handleClaimCodeSubmission);c.scannerEnabled&&(c.$claimCode.bind("keyup change",h.bind(c._toggleSubmitButton,c)),c.getDOMElement("claim-code-scan-icon").click(function(a){a.preventDefault();c._countGiftCardScannerEvent();b.handleCardScanDOMEvent(h.bind(c._scannerSuccessCallback,c),h.bind(c._scannerFailureCallback,
c),b.CARD_TYPE_GIFT)}));c.$claimCode.click(function(){c.widget.publishSuccessSushiMetrics({ActionType:"RedeemClaimCodeEvent",ActionValueType:"Click",ActionValue:"RedeemClaimCodeBoxClicked"})});if(c._shouldDisplayMCXModernFrame){var e="a:switch:"+c.$toggleSwitchCheckbox+":flip";c.widget.offAui(e);c.widget.onAui(e,function(a){c._toggleClaimCodeCustomInputDisplay(a.switchState.isOn)});c.$inputField.bind("input",function(a){c._switchIcon()})}},bindToEvents:function(){var b=this;b.widget.on("ClaimCodeSubmitted",
b,function(c){g(b.$claimCode).closest("form").submit();b._scannedClaimCode===c.claimCode&&l.logCounterMetric({feature:"GiftCardScannerClaimCodeEvent",resource:"_SuccessCount"});b.widget.publishSuccessSushiMetrics({ActionType:"SubmitRedeemClaimCodeEvent",ActionValueType:"Click",ActionValue:"RedeemClaimCodeSubmitButtonClicked"})});b.widget.on("UpdateWidget",b,function(c){c&&(c=g.parseJSON(c),"RedeemClaimCodeComponent"===c.componentName&&b.form.renderErrorMessages(c.errors))})},_toggleClaimCodeCustomInputDisplay:function(b){c.toggleElement(this.$errorMessageContainer,
b);c.toggleElement(this.$successMessageContainer,b);b||this._initializeInputField();c.toggleElement(this.$claimCodeFormContainer,b)},_initializeInputField:function(){this.$claimCode.val("");this._switchIcon()},_switchIcon:function(){this.$claimCode.val()?(c.toggleElement(this.$scanIcon,!1),c.toggleElement(this.$arrowIcon,!0)):(c.toggleElement(this.$scanIcon,!0),c.toggleElement(this.$arrowIcon,!1))},_toggleSubmitButton:function(){0<g.trim(this.$claimCode.val()).length?c.toggleElement(this.$claimCodeSubmitButton,
!0):c.hasAUIHiddenClass(this.$claimCodeSubmitButton)||c.toggleElement(this.$claimCodeSubmitButton,!1)},_countGiftCardScannerEvent:function(){l.logCounterMetric({feature:"GiftCardScannerEvent",resource:"_Count"})},_scannerFailureCallback:function(b){this.widget.log({giftCardScannerError:b});l.logCounterMetric({feature:"GiftCardScannerEvent",resource:"_ErrorCount"})},_scannerSuccessCallback:function(b){b&&b.cardData&&b.cardData.number&&(l.logCounterMetric({feature:"GiftCardScannerClaimCodeEvent",resource:"_Count"}),
this._scannedClaimCode=b=this._prettifyClaimCode(b.cardData.number),this.$claimCode.val(b),this.$claimCodeSubmitButton.trigger("click"))},_prettifyClaimCode:function(b){return 14>b.length?b:b.replace(/^(.{4})(.{6})(.+)?$/,"$1-$2-$3")},handleClaimCodeSubmission:function(){if(0===this.form.validateForm().length)if(this.data.requiresInlineSubmission)this.widget.submitFormAJAX({"ppw-widgetEvent":"ClaimAnyCodeEvent","ppw-claimCode":this.form.getFormValues().claimCode,"ppw-widgetState":this.widget.options.serializedState});
else{var b=this.$claimCodeSubmitButton.closest("form").serializeArray(),c=this.$claimCode.val(),a=this._shouldDisplayMCXModernFrame?this.claimCodeApplyPressed:this.$claimCodeSubmitButton.find("input").attr("name");this.widget.triggerContinue("ClaimCodeSubmitted",{claimCode:c,claimType:this._resolveClaimType(c),ppwEventNameAttribute:a,submissionParameters:b})}return!1},_resolveClaimType:function(b){if(b)return b.replace(/[\s\-]/g,"").toUpperCase().match(new RegExp(this.giftCardRegex))?"GiftCard":"Promotion"}})});
m("components/RewardsAccountComponent",["css-utils","jQuery","form-component","lang"],function(c,g,f,h){return f.extend({validationToErrorMap:{IsNumberFieldConstraint:"rewardsAccountErrorInvalidFormat",GreaterThanEqualFieldConstraint:"rewardsAccountErrorLessThanZero",LessThanEqualFieldConstraint:"rewardsAccountErrorGreaterThanEligible"},resetFormErrorMessages:function(){c.hideElement(this.getDOMElement("errorMessages"));c.hideElement(g(".pmts-rewards-account-server-message"));h.forEach(["rewardsAccountErrorInvalidFormat",
"GreaterThanEqualFieldConstraint","LessThanEqualFieldConstraint"],function(c){this.form.resetErrorMessage("amount",this.getDOMElement(c))},this)},displayFormErrorMessages:function(f){0!==f.length&&(f=f[0],"amount"===f.field&&(f=this.getDOMElement(this.validationToErrorMap[f.validation]),this.form.displayErrorMessage("amount",f)),f=this.getDOMElement("errorMessages"),c.showElement(f))},handleRewardsAccountDOMEvent:function(){var c=this.getDOMElement("amount").val();this.resetFormErrorMessages();var b=
this.form.validateForm();0===b.length?this.widget.trigger("RewardsAccountSubmitted",{amount:c,submissionParameters:this.getDOMElement("rewardsAccountSubmitButton").closest("form").serializeArray()}):this.displayFormErrorMessages(b);return!1},bindToElements:function(){var c=this,b=c.getDOMElement("pmtsRewardsAccountLearnMoreLink");b!==r&&0<b.length&&b.click(function(){c.widget.trigger("RewardsAccountLearnMoreRequested");return!1});c.bindFormSubmissionHandler("rewardsAccountSubmitButton","amount",c.handleRewardsAccountDOMEvent)},
bindToEvents:function(){var c=this;c.widget.on("RewardsAccountSubmitted",c,function(){g(c.getDOMElement("amount")).closest("form").submit()})}})});m("components/RegisteredDPMRewardsAccountComponent",["css-utils","component"],function(c,g){return g.extend({showRewardsAccountSelection:function(){this.getDOMElement("rewardsAccountSelectionSection").removeClass("apx-js-hide");this._toggleRewardsAccountSelectionDisplay(!0)},hideRewardsAccountSelection:function(){this._toggleRewardsAccountSelectionDisplay(!1)},
_toggleRewardsAccountSelectionDisplay:function(f){c.toggleElement(this.getDOMElement("rewardsAccountSelectionSection"),f)},bindToEvents:function(){var c=this;c.widget.on("rewardsAccountSelected",c,function(f){f.instrumentId===c.data.instrumentId&&c.showRewardsAccountSelection()});c.widget.on("rewardsAccountDeselected",c,function(f){f.instrumentId===c.data.instrumentId&&c.hideRewardsAccountSelection()})}})});m("components/RegisteredRewardsAccountComponent","events/InstrumentRowSelectedEvent css-utils form-component lang aui-helper jQuery AUI!P number-format input-helper".split(" "),
function(c,g,f,h,l,b,e,n,q){return f.extend({initialize:function(a,b){this.$container=this.getDOMElement("rewardsAccountApplied");this._currencyToPointsConversionRatio=b.data.currencyToPointsConversionRatio;this._rewardsCurrencyCode=b.data.rewardsCurrencyCode;this._isStandaloneRewards=b.data.isStandaloneRewards;this._parentCreditCardInstrumentId=b.data.parentCreditCardInstrumentId;this._hasViolation=b.data.hasViolation;this._isEBTSelected=null;this._rewardsErrors=[];this._shouldCheckboxBeSelected=
!1;this._shouldDisplayModernizedFrameCX=b.data.shouldDisplayMCXModernFrameWeblab;this._modernizedPaymentArtGridCssClass=b.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=b.data.disabledSectionCssClass;this._maxUsableBalance=b.data.maxUsableBalance;a=b.data.countryCode||a.options.locale.substring(3);this._rewardsPointsNumberFormat=new n(a,{fixedDecimalPrecision:b.data.rewardsDecimalPlaces});this._rewardsCurrencyNumberFormat=new n(a,{currency:this._rewardsCurrencyCode});this._ebtAccountDescriptorId=
b.data.ebtAccountDescriptorId;this._disabledByNotOwnedInstrument=this._disabledByNonCC=this._disabledByHBA=!1;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled},isRewardsAppliedChecked:function(){return this._shouldDisplayModernizedFrameCX?this.$toggleSwitch.find("input").prop("checked"):this.$checkbox.prop("checked")},showRewardsAccountSelection:function(){this.getDOMElement("rewardsAccountSelectionSection").removeClass("apx-js-hide");this._shouldCheckboxBeSelected&&
(this._toggleRewardsAppliedValue(!0),this._triggerBalanceSelectionChangedEvent(!0));this._toggleRewardsAccountSelectionDisplay(!0)},hideRewardsAccountSelection:function(){var a=this;this._shouldDisplayModernizedFrameCX?e.when("a-switch","jQuery").execute(function(b){b=b.getSwitch(a.$toggleSwitch);null!=b&&(b.isOn()?(a._shouldCheckboxBeSelected=!0,b.isOn(!1),a._triggerBalanceSelectionChangedEvent(!1)):a._shouldCheckboxBeSelected=!1)}):this.isRewardsAppliedChecked()?(this._shouldCheckboxBeSelected=
!0,this._toggleRewardsAppliedValue(!1),this._triggerBalanceSelectionChangedEvent(!1)):this._shouldCheckboxBeSelected=!1;this.getDOMElement("rewardsAccountSelectionChangeover").hide();this._toggleRewardsAccountSelectionDisplay(!1)},showRewardsAccountCustomInput:function(){this._toggleRewardsAccountCustomInputDisplay(!0)},hideRewardsAccountCustomInput:function(){this._toggleRewardsAccountCustomInputDisplay(!1)},showRewardsCustomAmountConversion:function(){this._toggleRewardsCustomAmountConversionDisplay(!0)},
hideRewardsCustomAmountConversion:function(){this._toggleRewardsCustomAmountConversionDisplay(!1)},showRewardsCustomAmountAppliedMessage:function(){this._toggleRewardsCustomAmountAppliedDisplay(!0)},hideRewardsCustomAmountAppliedMessage:function(){this._toggleRewardsCustomAmountAppliedDisplay(!1)},showRewardsCustomAmountErrorMessage:function(){this._toggleRewardsCustomAmountErrorMessageDisplay(!0)},hideRewardsCustomAmountErrorMessage:function(){this._toggleRewardsCustomAmountErrorMessageDisplay(!1)},
_toggleSelectBackingCardMessage:function(a){g.toggleElement(this.getDOMElement("selectBackingCardMessage"),a)},_toggleRewardsAppliedValue:function(a){this._shouldDisplayModernizedFrameCX?this._flipToggleSwitchState(a):this.$checkbox.prop("checked",a)},_flipToggleSwitchState:function(a){var b=this;e.when("a-switch","jQuery").execute(function(d){d=d.getSwitch(b.$toggleSwitch);null!=d&&d.isOn(a)})},_toggleCheckboxEditability:function(a){this.$checkbox.prop("disabled",!a);this._isEBTSelected||this._toggleRewardsAccountBalanceInfo(a)},
_toggleRewardsAccountSelectionDisplay:function(a){g.toggleElement(this.getDOMElement("rewardsAccountSelectionSection"),a)},_toggleRewardsCustomAmountConversionDisplay:function(a){g.toggleElement(this.getDOMElement("rewardsAccountCustomAmountPointsConversion"),a)},_toggleRewardsAccountCustomInputDisplay:function(a){g.toggleElement(this.getDOMElement("rewardsAccountCustomInput"),a)},_toggleRewardsCustomAmountAppliedDisplay:function(a){g.toggleElement(this.getDOMElement("rewardsAccountCustomAmountApplied"),
a)},_toggleRewardsCustomAmountErrorMessageDisplay:function(a){g.toggleElement(this.getDOMElement("rewardsAccountCustomAmountErrorMessage"),a)},_toggleRewardsWithEBTInfoMessage:function(a){g.toggleElement(this.getDOMElement("rewardsAccountEBTInfoMessage"),a)},_toggleRewardsAvailableBalanceInfo:function(a){g.toggleElement(this.getDOMElement("rewardsAvailableBalanceInfo"),a)},_toggleRewardsAccountSelection:function(a){if(this._shouldDisplayModernizedFrameCX){var b=this;this._isEBTSelected||this._toggleRewardsAccountBalanceInfo(a);
e.when("a-switch","jQuery").execute(function(d){d=d.getSwitch(b.$toggleSwitch);null!=d&&(d.isOn()&&(d.isOn(a),b._onRewardsAppliedChanged(!0)),d.enabled(a),b._toggleRewardsAccountCustomInputDisplay(d.isOn()),b._toggleRewardsAvailableBalanceInfo(!d.isOn()))});this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!a)}else this._toggleCheckboxEditability(a),this._isStandaloneRewards||this._isEBTSelected||this._toggleRewardsAccountCustomInputDisplay(a),
this.isRewardsAppliedChecked()&&(this._toggleRewardsAppliedValue(a),this._onRewardsAppliedChanged(!0))},_toggleRewardsAccountBalanceInfo:function(a){var b=this.getDOMElement("rewardsAccountBalanceInfo");a?b.removeClass("a-color-tertiary"):b.addClass("a-color-tertiary")},_triggerBalanceSelectionChangedEvent:function(a){var b=this.getCustomRewardsAmount()||0;this.widget.trigger("balanceSelectionChanged",{paymentMethod:"RewardsAccount",instrumentId:this.data.instrumentId,isSelected:a,balance:b,isBackingInstrument:!1});
a?this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.data.instrumentId,paymentMethod:"RewardsAccount",parentInstrumentId:this._parentCreditCardInstrumentId,errors:this._rewardsErrors}):this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.data.instrumentId})},getCustomRewardsAmount:function(){var a=this.form.getFormValues()[this.form.fields.rewardsAccountSelection.customAmountSelectionInput];return this._rewardsCurrencyNumberFormat.localizedParseNumber(a)},bindToElements:function(){var a=
this,b=a.form.fields.rewardsAccountSelection,d="rewardsAccountToggleSwitch-"+a.data.instrumentId;this.$checkbox=this.getDOMElement("rewardsAccountApplied").find("input");this.$toggleSwitch=this.getDOMElement(d);this.$toggleSwitchCheckboxName=this.$toggleSwitch.find("input").prop("name");this._shouldDisplayModernizedFrameCX&&null!=a.$toggleSwitchCheckboxName&&(this.$toggleSwitch.find("input").val(a._maxUsableBalance),this.$customInputField=this.getDOMElement("rewardsAccountCustomAmountInputField"),
this.$customInputField.attr("inputmode","decimal"),d="a:switch:"+a.$toggleSwitchCheckboxName+":flip",a.widget.offAui(d),a.widget.onAui(d,function(d){a._onRewardsAppliedChanged(d.switchState.clicked)}),q.limitToNumericInput(a.$customInputField),q.limitNumericInputDigits(a.$customInputField,2));d=h.bind(a._onRewardsAccountCustomAmountInputChanged,a);a.form.bindToParameter(b.customAmountSelectionInput,"keyup",d);a.getDOMElement("RewardsAccountBalanceRefresh").find(".pmts-rewards-account-balance-refresh-link").click(function(){a.widget.trigger("RewardsAccountBalanceRefresh");
return!1});a.$checkbox.change(function(){a._shouldDisplayModernizedFrameCX||a._onRewardsAppliedChanged(!0)})},bindToEvents:function(){var a=this;a.widget.on("rewardsAccountSelected",a,function(b){b.instrumentId===a.data.instrumentId&&a._onRewardsAccountSelected()});a.widget.on("rewardsAccountDeselected",a,function(b){b.instrumentId===a.data.instrumentId&&a._onRewardsAccountDeselected()});a.widget.on("RewardsAccountBalanceRefresh",a,function(b){a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,
"ppw-widgetEvent":"RewardsAccountBalanceRefreshEvent"})});a.widget.on("balanceSelectionChanged",a,function(b){"RewardsAccount"===b.paymentMethod&&b.instrumentId===this.data.instrumentId&&a._shouldDisplayModernizedFrameCX&&a.widget.trigger("updateEstimatedTotal",{type:b.paymentMethod,status:b.isSelected,balance:b.balance,isValid:0===this._rewardsErrors.length,message:this._rewardsErrors,instrumentId:this.data.instrumentId});a._shouldDisplayModernizedFrameCX?e.when("a-switch","jQuery").execute(function(d){d=
d.getSwitch(a.$toggleSwitch);null!=d&&"RewardsAccount"===b.paymentMethod&&b.instrumentId!==a.data.instrumentId&&b.isSelected&&(d.isOn()||a._shouldCheckboxBeSelected)&&(d.isOn(!1),a._shouldCheckboxBeSelected=!1,a._isStandaloneRewards||!g.hasAUIHiddenClass(a.getDOMElement("rewardsAccountSelectionSection")))&&(a.getDOMElement("rewardsAccountSelectionChangeover").stop(!0,!0).fadeIn(200),p.setTimeout(function(){a.getDOMElement("rewardsAccountSelectionChangeover").fadeOut(200)},1E3))}):"RewardsAccount"===
b.paymentMethod&&b.instrumentId!==this.data.instrumentId&&b.isSelected&&(a.isRewardsAppliedChecked()||a._shouldCheckboxBeSelected)&&(a._toggleRewardsAppliedValue(!1),a._shouldCheckboxBeSelected=!1,a._onRewardsAppliedChanged(!1),this._isStandaloneRewards||!g.hasAUIHiddenClass(this.getDOMElement("rewardsAccountSelectionSection")))&&(a.getDOMElement("rewardsAccountSelectionChangeover").stop(!0,!0).fadeIn(200),p.setTimeout(function(){a.getDOMElement("rewardsAccountSelectionChangeover").fadeOut(200)},
1E3))});a.widget.on(c,a,function(b){a._setDisabledByNotOwnedInstrument(b);a._onInstrumentSelected(b)});a.widget.on("initializeRecommendedInstrument",a,function(b){a._onInstrumentSelected(b)});a.widget.on("optionalInstrumentRowSelected",a,function(b){b.descriptorId===a._ebtAccountDescriptorId&&a._onEBTSelectionChanged(!0)});a.widget.on("optionalInstrumentRowDeselected",a,function(b){b.descriptorId===a._ebtAccountDescriptorId&&a._onEBTSelectionChanged(!1)});a.widget.on("hbaCoverageChanged",a,function(b){a._onHBACoverageChanged(b.coversPurchaseTotal)});
a.widget.on("componentsInitialized",a,function(){a.isRewardsAppliedChecked()?(a.showRewardsCustomAmountAppliedMessage(),a._triggerBalanceSelectionChangedEvent(!0)):a.hideRewardsCustomAmountAppliedMessage()})},_setDisabledByNotOwnedInstrument:function(a){a=h.isDefined(a.isInstrumentOwned)&&!a.isInstrumentOwned;this._disabledByNotOwnedInstrument=this._isStandaloneRewards&&this.isABCrossCustomerMultiTenderSuppressionEnabled&&a},_onEBTSelectionChanged:function(a){a?(this._toggleRewardsAccountBalanceInfo(!1),
this.hideRewardsAccountCustomInput(),this._toggleRewardsWithEBTInfoMessage(!0),this._isEBTSelected=!0):(this._toggleRewardsAccountBalanceInfo(!0),this._shouldDisplayModernizedFrameCX||this.showRewardsAccountCustomInput(),this._toggleRewardsWithEBTInfoMessage(!1),this._isEBTSelected=!1)},_onHBACoverageChanged:function(a){this._disabledByHBA=a;this._hasViolation||this._toggleRewardsAccountSelection(!this._disabledByNonCC&&!this._disabledByHBA)},_onInstrumentSelected:function(a){this._disabledByNonCC=
"CC"!==a.paymentMethod;this._hasViolation||(this._toggleSelectBackingCardMessage(this._disabledByNonCC&&this._isStandaloneRewards),this._toggleRewardsAccountSelection(!this._disabledByNonCC&&!this._disabledByHBA&&!this._disabledByNotOwnedInstrument))},_onRewardsAppliedChanged:function(a){var b=this;this._shouldDisplayModernizedFrameCX?e.when("a-switch","jQuery").execute(function(d){d=d.getSwitch(b.$toggleSwitch);null!=d&&(b._toggleRewardsAccountCustomInputDisplay(d.isOn()),b._toggleRewardsAvailableBalanceInfo(!d.isOn()),
b._toggleRewardsCustomAmountAppliedDisplay(d.isOn()),a&&(b._validateSelection(),b._triggerBalanceSelectionChangedEvent(d.isOn())))}):(this._isStandaloneRewards&&this._toggleRewardsAccountCustomInputDisplay(this.isRewardsAppliedChecked()),this._toggleRewardsCustomAmountAppliedDisplay(this.isRewardsAppliedChecked()),a&&(this._validateSelection(),this._triggerBalanceSelectionChangedEvent(this.isRewardsAppliedChecked())))},_onRewardsAccountSelected:function(){this.showRewardsAccountSelection()},_onRewardsAccountDeselected:function(){this.hideRewardsAccountSelection()},
_onRewardsAccountCustomAmountInputChanged:function(){this._shouldDisplayModernizedFrameCX||this.isRewardsAppliedChecked()||this._toggleRewardsAppliedValue(!0);var a=this._validateSelection();0===a.length?(this.hideRewardsCustomAmountErrorMessage(),this.showRewardsCustomAmountConversion(),this.showRewardsCustomAmountAppliedMessage(),a="0",a=this.form.getFormValues()[this.form.fields.rewardsAccountSelection.customAmountSelectionInput],a=this._rewardsCurrencyNumberFormat.localizedParseNumber(a)/this._currencyToPointsConversionRatio,
a=this._rewardsPointsNumberFormat.format(a),this.getDOMElement("rewardsAccountCustomAmountPointsConversionContent").text(a)):(a=a.map(function(a){return a.localizedMessageString}),this.hideRewardsCustomAmountConversion(),this.showRewardsCustomAmountErrorMessage(),this.getDOMElement("rewardsAccountCustomAmountErrorMessageContent").text(a[0]));this._triggerBalanceSelectionChangedEvent(!0)},_validateSelection:function(){var a=this.form.validateForm();this._rewardsErrors=a.map(function(a){return a.localizedMessageString});
return a}})});m("components/SecureContainerComponent","jQuery component lang AUI!P events/postToSecureIframeEvent events/secureIframeLoadedEvent events/spinner-events mixins/secure-container-support cvv-rate-limiting-inline-message-helper block-add-credit-card-trigger-helper mash-helper storage-helper TransitionMetricsConstants clog".split(" "),function(c,g,f,h,l,b,e,n,q,a,k,d,x,v){var u=/^\/[/.a-zA-Z0-9-]+/;return g.extend(n,{initialize:function(a,b){b.data.request?(this._request=b.data.request,
this._returnUrl=b.data.returnUrl,this._clientId=b.data.clientId,this._usePopover=b.data.usePopover,this._maxAgeSeconds=b.data.maxAgeSeconds,this._iFrameName=b.data.iFrameName):(this._returnUrl=b.data.returnUrl,this._clientId=b.data.clientId,this._usePopover=b.data.usePopover,this._maxAgeSeconds=b.data.maxAgeSeconds);this._parentWidgetInstanceId=b.data.parentWidgetInstanceId;this._deviceType=b.data.deviceType;this._iframeUri=b.data.iframeUri;this._iframeOrigin=b.data.iframeOrigin;this._secureFormTarget=
b.data.secureFormTarget;this._requestFromMobileApp=b.data.requestFromMobileApp;this._inlineIframe=b.data.inlineIframe;this._secureIframe=this.getDOMElement("JsBindingApxSecureIFrame");this._dynamicContinueEnabled=b.data.dynamicContinueEnabled;a=b.data.addCardIntermittentStepRemoved;a===r&&(a=!1);this._addCardIntermittentStepRemoved=a;this._closeIframe();this._requestFromMobileApp&&k.addEventListener("LaunchUpdateEverywhereEvent",function(a){u.test(a.detail.interstitialPageUrl)&&k.setUrlInCurrentWebview(a.detail.interstitialPageUrl)})},
_showIframe:function(){this._secureIframe.css("display","inline")},_closeIframe:function(){this._secureIframe.css("display","none")},bindToElements:function(){var a=this;a._bindCrossDomainMessaging();a._secureIframe.load(function(){a.widget.trigger(e.hideSpinner)})},bindToEvents:function(){var a=this;a.widget.on(l,a,function(b){if(!a._inlineIframe||b.postData.hasOwnProperty("iFrameName")&&b.postData.iFrameName===a._secureFormTarget)a.widget.trigger(e.showSpinner),a._postToIframe(b.postData)})},_bindCrossDomainMessaging:function(){var a=
f.bind(this._processCrossDomainMessage,this);f.addEventListener(p,"message",a);this._inlineIframe&&(a=f.bind(this._sendWindowResizeMessage,this),f.addEventListener(p,"resize",a))},_sendWindowResizeMessage:function(){var a=document.getElementsByName(this._secureFormTarget)[0];a.contentWindow.postMessage(JSON.stringify({parentWidth:a.offsetWidth-20}),"*")},_processCrossDomainMessage:function(k){try{var e=JSON.parse(k.data)}catch(z){return}var f=e&&e.event&&e.event.data&&e.event.data.hasOwnProperty("iFrameName")&&
e.event.data.iFrameName===this._secureFormTarget,g=this._inlineIframe&&e&&e.hasOwnProperty("frameHeight")&&e.hasOwnProperty("iFrameName")&&e.iFrameName===this._secureFormTarget;if(f)if(f=e.event,"apx:iframe:close"===f.name)this._closeIframe(),this._addCardIntermittentStepRemoved&&this.widget.trigger("pmts-close-add-card-form");else if("apx:iframe:display"===f.name)this._showIframe();else if("apx:iframe:redirect"===f.name)f.data&&k.origin===this._iframeOrigin&&u.test(f.data.interstitialPageUrl)&&(p.location.href=
f.data.interstitialPageUrl);else if("apx:page:reload"===f.name)this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(f.data.paymentMethodId,f.data.widgetAction,f.data.walletId):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":f.data.paymentMethodId,"ppw-widgetAction":f.data.widgetAction,"ppw-maybeWalletId":f.data.walletId,"ppw-maybeShouldRecordAPX3Metric":f.data.shouldRecordAPX3Metric});
else if("apx:auth:timeout"===f.name)this.widget.trigger("AuthTimeout");else if("apx:secureWidget:ready"===f.name||"apx:secureWidget:unavailable"===f.name)this._showIframe(),k=d.getFromSession(x.ADD_PM_LINK_CLICK_STORAGE_KEY+this.widget.widgetInstanceId),this.widget.trigger(b,{data:f.data,clickData:k});g&&(document.getElementsByName(this._secureFormTarget)[0].style.height=e.frameHeight+"px");try{if(e&&e.event&&"apx:add-payment-method:BlockCardAdditionsEvent"===e.event.name)if(this._closeIframe(),0<
e.event.data.rateLimitDurationInSeconds)this.widget.trigger("DisableCreditCardRegistrationLinkEvent",{rateLimitDurationInSeconds:e.event.data.rateLimitDurationInSeconds}),e.event.data.isDynamicRateLimitMessage?q.displayTimer(e.event.data.rateLimitDurationInSeconds,e.event.data.andString,e.event.data.hoursString,e.event.data.hourString,e.event.data.minuteString,e.event.data.minutesString):q.display(e.event.data.rateLimitDurationInSeconds),a();else{var l=c(".pmts-add-credit-card-component-container");
1===l.length&&(l.addClass("pmts-disabled-add-credit-card-container"),1===l.find(".a-button.apx-secure-registration-content-trigger-js").length&&l.find(".a-button.apx-secure-registration-content-trigger-js").addClass("a-button-disabled"),1===l.find("a.apx-secure-registration-content-trigger-js").length&&l.find("a.apx-secure-registration-content-trigger-js").addClass("pmts-add-cc-link-disabled"),e.event.data&&e.event.data.hasOwnProperty("isCreditCardCVVVerificationFailed")&&e.event.data.isCreditCardCVVVerificationFailed?
1===l.find(".pmts-add-cc-alert-container").length&&l.find(".pmts-add-cc-alert-container").removeClass("a-hidden aok-hidden"):1===l.find(".pmts-add-cc-info-container").length&&l.find(".pmts-add-cc-info-container").removeClass("a-hidden aok-hidden"));c(".pmts-add-cc-default-trigger")&&1===c(".pmts-add-cc-default-trigger").length&&(c(".pmts-add-cc-default-trigger").addClass("pmts-disabled-add-credit-card-container"),c(".pmts-add-cc-default-trigger").find(".pmts-add-cc-default-trigger-link").addClass("pmts-add-cc-link-disabled"),
c("#apx-add-credit-card-action-test-id")&&1===c("#apx-add-credit-card-action-test-id").length&&(c("#apx-add-credit-card-action-test-id").removeClass("a-declarative"),c("#apx-add-credit-card-action-test-id").addClass("pmts-disabled-add-credit-card-container")));e.event.data&&e.event.data.hasOwnProperty("isCreditCardCVVVerificationFailed")&&e.event.data.isCreditCardCVVVerificationFailed&&(c(".pmts-add-payment-link")&&c(".pmts-add-payment-link").click(),c(".pmts-add-payment-link")&&1===c(".pmts-add-payment-link").length&&
c(".pmts-add-payment-link")[0].click())}}catch(z){}},_postToIframe:function(a){var b=this,d=c("\x3cform\x3e").attr({action:b._iframeUri,method:"POST",target:b._secureFormTarget});d.append(b.buildHiddenInput("widgetState",b.widget.options.serializedState));f.isDefined(b._request)&&d.append(b.buildHiddenInput("request",b._request));d.append(b.buildHiddenInput("returnUrl",b._returnUrl));d.append(b.buildHiddenInput("clientId",b._clientId));d.append(b.buildHiddenInput("usePopover",b._usePopover));d.append(b.buildHiddenInput("maxAgeSeconds",
b._maxAgeSeconds));d.append(b.buildHiddenInput("iFrameName",b._secureFormTarget));d.append(b.buildHiddenInput("parentWidgetInstanceId",b._parentWidgetInstanceId));f.forEachKeyValue(a,function(a,c){"iFrameName"!==a&&d.append(b.buildHiddenInput(a,c))});c("body").append(d);this._requestFromMobileApp?h.when("A","mash").execute(function(a,c){c.navstack.begin().forward(a.$(d)).end();b.widget.trigger(e.hideSpinner);v.logCounterMetric({feature:"SecureRegistrationLoadSuccess_mobileapp",resource:"_Count"});
v.publishMetrics()}):d.submit().remove()},buildHiddenInput:function(a,b){return c("\x3cinput\x3e").attr({type:"hidden",name:a,value:b})}})});m("events/postToSecureIframeEvent",["public-event-registry"],function(c){c.register("postToSecureIframeEvent");return"postToSecureIframeEvent"});m("events/secureIframeLoadedEvent",["public-event-registry"],function(c){c.register("secureIframeLoadedEvent");return"secureIframeLoadedEvent"});m("events/close-secure-container-event",["public-event-registry"],function(c){c.register("CloseSecureContainerEvent");
return"CloseSecureContainerEvent"});m("events/display-secure-container-event",["public-event-registry"],function(c){c.register("DisplaySecureContainerEvent");return"DisplaySecureContainerEvent"});m("mixins/secure-container-support",["jQuery","lang","ExecutionsWidgetUtils"],function(c,g,f){return{initialize:function(c,f){this._dynamicContinueFormDescription=f.data.dynamicContinueFormDescription},addPaymentMethodRefreshContinue:function(c,g,b,e,n){this.widget.continueRequestAjaxSubstitutionEnabled||
"undefined"===typeof this._dynamicContinueFormDescription?this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":c,"ppw-widgetAction":g,"ppw-maybeWalletId":b,"ppw-maybeShouldRecordAPX3Metric":n}):f.dynamicContinueWithEvent("AddPaymentMethodRefreshEvent",this.widget.options.serializedState,[{name:"ppw-paymentMethodId",value:c},{name:"ppw-widgetAction",value:g},{name:"ppw-maybeWalletId",value:b}],this._dynamicContinueFormDescription,
this.widget.getRootDOMElements().last(),e?e:"post")}}});m("components/SecureFieldComponent","jQuery component lang AUI!P clog SecureFieldsInitializationConstants SecureFieldValidationEventTriggerType events/InitializeSecureFieldsEvent events/SecureFieldsInitializationStatusEvent events/CreateSecureFieldEvent events/RemoveSecureFieldEvent events/SecureFieldValidationEvent events/SecureFieldRemovedEvent".split(" "),function(c,g,f,h,l,b,e,n,q,a,k,d,x){return g.extend({initialize:function(a,d){this.secureFieldId=
d.data.secureFieldId;this.secureFieldName=d.data.secureFieldName;this.secureFieldType=d.data.secureFieldType;this.placeholder=d.data.placeholder;this.maxLength=d.data.maxLength;this.regularExpression=d.data.regularExpression;this.secureFieldCSS=this._parseJSON(d.data.secureFieldCSS);this.validations=this._parseJSON(d.data.validations);this.deviceType=d.data.deviceType;this.metricPrefix=(this.useStatic=d.data.useStatic)?"Static":"";this.initializationStatus=b.UNINITIALIZED;this.isFieldCreated=!1;this.isValid=
r;this.secureFieldJsBinding=d.data.secureFieldJsBinding;this.isFallbackEnabled=d.data.isFallbackEnabled;this.isAdditionalFallbackEnabled=d.data.isAdditionalFallbackEnabled;this.fallbackFieldName=d.data.fallbackFieldName;this.timeoutMs=d.data.timeoutMs;this.isFallbackRetryable=this.isFallbackTriggered=!1},_parseJSON:function(a){try{return a&&JSON.parse(a)}catch(u){}},_getFallbackField:function(a){var b={required:function(a){return!("undefined"===typeof a||""===a)}},c=document.createElement("input");
c.name=a.fallbackFieldName;c.type="password";a.maxLength&&(c.maxLength=a.maxLength);c.spellcheck=!1;var k=function(a,b){for(var d in b)a.style[d]=b[d]},f=function(c,e){for(var k=!0,f=0;f<a.validations.length;f++)"function"===typeof b[a.validations[f]]&&(k=k&&b[a.validations[f]](c));"undefined"!==typeof a.regularExpression&&(f=new RegExp(a.regularExpression),k=k&&f.test(c));c=k;c!==a.isValid&&(a.isValid=c,a.widget.trigger(d,{fieldId:a.secureFieldId,fieldName:a.secureFieldName,fieldType:a.secureFieldType,
fieldIsValid:a.isValid,triggerType:e}))};a.placeholder&&(c.placeholder=a.placeholder);a.secureFieldCSS&&a.secureFieldCSS.cssDefault&&(k(c,a.secureFieldCSS.cssDefault),a.secureFieldCSS.cssFocus&&(c.onblur=function(){c.removeAttribute("style");k(c,a.secureFieldCSS.cssDefault)}));a.secureFieldCSS&&a.secureFieldCSS.cssFocus&&(c.onfocus=function(){k(c,a.secureFieldCSS.cssFocus)});c.oninput=function(a){a&&a.target&&f(a.target.value,e.CustomerInput)};f(c.value,e.Initialization);return c},_useFallbackField:function(a,
b,d){a.isFallbackTriggered||(l.logCounterMetric({feature:d,resource:"_Count"}),l.publishMetrics(),a._remove(),d=a.getDOMElement(a.secureFieldJsBinding),d.children().remove(),d.append(a._getFallbackField(a)),a.isFallbackTriggered=!0,a.isFieldCreated=!0,a.isFallbackRetryable=b)},_field:function(){var a=this,c=!1;a.isAdditionalFallbackEnabled&&a.timeoutMs&&0<a.timeoutMs&&p.setTimeout(function(){h.now("apx-secure-fields").execute(function(b){"undefined"===typeof b&&(c=!0,a._useFallbackField(a,!0,"SecureFieldNoSDKFallbackTriggered"))})},
a.timeoutMs);var k=(new Date).getTime();h.when("apx-secure-fields").execute(function(f){l.logLatencyMetric({feature:"SecureFieldSDKReady",resource:"_Latency",startTime:k});if(!c){a.initializationStatus===b.UNINITIALIZED&&(a.widget.trigger(n,f),l.logCounterMetric({feature:"CreateSecureFieldBeforeInit",resource:"_Count"}),l.publishMetrics());var g={name:a.secureFieldName,type:a.secureFieldType};a.placeholder&&(g.placeholder=a.placeholder);a.maxLength&&(g.maxLength=a.maxLength);a.regularExpression&&
(g.regularExpression=a.regularExpression);a.validations&&(g.validations=a.validations);a.secureFieldCSS&&(a.secureFieldCSS.cssDefault&&(g.cssDefault=a.secureFieldCSS.cssDefault),a.secureFieldCSS.cssInvalid&&(g.cssInvalid=a.secureFieldCSS.cssInvalid),a.secureFieldCSS.cssFocus&&(g.cssFocus=a.secureFieldCSS.cssFocus));a.isFallbackEnabled&&a.timeoutMs&&0<a.timeoutMs&&(g.timeout=a.timeoutMs);l.logCounterMetric({feature:a.metricPrefix+"SecureFieldRequested",resource:"_Count"});l.publishMetrics();var h=
(new Date).getTime();f=f.field(a.secureFieldId,g,function(b){var c={fieldId:a.secureFieldId,fieldName:a.secureFieldName,fieldType:a.secureFieldType,fieldIsValid:b.isValid,triggerType:e.CustomerInput};b.isValid!==a.isValid&&(a.isValid=b.isValid,l.logCounterMetric({feature:b.isValid?"SecureFieldsCvvValid":"SecureFieldsCvvInvalid",resource:"_Count"}),l.publishMetrics(),a.widget.trigger(d,c))},a.useStatic);a.isFieldCreated=!0;f.then(function(){l.logLatencyMetric({feature:a.metricPrefix+"SecureFieldLoaded"+
a.deviceType,resource:"_Latency",startTime:h});l.publishMetrics()}).catch(function(b){a.isFallbackEnabled&&a._useFallbackField(a,!0,a.metricPrefix+"SecureFieldFallbackTriggered");b&&"timeout"===b.message?l.logCounterMetric({feature:a.metricPrefix+"SecureFieldLoadingTimeout",resource:"_Count"}):(p.ueLogError&&p.ueLogError(b,{logLevel:"ERROR",attribution:"apx_secure_fields",message:"Secure Field Failed to Load: "}),l.logCounterMetric({feature:a.metricPrefix+"SecureFieldLoadingFailed",resource:"_Count"}));
l.publishMetrics()})}})},_remove:function(){var a=this;a.isValid=r;a.isFieldCreated=!1;var b={fieldId:a.secureFieldId,fieldName:a.secureFieldName,fieldType:a.secureFieldType,fieldIsValid:a.isValid,triggerType:e.Removal};a.isFallbackTriggered?(a.getDOMElement(a.secureFieldJsBinding).children().remove(),a.isFallbackTriggered=!1,a.isFallbackRetryable=!1):h.now("apx-secure-fields").execute(function(b){"undefined"!==typeof b?(b.remove(a.secureFieldName,a.useStatic),a.widget.trigger(x,{secureFieldId:a.secureFieldId,
secureFieldName:a.secureFieldName})):(l.logCounterMetric({feature:"Remove.SecureFieldsSDKUndefinedError",resource:"_Count"}),l.publishMetrics())});a.widget.trigger(d,b)},bindToEvents:function(){var d=this;d.widget.on(q,d,function(a){a&&a.status&&(d.initializationStatus=a.status,a.status===b.FAILED&&d.isAdditionalFallbackEnabled&&d._useFallbackField(d,!1,d.metricPrefix+"SecureHandlerFallbackTriggered"))});d.widget.on(a,d,function(a){d.isFieldCreated||!a||a.secureFieldId!==d.secureFieldId||d.isFallbackTriggered&&
!d.isFallbackRetryable||d._field()});d.widget.on(k,d,function(a){d.isFieldCreated&&a&&a.secureFieldId===d.secureFieldId&&(!d.isFallbackTriggered||d.isFallbackRetryable)&&d._remove()})}})});m("events/CreateSecureFieldEvent",["public-event-registry"],function(c){c.register("CreateSecureFieldEvent");return"CreateSecureFieldEvent"});m("events/RemoveSecureFieldEvent",["public-event-registry"],function(c){c.register("RemoveSecureFieldEvent");return"RemoveSecureFieldEvent"});m("events/SecureFieldValidationEvent",
["public-event-registry"],function(c){c.register("SecureFieldValidationEvent");return"SecureFieldValidationEvent"});m("events/SecureFieldRemovedEvent",["public-event-registry"],function(c){c.register("SecureFieldRemovedEvent");return"SecureFieldRemovedEvent"});m("SecureFieldValidationEventTriggerType",[],function(){return{Removal:"Removal",CustomerInput:"CustomerInput",Initialization:"Initialization"}});m("mixins/SecureFieldsFormComponent","jQuery component lang AUI!P clog SecureFieldsInitializationConstants events/SubmitSecureFieldDataEvent events/SecureFieldDataReadyEvent events/SecureFieldsInitializationStatusEvent events/InitializeSecureFieldsEvent events/SecureFieldRemovedEvent".split(" "),
function(c,g,f,h,l,b,e,n,q,a,k){return{initialize:function(a,c){this.token=c.data.token;this.formJsBinding=c.data.formJsBinding;this.secureFieldsEnabled=c.data.secureFieldsEnabled;this.prefetchSecureHandlerEnabled=c.data.prefetchSecureHandlerEnabled;this.initializationStatus=b.UNINITIALIZED;this.useStatic=c.data.useStatic;this.domain=c.data.domain;this.siegeProfileName=c.data.siegeProfileName;this.metricPrefix=this.useStatic?"Static":""},_create:function(a){var d=this;if(d.initializationStatus===
b.UNINITIALIZED&&"undefined"!==typeof a){l.logCounterMetric({feature:d.metricPrefix+"SecureHandlerRequested",resource:"_Count"});l.publishMetrics();d._setAndTriggerInitializationStatusEvent(d,b.PENDING);var c=(new Date).getTime();a.create(d.useStatic&&d.domain&&d.siegeProfileName?{domain:d.domain,siegeProfileName:d.siegeProfileName}:{token:d.token},r,d.useStatic).then(function(){l.logLatencyMetric({feature:d.metricPrefix+"SecureHandlerLoaded",resource:"_Latency",startTime:c});d._setAndTriggerInitializationStatusEvent(d,
b.INITIALIZED);l.publishMetrics()}).catch(function(a){p.ueLogError&&p.ueLogError(a,{logLevel:"ERROR",attribution:"apx_secure_fields",message:"Secure Handler Failed to Load: "});l.logCounterMetric({feature:d.metricPrefix+"SecureHandlerLoadingFailed",resource:"_Count"});d._setAndTriggerInitializationStatusEvent(d,b.FAILED);l.publishMetrics()})}},_setAndTriggerInitializationStatusEvent:function(a,b){a.initializationStatus=b;a.widget.trigger(q,{status:b})},bindToEvents:function(){var d=this;d.secureFieldsEnabled&&
(d.token&&""!==d.token||d.useStatic&&d.domain&&d.siegeProfileName?d.prefetchSecureHandlerEnabled&&h.now("apx-secure-fields").execute(function(a){"undefined"!==typeof a?d._create(a):(l.logCounterMetric({feature:"SecureFieldsSDKUnavailableOnInit",resource:"_Count"}),l.publishMetrics())}):(l.logCounterMetric({feature:"SecureFieldsInvalidToken",resource:"_Count"}),l.publishMetrics()),d.widget.on(a,d,function(a){d._create(a)}),d.widget.on(e,d,function(a){d.initializationStatus!==b.INITIALIZED?(l.logCounterMetric({feature:d.metricPrefix+
"SecureFieldsSubmitError.SecureHandler."+d.initializationStatus,resource:"_Count"}),d.widget.trigger(n,{contextId:a&&a.contextId,error:Error("SecureHandler is not loaded")}),l.publishMetrics()):h.when("apx-secure-fields").execute(function(b){b.submit(function(b){l.logCounterMetric({feature:d.metricPrefix+"SecureFieldsSubmitSuccess",resource:"_Count"});l.publishMetrics();if(b.data&&0!==Object.keys(b.data).length){var c=d.getDOMElement(d.formJsBinding),k;for(k in b.data){if(typeof b.data[k]===r||0===
f.trim(b.data[k]).length)l.logCounterMetric({feature:d.metricPrefix+"SecureFieldsSubmitEmpty",resource:"_Count"}),l.publishMetrics();var e=c.find("input[type\x3d'hidden'][name\x3d'apx-secure-field-"+k+"']");0<e.length?e.val(b.data[k]):c.append(d._buildHiddenInput(k,b.data[k]))}}else l.logCounterMetric({feature:d.metricPrefix+"SecureFieldsSubmitEmpty",resource:"_Count"}),l.publishMetrics();d.widget.trigger(n,{contextId:a&&a.contextId})},function(b){l.logCounterMetric({feature:d.metricPrefix+"SecureFieldsSubmitError",
resource:"_Count"});l.publishMetrics();d.widget.trigger(n,{contextId:a&&a.contextId,error:b})},d.useStatic)})}),d.widget.on(k,d,function(a){d.getDOMElement(d.formJsBinding).find("input[type\x3d'hidden'][name\x3d'apx-secure-field-"+a.secureFieldName+"']").remove()}))},_buildHiddenInput:function(a,b){return c("\x3cinput\x3e").attr({type:"hidden",name:"apx-secure-field-"+a,value:b})}}});m("events/SubmitSecureFieldDataEvent",["public-event-registry"],function(c){c.register("SubmitSecureFieldDataEvent");
return"SubmitSecureFieldDataEvent"});m("events/SecureFieldDataReadyEvent",["public-event-registry"],function(c){c.register("SecureFieldDataReadyEvent");return"SecureFieldDataReadyEvent"});m("events/SecureFieldsInitializationStatusEvent",["public-event-registry"],function(c){c.register("SecureFieldsInitializationStatusEvent");return"SecureFieldsInitializationStatusEvent"});m("events/InitializeSecureFieldsEvent",["public-event-registry"],function(c){c.register("InitializeSecureFieldsEvent");return"InitializeSecureFieldsEvent"});
m("SecureFieldsInitializationConstants",[],function(){return{UNINITIALIZED:"Uninitialized",PENDING:"Pending",INITIALIZED:"Initialized",FAILED:"Failed"}});m("mixins/b2b-cross-wallet-mixin",["lang"],function(c){var g=["GC","JPPoints","ProductVoucher","PROMO"],f={matchByDescriptorId:function(b,e){return c.isArray(e)&&c.isDefined(b.instrumentId)&&c.some(e,function(e){return c.isString(e)&&0<=b.instrumentId.indexOf(e)})}},h={InstrumentRowSelected:function(b,e){var f=c.isDefined(b.instrumentId);b=!1!==
b.isInstrumentOwned;return!0===f&&b!==e.isCurrentPaymentMethodOwnedByOrderingCustomer()},balanceSelectionChanged:function(b,e){var f=!1!==b.isInstrumentOwned;return!0===(!0===b.isSelected&&!b.isBackingInstrument)&&0<=c.indexOf(g,b.paymentMethod)&&f!==e.isCurrentPaymentMethodOwnedByOrderingCustomer()}},l=function(b,e){return c.isDefined(b)&&c.isDefined(e._b2bMultitenderRules)&&c.isDefined(e._b2bMultitenderRules.disablingRules)&&c.some(c.keys(e._b2bMultitenderRules.disablingRules),function(g){return c.isFunction(f[g])?
f[g](b,e._b2bMultitenderRules.disablingRules[g]):!1})};return c.extend({},{initialize:function(b,c){this._isB2BCrossWalletMultitenderEnforcementEnabled=!0===c.data.isB2BCrossWalletMultitenderEnforcementEnabled;this._b2bMultitenderRules=c.data.b2bMultitenderRules||{}},shouldBeDisabledPerB2BMultitenderRules:function(b){return!0!==this._isB2BCrossWalletMultitenderEnforcementEnabled?!1:l(b,this)},shouldBeDeselectedPerB2BMultitenderRules:function(b,e){return!0!==this._isB2BCrossWalletMultitenderEnforcementEnabled?
!1:c.isDefined(b)&&c.isDefined(e)&&c.isDefined(this)&&c.isFunction(h[b])&&h[b](e,this)},isCurrentPaymentMethodOwnedByOrderingCustomer:function(){return!1!==this.data.isOwned}})});m("events/InstallmentOfferRowSelectedEvent",[],function(){return"InstallmentOfferRowSelectedEvent"});m("events/InstrumentRowSelectedEvent",["public-event-registry"],function(c){c.register("InstrumentRowSelected");return"InstrumentRowSelected"});m("components/RecommendedPaymentMethodCombinationComponent","css-utils continuable-component lang jQuery events/SelectablePaymentOptionEvents components/SelectablePaymentOptionListComponent".split(" "),
function(c,g,f,h,l,b){return b.extend({initialize:function(b,c){}})});m("components/SelectablePaymentMethodListItemComponent",["components/POAInstrumentListItemComponent"],function(c){return c});m("events/SelectablePaymentOptionEvents",["public-event-registry"],function(c){c.register("PaymentPlanSelected");return{paymentPlanSelectedPrepare:"paymentPlanSelectedPrepare",PaymentPlanSelected:"PaymentPlanSelected"}});m("components/SelectablePaymentOptionListComponent","css-utils continuable-component lang clog jQuery events/SelectablePaymentOptionEvents events/ShowAddPaymentInstrumentPage".split(" "),
function(c,g,f,h,l,b,e){var n=["EbtSnap","HealthBenefitsCard"],q=["EbtSnap"];return g.extend({_selectedBackingInstrument:null,_selectedOptionalInstruments:{},_eligibleBackingMethods:[],initialize:function(a,b){this.paymentMethodMap=l.parseJSON(b.data.paymentMethodMap);this.allowGCOnly=b.data.allowGCOnly;this.hasPurchaseTotal="undefined"!==typeof b.data.purchaseTotal;this.purchaseTotal=parseFloat(b.data.purchaseTotal);this.isGCOptionalPaymentInstrument=b.data.isGCOptionalPaymentInstrument;this.showFloatingContinueBarOnNonPaylastPspWithViewDetails=
b.data.showFloatingContinueBarOnNonPaylastPspWithViewDetails;this.isPageletContinueWidgetPrefetchEnabled=b.data.isPageletContinueWidgetPrefetchEnabled},_selectBackingInstrument:function(a){this._selectedBackingInstrument=a&&a.instrumentId?a:null;this._updatePaymentPlanState()},_selectOptionalInstrument:function(a){var b=this;f.forEachKeyValue(b._selectedOptionalInstruments,function(d,c){a&&c&&(b._isOptionalBackingInstrument(c.paymentMethodCode)||"RewardsAccount"===c.paymentMethod)&&c.paymentMethodCode===
a.paymentMethodCode&&delete b._selectedOptionalInstruments[d]},b);b._selectedOptionalInstruments[a.instrumentId]=a;a.eligibleBackingMethods&&(b._eligibleBackingMethods=a.eligibleBackingMethods);b._updatePaymentPlanState()},_deselectOptionalInstrument:function(a){delete this._selectedOptionalInstruments[a.instrumentId];delete this._eligibleBackingMethods;this._updatePaymentPlanState()},_triggerInitializeRecommendedInstrumentEvent:function(a,b){this.widget.trigger("initializeRecommendedInstrument",
{instrumentId:a,paymentMethod:b});this._recordRecommendedInstrumentActionMetric(a)},_triggerPaymentPlanSelectedEvent:function(a,c,d,e,f){c={isValid:a,message:c,notValidReason:d,paymentMethod:e,instrumentId:f,selectedOptionalInstruments:this._selectedOptionalInstruments,prefetchEnabled:this.isPageletContinueWidgetPrefetchEnabled};this.widget.trigger(b.paymentPlanSelectedPrepare,c);this.setContinuable(a);this.widget.trigger(b.PaymentPlanSelected,c);this.widget.log({event:b.PaymentPlanSelected,details:c})},
_triggerUpiRedirectionRequiredEvent:function(){this.setContinuable(!0);this.widget.trigger("UpiRedirectionRequiredEvent")},_triggerAPPRedirectionRequiredEvent:function(){this.setContinuable(!0);this.widget.trigger("APPRedirectionRequiredEvent")},_updatePaymentPlanState:function(){var a=null;if(this._isBackingEligible())if(this._selectedBackingInstrument)(a=this._firstElement(this._selectedBackingInstrument.errors))||(a=this._findOptionalInstrumentError());else if(this._hasOptionalBackingInstrument()){var b=
0,d=!1;for(f in this._selectedOptionalInstruments)if(this._selectedOptionalInstruments.hasOwnProperty(f)){var c=this._selectedOptionalInstruments[f];d=d||-1!==q.indexOf(c.paymentMethodCode);var e=this._firstElement(c.errors);if(e){a=e;break}c=parseFloat(c.balance);c=isNaN(c)?0:c;b=this._add(b,c)}null==a&&!d&&this.hasPurchaseTotal&&(isNaN(this.purchaseTotal)||b<this.purchaseTotal)&&(a=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"))}else a=this._findOptionalInstrumentError(),
null==a&&(a=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"));else a=this.widget.getLocalizedString("pmts_portal_require_backing_error_message",{paymentMethod:this._generateTooltipOfEligibleMethod()});b=null;this._selectedBackingInstrument&&this._selectedBackingInstrument.paymentMethod&&(b=this._selectedBackingInstrument.paymentMethod);var f=null;this._selectedBackingInstrument&&this._selectedBackingInstrument.instrumentId&&(f=this._selectedBackingInstrument.instrumentId);
null==a?this._selectedBackingInstrument&&this._selectedBackingInstrument.isUpiRedirectionRequired?this._triggerUpiRedirectionRequiredEvent():this._selectedBackingInstrument&&this._selectedBackingInstrument.isAPPInstrumentRedirectionRequired?this._triggerAPPRedirectionRequiredEvent():this._triggerPaymentPlanSelectedEvent(!0,null,null,b,f):this._triggerPaymentPlanSelectedEvent(!1,a,null,b,f)},_precision:function(a){if("number"!==typeof a||!isFinite(a))return 0;for(var b=1,d=0;Math.round(a*b)/b!==a;)b*=
10,d++;return d},_add:function(a,b){if("number"!==typeof a||"number"!==typeof b)return 0;var d=Math.max(this._precision(a),this._precision(b));return parseFloat((a+b).toFixed(d))},_generateTooltipOfEligibleMethod:function(){var a="";if(this._eligibleBackingMethods&&0<this._eligibleBackingMethods.length){for(var b=0,d=this._eligibleBackingMethods.length;b<d-1;b++)a+=this.widget.getLocalizedString(this.paymentMethodMap[this._eligibleBackingMethods[b]]),a+=",";a+=this.widget.getLocalizedString(this.paymentMethodMap[this._eligibleBackingMethods[d-
1]])}return a},_isBackingEligible:function(){var a=this._selectedBackingInstrument&&"GC"===this._selectedBackingInstrument.paymentMethod;return!(this._eligibleBackingMethods&&0<this._eligibleBackingMethods.length&&a)},_hasOptionalBackingInstrument:function(){for(var a in this._selectedOptionalInstruments)if(this._selectedOptionalInstruments.hasOwnProperty(a)){var b=this._selectedOptionalInstruments[a];if(b&&this._isOptionalBackingInstrument(b.paymentMethodCode,b.requireBackingInstrument))return!0}return!1},
_findOptionalInstrumentError:function(){var a=null,b;for(b in this._selectedOptionalInstruments)if(this._selectedOptionalInstruments.hasOwnProperty(b)){var d=this._selectedOptionalInstruments[b];a=this._firstElement(d.errors);if(null!==a)break;if("RewardsAccount"===d.paymentMethod&&(a=this._getRewardsAccountError(d),null!==a))break;if("FPS"===d.paymentMethod&&(a=this._getFPSError(),null!==a))break}return a},_isOptionalBackingInstrument:function(a,b){return this.allowGCOnly&&!1===b?!0:"GC"===a?!0===
this.isGCOptionalPaymentInstrument:-1<f.indexOf(n,a)},_getFPSError:function(){return this._selectedBackingInstrument&&"CC"!==this._selectedBackingInstrument.paymentMethod?this.widget.getLocalizedString("apx_payselect_require_cc_for_fps"):null},_getRewardsAccountError:function(a){return!this._selectedBackingInstrument||"CC"!==this._selectedBackingInstrument.paymentMethod||f.isDefined(a.parentInstrumentId)&&a.parentInstrumentId!==this._selectedBackingInstrument.instrumentId?this.widget.getLocalizedString("apx_child_rewards_account_credit_card_error"):
null},_recordTogglePaymentMethodActionMetric:function(a){a&&a.instrumentId&&this.widget.publishSuccessSushiMetrics({ActionType:"toggle-payment-method",ActionValueType:"PaymentInstrument",ActionValue:a.instrumentId})},_recordRecommendedInstrumentActionMetric:function(a){this.widget.publishSuccessSushiMetrics({ActionType:"recommended-instrument",ActionValueType:"PaymentInstrument",ActionValue:a})},_firstElement:function(a){return f.isArray(a)&&0<a.length?a[0]:null},_defaultInitialization:function(){this._triggerPaymentPlanSelectedEvent(!1,
this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"),"initial_widget_load_no_recommended_instrument")},bindToElements:function(){var a=this;this.getDOMElement("apx-jigsaw-other-payment-instruments-expander").click(function(){h.logCounterMetric({feature:"JigsawOtherPaymentInstrumentsExpanderClicked",resource:"_Count"});h.publishMetrics()});a.getDOMElement("add-new-payment-method").click(function(b){a.widget.trigger(e)})},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",
a,function(){a.data&&a.data.recommendedInstrumentId?(a._isOptionalBackingInstrument(a.data.recommendedInstrumentPaymentMethodCode,null)||(a._selectedBackingInstrument={instrumentId:a.data.recommendedInstrumentId,errors:null}),a.data.blockInitializeRecommendedInstrumentEvent||a._triggerInitializeRecommendedInstrumentEvent(a.data.recommendedInstrumentId,a.data.recommendedInstrumentPaymentMethodCode)):a._hasOptionalBackingInstrument()?a._updatePaymentPlanState():a._defaultInitialization();a.widget.trigger("preselectAPB")});
a.widget.on("backingInstrumentSelected",a,function(b){a._selectBackingInstrument(b)});a.widget.on("backingInstrumentDeselected",a,function(b){a._selectBackingInstrument(b)});a.widget.on("optionalInstrumentSelected",a,function(b){a._selectOptionalInstrument(b)});a.widget.on("optionalInstrumentDeselected",a,function(b){a._deselectOptionalInstrument(b)});a.widget.on("APBPreselected",a,function(a){this._triggerPaymentPlanSelectedEvent(!0,null,null)});a.widget.on("SuppressedZipOptionSelected",a,function(b){this._triggerPaymentPlanSelectedEvent(!1,
a.widget.getLocalizedString("pmts_portal_zp_error_insufficient_popover"),null)});a.widget.on("SuppressedNetBankingOptionSelected",a,function(b){a._triggerPaymentPlanSelectedEvent(!1,a.widget.getLocalizedString("payselect_bankTemporarilyNotAvailable"))});a.widget.on("ValidNetBankingOptionSelected",a,function(a){this._triggerPaymentPlanSelectedEvent(!0)});a.widget.on("NoNetBankingOptionSelected",a,function(b){this._triggerPaymentPlanSelectedEvent(!1,a.widget.getLocalizedString("pmts_portal_payselect_empty_netbanking_selection"))});
a.widget.on("installmentOfferSelectionChanged",a,function(a){this._updatePaymentPlanState()});a.widget.on("InstrumentRowSelected",a,function(a){this._recordTogglePaymentMethodActionMetric(a)});if(this.data.paylastOrderSummaryEnabled||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)a.widget.on("apbSelectionChanged",a,function(b){a._selectedBackingInstrument&&a._selectedBackingInstrument.paymentMethod&&("CC"===a._selectedBackingInstrument.paymentMethod||"UPI"===a._selectedBackingInstrument.paymentMethod||
a._selectedBackingInstrument.instrumentType&&"CashOnDelivery"===a._selectedBackingInstrument.instrumentType)||this._updatePaymentPlanState()});if((this.data.paylastOrderSummaryEnabled||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)&&!this.data.skipFormValidation)a.widget.on("installmentOptionChanged",a,function(a){this._updatePaymentPlanState()});f.forEach(["selectableAddCreditCardSelected","selectableAddDebitCardSelected","selectableDebitCardSelectedDisableContinue"],function(b){a.widget.on(b,
a,function(b){a._triggerPaymentPlanSelectedEvent(!1,a.widget.getLocalizedString("pmts_portal_payselect_empty_card_selection"))})})}})});m("components/SimplePaymentOptionListItemComponent","events/InstrumentRowSelectedEvent css-utils form-component lang continuable mixins/disable-component".split(" "),function(c,g,f,h,l,b){return f.extend(l,b,{isPaymentOptionEditable:!0,bindToElements:function(){var b=this;b.isPaymentOptionEditable&&b._getContainerElement().click(function(){var c=h.isDefined(b.data.isSuppressed)?
b.data.isSuppressed:!1;b._isInstrumentSelected()||b.isDisabled()||c||b._triggerInstrumentRowSelectedEvent()})},bindToEvents:function(){var b=this;h.forEach(["initializeRecommendedInstrument",c],function(c){b.widget.on(c,b,function(c){c.instrumentId===b._getInstrumentId()?b._onInstrumentSelected():b._onInstrumentDeselected()})});this.widget.on("APBPreselected",this,function(b){this._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("instrumentContainer")},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},
_getInstrumentSelectionInputElement:function(){return this.getDOMElement("instrumentRowSelection-"+this._getInstrumentId())},_getInstrumentId:function(){return this.data.instrumentId},_getInstrumentType:function(){return this.data.instrumentType},_getPaymentMethodCode:function(){return this.data.paymentMethod},_getIsOwned:function(){return h.isDefined(this._isOwned)?this._isOwned:!0},_getIsRecurringChargePaymentMethod:function(){return this.data.isRecurringChargePaymentMethod},_triggerInstrumentRowSelectedEvent:function(b){this.widget.trigger(c,
{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),isInstrumentOwned:this._getIsOwned(),isRecurringChargePaymentMethod:this._getIsRecurringChargePaymentMethod(),paymentMethod:this._getPaymentMethodCode()})},_triggerBackingInstrumentSelectedEvent:function(b){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:b,paymentMethod:this.data.paymentMethod})},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!0);this._triggerBackingInstrumentSelectedEvent(this._getDisplayableErrors(this.form.validateForm(!0)))},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1)},_getDisplayableErrors:function(b){if(0===b.length)return null;var c=[];h.forEach(b,function(b){c.push(b.localizedMessageString)});return c},_updateBackingInstrumentState:function(){this._isInstrumentSelected()&&
(this._onInstrumentDeselected(),this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},onDisabledChange:function(b){b&&this._isInstrumentSelected()&&(this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(c,{}))}})});m("components/PaymentMethodListComponent",["component"],function(c){return c.extend({bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(){c.data&&c.data.recommendedInstrumentId&&c._triggerInitializeRecommendedInstrumentEvent(c.data.recommendedInstrumentId)});
c.widget.on("submitSelectInstrumentForm",c,function(){c.getDOMElement("apx-select-instrument-form").submit()})},_triggerInitializeRecommendedInstrumentEvent:function(c){this.widget.trigger("initializeRecommendedInstrument",{instrumentId:c})}})});m("components/SelectableAddCreditCardComponent",["lang","component","css-utils","events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(c,g,f,h,l){return l.extend({addCardIntermittentStepRemoved:!1,initialize:function(b,
c){this.addCardIntermittentStepRemoved=c.data.addCardIntermittentStepRemoved;this._isMShop=c.data.isMShop;this._containerBinding=c.data.selectableCardContainerBinding;this._isDebit="DebitCard"===this.data.placementType;this.isPaylastEligible=c.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;self=this;E.when("A","ready").execute(function(b){self._isInlineAddCardEnabled=0===b.$("#apx-add-credit-card-action-test-id").length})},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!0);this._isDebit?this.widget.trigger("selectableAddDebitCardSelected"):this.widget.trigger("selectableAddCreditCardSelected");(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();if(this.addCardIntermittentStepRemoved){var b=this.getDOMElement("addCardButtonBinding");null!==b&&b.trigger("click");if(!this._isInlineAddCardEnabled)if(this._isMShop)this._delay(this).then(this._resetAddCardInstrument);
else this.widget.on("pmts-close-add-card-form",this,this._resetAddCardInstrument)}},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this._isDebit?this.widget.trigger("selectableAddDebitCardDeselected"):this.widget.trigger("selectableAddCreditCardDeselected");this.addCardIntermittentStepRemoved&&!this._isMShop&&this.widget.off("pmts-close-add-card-form",this,this._resetAddCardInstrument)},_resetAddCardInstrument:function(b){b||
(b=this);b.widget.trigger(h,{})},_delay:function(b){return new Promise(function(c,f){setTimeout(function(){c(b)},1E3)})},_getContainerElement:function(){return this.getDOMElement(this._containerBinding)},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},bindToEvents:function(){var b=this;c.forEach(["initializeRecommendedInstrument",h],function(c){b.widget.on(c,
b,function(c){c.instrumentId===this._getInstrumentId()?b._onInstrumentSelected():b._onInstrumentDeselected()})})}})});m("components/SelectablePayCodeListComponent",["form-component"],function(c){return c});m("components/SelectablePayCodeListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","clog"],function(c,g,f){return c.extend({initialize:function(c,f){this.isPayCodeMultiTenderEnabled=f.data.isPayCodeMultiTenderEnabled;this.paymentMethod=f.data.paymentMethod},
poaInstrumentClicked:function(c){this.widget.trigger(g,{instrumentId:c,isPayCodeMultiTenderEnabled:this.isPayCodeMultiTenderEnabled,paymentMethod:this.paymentMethod});f.logCounterMetric({feature:"AmazonPayCodeMultiTender"+(this.isPayCodeMultiTenderEnabled?".Enabled":".Disabled"),resource:"_Count"});f.publishMetrics()}})});m("components/APBListItemComponent","events/InstrumentRowSelectedEvent jQuery css-utils component mixins/disable-component lang clog".split(" "),function(c,g,f,h,l,b,e){var n=!1;
return h.extend(l,{initialize:function(c,a){this.$wave2=a.data.wave2Enabled;this.apbBalance=a.data.apbBalance;this.apbTotalBalance=a.data.apbTotalBalance;this.isClientGiftCardEligible=null==a.data.isClientGiftCardEligible?!0:a.data.isClientGiftCardEligible;this.isRadioButtonDisplay=a.data.canCoverPurchase;this.apbId=a.data.apbId;this.svaId=a.data.svaId;this.gcId=a.data.gcId;this.preselectApb=a.data.selectApbAtStart;this.isPaylastEligible=a.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=
a.data.showFloatingContinueBarOnNonPaylastPSP;this.isCODAPBToggleEnabled=a.data.isCODAPBToggleEnabled;this.isAPBContainerWhenAPVIsSelectedRequired=a.data.isAPBContainerWhenAPVIsSelectedRequired;this.storedValueId=a.data.storedValueId;this.giftCardId=a.data.giftCardId;this.isTurbo=a.data.isTurbo;this.isNomenclatureWave1Enabled=a.data.isNomenclatureWave1Enabled;this.apbPaymentMethodCategory=a.data.apbPaymentMethodCategory;this.isInlineEMIPlanChangeMessageExperienceEnabled=a.data.isInlineEMIPlanChangeMessageExperienceEnabled;
this.$apbRadioButtonTextTag=this.getDOMElement("apbRadioButtonTextTag");this.$apbCheckBoxTextTag=this.getDOMElement("apbCheckBoxTextTag");this.$isNomenclatureWave2FollowUpsEnabled=a.data.isNomenclatureWave2FollowUpsEnabled;this.$apbRadioButtonDisplayWhenAPVIsSelected=this.getDOMElement("apbRadioButtonDisplayWhenAPVIsSelected");this.$checkbox=this.getDOMElement("APBSelection");this.$checkboxContainer=this.getDOMElement("apbCheckboxDisplay");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+
this.apbId);this.$radioButtonContainer=this.getDOMElement("apbRadioButtonDisplay");this.$apbSubContainer=this.getDOMElement("apbSubContainer");this.$container=this.getDOMElement("apbContainer");this.$apbContainerWhenAPVIsSelectedForWave2=this.getDOMElement("apbWhenAPVSelectedContainerJS");this.$apbContainerWhenAPVIsSelected=this.getDOMElement("apbContainerWhenAPVIsSelected");this.$apbRadioButtonWhenAPVIsSelected=this.getDOMElement("instrumentRowSelection-APBWhenAPVIsSelected");this._setApb(this.preselectApb);
n=b.isDefined(a.data.isSuppressed)&&a.data.isSuppressed},_checkFormInput:function(b){this._getIsRadioButtonDisplay()?this._getRadioButton().prop("checked",b):this.$checkbox.prop("checked",b)},_toggleOptionalApb:function(){if(!this.$checkbox.prop("disabled")){var b=this.$checkbox.prop("checked");this._setApb(!b)}},_toggleApbRowIfRadioButton:function(b){this.$wave2&&this.$apbContainerWhenAPVIsSelectedForWave2.toggleClass("pmts-selected",b);this.$container.toggleClass("pmts-selected",b);var a=this._getActiveContainer().find(".a-touch-radio .a-icon");
a.toggleClass("a-icon-radio-active",b);a.toggleClass("a-icon-radio-inactive",!b);this.$isNomenclatureWave2FollowUpsEnabled&&this.$radioButton.prop("checked",b)},_toggleApbRowIfCheckbox:function(b){(this.isNomenclatureWave1Enabled||this.isTurbo)&&this.$container.toggleClass("pmts-selected",b)},_setApb:function(b){b?this._selectApb():this._unSelectApb()},_unSelectApb:function(){this._checkFormInput(!1);this._getIsRadioButtonDisplay()?(this._toggleApbRowIfRadioButton(!1),(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&
this.widget.trigger("UpdateOrderTotalForAPBEvent",{isApbSelected:!1,apbBalance:this.apbBalance})):(this._toggleApbRowIfCheckbox(!1),this._setCheckboxSelectedAttribute(!1),this._triggerApbSelectionChangedEvent(!1))},_selectApb:function(){this._checkFormInput(!0);this._getIsRadioButtonDisplay()?(this._toggleApbRowIfRadioButton(!0),this._triggerBackingInstrumentSelectedEvent(this.apbId,null),(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("UpdateOrderTotalForAPBEvent",
{isApbSelected:!0,apbBalance:this.apbBalance})):(this._toggleApbRowIfCheckbox(!0),this._setCheckboxSelectedAttribute(!0),this._triggerApbSelectionChangedEvent(!0))},_toggleRadioButtonDisplay:function(b){f.toggleElement(this.$radioButtonContainer,b);f.toggleElement(this.$checkboxContainer,!b)},_triggerApbSelectionChangedEvent:function(b){this.widget.trigger("apbSelectionChanged",{isSelected:b,isCODAPBToggleEnabled:this.isCODAPBToggleEnabled,canCoverPurchaseStandalone:this.isRadioButtonDisplay,giftCardId:this.giftCardId,
storedValueId:this.storedValueId});(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("UpdateOrderTotalForAPBEvent",{isApbSelected:b,apbBalance:this.apbBalance})},_setCheckboxSelectedAttribute:function(b){this.widget.set("apbCheckboxSelected",b)},_triggerOptionalInstrumentSelectedEvent:function(){var b=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.apbId,
errors:b})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.apbId})},_triggerBackingInstrumentSelectedEvent:function(b,a){this.widget.trigger("backingInstrumentSelected",{instrumentId:b,errors:a,paystationPaymentMethodCategory:this.apbPaymentMethodCategory,storedValueId:this.storedValueId,giftCardId:this.giftCardId,redeemableAPBBalance:this.apbBalance,totalAPBBalance:this.apbTotalBalance})},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,
{instrumentId:this.apbId})},_isApbSelectedAsInstrument:function(){return this._getActiveContainer().hasClass("pmts-selected")},_toggleBetweenDefaultAndAPBContainerWhenAPVIsSelected:function(b){this.isAPBContainerWhenAPVIsSelectedRequired&&(f.toggleElement(this.$apbContainerWhenAPVIsSelected,b),f.toggleElement(this.$apbSubContainer,!b))},_getActiveContainer:function(){return this.$isNomenclatureWave2FollowUpsEnabled?this.$container:this._isAPBContainerWhenAPVIsSelectedActive()?this.$wave2?this.$apbContainerWhenAPVIsSelectedForWave2:
this.$apbContainerWhenAPVIsSelected:this.$container},_getRadioButton:function(){return this._isAPBContainerWhenAPVIsSelectedActive()?this.$apbRadioButtonWhenAPVIsSelected:this.$radioButton},_isAPBContainerWhenAPVIsSelectedActive:function(){return this.isAPBContainerWhenAPVIsSelectedRequired?this.$wave2?this.$isNomenclatureWave2FollowUpsEnabled?!f.hasAUIHiddenClass(this.$apbRadioButtonTextTag):!f.hasAUIHiddenClass(this.$apbContainerWhenAPVIsSelectedForWave2):!f.hasAUIHiddenClass(this.$apbContainerWhenAPVIsSelected):
!1},_getIsRadioButtonDisplay:function(){return this._isAPBContainerWhenAPVIsSelectedActive()?!0:this.isRadioButtonDisplay},_isAPBInputButtonChecked:function(){return this.isRadioButtonDisplay?this.$radioButton.prop("checked"):this.$checkbox.prop("checked")},_resetAPBContainerWhenAPVIsSelected:function(){this.isAPBContainerWhenAPVIsSelectedRequired&&this.$apbRadioButtonWhenAPVIsSelected.prop("checked",!1)},_toggleAPBInputButton:function(b){this.isRadioButtonDisplay?this.$radioButton.prop("checked",
b):this.$checkbox.prop("checked",b)},_renderAPBContainerWhenAPVIsSelected:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var b=this._isAPBInputButtonChecked();this.$apbRadioButtonWhenAPVIsSelected.prop("checked",b);this.$container.toggleClass("pmts-selected",b);this._toggleAPBInputButton(!1);this._toggleBetweenDefaultAndAPBContainerWhenAPVIsSelected(!0);b&&!this.isRadioButtonDisplay&&(this._setApb(!0),this._triggerInstrumentRowSelectedEvent())}},_renderAPBContainerWhenAPVIsSelectedWhenWave2IsEnabled:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var b=
this._isAPBInputButtonChecked();this.$isNomenclatureWave2FollowUpsEnabled?(f.toggleElement(this.$apbRadioButtonTextTag,!0),f.toggleElement(this.$apbRadioButtonDisplayWhenAPVIsSelected,!0),f.toggleElement(this.$apbCheckBoxTextTag,!1),f.toggleElement(this.$container,!0)):(f.toggleElement(this.$apbContainerWhenAPVIsSelectedForWave2,!0),f.toggleElement(this.$container,!1),this.$apbContainerWhenAPVIsSelectedForWave2.toggleClass("pmts-selected",b));b&&(this._setApb(!0),this._triggerInstrumentRowSelectedEvent());
this.$apbRadioButtonWhenAPVIsSelected.prop("checked",b);this._toggleAPBInputButton(!1)}},_renderAPBContainerWhenAPVIsDeselected:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var b=this.$apbRadioButtonWhenAPVIsSelected.prop("checked");this._toggleAPBInputButton(b);this.isRadioButtonDisplay||this.$container.toggleClass("pmts-selected",!1);this._resetAPBContainerWhenAPVIsSelected();this._toggleBetweenDefaultAndAPBContainerWhenAPVIsSelected(!1);b&&!this.isRadioButtonDisplay&&this._triggerBackingInstrumentSelectedEvent(null,
null)}},_renderAPBContainerWhenAPVIsDeselectedWhenWave2IsEnabled:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var b=this.$apbRadioButtonWhenAPVIsSelected.prop("checked");this._toggleAPBInputButton(b);this.$isNomenclatureWave2FollowUpsEnabled&&(this.isRadioButtonDisplay?(f.toggleElement(this.$apbRadioButtonTextTag,!0),f.toggleElement(this.$apbCheckBoxTextTag,!1)):(f.toggleElement(this.$apbRadioButtonTextTag,!1),f.toggleElement(this.$apbCheckBoxTextTag,!0)));this.$isNomenclatureWave2FollowUpsEnabled||
this._resetAPBContainerWhenAPVIsSelected();f.toggleElement(this.$apbContainerWhenAPVIsSelectedForWave2,!1);f.toggleElement(this.$container,!0);b&&!this.isRadioButtonDisplay&&this._triggerBackingInstrumentSelectedEvent(null,null)}},bindToElements:function(){var b=this;n||(this.$wave2&&b.$apbContainerWhenAPVIsSelectedForWave2.click(function(a){b._getIsRadioButtonDisplay()?b._isApbSelectedAsInstrument()||b.isDisabled()||b._triggerInstrumentRowSelectedEvent():"a"!==a.target.tagName.toLowerCase()&&(a.preventDefault(),
b._toggleOptionalApb())}),b.$container.click(function(a){b._getIsRadioButtonDisplay()?b._isApbSelectedAsInstrument()||b.isDisabled()||b._triggerInstrumentRowSelectedEvent():"a"!==a.target.tagName.toLowerCase()&&(a.preventDefault(),b._toggleOptionalApb())}),b.$checkbox.click(function(a){var c=b.$checkbox.prop("checked");b._setApb(c);a.stopPropagation()}));this._isDesktop?(b.getDOMElement("APBRecommendationMessageLink").mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessagePopover",
ActionValueType:"Mouseover"})}),b.getDOMElement("APBRecommendationMessageLinkWhenAPVIsSelected").mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessageLinkWhenAPVIsSelected",ActionValueType:"Mouseover"})})):(b.getDOMElement("APBRecommendationMessageLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessagePopover",ActionValueType:"Click"})}),b.getDOMElement("APBRecommendationMessageLinkWhenAPVIsSelected").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessageLinkWhenAPVIsSelected",
ActionValueType:"Click"})}));b.getDOMElement("APBRadioButtonAddMoneyLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBRadioButtonAddMoneyLink",ActionValueType:"Click"});e.logCounterMetric({feature:"APBRadioButtonAddMoneyLinkClicked",resource:"_Count"});e.publishMetrics()});b.getDOMElement("APBCheckboxAddMoneyLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBCheckboxAddMoneyLink",ActionValueType:"Click"});e.logCounterMetric({feature:"APBCheckboxAddMoneyLinkClicked",
resource:"_Count"});e.publishMetrics()});b.getDOMElement("APBNomenclatureAddMoneyLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"APBNomenclatureAddMoneyLink",ActionValueType:"Click"});e.logCounterMetric({feature:"APBNomenclatureAddMoneyLinkClicked",resource:"_Count"});e.publishMetrics()})},_deselectAPBCheckbox:function(){var b=!this.$checkbox.prop("disabled"),a=this.$checkbox.prop("checked");b&&a&&(this.$checkbox.prop("checked",!1),this._setApb(!1))},bindToEvents:function(){var e=
this;e.widget.on(c,e,function(a){e._getIsRadioButtonDisplay()?e._setApb(a.instrumentId===e.apbId):e.$checkbox.prop("disabled",!this.isClientGiftCardEligible||n)});if(e.isCODAPBToggleEnabled)e.widget.on("codSelectionEvent",e,function(a){if(!e._getIsRadioButtonDisplay()){a=!e.$checkbox.prop("disabled");var b=e.$checkbox.prop("checked");a&&b&&(e._unSelectApb(),e.widget.trigger("apbDeselectMessageEventOnCodSelection"))}});e.widget.on("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",e,function(a){if(e.isInlineEMIPlanChangeMessageExperienceEnabled){var c=
g(".emi-changed-info-message");if(b.isDefined(c)&&a.message){for(var d=0;d<c.length;d++)b.isDefined(c[d].getElementsByClassName("a-size-small"))&&b.isDefined(c[d].getElementsByClassName("a-size-small")[0])&&(c[d].getElementsByClassName("a-size-small")[0].textContent=a.message);f.showElement(c)}}});e.widget.on("initializeRecommendedInstrument",e,function(a){a.instrumentId!==e.gcId&&a.instrumentId!==e.svaId&&a.instrumentId!==e.apbId&&a.instrumentId!==e.storedValueId&&a.instrumentId!==e.giftCardId||
e._triggerInstrumentRowSelectedEvent()});e.widget.on("preselectAPB",e,function(a){a=e.data.isPreselectionEnabled!==r?e.data.isPreselectionEnabled:!1;this._getIsRadioButtonDisplay()&&!a&&this.widget.trigger("APBPreselected")});e.widget.on("componentsInitialized",e,function(){if(!e._getIsRadioButtonDisplay()){var a=e.widget.get("apbCheckboxSelected");a!==r&&e._setApb(a);e.$checkbox.prop("checked")&&e._triggerBackingInstrumentSelectedEvent(null,null)}});e.widget.on("apvSelectionChanged",e,function(a){e.isAPBContainerWhenAPVIsSelectedRequired?
a.isSelected&&!e._isAPBContainerWhenAPVIsSelectedActive()?this.$wave2?e._renderAPBContainerWhenAPVIsSelectedWhenWave2IsEnabled():e._renderAPBContainerWhenAPVIsSelected():!a.isSelected&&e._isAPBContainerWhenAPVIsSelectedActive()&&(this.$wave2?e._renderAPBContainerWhenAPVIsDeselectedWhenWave2IsEnabled():e._renderAPBContainerWhenAPVIsDeselected()):a.isSelected&&a.canCoverPurchaseStandalone&&(e._getIsRadioButtonDisplay()||e._deselectAPBCheckbox())})}})});m("events/BalanceInfoEvent",["public-event-registry"],
function(c){c.register("BalanceInfoEvent");return"BalanceInfoEvent"});m("components/FPSListItemComponent",["events/InstrumentRowSelectedEvent","component"],function(c,g){return g.extend({initialize:function(c,g){this.instrumentId=g.data.instrumentId;this.paymentMethod=g.data.paymentMethod;this.$container=this.getDOMElement("fpsContainer");this.$checkbox=this.getDOMElement("fpsSelection")},bindToElements:function(){var c=this;c.$container.click(function(c){c.preventDefault();c=this.$checkbox.prop("checked");
this._setFPS(!c)});c.$checkbox.click(function(f){var g=c.$checkbox.prop("checked");c._setFPS(g);f.stopPropagation()})},_setFPS:function(c){c?this._selectFPS():this._deselectFPS()},_selectFPS:function(){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.instrumentId,paymentMethod:this.paymentMethod});this.$checkbox.prop("checked",!0)},_deselectFPS:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.instrumentId});this.$checkbox.prop("checked",!1)}})});
m("components/GiftCardListItemComponent","events/InstrumentRowSelectedEvent jQuery css-utils component lang post-pay-utils clog events/BalanceInfoEvent mixins/b2b-cross-wallet-mixin digital-wallet-utils AUI!P".split(" "),function(c,g,f,h,l,b,e,n,q,a,k){return h.extend(q,{_isProductVoucherSelected:!1,_isPromoBalanceSelected:!1,_isPostPaySelected:!1,_isNotOwnedInstrumentSelected:!1,initialize:function(a,b){this.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo=b.data.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo;
this.canCoverThePurchaseWithNonStandaloneProductVoucher=b.data.canCoverThePurchaseWithNonStandaloneProductVoucher;this.canCoverThePurchaseWithNonStandalonePromo=b.data.canCoverThePurchaseWithNonStandalonePromo;this.canCoverThePurchaseStandalone=b.data.canCoverThePurchaseStandalone;this.canCoverPurchaseWithOutPromo=b.data.canCoverPurchaseWithOutPromo;this.canCoverPurchaseWithNonStandalonePromo=b.data.canCoverThePurchaseWithNonStandalonePromo;this.promoCanCoverPurchaseWithOutGC=b.data.promoCanCoverPurchaseWithOutGC;
this.giftCardBalance=b.data.giftCardBalance;this.giftCardBalanceValue=b.data.giftCardBalanceValue;this.displayablePurchaseTotal=b.data.displayablePurchaseTotal;this.displayableAdjustedPurchaseTotal=b.data.displayableAdjustedPurchaseTotal;this.requireBackingInstrument=b.data.requireBacking;this.eligibleBackingMethods=b.data.eligibleBackingMethods;this.promoIdentifier=b.data.promoIdentifier;this.productVoucherIdentifier=b.data.productVoucherIdentifier;this.isClientGiftCardEligible=null==b.data.isClientGiftCardEligible?
!0:b.data.isClientGiftCardEligible;this.isRadioButtonDisplay=(this.canCoverPurchaseWithOutPromo||this.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo)&&this.isClientGiftCardEligible;this.isMultiTenderDisabledWithCashOnDelivery=b.data.isMultiTenderDisabledWithCashOnDelivery;this.giftCardId=b.data.giftCardId;this.disableGCWithMCB=b.data.disableGCWithMCB;this.isMultitenderDisabledWithPostPay=b.data.isMultitenderDisabledWithPostPay;this.isMultiTenderEnabledWithZip=b.data.isMultiTenderEnabledWithZip;
this.isMultiTenderEnabledWithPayLaterAccount=b.data.isMultiTenderEnabledWithPayLaterAccount;this.disallowAutoSelectionWhenConvertingToCheckbox=b.data.disallowAutoSelectionWhenConvertingToCheckbox;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.incompatibleMultitenderInstrumentIds=b.data.incompatibleMultitenderInstrumentIds;this.$consumerInvoicingGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithConsumerInvoicing");this.isGCOverauthEligible=
b.data.isGCOverauthEligible;this.giftCardToggleSwitchId=b.data.giftCardToggleSwitchId;this.giftCardToggleSwitchNativeId=b.data.giftCardToggleSwitchNativeId;this.giftCardSelectionFormName=b.data.giftCardSelectionFormName;this.giftCardSelectionFormValue=b.data.giftCardSelectionFormValue;this.isComplianceViolationPresent=b.data.isComplianceViolationPresent;this.$checkbox=this.getDOMElement("giftCardSelection");this.$checkboxContainer=this.getDOMElement("gcCheckboxDisplay");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+
this.giftCardId);this.$radioButtonContainer=this.getDOMElement("gcRadioButtonDisplay");this.$modernizedPaymentArtGrid=this.getDOMElement("modernizedPaymentArtGridReference");this.$toggleSwitch=this.getDOMElement(this.giftCardToggleSwitchId);this.$warningMessage=this.getDOMElement("gcWarningMessageDisplay");this.$container=this.getDOMElement("giftCardContainer");this.$gcOnlyOverauthMessage=this.getDOMElement("gcOnlyOverauthInfoMessageDisplay");this.$multitenderOverauthMessage=this.getDOMElement("gcMultiTenderOverauthInfoMessageDisplay");
this.$gcComplianceWarningMessage=this.getDOMElement("gcComplianceWarningMessageDisplay");this._setTitleAttributeToElement(this.$checkbox);this._setTitleAttributeToElement(this.$radioButton);this._setTitleAttributeToElement(this.$toggleSwitch);this.$bankRedirectGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithBankRedirect");this.$payAgentGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithPayAgent");this.$payOnPickupGCWarningReference=this.getDOMElement("gcWarningMessageDisplayWithPayOnPickup");
this.$postPayGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithPP");this.$digitalWalletGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithDigitalWallet");this.$defaultGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithSelectedPaymentMethod");this.$abSharedPayGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithABSharedInstrument");this._shouldDisplayModernizedPaymentArtCX=b.data.shouldDisplayModernizedPaymentArtCX;this._shouldDisplayModernizedFrameCX=
b.data.shouldDisplayModernizedFrameCX;this._modernizedPaymentArtGridCssClass=b.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=b.data.disabledSectionCssClass;this.disableGCWithMCB&&(b.data.disableGcAtStart?this._updateOptionalGiftCardEnabled(!1):f.toggleElement(this.$warningMessage),this.$warningMessage.removeClass("apx-js-hide"));this.isComplianceViolationPresent&&this.$gcComplianceWarningMessage.removeClass("apx-js-hide");this.widget.trigger(n,{category:"GiftCard",balanceValue:this.giftCardBalanceValue,
currencyCode:b.data.giftCardBalanceCurrencyCode})},_setTitleAttributeToElement:function(a){a.length&&this.getDOMElement("gcMsgWithPromo")&&this.getDOMElement("gcMsgWithPromo")[0]&&a.attr({title:this.getDOMElement("gcMsgWithPromo")[0].textContent})},_checkFormInput:function(a){this.isRadioButtonDisplay?this.$radioButton.prop("checked",a):this._updateOptionalGiftCardSelected(a)},_toggleOptionalGiftCard:function(){this._isOptionalGiftCardEnabled()&&this._setGiftCard(!this._isOptionalGiftCardSelected())},
_toggleGiftCardRowIfRadioButton:function(a){this.$container.toggleClass("pmts-selected",a);var b=this.$container.find(".a-touch-radio .a-icon");b.toggleClass("a-icon-radio-active",a);b.toggleClass("a-icon-radio-inactive",!a)},_setGiftCard:function(a){a?this._selectGiftCard():this._unselectGiftCard()},_unselectGiftCard:function(){this.isRadioButtonDisplay?this._toggleGiftCardRowIfRadioButton(!1):this._triggerOptionalInstrumentDeselectedEvent(null);this._checkFormInput(!1);this._triggerBalanceSelectionChangedEvent(!1);
f.toggleElement(this.$gcOnlyOverauthMessage,!1);f.toggleElement(this.$multitenderOverauthMessage,!1)},_selectGiftCard:function(){this.isRadioButtonDisplay?(this._toggleGiftCardRowIfRadioButton(!0),this._triggerBackingInstrumentSelectedEvent(this.giftCardId,null),f.toggleElement(this.$gcOnlyOverauthMessage,this.isGCOverauthEligible)):(this.requireBackingInstrument?this._triggerOptionalInstrumentSelectedEvent(null,this.eligibleBackingMethods):this._triggerOptionalInstrumentSelectedEvent(null),f.toggleElement(this.$multitenderOverauthMessage,
this.isGCOverauthEligible));this._checkFormInput(!0);this._triggerBalanceSelectionChangedEvent(!0)},_deselectCurrentDisplay:function(){!0===this.isRadioButtonDisplay&&this.$radioButton.prop("checked")?(this._unselectGiftCard(),this.widget.trigger(c,{}),this._triggerBackingInstrumentSelectedEvent(null,null)):!1===this.isRadioButtonDisplay&&this._isOptionalGiftCardSelected()&&this._unselectGiftCard()},_setDisplayToRadioButton:function(){this.isRadioButtonDisplay||(this._isOptionalGiftCardSelected()&&
this._unselectGiftCard(),this.isRadioButtonDisplay=!0,this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_setDisplayToCheckBoxOrToggleSwitch:function(){this.isRadioButtonDisplay&&(this.$radioButton.prop("checked")&&(this._unselectGiftCard(),this._triggerBackingInstrumentSelectedEvent(null,null)),this.isRadioButtonDisplay=!1,!0===this._isB2BCrossWalletMultitenderEnforcementEnabled?!0!==this.disallowAutoSelectionWhenConvertingToCheckbox&&this._selectGiftCard():this.isABCrossCustomerMultiTenderSuppressionEnabled&&
this._isNotOwnedInstrumentSelected||this._selectGiftCard(),this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_toggleRadioButtonDisplay:function(a){f.toggleElement(this.$radioButtonContainer,a);this._shouldDisplayModernizedFrameCX&&this.$toggleSwitch?(f.toggleElement(this.$toggleSwitch,!a),this._updatePaymentArtEnabledState(a?!0:this._isOptionalGiftCardEnabled())):!this._shouldDisplayModernizedFrameCX&&this.$checkboxContainer&&f.toggleElement(this.$checkboxContainer,!a);this._shouldDisplayModernizedPaymentArtCX&&
!this._shouldDisplayModernizedFrameCX&&this.$modernizedPaymentArtGrid&&f.toggleElement(this.$modernizedPaymentArtGrid,a)},_updatePaymentArtEnabledState:function(a){this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!a)},_handleSelectionChange:function(){this._changeGiftCardMessageDisplay();var a=this._canCoverPurchaseWithCurrentSelection();this.isClientGiftCardEligible&&a?this._setDisplayToRadioButton():this._setDisplayToCheckBoxOrToggleSwitch()},
_canCoverPurchaseWithCurrentSelection:function(){return this._isProductVoucherSelected&&this._isPromoBalanceSelected?this.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo:this._isProductVoucherSelected&&!this._isPromoBalanceSelected?this.canCoverThePurchaseWithNonStandaloneProductVoucher:!this._isProductVoucherSelected&&this._isPromoBalanceSelected?this.canCoverThePurchaseWithNonStandalonePromo:this.canCoverThePurchaseStandalone},_changeGiftCardMessageDisplay:function(){var a=this.getDOMElement("gcMsgWithoutPromo"),
b=this.getDOMElement("gcMsgWithPromo"),c=this.getDOMElement("gcMsgWithPV"),e=this.getDOMElement("gcMsgWithPVAndPromo");this.getDOMElement("gcOverauthInfoMessageDisplay");var k=!this._isProductVoucherSelected&&!this._isPromoBalanceSelected,g=!this._isProductVoucherSelected&&this._isPromoBalanceSelected,l=this._isProductVoucherSelected&&!this._isPromoBalanceSelected,h=this._isProductVoucherSelected&&this._isPromoBalanceSelected;f.toggleElement(a,k);f.toggleElement(b,g);f.toggleElement(c,l);f.toggleElement(e,
h);f.toggleElement(this.getDOMElement("gcMsgWithoutPromoWithCheckbox"),k);f.toggleElement(this.getDOMElement("gcMsgWithPromoWithCheckbox"),g);f.toggleElement(this.getDOMElement("gcMsgWithPVWithCheckbox"),l);f.toggleElement(this.getDOMElement("gcMsgWithPVAndPromoWithCheckbox"),h)},_triggerBalanceSelectionChangedEvent:function(a){this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.data.paymentMethod,isSelected:a,balance:this.giftCardBalanceValue,isBackingInstrument:this.isRadioButtonDisplay})},
_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.giftCardId})},_triggerBackingInstrumentSelectedEvent:function(a,b){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,errors:b,paymentMethod:this.data.paymentMethod})},_triggerOptionalInstrumentSelectedEvent:function(a,b){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.giftCardId,paymentMethod:this.data.paymentMethod,errors:a,eligibleBackingMethods:b,requireBackingInstrument:this.requireBackingInstrument,
balance:this.giftCardBalanceValue})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.giftCardId,paymentMethod:this.data.paymentMethod})},_isGiftCardSelectedAsInstrument:function(){return this.$container.hasClass("pmts-selected")},isPaycodeSelected:function(a){return l.isDefined(a.instrumentId)&&-1!==a.instrumentId.indexOf("amzn1.pm.pma.pag")},isPayOnPickupMultiTenderDisabled:function(a){return!(l.isDefined(a.isPayOnPickupMultiTenderEnabled)&&
a.isPayOnPickupMultiTenderEnabled)},isPayOnPickupSelected:function(a){return l.isDefined(a.instrumentId)&&-1!==a.instrumentId.indexOf("amzn1.pm.pma.cop")},_getToggleSwitchAuiElement:function(){var a=this,b=null;k.now("a-switch","jQuery").execute(function(d,c){d!==r&&c!==r&&(b=d.getSwitch(a.$toggleSwitch))});return b},_isOptionalGiftCardSelected:function(){if(this._shouldDisplayModernizedFrameCX){var a=this._getToggleSwitchAuiElement();return a&&a.isOn()}return this.$checkbox.prop("checked")},_updateOptionalGiftCardSelected:function(a){if(this._shouldDisplayModernizedFrameCX){var b=
this._getToggleSwitchAuiElement();if(b&&this._isOptionalGiftCardSelected()!==a){var d=!this._isOptionalGiftCardEnabled();d&&this._updateOptionalGiftCardEnabled(!0);b.isOn(a);d&&this._updateOptionalGiftCardEnabled(!1)}}else return this.$checkbox.prop("checked",a)},_isOptionalGiftCardEnabled:function(){if(this._shouldDisplayModernizedFrameCX){var a=this._getToggleSwitchAuiElement();return a&&a.enabled()}return!this.$checkbox.prop("disabled")},_updateOptionalGiftCardEnabled:function(a){if(this._shouldDisplayModernizedFrameCX){var b=
this._getToggleSwitchAuiElement();b&&(this._isOptionalGiftCardEnabled()!==a&&b.enabled(a),this._updatePaymentArtEnabledState(this.isRadioButtonDisplay?!0:a))}else return this.$checkbox.prop("disabled",!a)},bindToElements:function(){var a=this;a.$container.click(function(b){a.isRadioButtonDisplay?a._isGiftCardSelectedAsInstrument()||a._triggerInstrumentRowSelectedEvent():a._shouldDisplayModernizedFrameCX||(b.preventDefault(),a._toggleOptionalGiftCard())});a.$checkbox.click(function(b){a._setGiftCard(a._isOptionalGiftCardSelected());
b.stopPropagation()});if(this._shouldDisplayModernizedFrameCX&&(a.$toggleSwitch.find("#"+a.giftCardToggleSwitchNativeId).val(a.giftCardSelectionFormValue),a.giftCardSelectionFormName)){var b="a:switch:"+this.giftCardSelectionFormName+":flip";this.widget.offAui(b);this.widget.onAui(b,function(b){a._setGiftCard(b.switchState.isOn)})}},bindToEvents:function(){var d=this;d.widget.on(c,d,function(e){this._isNotOwnedInstrumentSelected=l.isDefined(e.isInstrumentOwned)&&!e.isInstrumentOwned;if(d.isRadioButtonDisplay)(e.instrumentId===
d.giftCardId||d._isGiftCardSelectedAsInstrument())&&d._setGiftCard(e.instrumentId===d.giftCardId);else{d._isPostPaySelected=b.isInstrumentSelection(e,this.isMultitenderDisabledWithPostPay);var k=l.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.poa.poda.MCB"),g="CashOnDelivery"===e.instrumentType,h=l.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.pm.pma.brd"),n=a.isInstrumentSelectionWithoutMultitender(e),q=d.isPaycodeSelected(e),m=d.isPayOnPickupSelected(e),x=d.isPayOnPickupMultiTenderDisabled(e),
z=e.paymentMethod===d.productVoucherIdentifier,w=l.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.pm.pma.zip"),p=l.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.pm.pma.pla"),y=l.isDefined(e.isPayCodeMultiTenderEnabled)&&e.isPayCodeMultiTenderEnabled,r=l.isDefined(e.isConsumerInvoicingOrderTFXEnabaled)&&e.isConsumerInvoicingOrderTFXEnabaled,H=l.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.pm.pma.inv");r=r&&H;H=-1===this.incompatibleMultitenderInstrumentIds.indexOf(e.instrumentId);
!0===d._isB2BCrossWalletMultitenderEnforcementEnabled?d.shouldBeDeselectedPerB2BMultitenderRules(c,e)&&d._unselectGiftCard():this.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected&&this._unselectGiftCard();this._updateOptionalGiftCardEnabled(!(e.instrumentId===d.promoIdentifier||z||this.disableGCWithMCB&&k||this.isMultiTenderDisabledWithCashOnDelivery&&g||!this.isClientGiftCardEligible||h||!y&&q||n||d._isPostPaySelected||w&&!d.isMultiTenderEnabledWithZip||r||m&&x||
p&&!d.isMultiTenderEnabledWithPayLaterAccount||!H));this.disableGCWithMCB&&f.toggleElement(this.$warningMessage,k);f.toggleElement(this.$gcComplianceWarningMessage,this.isComplianceViolationPresent);f.toggleElement(this.$bankRedirectGCWarningMessage,h);y||f.toggleElement(this.$payAgentGCWarningMessage,q);x&&f.toggleElement(this.$payOnPickupGCWarningReference,m);f.toggleElement(this.$consumerInvoicingGCWarningMessage,r);f.toggleElement(this.$postPayGCWarningMessage,this._isPostPaySelected);f.toggleElement(this.$digitalWalletGCWarningMessage,
n);f.toggleElement(this.$defaultGCWarningMessage,!H)}});d.widget.on("deselectGiftCardCheckbox",d,function(a){a.paymentMethod===this.productVoucherIdentifier?d._updateOptionalGiftCardEnabled(!1):"Zip"!==a.paymentMethod||d.isMultiTenderEnabledWithZip?"FoodVoucherCard"===a.paymentMethod&&d._unselectGiftCard():(d._isOptionalGiftCardSelected()&&d._unselectGiftCard(),d._updateOptionalGiftCardEnabled(!1))});d.widget.on("balanceSelectionChanged",d,function(a){"GC"===a.paymentMethod&&d._shouldDisplayModernizedFrameCX&&
d.widget.trigger("updateEstimatedTotal",{type:a.paymentMethod,status:a.isSelected,balance:a.balance,isValid:!0});d.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",a)&&d._deselectCurrentDisplay();a.paymentMethod===this.productVoucherIdentifier?(d._isProductVoucherSelected=a.isSelected,d._handleSelectionChange()):a.paymentMethod===this.promoIdentifier&&(d._isPromoBalanceSelected=a.isSelected,d._handleSelectionChange())});d.widget.on("componentsInitialized",d,function(){d.isRadioButtonDisplay||
(d._isOptionalGiftCardSelected()?(d._triggerOptionalInstrumentSelectedEvent(null,d.eligibleBackingMethods),d._triggerBalanceSelectionChangedEvent(!0)):d._triggerOptionalInstrumentDeselectedEvent())});d.widget.on("initializeRecommendedInstrument",d,function(a){a.instrumentId===d.giftCardId&&d.isRadioButtonDisplay&&d._triggerInstrumentRowSelectedEvent()});d.widget.on("backingInstrumentSelected",d,function(a){null!==a&&"CashOnDelivery"===a.instrumentType&&!d.isRadioButtonDisplay&&d.isMultiTenderDisabledWithCashOnDelivery&&
d._updateOptionalGiftCardEnabled(!1)})}})});m("components/PromoBalanceListItemComponent","events/InstrumentRowSelectedEvent jQuery lang clog css-utils component post-pay-utils mixins/b2b-cross-wallet-mixin digital-wallet-utils AUI!P".split(" "),function(c,g,f,h,l,b,e,n,q,a){var k;return b.extend(n,{_isPostPaySelected:!1,_isDigitalWalletSelected:!1,initialize:function(a,b){this.canCoverPurchaseStandalone=b.data.canCoverPurchaseStandalone;this.promoIdentifier=b.data.promoIdentifier;this.disableUserSelection=
b.data.disableUserSelection;this.promoBalance=b.data.promoBalance;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.isMultitenderDisabledWithPostPay=b.data.isMultitenderDisabledWithPostPay;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this._shouldDisplayModernizedFrameCX=b.data.shouldDisplayModernizedFrameCX;this._modernizedPaymentArtGridCssClass=
b.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=b.data.disabledSectionCssClass;this._promoBalanceToggleSwitchName=b.data.promoBalanceToggleSwitchName;this._promoBalanceToggleSwitchValue=b.data.promoBalanceToggleSwitchValue;this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.promoIdentifier);this.$checkbox=this.getDOMElement("promoBalanceSelection");this.$toggleSwitch=this.getDOMElement(this._promoBalanceToggleSwitchName);this.$container=this.getDOMElement("promoBalanceContainer");
this.$promoBalanceSelectableAreaContainer=this.getDOMElement("promoBalanceSelectableArea");this.$promoBalanceSelectionHiddenInput=this.getDOMElement("promoBalanceSelection");this.$revampedPromoBalanceContainer=this.getDOMElement("promoBalanceMobileContainer");this._setTitleAttributeToElement(this.$checkbox);this.$toggleSwitchInput=this.$toggleSwitch.find("input");this.$toggleSwitchInput.val(this._promoBalanceToggleSwitchValue)},_setTitleAttributeToElement:function(a){a.length&&this.getDOMElement("promoBalanceMessage")&&
this.getDOMElement("promoBalanceMessage")[0]&&a.attr({title:this.getDOMElement("promoBalanceMessage")[0].textContent})},_triggerBalanceSelectionChangedEvent:function(){var a=0<this.$container.length&&(this.$checkbox.prop("checked")||this.$toggleSwitchInput.prop("checked"))||0<this.$revampedPromoBalanceContainer.length&&!this.$promoBalanceSelectionHiddenInput.prop("disabled");this.widget.trigger(a?"optionalInstrumentSelected":"optionalInstrumentDeselected",{instrumentId:this.promoIdentifier,balance:this.promoBalance});
(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("UpdateOrderTotalForPromoBalanceEvent",{paymentMethod:this.promoIdentifier,isSelected:a,promoBalance:this.promoBalance,isBackingInstrument:this.canCoverPurchaseStandalone});this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:a,balance:this.promoBalance,isBackingInstrument:this.canCoverPurchaseStandalone})},_toggleCheckbox:function(){this.$checkbox.prop("checked",!this.$checkbox.prop("checked"))},
_deselectCheckbox:function(){this.$checkbox.prop("checked",!1)},_getToggleSwitchAuiElement:function(){var b=this,c=null;a.now("a-switch","jQuery").execute(function(a,d){a!==r&&d!==r&&(c=a.getSwitch(b.$toggleSwitch))});return c},_deselectToggleSwitch:function(){var a=this._getToggleSwitchAuiElement();null!=a&&a.isOn(!1)},_deselectPromoBalance:function(){this._isPromoSelectedAsInstrument()&&this.$radioButton.prop("checked")?(this.$radioButton.prop("checked",!1),this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",
{})):!1===this.canCoverPurchaseStandalone&&(0<this.$revampedPromoBalanceContainer.length&&!this.$promoBalanceSelectionHiddenInput.prop("disabled")?this._deselectPromoBalanceSelectionHiddenInput():0<this.$container.length&&this.$checkbox.prop("checked")?this._deselectCheckbox():0<this.$container.length&&this._shouldDisplayModernizedFrameCX&&this.$toggleSwitchInput.prop("checked")&&this._deselectToggleSwitch(),this._triggerBalanceSelectionChangedEvent())},_isPromoSelectedAsInstrument:function(){return this.$container.hasClass("pmts-selected")},
_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.promoIdentifier})},bindToElements:function(){var a=this;if(0<a.$revampedPromoBalanceContainer.length)a.$promoBalanceSelectableAreaContainer.click(function(b){a.disableUserSelection||a._isPostPaySelected||a._isDigitalWalletSelected||(a._togglePromoBalanceSelectionHiddenInput(),a._togglePromoBalanceDisplayStrings(),a._triggerBalanceSelectionChangedEvent(),a.publishPromoBalanceSelectionMetrics())});else if(a._shouldDisplayModernizedFrameCX&&
!a.canCoverPurchaseStandalone){var b="a:switch:"+a._promoBalanceToggleSwitchName+":flip";a.widget.offAui(b);a.widget.onAui(b,function(b){b.switchState.clicked&&a._triggerBalanceSelectionChangedEvent()})}else a.$container.click(function(b){a.disableUserSelection||a._isPostPaySelected||a._isDigitalWalletSelected?b.preventDefault():a.canCoverPurchaseStandalone?a._isPromoSelectedAsInstrument()||a._triggerInstrumentRowSelectedEvent():(b.preventDefault(),a._toggleCheckbox(),a._triggerBalanceSelectionChangedEvent())}),
a.$checkbox.click(function(b){a.disableUserSelection||a._isPostPaySelected||a._isDigitalWalletSelected||a._triggerBalanceSelectionChangedEvent();b.stopPropagation()})},_changeCheckboxEditability:function(a){this.$checkbox.prop("disabled",a)},_changeToggleSwitchEditability:function(a){var b=this._getToggleSwitchAuiElement();null!=b&&(b.enabled()&&a&&b.isOn(!1),b.enabled(!a))},_togglePromoBalanceSelectionHiddenInput:function(){this.$promoBalanceSelectionHiddenInput.prop("disabled",!this.$promoBalanceSelectionHiddenInput.prop("disabled"))},
_togglePromoBalanceDisplayStrings:function(){k=!this.$promoBalanceSelectionHiddenInput.prop("disabled");l.toggleElement(this.getDOMElement("promoBalanceAvailable"),!k);l.toggleElement(this.getDOMElement("promoBalanceApplied"),k);l.toggleElement(this.getDOMElement("promoBalanceApplyLink"),!k);l.toggleElement(this.getDOMElement("promoBalanceRemoveLink"),k);k?(this.$revampedPromoBalanceContainer.removeClass("promo-balance-mobile-container-background-change"),this.getDOMElement("promoBalanceMobileSelectionChangeover").show()):
this.$revampedPromoBalanceContainer.addClass("promo-balance-mobile-container-background-change")},_deselectPromoBalanceSelectionHiddenInput:function(){this.$promoBalanceSelectionHiddenInput.prop("disabled",!0);this._togglePromoBalanceDisplayStrings()},_togglePromoBalanceSelectionEditability:function(a){a?(this.$promoBalanceSelectionHiddenInput.prop("disabled",a),this.$revampedPromoBalanceContainer.addClass("promo-mobile-container-disable-css-class")):this.$revampedPromoBalanceContainer.removeClass("promo-mobile-container-disable-css-class")},
publishPromoBalanceSelectionMetrics:function(a){(k=!this.$promoBalanceSelectionHiddenInput.prop("disabled"))?h.logCounterMetric({feature:"PromoBalanceSelected",resource:"_Count"}):h.logCounterMetric({feature:"PromoBalanceDeselected",resource:"_Count"});h.publishMetrics()},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId===a.promoIdentifier?(a.widget.trigger("backingInstrumentSelected",{instrumentId:a.promoIdentifier,errors:null}),a.$container.addClass("pmts-selected"),
a.getDOMElement("instrumentRowSelection-"+a.promoIdentifier).prop("checked",!0),this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:!0,balance:this.promoBalance,isBackingInstrument:!0})):a._isPromoSelectedAsInstrument()&&"HealthBenefitsCard"!==b.paymentMethod&&(a.$container.removeClass("pmts-selected"),this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:!1,balance:this.promoBalance,isBackingInstrument:!1}));if(b.instrumentId!==
a.promoIdentifier&&!a.canCoverPurchaseStandalone)if(!0===a._isB2BCrossWalletMultitenderEnforcementEnabled)!0===a.shouldBeDeselectedPerB2BMultitenderRules(c,b)&&a._deselectPromoBalance();else{var d=f.isDefined(b.isInstrumentOwned)&&!b.isInstrumentOwned;this.isABCrossCustomerMultiTenderSuppressionEnabled&&d&&(0<this.$revampedPromoBalanceContainer.length?a._deselectPromoBalanceSelectionHiddenInput():a._shouldDisplayModernizedFrameCX?a._deselectToggleSwitch():a._deselectCheckbox(),a._triggerBalanceSelectionChangedEvent())}a.canCoverPurchaseStandalone||
(a._isPostPaySelected=e.isInstrumentSelection(b,this.isMultitenderDisabledWithPostPay),a._isDigitalWalletSelected=q.isInstrumentSelectionWithoutMultitender(b),b=a._isPostPaySelected||a._isDigitalWalletSelected,0<this.$revampedPromoBalanceContainer.length?a._togglePromoBalanceSelectionEditability(b):a._shouldDisplayModernizedFrameCX?a._changeToggleSwitchEditability(b):a._changeCheckboxEditability(b),this._shouldDisplayModernizedFrameCX&&this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,
!!b))});a.widget.on("balanceSelectionChanged",a,function(b){"PROMO"===b.paymentMethod&&a._shouldDisplayModernizedFrameCX&&a.widget.trigger("updateEstimatedTotal",{type:b.paymentMethod,status:b.isSelected,balance:b.balance,isValid:!0});!0===a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",b)&&a._deselectPromoBalance()});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.promoIdentifier&&a.canCoverPurchaseStandalone&&a._triggerInstrumentRowSelectedEvent()});
a.widget.on("componentsInitialized",a,function(){!a.canCoverPurchaseStandalone&&(0<a.$checkbox.length&&a.$checkbox.is(":checked")||0<a.$toggleSwitch.length&&a.$toggleSwitchInput.prop("checked")||0<a.$revampedPromoBalanceContainer.length&&!this.$promoBalanceSelectionHiddenInput.prop("disabled"))&&a._triggerBalanceSelectionChangedEvent()});a.widget.on("deselectPromoBalanceInstrument",a,function(b){a._isPromoSelectedAsInstrument()&&(a.$container.removeClass("pmts-selected"),this.widget.trigger("balanceSelectionChanged",
{paymentMethod:this.promoIdentifier,isSelected:!1,balance:this.promoBalance,isBackingInstrument:!1}))})}})});m("components/SelectableBalanceListComponent",["component","lang"],function(c,g){return c.extend({})});m("components/JPPointsListItemComponent","events/InstrumentRowSelectedEvent jQuery lang css-utils form-component post-pay-utils mixins/b2b-cross-wallet-mixin digital-wallet-utils".split(" "),function(c,g,f,h,l,b,e,n){var q="jpPointsBalanceSelection instrumentRowSelection-jpPoints jpPointsBalanceSelection_pointsSelection-max jpPointsBalanceSelection_pointsSelection-partial jpPointsBalanceSelection_partialPointsAmount jpPointsBalanceSelection_partialCurrencyAmount".split(" ");
return l.extend(e,{_maxPointsApplicable:0,_canUseMaxPointsWithoutBackingInstrument:!1,_isUsingMaxPointsWithoutBackingInstrument:!1,_isGiftCardSelected:!1,_isProductVoucherSelected:!1,_isPromoBalanceSelected:!1,_isNonPointsInstrumentSelected:!1,_isPostPaySelected:!1,_isDigitalWalletSelected:!1,_isMCBSelected:!1,_shouldBeDisabledPerB2BMultitenderRules:!1,_currencyToPointsRate:0,_usePartialCurrencyAmountElement:!1,_isJPPointsForPreference:!1,initialize:function(a,b){f.has(b.data,"defaultMaxPoints")&&
(this._maxPointsApplicable=b.data.defaultMaxPoints.points);this._currencyToPointsRate=b.data.currencyToPointsRate;this._usePartialCurrencyAmountElement=b.data.usePartialCurrencyAmountElement;this._canUseMaxPointsWithoutBackingInstrument=b.data.canCoverPurchaseTotalStandalone;this.isMultitenderDisabledWithPostPay=b.data.isMultitenderDisabledWithPostPay;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this._isJPPointsForPreference=b.data.isJPPointsForPreference;
this.$preferenceCheckbox=this.getDOMElement("JPPointsPreferenceSelection");this._isJPPointsForPreference&&(this._pointsInstrumentId=b.data.pointsInstrumentId,this.requireBackingInstrument=b.data.requireBackingInstrument,this.eligibleBackingMethods=b.data.eligibleBackingMethods,this.pointsAccountSelectionFormValue=b.data.pointsAccountSelectionFormValue,this.ineligiblePaymentMethodCategories=b.data.ineligiblePaymentMethodCategories,this.$mcbWarningMessage=this.getDOMElement("jpPointsWarningMessageDisplayWithMCB"),
this.$postPayWarningMessage=this.getDOMElement("jpPointsWarningMessageDisplayWithPostPay"),this.$digitalWalletWarningMessage=this.getDOMElement("jpPointsWarningMessageDisplayWithDigitalWallet"),this.recommendedInstrumentIds=b.data.recommendedInstrumentIds,0<this.recommendedInstrumentIds.filter(function(a){return-1!==a.indexOf("amzn1.poa.poda.MCB")}).length&&this.ineligiblePaymentMethodCategories.includes("MobileCarrierBilling")&&(this._updateOptionalPointsAccountCheckBoxEnabled(!1),h.toggleElement(this.$mcbWarningMessage,
!0)))},_setMaxPointsValue:function(a,b){this._maxPointsApplicable=a.points;this._canUseMaxPointsWithoutBackingInstrument=b;b=this.getDOMElement("jpPointsContainer");b.find(".pmts-jppoints-value-in-points").text(a.points);b.find(".pmts-jppoints-value-in-currency").text(a.currency)},_setPointsToApplyValue:function(a){this.getDOMElement("jpPointsBalanceSelection").val(a);a=0<Number(a);this.getDOMElement("jpPointsBalanceSelection_instrumentId").prop("disabled",!a)},_resolveElement:function(a){if(f.isString(a))return this.getDOMElement(a);
if(f.isArray(a)){for(var b=[],c=0;c<a.length;c++){var e=this._resolveElement(a[c]);e&&0<e.length&&b.push(e[0])}return g(b)}return a},_isBoxChecked:function(a){return this._resolveElement(a).is(":checked")},_shouldBeDisabledByIncompatiblePaymentMethods:function(){return this._isPostPaySelected||this._shouldBeDisabledPerB2BMultitenderRules||this._isDigitalWalletSelected},_toggleCheckableBox:function(a,b){a=this._resolveElement(a);"undefined"===typeof b&&(b=!a.prop("checked"));a.prop("checked",b)},_toggleControlEditability:function(a,
b){a=this._resolveElement(a);"undefined"===typeof b&&(b=a.prop("disabled"));a.prop("disabled",!b)},_toggleContainerHighlighting:function(a){this.getDOMElement("jpPointsContainer").toggleClass("pmts-selected",a)},_resolvePointsBalanceChange:function(){0<this._maxPointsApplicable?(this._enablePoints(),this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-max")?this._canUseMaxPointsWithoutBackingInstrument?this._useMaxPointsWithoutBackingInstrument():this._useMaxPointsWithBackingInstrument():
this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")&&(this._usePartialCurrencyAmountElement?this._parseAndValidatePartialCurrencyAmountFromField(this):this._parseAndValidatePartialPointsAmountFromField(this))):this._disablePoints()},_disablePoints:function(){this._useNoPoints();this._toggleControlEditability(q,!1)},_enablePoints:function(){this._toggleControlEditability(q,!0)},_useNoPoints:function(){this._toggleCheckableBox(["jpPointsBalanceSelection","instrumentRowSelection-jpPoints",
"jpPointsBalanceSelection_pointsSelection-max"],!1);this._toggleContainerHighlighting(!1);this._clearPartialPoints();this._setPointsToApplyValue("0");this._isUsingMaxPointsWithoutBackingInstrument&&!this._isNonPointsInstrumentSelected?this._triggerBackingInstrumentSelectedEvent(!1,null):this._isUsingMaxPointsWithoutBackingInstrument=!1;this._triggerOptionalInstrumentDeselectedEvent();this._triggerBalanceSelectionChangedEvent(!1,0,!1)},_useMaxPointsWithoutBackingInstrument:function(){this._toggleCheckableBox(["jpPointsBalanceSelection",
"instrumentRowSelection-jpPoints","jpPointsBalanceSelection_pointsSelection-max"],!0);this._isNonPointsInstrumentSelected=!1;this._toggleContainerHighlighting(!0);this._clearPartialPoints();this._setPointsToApplyValue(this._maxPointsApplicable);this._triggerInstrumentRowSelectedEvent(null);this._triggerBackingInstrumentSelectedEvent(!0,null);this._triggerOptionalInstrumentDeselectedEvent();this._triggerBalanceSelectionChangedEvent(!0,this._maxPointsApplicable,!0)},_useMaxPointsWithBackingInstrument:function(){this._toggleCheckableBox(["jpPointsBalanceSelection",
"jpPointsBalanceSelection_pointsSelection-max"],!0);this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1);this._toggleContainerHighlighting(!1);this._clearPartialPoints();this._setPointsToApplyValue(this._maxPointsApplicable);this._isUsingMaxPointsWithoutBackingInstrument&&this._triggerBackingInstrumentSelectedEvent(!1,null);this._isNonPointsInstrumentSelected?this._triggerOptionalInstrumentSelectedEvent(null):this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_insufficient_balance")]);
this._triggerBalanceSelectionChangedEvent(!0,this._maxPointsApplicable,!1)},_usePartialPoints:function(a){this._toggleCheckableBox(["jpPointsBalanceSelection","jpPointsBalanceSelection_pointsSelection-partial"],!0);this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1);this._toggleContainerHighlighting(!1);a&&(this._usePartialCurrencyAmountElement?this.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount").focus():this.getDOMElement("jpPointsBalanceSelection_partialPointsAmount").focus());
this._setPointsToApplyValue("0");this._isUsingMaxPointsWithoutBackingInstrument&&this._triggerBackingInstrumentSelectedEvent(!1,null);this._isNonPointsInstrumentSelected?this._triggerOptionalInstrumentSelectedEvent(null):this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_insufficient_balance")])},_clearPartialPoints:function(){this.form.clearValidationErrors();this._toggleCheckableBox("jpPointsBalanceSelection_pointsSelection-partial",
!1);this.getDOMElement("jpPointsBalanceSelection_partialPointsAmount").val("");this.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount").val("");this._updatePartialAmountPointsConversion(0);this._togglePartialPointsError(!1)},_togglePartialPointsError:function(a){h.toggleElement(this.getDOMElement("jpPointsErrorPartialExceededBalance"),a);h.toggleElement(this.getDOMElement("abRewardsPartialAmountPointsConversion"),!a)},_updatePartialAmountPointsConversion:function(a){a=this.widget.getLocalizedString("pmts_portal_payselect_ab_rewards_redeem_partial_points_conversion",
{value_in_points:a});var b=this.getDOMElement("abRewardsPartialAmountPointsConversion")[0];b!==r&&(b.innerHTML=a)},_validatePartialPoints:function(a){var b=Number(this._maxPointsApplicable);this._triggerBalanceSelectionChangedEvent(!0,a,!1);a<=b?(this.form.clearValidationErrors(),this._togglePartialPointsError(!1),this._setPointsToApplyValue(a.toString()),this._isNonPointsInstrumentSelected?this._triggerOptionalInstrumentSelectedEvent(null):a===b&&this._canUseMaxPointsWithoutBackingInstrument?(this._toggleCheckableBox("instrumentRowSelection-jpPoints",
!0),this._triggerBackingInstrumentSelectedEvent(!0,null),this._triggerOptionalInstrumentDeselectedEvent()):(this._isUsingMaxPointsWithoutBackingInstrument&&(this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1),this._triggerBackingInstrumentSelectedEvent(!1,null)),this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_insufficient_balance")]))):(this._isUsingMaxPointsWithoutBackingInstrument&&(this._toggleCheckableBox("instrumentRowSelection-jpPoints",
!1),this._triggerBackingInstrumentSelectedEvent(!1,null)),this._togglePartialPointsError(!0),this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_exceeded_balance_continue")]),this._setPointsToApplyValue("0"),this.form.blameFormField("jpPointsBalanceSelection",!0))},_convertCurrencyToPoints:function(a){return Math.round(a*this._currencyToPointsRate)},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.data.pointsInstrumentId})},
_triggerBalanceSelectionChangedEvent:function(a,b,c){this.widget.trigger("balanceSelectionChanged",{paymentMethod:"JPPoints",isSelected:a,instrumentId:this.data.pointsInstrumentId,isInstrumentOwned:this.data.isOwned,balance:b,isBackingInstrument:c})},_triggerBackingInstrumentSelectedEvent:function(a,b){this._isUsingMaxPointsWithoutBackingInstrument=a;var c=null;a&&(c={instrumentId:this.data.pointsInstrumentId,errors:b,paymentMethod:this.data.paymentMethod});this.widget.trigger("backingInstrumentSelected",
c)},_triggerOptionalInstrumentSelectedEvent:function(a){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.data.pointsInstrumentId,errors:a})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.data.pointsInstrumentId})},_toggleJPPointsSectionDisplay:function(a){h.toggleElement(this.getDOMElement("jpPointsCollapsibleSection"),a)},_handleSelectionChange:function(){this._isGiftCardSelected&&this._isProductVoucherSelected&&
this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithGiftCardAndProductVoucherAndPromo,this.data.canCoverPurchaseTotalAfterGiftCardAndProductVoucherAndPromo):!this._isGiftCardSelected&&this._isProductVoucherSelected&&this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithProductVoucherAndPromo,this.data.canCoverPurchaseTotalAfterProductVoucherAndPromo):this._isGiftCardSelected&&this._isProductVoucherSelected&&!this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithGiftCardAndProductVoucher,
this.data.canCoverPurchaseTotalAfterGiftCardAndProductVoucher):this._isGiftCardSelected&&!this._isProductVoucherSelected&&this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithGiftCardAndPromo,this.data.canCoverPurchaseTotalAfterGiftCardAndPromo):this._isGiftCardSelected||this._isProductVoucherSelected||!this._isPromoBalanceSelected?this._isGiftCardSelected||!this._isProductVoucherSelected||this._isPromoBalanceSelected?!this._isGiftCardSelected||this._isProductVoucherSelected||
this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsStandalone,this.data.canCoverPurchaseTotalStandalone):this._setMaxPointsValue(this.data.maxPointsWithGiftCard,this.data.canCoverPurchaseTotalAfterGiftCard):this._setMaxPointsValue(this.data.maxPointsWithProductVoucher,this.data.canCoverPurchaseTotalAfterProductVoucher):this._setMaxPointsValue(this.data.maxPointsWithPromo,this.data.canCoverPurchaseTotalAfterPromo);this._shouldBeDisabledByIncompatiblePaymentMethods()||this._resolvePointsBalanceChange()},
_parseAndValidatePartialPointsAmountFromField:function(a){var b=a.getDOMElement("jpPointsBalanceSelection_partialPointsAmount"),c=b.val().replace(/[^0-9]/g,"");"0"===c&&(c="");b.val(c);a._validatePartialPoints(""!==c?Number(c):0)},_parseAndValidatePartialCurrencyAmountFromField:function(a){var b=a.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount"),c=b.val().match(/[\d]+[\.]?[\d]{0,2}/);c=null===c?"":c[0];b.val(c);b=a._convertCurrencyToPoints(Number(c));a._validatePartialPoints(b);a._updatePartialAmountPointsConversion(b)},
_handleRowSelectionEventForSetPaymentPlanSelection:function(a,e){a._isPostPaySelected=b.isInstrumentSelection(e,this.isMultitenderDisabledWithPostPay);a._isDigitalWalletSelected=n.isInstrumentSelectionWithoutMultitender(e);a._shouldBeDisabledPerB2BMultitenderRules=a.shouldBeDisabledPerB2BMultitenderRules(e);a._isNonPointsInstrumentSelected=!0;a._isMCBSelected=f.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.poa.poda.MCB");this._shouldBeDisabledByIncompatiblePaymentMethods()?this._disablePoints():
this._enablePoints();!0===this._isB2BCrossWalletMultitenderEnforcementEnabled?!0===this.shouldBeDeselectedPerB2BMultitenderRules(c,e)&&this._useNoPoints():!0===this.isABCrossCustomerMultiTenderSuppressionEnabled&&f.isDefined(e.instrumentId)&&(!f.isDefined(e.isInstrumentOwned)||e.isInstrumentOwned)!==this.data.isOwned&&this._useNoPoints();this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")?this._isUsingMaxPointsWithoutBackingInstrument?(this._isUsingMaxPointsWithoutBackingInstrument=
!1,this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1),this._triggerOptionalInstrumentSelectedEvent(null)):this._resolvePointsBalanceChange():this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-max")&&(this._isUsingMaxPointsWithoutBackingInstrument?this._useNoPoints():this._resolvePointsBalanceChange())},_setPointsAccountCheckBox:function(a){a?this._selectPointsAccountCheckBox():this._unselectPointsAccountCheckBox()},_selectPointsAccountCheckBox:function(){this.requireBackingInstrument?
this._triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent(null,this.eligibleBackingMethods):this._triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent(null);this._updateOptionalPointsAccountCheckBoxSelected(!0)},_unselectPointsAccountCheckBox:function(){this._triggerOptionalPointsAccountInstrumentCheckBoxDeselectedEvent();this._updateOptionalPointsAccountCheckBoxSelected(!1)},_updateOptionalPointsAccountCheckBoxSelected:function(a){return this.$preferenceCheckbox.prop("checked",a)},
_triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent:function(a,b){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this._pointsInstrumentId,paymentMethod:this.data.paymentMethod,errors:a,eligibleBackingMethods:b,requireBackingInstrument:this.requireBackingInstrument})},_triggerOptionalPointsAccountInstrumentCheckBoxDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this._pointsInstrumentId,paymentMethod:this.data.paymentMethod})},_toggleOptionalPointsAccountCheckBox:function(){this._isOptionalPointsAccountCheckBoxEnabled()&&
this._setPointsAccountCheckBox(!this._isOptionalPointsAccountCheckBoxSelected())},_toggleJPPointsCheckboxDisplay:function(a){h.toggleElement(this.getDOMElement("JPPointsPreferenceSelection"),a)},_isOptionalPointsAccountCheckBoxEnabled:function(){return!this.$preferenceCheckbox.prop("disabled")},_isOptionalPointsAccountCheckBoxSelected:function(){return this.$preferenceCheckbox.prop("checked")},_handleRowSelectionEventForSetPaymentPreference:function(a,c){a._isPostPaySelected=b.isInstrumentSelection(c,
this.ineligiblePaymentMethodCategories.includes("LineOfCredit"));a._isDigitalWalletSelected=n.isInstrumentSelectionWithNoMultiTender(c,this.ineligiblePaymentMethodCategories.includes("DigitalWallet"));a._isMCBSelected=f.isDefined(c.instrumentId)&&-1!==c.instrumentId.indexOf("amzn1.poa.poda.MCB")&&this.ineligiblePaymentMethodCategories.includes("MobileCarrierBilling");this._updateOptionalPointsAccountCheckBoxEnabled(!(a._isMCBSelected||a._isDigitalWalletSelected||a._isPostPaySelected));h.toggleElement(this.$mcbWarningMessage,
a._isMCBSelected);h.toggleElement(this.$digitalWalletWarningMessage,a._isDigitalWalletSelected);h.toggleElement(this.$postPayWarningMessage,a._isPostPaySelected)},_updateOptionalPointsAccountCheckBoxEnabled:function(a){this._toggleControlEditability("JPPointsPreferenceSelection",a)},bindToElements:function(){var a=this;a.getDOMElement("jpPointsBalanceSelection").change(function(b){b.target.checked?(a._toggleJPPointsSectionDisplay(!0),a._canUseMaxPointsWithoutBackingInstrument?a._useMaxPointsWithoutBackingInstrument():
a._useMaxPointsWithBackingInstrument()):(a._toggleJPPointsSectionDisplay(!1),a._useNoPoints())});a.getDOMElement("jpPointsBalanceSelection_pointsSelection-max").change(function(b){b.target.checked&&(a._canUseMaxPointsWithoutBackingInstrument?a._useMaxPointsWithoutBackingInstrument():a._useMaxPointsWithBackingInstrument())});a.getDOMElement("jpPointsBalanceSelection_pointsSelection-partial").change(function(b){b.target.checked&&a._usePartialPoints(!0)});var b=a.getDOMElement("jpPointsBalanceSelection_partialPointsAmount");
b.click(function(){a._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")||a._usePartialPoints(!1)});b.keyup(function(){a._parseAndValidatePartialPointsAmountFromField(a)});b=a.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount");b.click(function(){a._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")||a._usePartialPoints(!1)});b.keyup(function(){a._parseAndValidatePartialCurrencyAmountFromField(a)});a.$preferenceCheckbox.click(function(b){a._setPointsAccountCheckBox(a._isOptionalPointsAccountCheckBoxSelected())})},
bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId!==a.data.pointsInstrumentId&&(a._isJPPointsForPreference?a._handleRowSelectionEventForSetPaymentPreference(a,b):a._handleRowSelectionEventForSetPaymentPlanSelection(a,b))});a.widget.on("balanceSelectionChanged",a,function(b){if(!a._isJPPointsForPreference){var c=!0===b.isSelected&&"JPPoints"===b.paymentMethod&&b.instrumentId!==a.data.pointsInstrumentId;!0!==a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",
b)&&!0!==c||a._useNoPoints();"GC"===b.paymentMethod?(a._isGiftCardSelected=b.isSelected,a._handleSelectionChange()):"ProductVoucher"===b.paymentMethod?(a._isProductVoucherSelected=b.isSelected,a._handleSelectionChange()):"PROMO"===b.paymentMethod&&(a._isPromoBalanceSelected=b.isSelected,a._handleSelectionChange())}});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a._pointsInstrumentId&&this._isJPPointsForPreference&&a._triggerInstrumentRowSelectedEvent()});a.widget.on("componentsInitialized",
a,function(){this._isJPPointsForPreference&&(a._isOptionalPointsAccountCheckBoxSelected()?a._triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent(null,a.eligibleBackingMethods):a._triggerOptionalInstrumentDeselectedEvent())})}})});m("components/SelectableBancontactListComponent",["form-component"],function(c){return c});m("components/BankAccountListItemComponent",["css-utils","components/SimplePaymentOptionListItemComponent","lang","events/InstrumentRowSelectedEvent"],function(c,g,f,h){var l=
["GC","JPPoints","ProductVoucher","PROMO"];return g.extend({_getContainerElement:function(){return this.getDOMElement("bankAccountContainer")},initialize:function(b,c){this._isAddressChallenged=c.data.isAddressChallenged;this._isOwned=c.data.isOwned;this._isABCrossCustomerMultiTenderSuppressionEnabled=c.data.isABCrossCustomerMultiTenderSuppressionEnabled},bindToEvents:function(){f.bind(g.prototype.bindToEvents,this).apply();this.widget.on("bankAccountAddressChallengePassed",this,function(b){b.instrumentId===
this._getInstrumentId()&&(this._isAddressChallenged=!1,this._updateContinueButton(),c.showElement(this.getDOMElement("bankAccountHolderName")))});this.widget.on("balanceSelectionChanged",this,function(b){this._isABCrossCustomerMultiTenderSuppressionEnabled&&!this._getIsOwned()&&!b.isBackingInstrument&&b.isSelected&&l.includes(b.paymentMethod)&&this._updateBackingInstrumentState()});this.widget.on("initializeRecommendedInstrument",this,function(b){b.instrumentId===this._getInstrumentId()&&this._triggerInstrumentRowSelectedEvent()})},
_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._updateContinueButton();this._toggleRecurringPaymentEligibilityBAMessage(!0);this._isAddressChallenged?c.hideElement(this.getDOMElement("bankAccountHolderName")):c.showElement(this.getDOMElement("bankAccountHolderName"))},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",
!1);this._toggleRecurringPaymentEligibilityBAMessage(!1);c.showElement(this.getDOMElement("bankAccountHolderName"))},_toggleRecurringPaymentEligibilityBAMessage:function(b){this.widget.trigger("toggleRecurringPaymentEligibilityMessage",{instrumentId:this.data.instrumentId,isSelected:b})},_updateContinueButton:function(){var b=null;this._isAddressChallenged&&(b="pmts_portal_payselect_blocked_continue_address_challenge");b=b?[this.widget.getLocalizedString(b)]:null;this._triggerBackingInstrumentSelectedEvent(b)}})});
m("components/SelectableBankAccountListComponent",["component","lang"],function(c,g){return c.extend({})});m("components/SelectableConsumerInvoicingListComponent",["form-component"],function(c){return c});m("components/SelectableConsumerInvoicingListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","jQuery"],function(c,g,f){return c.extend({initialize:function(c,f){this.isConsumerInvoicingOrderTFXEnabaled=f.data.isConsumerInvoicingOrderTFXEnabaled},
poaInstrumentClicked:function(c){this.widget.trigger(g,{instrumentId:c,isConsumerInvoicingOrderTFXEnabaled:this.isConsumerInvoicingOrderTFXEnabaled})},bindToElements:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToElements();else{var c=this;c.getDOMElementsByPrefix("POAInstrumentContainer").click(function(g){f(g.currentTarget).data("disabled")||c.poaInstrumentClicked(c._instrumentId)});c.widget.on("initializeRecommendedInstrument",c,function(f){f.instrumentId!==c._instrumentId||
c.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||(c._poaInstrumentSelected(),c.poaInstrumentClicked(c._instrumentId))})}}})});m("components/CreditCardListItemComponent","events/InstrumentRowSelectedEvent events/CreateSecureFieldEvent events/RemoveSecureFieldEvent events/SubmitSecureFieldDataEvent events/SecureFieldDataReadyEvent SecureFieldValidationEventTriggerType css-utils form-component lang clog aui-helper jQuery keyboard continuable mixins/tfx-currency-mixin AUI!P payment-method-fee-utils".split(" "),
function(c,g,f,h,l,b,e,n,q,a,k,d,m,v,u,D,t){var x,A={pmts_portal_payselect_cc_address_challenge_error_no_match:"-noMatch",pmts_portal_payselect_cc_address_challenge_error_security_code_invalid:"-securityCodeInvalid",pmts_portal_payselect_cc_address_challenge_error_unknown:"-unknown",pmts_portal_payselect_selectedPaymentMethodExpired:"-expirationDateInvalid"},G=["GC","JPPoints","ProductVoucher","PROMO"];return n.extend(u,v,{EXPIRATION_DATE_FIELD_NAME:"expirationDate",CURRENCY_SELECTION_FIELD_NAME:"currencySelection",
CREDIT_CARD_POSTAL_CODE_FIELD_NAME:"postalCode",INSTALLMENT_OPTION_CHANGED_EVENT:"installmentOptionChanged",isExpired:!1,requiresCurrency:!1,isCreditCardVerificationRequired:!1,isCreditCardPostalCodeRequired:!1,hasUpdatedExpired:!1,isEmiMessagingEnabled:!1,showPCIComplianceComponent:!1,isInactiveCupMbcc:!1,orderSummaryFired:!1,acceptanceData:{accepted:!0},isInstallmentsEligible:!0,isAPBSelected:!1,isCardSelected:!1,isAPBWithEMIEnabled:!1,isDownPaymentEnabled:!1,installmentOfferBOs:[],installmentOfferBOsWithAPB:[],
isEMIAvailable:!1,appliedNoCostEMIDiscount:null,isEligibleForFxInstallments:!1,isGiftCardCheckboxSelected:!1,initialSelectedFixupInstrumentId:null,showAuthorizationFailureAlert:!1,shouldDecoupleCardsFromSavedCardsSection:!1,selectedInstrumentId:null,bindTokenisationConsentConfirmationToClick:!0,bindTokenisationConsentRevokedToClick:!0,fixExpiredCardUpdation:!1,isDecoratePayStationBOAndLegacyBOEnabled:!1,isInvalidCVVErrorMessagingEnabled:!1,showSuppressionMessagingUpfront:!1,shouldDisplayNomenclatureWave1Changes:!1,
scrollAfterAddCardEvent:!1,initialize:function(a,b){this._isDesktop="desktop"===a.options.deviceType;this.isExpired=b.data.isExpired;this.isEligibleForTfx=b.data.isEligibleForTfx;this.requiresCurrency=b.data.requiresCurrencySelection;this.isCreditCardVerificationRequired=b.data.isCreditCardVerificationRequired;this.isCreditCardPostalCodeRequired=b.data.isCreditCardPostalCodeRequired;this.cvvFieldName=b.data.cvvFieldName;this.cvvSecureFieldId=b.data.cvvSecureFieldId;this.isPaySelectCvvSecureFieldEnabled=
b.data.isPaySelectCvvSecureFieldEnabled;this.isSecureFieldsEnabledForPrefetch=b.data.isSecureFieldsEnabledForPrefetch;this.externalTokenCustomerConsentFieldName=b.data.externalTokenCustomerConsentFieldName;this.hasFinancialOffer=b.data.hasFinancialOffer;this.hasInstallmentOffer=b.data.hasInstallmentOffer;this.hasVisibleInstallmentOffer=b.data.hasVisibleInstallmentOffer;this.isEmiMessagingEnabled=b.data.isEmiMessagingEnabled;this.showPCIComplianceComponent=b.data.showPCIComplianceComponent;this.isInactiveCupMbcc=
b.data.isInactiveCupMbcc;this.isAddressChallenged=b.data.isAddressChallenged||!1;this.useNewAddressChallengeFormat=b.data.useNewAddressChallengeFormat||!1;this.hasPurchaseFinancingOffer=b.data.hasPurchaseFinancingOffer;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.isDownPaymentEnabled=b.data.isDownPaymentEnabled;this.installmentOfferBOs=b.data.installmentOfferBOs;this.installmentOfferBOsWithAPB=b.data.installmentOfferBOsWithAPB;this.isEMIAvailable=this.installmentOfferBOs!==r&&0!==this.installmentOfferBOs.length||
this.installmentOfferBOsWithAPB!==r&&0!==this.installmentOfferBOsWithAPB.length;this.isPaylastEligible=b.data.isPaylastEligible;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.isEligibleForFxInstallments=b.data.isEligibleForFxInstallments;this.isOwned=b.data.isOwned;this.useUpdatedCardExpirationCx=b.data.useUpdatedCardExpirationCx||!1;this.isEMISuppressed=b.data.isEMISuppressed;this.acceptanceData=
b.data.acceptanceData||{accepted:!0};this.initialSelectedFixupInstrumentId=b.data.initialSelectedFixupInstrumentId;this.showAuthorizationFailureAlert=b.data.showAuthorizationFailureAlert;this.shouldDecoupleCardsFromSavedCardsSection=b.data.shouldDecoupleCardsFromSavedCardsSection;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.isDebitCardDegraded=b.data.isDebitCardDegraded;this.shouldDisplayInlineMsgForMultiTender=b.data.shouldDisplayInlineMsgForMultiTender;
this.shouldDisplayModernizedFrameCX=b.data.shouldDisplayModernizedFrameCX;this._onCreditCardDeselected();this.$consentCheckboxDomElement=this.getDOMElement("externalTokenCustomerConsentCheckbox").find("input[type\x3dcheckbox]").first();e.hideElement(this.getDOMElement("emiMessagingSlot"));this.$explicitConsentBottomsheet=null;this.payStationId=b.data.payStationId;this.isDecoratePayStationBOAndLegacyBOEnabled=b.data.isDecoratePayStationBOAndLegacyBOEnabled;this.isInvalidCVVErrorMessagingEnabled=b.data.isInvalidCVVErrorMessagingEnabled;
this.showSuppressionMessagingUpfront=b.data.showSuppressionMessagingUpfront;this.invalidCvv=this.isPaySelectCvvSecureFieldEnabled&&this.isCreditCardVerificationRequired;this.shouldDisplayNomenclatureWave1Changes=b.data.shouldDisplayNomenclatureWave1Changes;this.isNomenclatureWave2Enabled=b.data.isNomenclatureWave2Enabled;this.scrollAfterAddCardEvent=b.data.scrollAfterAddCardEvent;this.isInlineEMIPlanChangeMessageExperienceEnabled=b.data.isInlineEMIPlanChangeMessageExperienceEnabled;this.paymentMethodFeeData=
b.data.paymentMethodFeeData;this.isConvenienceFeeEnabled=b.data.isConvenienceFeeEnabled;this.scrollAfterAddCardEvent!==r&&!0===this.scrollAfterAddCardEvent&&this.widget.scrollToElementWithCompensation(this.getDOMElement("creditCardContainer-"+this.data.instrumentId))},showTFXCurrencyOptions:function(){this._toggleTFXCurrencyOptionsDisplay(!0)},hideTFXCurrencyOptions:function(){this._toggleTFXCurrencyOptionsDisplay(!1)},showCreditCardPaymentDetail:function(){this._toggleCreditCardPaymentDetailDisplay(!0)},
hideCreditCardPaymentDetail:function(){this._toggleCreditCardPaymentDetailDisplay(!1)},showCreditCardVerification:function(){this._toggleCreditCardVerificationDisplay(!0)},hideCreditCardVerification:function(){this._toggleCreditCardVerificationDisplay(!1)},hideInvalidCvvErrorMessage:function(){this.isInvalidCVVErrorMessagingEnabled&&e.hideElement(this.getDOMElement("invalidCvvErrorMessagingSlot"))},showPaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!0)},hidePaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!1)},
showPageInlineWarningMessage:function(){this._togglePageInlineWarningMessage(!0)},showCreditCardPostalCode:function(){this._toggleCreditCardPostalCodeDisplay(!0)},hideCreditCardPostalCode:function(){this._toggleCreditCardPostalCodeDisplay(!1)},showPCardNumber:function(){this._togglePCardNumberDisplay(!0)},hidePCardNumber:function(){this._togglePCardNumberDisplay(!1)},_getIsOwned:function(){return q.isDefined(this.isOwned)?this.isOwned:!0},_toggleTFXCurrencyOptionsDisplay:function(a){this.data.hasPreferredCurrency&&
e.toggleElement(this.getDOMElement("tfxJSHeader"),!a);e.toggleElement(this.getDOMElement("tfxCurrencyOptions"),a)},showUpdateExpiryDateDropdown:function(){this._toggleUpdateExpiryDateDropdownDisplay(!0)},enableExpiredCreditCardDetail:function(){this.shouldDisplayModernizedFrameCX||(this.getDOMElement("accountHolderName").removeClass("a-color-secondary").addClass("a-color-base"),this.getDOMElement("issuerNumberTail").removeClass("a-color-secondary").addClass("a-color-base"))},disableExpiredCreditCardDetail:function(){this.shouldDisplayModernizedFrameCX||
(this.getDOMElement("accountHolderName").removeClass("a-color-base").addClass("a-color-secondary"),this.getDOMElement("issuerNumberTail").removeClass("a-color-base").addClass("a-color-secondary"))},hideUpdateExpiryDateDropdown:function(){this._toggleUpdateExpiryDateDropdownDisplay(!1)},_toggleEMIAvailableText:function(a){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?e.toggleElement(this.getDOMElement("installmentEMIAvailable"),
!1):e.toggleElement(this.getDOMElement("installmentEMIAvailable"),a)},_changeEMIMessageSpacing:function(a,b){a?this.getDOMElement(b).removeClass("a-spacing-top-mini"):this.getDOMElement(b).addClass("a-spacing-top-mini")},_toggleEMISuppressionText:function(a){e.toggleElement(this.getDOMElement(this.data.JsReferenceEMISuppressionMessage),a);a&&(this._toggleEMIAvailableText(!1),this._toggleEMINotAvailableText(!1),this._toggleNCEAvailableText(!1),this._toggleNCENotAvailableText(!1),e.toggleElement(this.getDOMElement("IBDWithAPB"),
!1),e.toggleElement(this.getDOMElement("IBDWithoutAPB"),!1),e.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1),e.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1),e.toggleElement(this.getDOMElement("IBDv1Message"),!1))},_togglePaymentMethodDegradedText:function(a){e.toggleElement(this.getDOMElement("CCPaymentMethodDegradedText"),a)},_toggleInlinePaymentMessaging:function(a){this.shouldDisplayInlineMsgForMultiTender||e.toggleElement(this.getDOMElement("targetedPaymentMethodInlineMessage"),
a)},_toggleNCEAvailableText:function(a){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?e.toggleElement(this.getDOMElement("installmentNCEAvailable"),!1):e.toggleElement(this.getDOMElement("installmentNCEAvailable"),a)},_toggleEMINotAvailableText:function(a){e.toggleElement(this.getDOMElement("installmentEMINotAvailable"),a);e.toggleElement(this.getDOMElement("installmentEMINotAvailablePopoverContent"),
a)},_toggleNCENotAvailableText:function(a){e.toggleElement(this.getDOMElement("installmentNCENotAvailable"),a)},_toggleInstallmentsNotAvailableText:function(a){e.toggleElement(this.getDOMElement("installmentsNotAvailable"),!this.hasVisibleInstallmentOffer||a)},_toggleNCEAvailableTextWithAPB:function(a){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?e.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),
!1):e.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),a)},_toggleEMIMessage:function(a,b,c){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?e.toggleElement(this.getDOMElement(a),!1):(e.toggleElement(this.getDOMElement(a),b),this.isNomenclatureWave2Enabled||this._changeEMIMessageSpacing(c,a))},displayEMIMessages:function(a){this.isEmiMessagingEnabled&&(this.isAPBSelected?this.isAPBWithEMIEnabled?
this.emiHelpTextOnAPBDeselected(a):this.emiHelpTextOnAPBSelected(a):this.emiHelpTextOnAPBDeselected(a))},emiHelpTextOnAPBSelected:function(a){this._toggleEMIAvailableText(!1);this._toggleEMINotAvailableText(!0);this._toggleNCEAvailableText(!1);this._toggleNCENotAvailableText(!0)},emiHelpTextOnAPBDeselected:function(a){this.shouldDisplayNomenclatureWave1Changes&&!this.isNomenclatureWave2Enabled?this._toggleEMIMessage("installmentEMIAvailable",!0,a):this._toggleEMIAvailableText(!a);this._toggleEMINotAvailableText(!1);
this.displayNCEHelpText(a);this._toggleNCENotAvailableText(!1)},displayNCEHelpText:function(a){this.isAPBWithEMIEnabled&&this.isAPBSelected?this.shouldDisplayNomenclatureWave1Changes?(this._toggleEMIMessage("nceAvailableTextWithAPB",!0,a),this._toggleEMIMessage("installmentNCEAvailable",!1,a)):(this._toggleNCEAvailableTextWithAPB(!0),this._toggleNCEAvailableText(!1)):this.shouldDisplayNomenclatureWave1Changes?(this._toggleEMIMessage("nceAvailableTextWithAPB",!1,a),this._toggleEMIMessage("installmentNCEAvailable",
!0,a)):(this._toggleNCEAvailableTextWithAPB(!1),this._toggleNCEAvailableText(!0))},showInstallmentOffers:function(){this._toggleInstallmentOffers(!0);this.displayEMIMessages(!0)},hideInstallmentOffers:function(){this._toggleInstallmentOffers(!1);this.displayEMIMessages(!1)},_toggleRewardsBalanceAvailableMessage:function(a){e.toggleElement(this.getDOMElement("rewardsBalanceAvailableMessage"),a)},_toggleUpdateExpiryDateDropdownDisplay:function(a){this.useUpdatedCardExpirationCx?e.toggleElement(this.getDOMElement("updateExpiryDateLink"),
!a):(e.toggleElement(this.getDOMElement("updateExpiryDateJSHeader"),!a),e.toggleElement(this.getDOMElement("expiryDate"),!a));e.toggleElement(this.getDOMElement("updateExpiryDate"),a);e.toggleElement(this.getDOMElement("updateExpiryDateDropDown"),a);this.useUpdatedCardExpirationCx&&(e.toggleElement(this.getDOMElement("updateExpiryDateButton"),a),this.isExpired&&!this.hasUpdatedExpired&&this._toggleUpdateExpiryDateButtonDisplay(!1))},_toggleUpdateExpiryDateButtonDisplay:function(a){e.toggleDisabledElement(this.getDOMElement("updateExpiryDateButton"),
a)},_toggleCreditCardPaymentDetailDisplay:function(a){e.toggleElement(this.getDOMElement("creditCardPaymentDetail"),a)},_toggleCreditCardVerificationDisplay:function(a){e.toggleElement(this.getDOMElement("creditCardVerification"),a)},_togglePaymentMethodInlineMessage:function(a){e.toggleElement(this.getDOMElement("paymentMethodInlineMessage"),a)},_togglePageInlineWarningMessage:function(a){e.toggleElement(this.getDOMElement("pageInlineWarningMessage"),a)},_toggleCreditCardPostalCodeDisplay:function(a){e.toggleElement(this.getDOMElement("creditCardPostalCode"),
a)},_togglePCardNumberDisplay:function(a){e.toggleElement(this.getDOMElement("pcardNumberField"),a)},_togglePCIComplianceComponentDisplay:function(a){e.toggleElement(this.getDOMElement("pciComponentContainer"),a)},_toggleExternalTokenCustomerConsentSection:function(a){e.toggleElement(this.getDOMElement("externalTokenCustomerConsentSection"),a)},_toggleCardTokenAboutToExpireMessageSection:function(a){e.toggleElement(this.getDOMElement("externalTokenAboutToExpireMessageSection"),a)},_toggleCardTokenExpiredMessageSection:function(a){e.toggleElement(this.getDOMElement("externalTokenExpiredMessageSection"),
a)},_toggleInstallmentOffers:function(a){this._toggleInstallmentsAvailableMessage(a);e.toggleElement(this.getDOMElement("installmentSelections"),a);e.toggleElement(this.getDOMElement("installmentsItemIneligible"),a)},_toggleInstallmentsAvailableMessage:function(a){a=this.isEligibleForFxInstallments?this.isGiftCardCheckboxSelected:a;a=this.isInstallmentsEligible&&!this.isAddressChallenged&&!a;e.toggleElement(this.getDOMElement("installmentsAvailable"),a)},_toggleInstallmentActivationExpander:function(a){e.toggleElement(this.getDOMElement("creditCardInstallmentActivationExpander"),
a)},_toggleFinancialOffers:function(a){this.hasFinancialOffer&&this.widget.trigger("toggleFinancialOffer",{instrumentId:this.data.instrumentId,isSelected:a,isAddressChallenged:this.isAddressChallenged})},_togglePurchaseFinancingOffers:function(a){this.hasPurchaseFinancingOffer&&this.widget.trigger("togglePurchaseFinancingOffers",{instrumentId:this.data.instrumentId,isSelected:a})},_togglePaymentMethodFeeSection:function(a){this.isConvenienceFeeEnabled&&e.toggleElement(this.getDOMElement("ccPaymentMethodFeeSection"),
a)},_updateAndTogglePaymentMethodFeeSection:function(){if(this.isConvenienceFeeEnabled)try{var b=t.getFeeApplied(this.paymentMethodFeeData,"Card");null!==b&&null!==b.valueToken?(this.getDOMElement("ccPaymentMethodFeeString")[0].innerHTML=this.widget.getLocalizedString("pmts_portal_pay_select_convenience_fee_content",{fee_amount:b.valueToken}),this._togglePaymentMethodFeeSection(!0)):this._togglePaymentMethodFeeSection(!1)}catch(w){console.log(w),a.logCounterMetric({feature:"CardUpdatePaymentMethodFeeException",
resource:"_Count"}),this._togglePaymentMethodFeeSection(!1)}},_getCreditCardRow:function(a){return this.getDOMElement("creditCardContainer-"+a)},_triggerInstrumentRowSelectedEvent:function(a,b,d){this.widget.trigger(c,{instrumentId:a,isRecurringChargePaymentMethod:b,paymentMethod:"CC",isInstrumentOwned:d})},_instrumentRowSelected:function(a){d(this.getDOMElement("instrumentRowSelection-"+a)).prop("checked",!0);var b=this._getCreditCardRow(a);this.showAuthorizationFailureAlert&&this.initialSelectedFixupInstrumentId===
a?b.addClass("pmts-fixup-selected"):b.addClass("pmts-selected");this._triggerCreditCardRowSelectedEvent(a);this._createSecureFieldFrame(a)},_instrumentRowDeselected:function(){this._deselectingInstrument();this._onCreditCardDeselected()},_createSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(g,{secureFieldId:"secureFieldsCVV-"+a})},_removeSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(f,{secureFieldId:"secureFieldsCVV-"+
a})},_confirmButtonClicked:function(a){this.isCardSelected&&this.widget.trigger("confirmButtonClicked",{instrumentId:this.data.instrumentId})},_triggerCreditCardRowSelectedEvent:function(a,b){var c=this.getDOMElement("instrumentRowSelection-"+a).val();e.showElement(d(this.getDOMElement("creditCardInstallmentActivationRetryExceededAlert-"+a)));this.widget.trigger("creditCardRowSelected",{instrumentId:a,instrumentSelectionValue:c,isInstrumentOwned:b})},_deselectingInstrument:function(){this._removeSecureFieldFrame(this.data.instrumentId);
this.getDOMElement("instrumentRowSelection-"+this.data.instrumentId).prop("checked",!1);var a=this._getCreditCardRow(this.data.instrumentId);a.removeClass("pmts-selected");this.showAuthorizationFailureAlert&&a.removeClass("pmts-fixup-selected");e.hideElement(this.getDOMElementsByPrefix("addressChallengeMessages-"));e.hideElement(this.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-"));e.hideElement(this.getDOMElementsByPrefix("addressChallengeScan-"));e.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationExpander-"));
e.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationRetryExceededAlert-"));e.hideElement(this.getDOMElementsByPrefix("inactiveMbccMessages-"))},_creditCardRowClicked:function(b){var c=d(b.currentTarget);b=c.data("instrument-id");var e=c.data("co-brand"),k=c.data("disabled"),f=c.data("is-owned");c=c.data("is-recurring-charge");"AmazonVisaSignature"===e&&a.logCounterMetric({feature:"selected-cbcc",resource:"_Count"});"AmazonVisaSignature"===x&&"AmazonVisaSignature"!==e&&a.logCounterMetric({feature:"deselected-cbcc",
resource:"_Count"});x=e;k||!b||this.isCardSelected||this._triggerInstrumentRowSelectedEvent(b,c,f)},_showAddressChallengeErrors:function(a){var b=this;0<a.errorMessages.length&&(q.forEach(a.errorMessages,function(c){e.showElement(b.getDOMElement(b._getJsRefForErrorMessage(a.instrumentId,c)))}),e.showElement(b.getDOMElement("addressChallengeErrors-"+a.instrumentId)))},_getJsRefForErrorMessage:function(a,b){b=A[b.messageStringId];"undefined"===typeof b&&(b="-unknown");return"addressChallengeError-"+
a+b},_selectConsentCheckbox:function(){this.form.getAUITagHelperForParameter(this.externalTokenCustomerConsentFieldName).getControlElement().val(!0);this.$consentCheckboxDomElement.prop("checked",!0);this.updateContinueButton()},_deselectConsentCheckbox:function(){this.form.getAUITagHelperForParameter(this.externalTokenCustomerConsentFieldName).getControlElement().val(!1);this.$consentCheckboxDomElement.prop("checked",!1);this.updateContinueButton()},_showConsentConfirmationPopover:function(){this.getDOMElement("apx-customer-tokenization-consent-confirmation-bottomsheet").length&&
this.getDOMElement("apx-customer-tokenization-consent-confirmation-bottomsheet").click();this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").length&&this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").click();this.$explicitConsentBottomsheet=this.getDOMElement("apx-customer-tokenization-consent-confirmation-bottomsheet")},_hideConsentConfirmationBottomSheet:function(){var a=this;D.when("a-sheet").execute("consent-sheet-events",function(b){b&&(b=b.get("apx-customer-tokenization-consent-confirmation-bottomsheet"+
a.data.instrumentId))&&b.hide()})},_hideConsentConfirmationModal:function(){var a=this;D.when("a-modal").execute("consent-modal-events",function(b){b?(b=b.get("apx-customer-tokenization-consent-confirmation-popover"+a.data.instrumentId))&&b.hide():a.tokenizationConsentPopoverReference&&(b=d(a.tokenizationConsentPopoverReference.find("button[data-action]\x3da-popover-close")[0]))&&b.trigger("click")})},_onTokenisationConsentApprovedButtonClick:function(a){this._selectConsentCheckbox();this.$explicitConsentBottomsheet.length&&
this._hideConsentConfirmationBottomSheet();this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").length&&this._hideConsentConfirmationModal();this.widget.trigger("ConsentPopoverContinueButtonClicked");a.stopPropagation()},_onTokenisationConsentRevokedButtonClick:function(a){this._deselectConsentCheckbox();this.$explicitConsentBottomsheet.length&&this._hideConsentConfirmationBottomSheet();this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").length&&this._hideConsentConfirmationModal();
this.widget.trigger("ConsentPopoverContinueButtonClicked");a.stopPropagation()},_bindClickEventsToTokenisationConsentButtons:function(a,b,c){a.bindTokenisationConsentConfirmationToClick&&(d(b).bind("click",function(b){a._onTokenisationConsentApprovedButtonClick(b)}),a.bindTokenisationConsentConfirmationToClick=!1);a.bindTokenisationConsentRevokedToClick&&(d(c).bind("click",function(b){a._onTokenisationConsentRevokedButtonClick(b)}),a.bindTokenisationConsentRevokedToClick=!1)},bindToElements:function(){var b=
this;this._isDesktop?(b.getDOMElement("CVVHelpMessageLink").mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CVVHelpMessagePopover",ActionValueType:"Mouseover"})}),b.getDOMElement("CardRecommendationMessageLink").mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CardRecommendationMessagePopover",ActionValueType:"Mouseover"})}),b.getDOMElement("CBCCRecommendationMessageLink").mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CBCCCardRecommendationMessagePopover",
ActionValueType:"Mouseover"})})):(b.getDOMElement("CVVHelpMessageLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CVVHelpMessagePopover",ActionValueType:"Click"})}),b.getDOMElement("CardRecommendationMessageLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CardRecommendationMessagePopover",ActionValueType:"Click"})}),b.getDOMElement("CBCCRecommendationMessageLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CBCCCardRecommendationMessagePopover",
ActionValueType:"Click"})}));b.getDOMElement("CardSuppressionMessageLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"CardSuppressionMessagePopover",ActionValueType:"Click"})});var c=b.form.fields.currencySelection,e=b.form.fields.expirationDate;b.getDOMElement("updateExpiryDateButton").click(function(a){b.widget.trigger("RemoveSetPaymentPlanSelectContinueEvent")});b.getDOMElement("tfxShowCurrencyOptionsLink").click(function(a){b.showTFXCurrencyOptions();b.triggerInstrumentRowSelectedEvent();
b.form.getAUITagHelperForParameter(c.radioButtonName).isChecked()&&b.disableTFXCurrencyDropdown();a.preventDefault()});b.isPaySelectCvvSecureFieldEnabled||b.getDOMElement("creditCardVerification").keypress(function(a){a.which===m.keys.VK_RETURN&&(a.preventDefault(),b.checkCreditCardVerificationCode(),q.isDefined(b.getErrorStringId())?b.updateContinueButton():b.widget.trigger("ContinueButtonClicked"))});b.getDOMElement("creditCardVerification").click(function(a){b.widget.publishSuccessSushiMetrics({ActionType:"CreditCardVerificationEvent",
ActionValueType:"Click",ActionValue:"CreditCardVerificationBoxClicked",ActionParentValueType:"PaymentInstrument",ActionParentValue:b.data.instrumentId})});b.getDOMElement("tfxPreferredCurrency").click(function(a){!1===b.isEligibleForFxInstallments&&(b.updateTFXCurrencyHeader(b.form.getAUITagHelperForParameter(c.radioButtonName).val()),b.disableTFXCurrencyDropdown());b.widget.trigger("tfxPreferredCurrencySelected",{instrumentId:b.data.instrumentId})});b.getDOMElement("tfxSelectCurrency").click(function(a){!1===
b.isEligibleForFxInstallments&&(a.preventDefault(),a=b.form.getAUITagHelperForParameter(b.form.fields.currencySelection.dropdownName).isEnabled(),b.requiresCurrency||!a)&&(b.enableTFXCurrencyDropdown(),p.setTimeout(function(){b.form.getAUITagHelperForParameter(c.dropdownName).getControlElement().trigger("change")},100));b.widget.trigger("tfxSelectCurrencySelected",{instrumentId:b.data.instrumentId})});b.getDOMElement("apx-card-token-expired-update-button").click(function(c){c={"ppw-widgetEvent":"DeleteExpiredCardTokenInstrumentEvent",
"ppw-widgetState":b.widget.options.serializedState,"ppw-instrumentId":b.data.instrumentId,"ppw-payStationId":b.payStationId};b.isCardInstrumentDeleted=!0;b.updateContinueButton();b.widget.continueRequest(c,{success:function(){a.logCounterMetric({feature:"DeleteExpiredCardTokenInstrumentEventSuccess",resource:"_Count"})},error:function(){a.logCounterMetric({feature:"DeleteExpiredCardTokenInstrumentEventFailure",resource:"_Count"})},complete:function(){a.publishMetrics()}});b.widget.trigger("triggerAddCardFlow");
return!1});b.getDOMElement("updateExpiryDateLink").click(function(a){b.isExpired&&b.useUpdatedCardExpirationCx&&b.enableExpiredCreditCardDetail();b.useNewAddressChallengeFormat&&b.isAddressChallenged||b.showUpdateExpiryDateDropdown();b.triggerInstrumentRowSelectedEvent();b.hidePCardNumber();a.preventDefault()});var k=q.bind(b.checkExpirationDate,b);b.form.bindToParameter(e.monthParameterName,"change",k);b.form.bindToParameter(e.yearParameterName,"change",k);b.form.bindToParameter(c.radioButtonName,
"change",q.bind(b.checkCurrencySelection,b));b.form.bindToParameter(c.dropdownName,"change",function(a){b.form.getAUITagHelperForParameter(c.radioButtonName).getControlElement().filter("[value\x3d]").prop("checked",!0);b.updateTFXCurrencyHeader();b.checkCurrencySelection()});this.isCreditCardVerificationRequired&&!this.isPaySelectCvvSecureFieldEnabled&&d(this.getDOMElement(this.cvvFieldName)).bind("input",function(){b.checkCreditCardVerificationCode();b.updateContinueButton()});this.$consentCheckboxDomElement.length&&
d(this.$consentCheckboxDomElement).bind("click",function(a){b.$consentCheckboxDomElement.prop("checked")?b._selectConsentCheckbox():b._deselectConsentCheckbox();a.stopPropagation()});D.when("A","a-sheet","ready").execute(function(a){a.on("a:sheet:beforeShow:apx-customer-tokenization-consent-confirmation-bottomsheet"+b.data.instrumentId,function(){var a=b.getDOMElement("apx-tokenization-consent-approved-button"),c=b.getDOMElement("apx-tokenization-consent-revoked-button");b._bindClickEventsToTokenisationConsentButtons(b,
a,c)})});D.when("A","a-modal","ready").execute(function(a){a.on("a:popover:beforeShow:apx-customer-tokenization-consent-confirmation-popover"+b.data.instrumentId,function(a){a.popover&&(b.tokenizationConsentPopoverReference=a.popover.$popover);a=b.getDOMElement("apx-tokenization-consent-approved-button");var c=b.getDOMElement("apx-tokenization-consent-revoked-button");b._bindClickEventsToTokenisationConsentButtons(b,a,c)})});this.isCreditCardPostalCodeRequired&&d(this.getDOMElement(this.data.instrumentId+
"_postalCode")).bind("input",function(){b.checkCreditCardPostalCode();b.updateContinueButton()});b.shouldDecoupleCardsFromSavedCardsSection&&(b.getDOMElementsByPrefix("creditCardContainer-").click(q.bind(this._creditCardRowClicked,this)),b.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-").click(q.bind(this._confirmButtonClicked,this)),b.getDOMElementsByPrefix("installmentActivationMobileConfirmButtons-").click(q.bind(this._confirmButtonClicked,this)));u.bindToElements.apply(this)},bindToEvents:function(){var b=
this;b.widget.on("initializeRecommendedInstrument",b,function(a){if(a.instrumentId===b.data.instrumentId||b.isDecoratePayStationBOAndLegacyBOEnabled&&a.instrumentId===b.payStationId)if(this.isCardSelected=!0,this.orderSummaryFired=!1,b.shouldDecoupleCardsFromSavedCardsSection){b.showAuthorizationFailureAlert&&!b.initialSelectedFixupInstrumentId&&(b.initialSelectedFixupInstrumentId=b.data.instrumentId);var c=b._getCreditCardRow(b.data.instrumentId);null!==c&&1===c.length&&null!==c[0].attributes&&(a=
"true"===c[0].attributes.getNamedItem("data-is-recurring-charge").value,c=this.isABCrossCustomerMultiTenderSuppressionEnabled&&null!==c[0].attributes.getNamedItem("data-is-owned")&&"false"===c[0].attributes.getNamedItem("data-is-owned").value?!1:!0,b._triggerInstrumentRowSelectedEvent(b.data.instrumentId,a,c))}else b._onCreditCardSelected();else this.isCardSelected=!1,b._onCreditCardDeselected()});if(this.isDynamicOrderSummaryEnabled)b.widget.on("componentsInitialized",b,function(){var a=document.getElementsByName("ppw-"+
b.data.instrumentId+"_instrumentOrderTotalBalance")[0];a&&(a.value=JSON.stringify({}));b._updateOrderTotalHiddenInputForPaymentMethodFee(b.data.instrumentId)});b.widget.on("DisplayConsentPopover"+b.data.instrumentId,b,function(a){b._showConsentConfirmationPopover()});b.widget.on("validateConsentCheckBoxStatus"+b.data.instrumentId,b,function(a){a=!0;b.$consentCheckboxDomElement.length&&(a=b.$consentCheckboxDomElement.prop("checked"));this.widget.trigger("updateConsentCheckBoxStatus",{consentCheckBoxStatus:a,
isCardSelected:this.isCardSelected})});b.widget.on("creditCardRowSelected",b,function(a){a.instrumentId===b.data.instrumentId?(this.isCardSelected=!0,this.orderSummaryFired=!1,b._onCreditCardSelected()):(this.isCardSelected=!1,b._onCreditCardDeselected())});b.widget.on(c,b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&(b.data.instrumentId===a.instrumentId?(this.isCardSelected=!0,b._instrumentRowSelected(a.instrumentId)):(this.isCardSelected=!1,b._instrumentRowDeselected()))});b.widget.on("resetSelectedPaymentMethod",
b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&b.isCardSelected&&(this._deselectingInstrument(b.data.instrumentId),b.isCardSelected=!1,this.setContinuable(!1),a=a.isInstallmentPlansAvailable?b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"):b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message"),b.isInlineEMIPlanChangeMessageExperienceEnabled?this.widget.trigger("PaymentPlanSelected",{isValid:!1,
message:b.widget.getLocalizedString("apx_select_payment_method_to_continue")}):this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:a}),this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:a}))});b.widget.on("showInstallmentActivation",b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&a.instrumentId===b.data.instrumentId&&e.showElement(b.getDOMElement("creditCardInstallmentActivationExpander-"+a.instrumentId))});b.widget.on("APBPreselected",b,function(a){b._onCreditCardDeselected()});
b.widget.on("showAddressChallenge",b,function(a){a.instrumentId===b.data.instrumentId&&(this.useNewAddressChallengeFormat||b.hideCreditCardPaymentDetail(),b._toggleRewardsBalanceAvailableMessage(!1),b.setAddressChallenged(!0),b._toggleFinancialOffers(!0),b._togglePurchaseFinancingOffers(!0),b.shouldDecoupleCardsFromSavedCardsSection&&(e.showElement(b.getDOMElement("addressChallengeMessages-"+a.instrumentId)),e.showElement(b.getDOMElement("addressChallengeMobileConfirmButtons-"+a.instrumentId)),e.showElement(b.getDOMElement("addressChallengeScan-"+
a.instrumentId))))});b.widget.on("showAddressChallengeErrors",b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&a.instrumentId===b.data.instrumentId&&b._showAddressChallengeErrors(a)});b.widget.on("hideAddressChallengeErrors",b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&a.instrumentId===b.data.instrumentId&&(e.hideElement(b.getDOMElementsByPrefix("addressChallengeError-"+a.instrumentId)),e.hideElement(b.getDOMElement("addressChallengeErrors-"+a.instrumentId)))});b.widget.on("addressChallengePassed",
b,function(a){a.instrumentId===b.data.instrumentId&&(b.shouldDecoupleCardsFromSavedCardsSection&&(e.hideElement(b.getDOMElement("addressChallengeMessages-"+a.instrumentId)),e.hideElement(b.getDOMElement("addressChallengeMobileConfirmButtons-"+a.instrumentId)),e.hideElement(b.getDOMElement("addressChallengeScan-"+a.instrumentId))),b.showCreditCardPaymentDetail(),b.hideUpdateExpiryDateDropdown(),b.showPCardNumber(),e.toggleElement(this.getDOMElement("tfxCurrencyDetails"),!0),e.toggleElement(this.getDOMElement("rewardsAccountDetails"),
!0),b._toggleRewardsBalanceAvailableMessage(!1),b.setAddressChallenged(!1),b.data.childRewardsAccountInstrumentId&&b.checkRewardsAccountSelection(),b.updateContinueButton(),b._toggleFinancialOffers(!0),b._togglePurchaseFinancingOffers(!0),b.showInstallmentOffers())});b.widget.on("addressChallengeValidate",b,function(a){if(a.instrumentId===b.data.instrumentId){a=[];var c=this.form.fields.expirationDate,d=this.EXPIRATION_DATE_FIELD_NAME;b.data.isExpired&&(b.form.clearValidationErrors(),a=this._validateFormField(d),
0<a.length&&(q.forEach(a,function(a){b.form.blameFormField(a.field,!0)}),b.widget.trigger("showAddressChallengeErrors",{instrumentId:b.data.instrumentId,errorMessages:a})));b.widget.trigger("expirationDateValidated",{instrumentId:b.data.instrumentId,isExpirationDateValid:0===a.length,expMonth:b.form.getFormValues()[c.monthParameterName],expYear:b.form.getFormValues()[c.yearParameterName]})}});b.widget.on("creditCardUpdated",b,function(a){if(a.instrumentId===b.data.instrumentId){var c=a.newExpMonth;
a=a.newExpYear;b.getDOMElement("expiryDate").text(b.makeExpirationDateString(c,a));e.hideElement(b.getDOMElement("updateExpiryDateLink"))}});b.widget.on("installmentsEligibilityChanged",b,function(a){b.isInstallmentsEligible=a.isEligible;this._toggleInstallmentOffers(this.isCardSelected)});if(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)b.widget.on("UpdateOrderTotalForNoCostEMIDiscount",b,function(a){b.appliedNoCostEMIDiscount=a&&0<a.noCostEMIValue?parseFloat(a.noCostEMIValue):
0});b.widget.on("apbSelectionChanged",b,function(a){this.isAPBSelected=a.isSelected;if(this.isCardSelected){if(b.orderSummaryFired=!1,b._onCreditCardSelected(),b.shouldDecoupleCardsFromSavedCardsSection){var c=b._getCreditCardRow(b.data.instrumentId).hasClass("pmts-selected");b.widget.get("apbCheckboxSelected")!==r&&c&&this.widget.trigger("toggleInstallmentDropDown",{isAPBSelected:a.isSelected,instrumentId:b.data.instrumentId})}}else b._onCreditCardDeselected();if(this.isAPBWithEMIEnabled){a="";c=
!1;var d=b.getDOMElement("emiMessagingSlot");e.hideElement(d);this.shouldDecoupleCardsFromSavedCardsSection&&this.isCardSelected&&this.widget.trigger("apbSelectionChangedForAPBWithEMIFeature",{selectedInstrumentId:b.data.instrumentId});this.isAPBSelected?0===this.installmentOfferBOsWithAPB.length&&(c=!0,a=b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message")):0===this.installmentOfferBOs.length&&(c=!0,a=b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_to_view_emi_options_message"));
this.isEMIAvailable&&c&&(this._toggleEMIAvailableText(!1),this._toggleNCEAvailableText(!1),this._toggleNCEAvailableTextWithAPB(!1),"undefined"!==typeof d[0]&&(this.shouldDisplayNomenclatureWave1Changes&&"undefined"!==d[0].getElementsByClassName("a-size-small")[0]?d[0].getElementsByClassName("a-size-small")[0].textContent=a:"undefined"!==d[0].getElementsByClassName("a-alert-content")[0]&&(d[0].getElementsByClassName("a-alert-content")[0].textContent=a)),e.showElement(d))}});b.widget.on("balanceSelectionChanged",
b,function(a){if(this.isCardSelected&&this.data.skipFormValidation){if(b.shouldDecoupleCardsFromSavedCardsSection){var c=0<=q.indexOf(G,a.paymentMethod);this.isABCrossCustomerMultiTenderSuppressionEnabled&&c&&!a.isBackingInstrument&&a.isSelected&&this._updateBackingInstrumentState(a)}this.updateContinueButton()}});b.widget.on("resetSelectedPaymentMethod",b,function(a){b._onCreditCardDeselected()});b.widget.on("installmentsAvailabilityChanged",b,function(a){this._toggleInstallmentsNotAvailableText(!a.isInstallmentsAvailable)});
b.widget.on("installmentOptionChanged",b,function(a){this.data.skipFormValidation&&this.isCardSelected&&this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:this._shouldFetchOrderSummary(),fetchOSTriggeredByViewDetails:!1})});b.widget.on("optionalInstrumentSelected",b,function(a){"GC"===a.paymentMethod&&b._toggleInlinePaymentMessaging(!1);b.isEligibleForFxInstallments&&"GC"===a.paymentMethod&&(b.isGiftCardCheckboxSelected=!0,b._toggleInstallmentsAvailableMessage())});b.widget.on("optionalInstrumentDeselected",
b,function(a){"GC"===a.paymentMethod&&b._toggleInlinePaymentMessaging(!0);b.isEligibleForFxInstallments&&"GC"===a.paymentMethod&&(b.isGiftCardCheckboxSelected=!1,b._toggleInstallmentsAvailableMessage())});b.widget.on("inactiveMbccSelected",b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&a.instrumentId===b.data.instrumentId&&e.showElement(b.getDOMElementsByPrefix("inactiveMbccMessages-"+a.instrumentId))});b.widget.on("SecureFieldValidationEvent",b,function(a){b.updateCvvValidationState(a.fieldId,
a.fieldIsValid,a.triggerType)});if(b.isSecureFieldsEnabledForPrefetch)b.widget.on(l,b,function(b){b.contextId!==this.cvvSecureFieldId||this.invalidCvv||(a.logCounterMetric({feature:"SecureFieldsPaySelectCVVPrefetchReady",resource:"_Count"}),this.updateContinueButton())});b.widget.on("ContinueButtonClickedWithInvalidPaymentPlanEvent",b,function(a){this.isInvalidCVVErrorMessagingEnabled&&this.isCardSelected&&a.message===b.widget.getLocalizedString("pmts_portal_add_instrument_credit_card_error_security_code_invalid")&&
e.showElement(b.getDOMElement("invalidCvvErrorMessagingSlot"))});u.bindToEvents.apply(this)},_updateBackingInstrumentState:function(a){var b=this._getCreditCardRow(this.data.instrumentId);a=!1!==a.isInstrumentOwned;var d=!1!==b.data("is-owned");b.hasClass("pmts-selected")&&d!==a&&(this._deselectingInstrument(b.data("instrument-id")),this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},_onCreditCardSelected:function(){var a=this;this.data.hasPreferredCurrency&&!this.data.isEligibleForFxInstallments||
this.showTFXCurrencyOptions();this.showPCIComplianceComponent?this._togglePCIComplianceComponentDisplay(!0):(this.isAddressChallenged?(this.hidePCardNumber(),this.hideInstallmentOffers(),this.data.expiryDateSelectionDisplayed&&(this.useNewAddressChallengeFormat?(this.useUpdatedCardExpirationCx?e.toggleElement(this.getDOMElement("updateExpiryDateLink"),!1):e.toggleElement(this.getDOMElement("updateExpiryDateJSHeader"),!1),e.toggleElement(this.getDOMElement("expiryDate"),!0)):this.showUpdateExpiryDateDropdown()),
this._triggerInstallmentOptionDeselected()):(this.data.childRewardsAccountInstrumentId&&this.checkRewardsAccountSelection(),this.showPCardNumber(),this.showInstallmentOffers(),this.hasInstallmentOffer||this._triggerInstallmentOptionDeselected()),this.isCreditCardVerificationRequired&&(this.showCreditCardVerification(),this.checkCreditCardVerificationCode()),this.isCreditCardPostalCodeRequired&&(this.showCreditCardPostalCode(),this.checkCreditCardPostalCode()),!this.isExpired&&this.hasUpdatedExpired&&
this.showUpdateExpiryDateDropdown(),this.isExpired&&this._triggerInstallmentOptionDeselected());this.isInactiveCupMbcc&&this._triggerInactiveMbccSelectedEvent();this.data.isSuppressed&&e.showElement(this.getDOMElement(this.data.JsReferenceSavedCardsSuppressionMessage));this.updateContinueButton();this.hideInvalidCvvErrorMessage();this._toggleFinancialOffers(!0);this._togglePurchaseFinancingOffers(!0);this._toggleInstallmentActivationExpander(!0);(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&
p.setTimeout(function(){a.getDOMElement("installmentSelections")[0]&&a.getDOMElement("installmentSelections")[0].innerText&&-1!==a.getDOMElement("installmentSelections")[0].innerText.indexOf("No Cost")?a.widget.trigger("GetNoCostEMISelectionDiscountValue",{instrumentId:a.data.instrumentId}):a.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},0);this.isEMISuppressed&&this._toggleEMISuppressionText(!0);this.isDebitCardDegraded&&this._togglePaymentMethodDegradedText(!0);this.getDOMElement("paymentMethodInlineMessage")[0]&&
this.showPaymentMethodInlineMessage();this.getDOMElement("pageInlineWarningMessage")[0]&&this.showPageInlineWarningMessage();this._toggleExternalTokenCustomerConsentSection(!0);this._toggleCardTokenAboutToExpireMessageSection(!0);this._toggleCardTokenExpiredMessageSection(!1);this.widget.trigger("UpdateSelectedCardData",{instrumentId:this.data.instrumentId});this._updateAndTogglePaymentMethodFeeSection();this.isNomenclatureWave2Enabled&&(this.getDOMElement("cardTitleSlotDecorationContentJsBinding").removeClass("pmts-ellipsis-nomenclature"),
this.getDOMElement("installmentEMIAvailable").addClass("hide-element"),this.getDOMElement("nceAvailableTextWithAPB").removeClass("yellow-text-box"),this.getDOMElement("installmentNCEAvailable").removeClass("yellow-text-box"),this.getDOMElement("installmentEMIAvailableRowJsBinding").removeClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIAvailableRowJsBinding").removeClass("a-spacing-top-mini"),
this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("pmts-ncemi-row-height-when-unselected"))},_onCreditCardDeselected:function(){this.isNomenclatureWave2Enabled&&(this.isAPBSelected?(this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("pmts-ncemi-row-height-when-unselected"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").addClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIAvailableRowJsBinding").removeClass("a-spacing-top-mini")):
(this.getDOMElement("installmentNCEMIAvailableRowJsBinding").addClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").addClass("pmts-ncemi-row-height-when-unselected")),this.getDOMElement("installmentEMIAvailableRowJsBinding").addClass("a-spacing-top-mini"),this.getDOMElement("cardTitleSlotDecorationContentJsBinding").addClass("pmts-ellipsis-nomenclature"),
this.getDOMElement("installmentEMIAvailable").removeClass("hide-element"),this.getDOMElement("nceAvailableTextWithAPB").addClass("yellow-text-box"),this.getDOMElement("installmentNCEAvailable").addClass("yellow-text-box"));this.hideTFXCurrencyOptions();this.showCreditCardPaymentDetail();this.data.expiryDateSelectionDisplayed&&this.hideUpdateExpiryDateDropdown();this.isExpired&&this.useUpdatedCardExpirationCx&&this.disableExpiredCreditCardDetail();this.hideCreditCardVerification();this.hideInvalidCvvErrorMessage();
this.hideCreditCardPostalCode();this._onRewardsAccountDeselected();this.hidePCardNumber();this.isCardSelected=!1;this.hideInstallmentOffers();this._toggleFinancialOffers(!1);this._togglePurchaseFinancingOffers(!1);this._toggleInstallmentActivationExpander(!1);this._togglePCIComplianceComponentDisplay(!1);this.data.showSuppressionMessagingUpfront?e.showElement(this.getDOMElement(this.data.JsReferenceSavedCardsSuppressionMessage)):e.hideElement(this.getDOMElement(this.data.JsReferenceSavedCardsSuppressionMessage));
this._toggleEMISuppressionText(!1);this.isDebitCardDegraded&&this._togglePaymentMethodDegradedText(!1);this.getDOMElement("paymentMethodInlineMessage")[0]&&this.hidePaymentMethodInlineMessage();this.getDOMElement("pageInlineWarningMessage")[0]&&this.showPageInlineWarningMessage();this._toggleExternalTokenCustomerConsentSection(!1);this._toggleCardTokenAboutToExpireMessageSection(!1);this._toggleCardTokenExpiredMessageSection(!0);this._togglePaymentMethodFeeSection(!1)},checkRewardsAccountSelection:function(){this.isExpired||
(this.widget.trigger("rewardsAccountSelected",{instrumentId:this.data.childRewardsAccountInstrumentId}),this._toggleRewardsBalanceAvailableMessage(!1))},_onRewardsAccountDeselected:function(){this.data.childRewardsAccountInstrumentId&&(this.widget.trigger("rewardsAccountDeselected",{instrumentId:this.data.childRewardsAccountInstrumentId}),this._toggleRewardsBalanceAvailableMessage(!0))},triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.data.instrumentId,paymentMethod:"CC",
isInstrumentOwned:this._getIsOwned()})},checkExpirationDate:function(){this.setExpired(0<this._validateFormField(this.EXPIRATION_DATE_FIELD_NAME).length)},setExpired:function(a){this.useUpdatedCardExpirationCx?(this._toggleUpdateExpiryDateButtonDisplay(!a),this.hasUpdatedExpired=!a,this.data.childRewardsAccountInstrumentId&&this.checkRewardsAccountSelection()):(this.isExpired=a,this.data.childRewardsAccountInstrumentId&&this.checkRewardsAccountSelection(),this.hasUpdatedExpired=!a,this.updateContinueButton())},
checkCurrencySelection:function(){this.setRequiresCurrency(0<this._validateFormField(this.CURRENCY_SELECTION_FIELD_NAME).length)},enableTFXCurrencyDropdown:function(){this._toggleTFXCurrencyOptionsDropdown(!1)},disableTFXCurrencyDropdown:function(){this._toggleTFXCurrencyOptionsDropdown(!0)},_toggleTFXCurrencyOptionsDropdown:function(a){this.form.getAUITagHelperForParameter(this.form.fields.currencySelection.dropdownName).toggleDisabled(a)},updateTFXCurrencyHeader:function(a){var b=this.form.fields.currencySelection;
0===arguments.length&&(a=this.form.getFormValues()[b.dropdownName]);if(a){b=this.getSelectTextUsingValue(a);var c=this.getDOMElement("tfxJSHeader").find("[class\x3d'pmts-tfx-preselected-currency-code']");b&&0!==c.length&&(c[0].innerHTML=b)}},getSelectTextUsingValue:function(a){return this.form.getAUITagHelperForParameter(this.form.fields.currencySelection.dropdownName).getOptionTextForValue(a)},setRequiresCurrency:function(a){this.requiresCurrency=a;this.updateContinueButton()},setAddressChallenged:function(a){this.isAddressChallenged=
a},checkCreditCardVerificationCode:function(){this.showPCIComplianceComponent||this.isPaySelectCvvSecureFieldEnabled||(this.invalidCvv=0<this._validateFormField(this.cvvFieldName).length)},updateCvvValidationState:function(a,c,d){a!==this.cvvSecureFieldId||this.showPCIComplianceComponent||(this.invalidCvv=!c,!this.isSecureFieldsEnabledForPrefetch||this.invalidCvv?d!==b.Removal&&this.updateContinueButton():this.widget.trigger(h,{contextId:a}))},checkCreditCardPostalCode:function(){this.invalidPostalCode=
0<this._validateFormField(this.CREDIT_CARD_POSTAL_CODE_FIELD_NAME).length},_validateFormField:function(a){return q.filter(this.form.validateForm(),function(b){return b.field===a})},updateContinueButton:function(){var a=this.getErrorStringId();a=a?this.widget.getLocalizedString(a):null;this._triggerBackingInstrumentSelectedEvent(a);this.data.skipFormValidation&&!this.orderSummaryFired&&(this.orderSummaryFired=!0,this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:this._shouldFetchOrderSummary(),
fetchOSTriggeredByViewDetails:!1}))},_shouldFetchOrderSummary:function(){var a=this.form.getFormValues()[this.cvvFieldName];return this.data.isSuppressed||this.isInactiveCupMbcc||this.isAddressChallenged||this.showPCIComplianceComponent||this.isExpired||this.requiresCurrency||!this.acceptanceData.accepted?!1:this.invalidCvv&&a&&0<a.length?!1:!0},getErrorStringId:function(){var b=null;this.data.isSuppressed?b=this.data.suppressionStringId:this.acceptanceData.accepted?this.isInactiveCupMbcc?b="pmts_portal_payselect_blocked_continue_inactive_mbcc":
this.showPCIComplianceComponent?b="pmts_portal_card_verification_required":this.isAddressChallenged?b="pmts_portal_payselect_blocked_continue_address_challenge":this.isExpired?b="pmts_portal_payselect_blocked_continue_instrument_expired":this.requiresCurrency?(b="pmts_portal_payselect_blocked_continue_currency_required",a.logCounterMetric({feature:"PaySelectContinueBlockedCurrencyRequired",resource:"_Count"})):this.invalidCvv?b="pmts_portal_add_instrument_credit_card_error_security_code_invalid":
this.invalidPostalCode?b="pmts_portal_add_instrument_credit_card_error_postal_code_invalid":this.isCardInstrumentDeleted&&(b="pmts_portal_token_expired_instrument_deleted"):b=this.acceptanceData.notAcceptedButtonTooltip;a.publishMetrics();return b},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.data.instrumentId,errors:a?[a]:null,paymentMethod:this.data.paymentMethod,isEligibleForTfx:this.isEligibleForTfx})},_updateOrderTotalHiddenInputForPaymentMethodFee:function(b){try{if(this.isConvenienceFeeEnabled){var c=
t.getFeeApplied(this.paymentMethodFeeData,"Card").value,d=document.getElementsByName("ppw-"+b+"_instrumentOrderTotalBalance")[0],e=JSON.parse(d&&d.value?d.value.toString():"{}");e?e.paymentMethodFeeAmount=c:e={paymentMethodFeeAmount:c};d&&(d.value=JSON.stringify(e))}}catch(C){console.log(C),a.logCounterMetric({feature:"CreditCardHiddenInputUpdateForPaymentMethodFeeException",resource:"_Count"})}},_triggerInstallmentOptionDeselected:function(){this.widget.trigger(this.INSTALLMENT_OPTION_CHANGED_EVENT)},
makeExpirationDateString:function(a,b){return(2>a.length?"0"+a:a)+"/"+b},_triggerInactiveMbccSelectedEvent:function(){this.widget.trigger("inactiveMbccSelected",{instrumentId:this.data.instrumentId})}})});m("components/CreditCardListItemInstallmentsComponent","events/InstallmentOfferRowSelectedEvent events/InstrumentRowSelectedEvent form-component jQuery AUI!P css-utils lang InstallmentOptionsAccordionHelper".split(" "),function(c,g,f,h,l,b,e,n){var q=["GC","JPPoints","PROMO","RewardsAccount"];return f.extend({selectedInstallmentOfferCategory:null,
currentInstrumentId:null,isAPBWithEMIEnabled:!1,isDownPaymentEnabled:!1,previouslySelectedInstallmentPlanId:null,installmentOfferBOs:[],installmentOfferBOsWithAPB:[],isPaylastEligible:!1,isEligibleForFxInstallments:!1,isMarketplaceCurrencySelected:!1,initialize:function(a,b){this.currentInstrumentId=b.data.instrumentId;this.isSingleInstallmentRow=b.data.isSingleInstallmentRow;this.installmentOffers=b.data.installmentOffers;this.installmentOffersWithAPB=b.data.installmentOffersWithAPB;this.touchLinkDisplayStrings=
b.data.touchLinkDisplayStrings;this.installmentsOneTimePaymentOfferCategoryName=b.data.installmentsOneTimePaymentOfferCategoryName;this.installmentsAvailableString=b.data.installmentsAvailableString;this.touchLinkDisplayStrings=b.data.touchLinkDisplayStrings;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.isDownPaymentEnabled=b.data.isDownPaymentEnabled;this.isDownPaymentWithAPBSelectionFixEnabled=b.data.isDownPaymentWithAPBSelectionFixEnabled;this.isAccordionViewForDesktopEnabled=b.data.isAccordionViewForDesktopEnabled;
this.isAccordionViewForMobileEnabled=b.data.isAccordionViewForMobileEnabled;this.isInstallmentsCarouselView=b.data.isInstallmentsCarouselView;this.isInstallmentsWithFeeInfoPopoverViewEnabled=b.data.isInstallmentsWithFeeInfoPopoverViewEnabled;this.isInstallmentsCapEnabled=b.data.isInstallmentsCapEnabled;this.dropdownSelectedIndex=-1;this.installmentOptionSelectionHiddenInputValue="";this.isMultiTenderDisabledWithGiftCard=b.data.isMultiTenderDisabledWithGiftCard;this.isGiftCardCheckboxSelected=!1;this.categorizedInstallmentOffers=
{};this.selectedPromoAmount=this.selectedGCAmount=this.selectedJPPoints=this.selectedRewardsAmount=0;this.otherPaymentMethodsBalance={};this.maxAllowedOtherPaymentMethodAmount=0;this.installmentsDropdownListIsReady=this.useInstallmentsBalanceEligibility=!1;b.data.maxAllowedOtherPaymentMethodAmount&&(this.maxAllowedOtherPaymentMethodAmount=b.data.maxAllowedOtherPaymentMethodAmount.value,this.useInstallmentsBalanceEligibility=!0);b.data.fxInstallmentsDisplayData&&(this.isEligibleForFxInstallments=!0,
this.isMarketplaceCurrencySelected=b.data.fxInstallmentsDisplayData.cardCurrencyMatchesMarketplaceCurrency);this.$dropdownPrompt=this.getDOMElement("creditCardListItemInstallmentOptionDropdownPrompt-INSTALLMENT")[0];this.$installmentOptionSelectionHiddenInput=this._getCreditCardInstallmentSelectionHiddenInput(this.currentInstrumentId);this.isInstallmentsCarouselView?(this.$carouselInstallmentOptionSelectionHiddenInput=this._getCreditCardInstallmentCarouselHiddenInput(this.currentInstrumentId),this._initializeCarouselInstallmentOptionSelectionHiddenInputValue(),
this._initializeInstallmentCarouselFaster()):this.isInstallmentsWithFeeInfoPopoverViewEnabled?this._initializeInstallmentsWithFeeInfoPopoverView():(this._initializeSelectedIndex(),this._initializeInstallmentOptionSelectionHiddenInputValue());this._initializeSelectedInstallmentOffer();this._initializeCategorizedInstallmentOffers();this._initializeOtherPaymentMethodsBalance();this.installmentOfferBOs=b.data.installmentOfferBOs;this.installmentOfferBOsWithAPB=b.data.installmentOfferBOsWithAPB;this.isPaylastEligible=
b.data.isPaylastEligible;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.installmentOptionsAccordionHelper=new n(this);this.mustHideMaxInstallments=""!==this.$installmentOptionSelectionHiddenInput.val();this._hideMaxInstallmentCount(this.currentInstrumentId)},_mobileView:function(){return"mobile"===this.widget.options.deviceType},_isAmazonPayBalanceSelected:function(){return!!this.widget.get("apbCheckboxSelected")},
_shouldSuppressInstallments:function(){return this._isAmazonPayBalanceSelected()||this.isMultiTenderDisabledWithGiftCard&&this.isGiftCardCheckboxSelected||!this._mobileView()&&this.isEligibleForFxInstallments&&this.isMarketplaceCurrencySelected},isInstallmentsEligible:function(){return!this._shouldSuppressInstallments()||this.isAPBWithEMIEnabled},getTotalOtherBalance:function(){return this.isInstallmentsCapEnabled?e.reduce(Object.values(this.otherPaymentMethodsBalance),function(a,b){return a+b}):
this.selectedRewardsAmount+this.selectedJPPoints+this.selectedGCAmount+this.selectedPromoAmount},isInstallmentsBalanceEligible:function(){return this.maxAllowedOtherPaymentMethodAmount>=this.getTotalOtherBalance()},isInstallmentsOfferBalanceEligible:function(a){return null==a.maxAllowedOtherPaymentMethodAmount?!0:a.maxAllowedOtherPaymentMethodAmount.value>=this.getTotalOtherBalance()},_initializeSelectedIndex:function(){this.$dropdownPrompt&&(this.dropdownSelectedIndex=this.$dropdownPrompt.selectedIndex)},
_initializeInstallmentOptionSelectionHiddenInputValue:function(){this._mobileView()&&(this.installmentOptionSelectionHiddenInputValue=this.$installmentOptionSelectionHiddenInput.val(),this.previouslySelectedInstallmentPlanId=this.$installmentOptionSelectionHiddenInput.val())},_initializeCarouselInstallmentOptionSelectionHiddenInputValue:function(){this._mobileView()?(this.installmentOptionSelectionHiddenInputValue=this.$carouselInstallmentOptionSelectionHiddenInput.val(),this.previouslySelectedInstallmentPlanId=
this.$carouselInstallmentOptionSelectionHiddenInput.val()):this.previouslySelectedInstallmentPlanId=this.installmentOptionSelectionHiddenInputValue=this.$carouselInstallmentOptionSelectionHiddenInput.value},_initializeInstallmentCarouselFaster:function(){l.when("a-carousel-framework").execute("init-faster",function(a){a.createAll();a.initializeAll()})},_initializeInstallmentsWithFeeInfoPopoverView:function(){var a=this;a.installmentOptionSelectionHiddenInputValue=a.$installmentOptionSelectionHiddenInput.val();
a.previouslySelectedInstallmentPlanId=a.$installmentOptionSelectionHiddenInput.val();l.when("A","ready").execute(function(b){b.on("a:accordion:creditCardListItemInstallmentPopoverAccordion-"+a.currentInstrumentId+":select",a._installmentsWithFeeInfoPopoverAccordionRowSelectedHandler(a));b.on("a:popover:hide:creditCardInstallmentsPopover-"+a.currentInstrumentId,a._installmentsWithFeeInfoPopoverHideHandler(a))})},_initializeOtherPaymentMethodsBalance:function(){var a=this;e.forEach(q,function(b){a.otherPaymentMethodsBalance[b]=
0})},_syncMaxInstallmentsText:function(a){var b=this.getDOMElement("creditCardListItemInstallmentPopoverAccordionRow-"+a).data("maxinstallmentsdisplay");this.getDOMElement("creditCardListItemMaxInstallmentsText-"+a).find("span").text(b)},_hasMonthlyFee:function(a){return a?0!==Number(a.replace(/[^0-9]/g,"")):!1},_installmentsWithFeeInfoPopoverAccordionRowSelectedHandler:function(a){return function(c){b.toggleElement(a.getDOMElement("creditCardInstallmentPopoverAccordionFeeDisclaimerLine-"+a.currentInstrumentId),
""!==a.getDOMElement(c.selectedRow.rowName).data("totalfeedisplay"));b.toggleElement(a.getDOMElement("creditCardInstallmentPopoverAccordionFeeDisclaimerLine-"+a.currentInstrumentId),a._hasMonthlyFee(a.getDOMElement(c.selectedRow.rowName).data("totalfeedisplay")));a.mustHideMaxInstallments=""===a.getDOMElement(c.selectedRow.rowName).data("maxinstallmentsdisplay");a._syncMaxInstallmentsText(a.currentInstrumentId);var d=a.getDOMElement(c.selectedRow.rowName);c=a.getDOMElement(c.selectedRow.accordionName);
c.data("selectedfinancialofferid",d.data("financialofferid"));c.data("selectiondisplay",d.data("selectiondisplay"));c.data("summarydisplay",d.data("summarydisplay"));c.data("selectiondetaildisplay",d.data("selectiondetaildisplay"));c.data("currencyselection",d.data("currencyselection"))}},_installmentsWithFeeInfoPopoverHideHandler:function(a){return function(){var b=a.getDOMElement("creditCardListItemInstallmentPopoverAccordion-"+a.currentInstrumentId),c=b.data("previouslyselectedfinancialofferid");
b.data("selectedfinancialofferid")!==c&&(b.data("selectedfinancialofferid",c),a.getDOMElement("creditCardListItemInstallmentPopoverAccordionRow-"+a.currentInstrumentId+c).find("a").click())}},_initializeSelectedInstallmentOffer:function(a){var b=this;b.isInstallmentsCarouselView?this._toggleCarouselInstallmentOptionsDisplay(a,"creditCardListItemInstallmentCarousel-",this.currentInstrumentId):b.isInstallmentsWithFeeInfoPopoverViewEnabled?b._toggleInstallmentPopoverButtonDisplay(a,this.currentInstrumentId):
b.isSingleInstallmentRow?b._toggleInstallmentDropdownDisplay(a,"INSTALLMENT"):b.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-").find("input").get().forEach(function(a,c){c=b._getCategorizedInstallmentOffersByIndex(c)[0];a.checked&&(b.selectedInstallmentOfferCategory=c);b._toggleInstallmentDropdownDisplay(a.checked&&1<b._getNumInstallmentOptionsInCategory(c),c)})},_initializeSelectedInstrument:function(a){var b=a.instrumentId===this.currentInstrumentId;this._initializeSelectedInstallmentOffer(b);
this._mobileView()&&!this.isInstallmentsCarouselView&&this._toggleInstallmentMobileTouchLinkDisplay(b,a.instrumentId)},_initializeCategorizedInstallmentOffers:function(){var a=this;this.installmentOffers.forEach(function(b){a.categorizedInstallmentOffers[b[0]]=b[1]})},_toggleInstallmentDisplay:function(a,b){b===this.currentInstrumentId&&(this.isInstallmentsCarouselView?this._toggleCarouselInstallmentOptionsDisplay(a,"creditCardListItemInstallmentCarousel-",b):this.isInstallmentsWithFeeInfoPopoverViewEnabled?
(this._toggleInstallmentPopoverButtonDisplay(a,b),this._toggleInstallmentSelectionDetailDisplay(a,"INSTALLMENT")):this.isSingleInstallmentRow&&(this._mobileView()?this._toggleInstallmentMobileTouchLinkDisplay(a,b):this._toggleInstallmentDropdownDisplay(a,"INSTALLMENT"),this._toggleInstallmentSelectionDetailDisplay(a,"INSTALLMENT")))},_toggleInstallmentDropdownDisplay:function(a,c){this._isAmazonPayBalanceSelected()?this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOsWithAPB.length&&(a=!1):this.isAPBWithEMIEnabled&&
a&&0===this.installmentOfferBOs.length&&(a=!1);b.toggleElement(this.getDOMElement("creditCardListItemInstallmentOptionDropdownSelection-"+c),a&&this.isInstallmentsEligible())},_toggleInstallmentPopoverButtonDisplay:function(a,c){this._isAmazonPayBalanceSelected()?this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOsWithAPB.length&&(a=!1):this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOs.length&&(a=!1);b.toggleElement(this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+c),
a&&this.isInstallmentsEligible())},_toggleInstallmentOptionsDisplay:function(a,c,d){a=this._showInstallmentOptions(a);b.toggleElement(this.getDOMElement(c+d),a&&this.isInstallmentsEligible());a&&this._initializeInstallmentCarouselFaster()},_toggleInstallmentOptionsMobileDisplay:function(a,c,d){a=this._showInstallmentOptions(a);b.toggleElement(this.getDOMElement(c+d).add(this.getDOMElement(c)),a&&this.isInstallmentsEligible());a&&this._initializeInstallmentCarouselFaster()},_showInstallmentOptions:function(a){return this._isAmazonPayBalanceSelected()&&
this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOsWithAPB.length||!this._isAmazonPayBalanceSelected()&&this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOs.length?!1:a},_toggleCarouselInstallmentOptionsDisplay:function(a,b,c){this._mobileView()?this._toggleInstallmentOptionsMobileDisplay(a,b,c):this._toggleInstallmentOptionsDisplay(a,b,c)},_toggleInstallmentMobileTouchLinkDisplay:function(a,c){this._isAmazonPayBalanceSelected()?this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOsWithAPB.length&&
(a=!1):this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOs.length&&(a=!1);b.toggleElement(this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-"+c).add(this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-")),a&&this.isInstallmentsEligible())},_toggleInstallmentSelectionDetailDisplay:function(a,c){b.toggleElement(this.getDOMElement("creditCardListItemInstallmentOptionSelectionDetailText-"+c),this.isInstallmentsEligible()&&a)},_toggleInstallmentsBalanceEligibility:function(a){b.toggleElement(this.getDOMElement("creditCardInstallmentErrorExceededOtherBalance"),
!a);b.toggleElement(this.getDOMElement("creditCardInstallmentInfoMessage"),a);this._triggerInstallmentsEligibilityChangedEvent(a);this.isInstallmentsCarouselView?this._toggleCarouselInstallmentOptionsDisplay(a,"creditCardListItemInstallmentCarousel-",this.currentInstrumentId):this._mobileView()?this._toggleInstallmentMobileTouchLinkDisplay(a,this.currentInstrumentId):this.isInstallmentsWithFeeInfoPopoverViewEnabled?this._toggleInstallmentPopoverButtonDisplay(a,this.currentInstrumentId):(this.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-").find("input").get().forEach(function(b,
c){a?(b.disabled=!1,b.nextSibling.nextSibling.classList.remove("a-color-tertiary")):0<c?(b.disabled=!0,b.nextSibling.nextSibling.classList.add("a-color-tertiary")):b.checked=!0}),a||this._installmentOfferRowSelected(h(this.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-")[0])))},_toggleInstallmentsOptionsBalanceEligibility:function(){var a=this;e.forEach(a.categorizedInstallmentOffers.INSTALLMENT,function(c){var d=document.getElementById("pmts-cc-installment-option-list-item-id"+a.currentInstrumentId+
c.financialOfferId);var e=a._mobileView()?null!=d?null!=d.querySelector(".a-active"):!1:a.$dropdownPrompt.value===c.financialOfferId;a.isInstallmentsOfferBalanceEligible(c)?b.showElement(h(d)):(b.hideElement(h(d)),e&&(a._mobileView()?a.getDOMElementsByPrefix("creditCardListItemInstallmentOption-"+a.currentInstrumentId)[0].click():a.getDOMElement("creditCardListItemInstallmentOptionDropdownPrompt-INSTALLMENT").val("").change()))})},_triggerInstallmentOfferRowSelectedEvent:function(a){this.widget.trigger(c,
{installmentOfferCategory:a,instrumentId:this.currentInstrumentId})},_triggerInstallmentOptionChangedEvent:function(a,b){this.widget.trigger("installmentOptionChanged",{summaryDisplay:a,isInstallmentOfferSelected:b,instrumentId:this.currentInstrumentId})},_triggerInstallmentsEligibilityChangedEvent:function(a){this.widget.trigger("installmentsEligibilityChanged",{isEligible:a})},_triggerResetSelectedPaymentMethodEvent:function(){var a=!0;this._isAmazonPayBalanceSelected()?0===this.installmentOfferBOsWithAPB.length&&
(a=!1):0===this.installmentOfferBOs.length&&(a=!1);this.widget.trigger("resetSelectedPaymentMethod",{isInstallmentPlansAvailable:a})},_selectionDetailDisplayContentChanged:function(a){this.getDOMElement("creditCardListItemInstallmentOptionSelectionDetailText-INSTALLMENT").html(a)},_getSelectedInstallmentOptionSummaryDisplay:function(a){if(this.isInstallmentsCarouselView){var b=this._getCreditCardCarouselInstallmentSelectedOfferId(a);b=this.getDOMElement("creditCardInstallmentOfferOptionCarouselRadioButton-"+
b).data("summarydisplay")}else this.isInstallmentsWithFeeInfoPopoverViewEnabled?b=this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+a).find("input").data("summarydisplay"):this._mobileView()?b=this._getCreditCardInstallmentMobileTouchLink(a).find("input").data("summarydisplay"):(a=this.getDOMElement("creditCardListItemInstallmentOptionDropdownSelection-INSTALLMENT"))&&this.$dropdownPrompt&&0<=this.$dropdownPrompt.selectedIndex&&(b=a.data(this.$dropdownPrompt.options[this.$dropdownPrompt.selectedIndex].value));
return b},_getSelectedInstallmentOptionSelectionDetailDisplay:function(a){if(this._mobileView())var b=this._getCreditCardInstallmentMobileTouchLink(a).find("input").data("selectiondetaildisplay");else(a=this.getDOMElement("creditCardListItemInstallmentOptionDropdownSelection-INSTALLMENT"))&&this.$dropdownPrompt&&0<=this.$dropdownPrompt.selectedIndex&&(b=a.data(this.$dropdownPrompt.options[this.$dropdownPrompt.selectedIndex].value+"selectiondetaildisplay"));return b},_installmentOfferRowSelected:function(a){(a=
a.data("installment-offer-category"))&&this.selectedInstallmentOfferCategory!==a&&this._triggerInstallmentOfferRowSelectedEvent(a)},_getCategorizedInstallmentOffersByIndex:function(a){if(0<=a&&a<this.installmentOffers.length)return this.installmentOffers[a]},_getNumInstallmentOptionsInCategory:function(a){return this.categorizedInstallmentOffers[a]?this.categorizedInstallmentOffers[a].length:0},closeCreditCardInstallmentsSecondaryPopover:function(a){l.when("a-secondary-view").execute(function(b){b&&
(b=b.get("creditCardInstallmentsSecondaryPopover-"+a))&&b.hide()})},creditCardInstallmentsPopoverContinueButtonClick:function(a){a=this.currentInstrumentId;this._updateTouchLinkContent(a);this.closeCreditCardInstallmentsSecondaryPopover(a)},_creditCardInstallmentPopoverAccordionButtonClickHandler:function(a){a=this.getDOMElement("creditCardListItemInstallmentPopoverAccordionRow-"+this.currentInstrumentId+this.installmentOptionSelectionHiddenInputValue).data("totalfeedisplay");b.toggleElement(this.getDOMElement("creditCardInstallmentPopoverAccordionFeeDisclaimerLine-"+
this.currentInstrumentId),this._hasMonthlyFee(a))},_creditCardInstallmentPopoverAccordionContinueButtonClickHandler:function(a){function b(a){a&&(a=a.get("creditCardInstallmentsPopover-"+e))&&a.hide()}var c=this,e=this.currentInstrumentId;a=this.getDOMElement("creditCardListItemInstallmentPopoverAccordion-"+e);this._refreshCreditCardInstallmentPopoverButtonText(a,e);var f=a.data("previouslyselectedfinancialofferid");this._getCreditCardInstallmentSelectionHiddenInput(e).val(f);this.installmentOptionSelectionHiddenInputValue=
f;var g=a.data("summarydisplay");this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+e).find("input").data("summarydisplay",g);this._triggerInstallmentOptionChangedEvent(g,f&&0<f.length);f=a.data("selectiondetaildisplay");this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+e).find("input").data("selectiondetaildisplay",f);this._selectionDetailDisplayContentChanged(f);!0===this.isEligibleForFxInstallments&&(a=a.data("currencyselection"),this._updateCreditCardSelectionCurrency(a));
l.when("a-modal").execute(function(a){if(a)b(a);else{a=c._mobileView();var d=h('div[id^\x3d"a-popover-"]');d&&!a&&d.hide();a=c._mobileView();(d=h('iframe[id^\x3d"a-popover-"]'))&&!a&&d.hide()}});l.when("a-secondary-view").execute(function(a){b(a)})},_hideMaxInstallmentCount:function(a){(a=this.getDOMElement("creditCardListItemMaxInstallmentsText-"+a))&&this.isInstallmentsWithFeeInfoPopoverViewEnabled&&(this.mustHideMaxInstallments?b.hideElement(a):b.showElement(a))},_refreshCreditCardInstallmentPopoverButtonText:function(a,
b){var c=this.getDOMElement("creditCardListItemInstallmentsPopoverButtonText-"+b);a.data("previouslyselectedfinancialofferid",a.data("selectedfinancialofferid"));var e=a.data("selectiondisplay");c.text(e);this._hideMaxInstallmentCount(b);return a},_updateTouchLinkContent:function(a){var b=this._getCreditCardInstallmentMobileTouchLink(a);b.find("input").remove();var c=this._getCreditCardInstallmentMobilePopover(a);c=this._extractInputs(c);this._appendHiddenInput(c,b);if(a=this._getSelectedFinancialOfferId(c,
a))a=this.selectedInstallmentOfferCategory===this.installmentsOneTimePaymentOfferCategoryName?this.installmentsAvailableString:this.touchLinkDisplayStrings[a],b.find("span").text(a)},_appendHiddenInput:function(a,b){e.forEachKeyValue(a,function(a,c){h('\x3cinput type\x3d"hidden"\x3e').attr({name:a,value:c}).appendTo(b)})},_getSelectedFinancialOfferId:function(a,b){return a["ppw-"+b+"_installmentsSelection_dropdown_"+a["ppw-"+b+"_installmentCategory"]]},creditCardInstallmentsOptionClick:function(a){var b=
this.currentInstrumentId;a=h(a.currentTarget);if(b===a.data("instrumentid").toString()){var c=a.data("summarydisplay"),e=this.isInstallmentOfferSelected(this);if(this.isAccordionViewForMobileEnabled)this.getDOMElement("installmentOfferMobileDropdownMonthlyBreakdown").html(c),this.getDOMElement("installmentOfferMobileDropdownTotalCost").html(a.data("installmentoptiontotalamountdisplay"));else{this.getDOMElementsByPrefix("creditCardListItemInstallmentOption-").removeClass("a-active");a.addClass("a-active");
var f=this._getPrimaryViewButtonDisplay(b),g=a.find(".a-section").html();f.html(g)}f=this._getCreditCardInstallmentSelectionHiddenInput(b);f.val(a.data("financialofferid"));this.installmentOptionSelectionHiddenInputValue=f.val();this._getCreditCardInstallmentMobileTouchLink(b).find("input").data("summarydisplay",c);this._triggerInstallmentOptionChangedEvent(c,e);c=a.data("selectiondetaildisplay");this._getCreditCardInstallmentMobileTouchLink(b).find("input").data("selectiondetaildisplay",c);this._selectionDetailDisplayContentChanged(c);
!0===this.isEligibleForFxInstallments&&(b=a.data("currencyselection"),this._updateCreditCardSelectionCurrency(b))}},creditCardCarouselInstallmentsOptionEventHandler:function(a){var b=this.currentInstrumentId,c=h(a.currentTarget);if(b===c.data("instrumentid").toString()&&this.isInstallmentsCarouselView){var e=this._getCreditCardCarouselInstallmentSelectedOfferId(b);this._toggleCarouselCardSelection(this.getDOMElement("creditCardInstallmentOfferOptionCarouselRadioButton-"+e),!1);this._toggleCarouselCardSelection(c,
!0);e=c.data("financialofferid");this._setCreditCardCarouselInstallmentSelectedOfferId(b,e);this.installmentOptionSelectionHiddenInputValue=this._getCreditCardCarouselInstallmentSelectedOfferId(b);b=c.data("summarydisplay");this._triggerInstallmentOptionChangedEvent(b,a.target.checked);a=c.data("selectiondetaildisplay");this._selectionDetailDisplayContentChanged(a);!0===this.isEligibleForFxInstallments&&(c=c.data("currencyselection"),this._updateCreditCardSelectionCurrency(c))}},_toggleCarouselCardSelection:function(a,
b){b?a.removeClass("installments-carousel-not-selected-card").addClass("installments-carousel-selected-card"):a.removeClass("installments-carousel-selected-card").addClass("installments-carousel-not-selected-card")},_getCreditCardInstallmentCarouselHiddenInput:function(a){return this._mobileView()?this.getDOMElement("creditCardListItemInstallmentsCarouselSelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemInstallmentsCarouselSelectionHiddenInput-")):this.getDOMElement("creditCardListItemInstallmentsCarouselSelectionHiddenInput-"+
a)[0]},_getCreditCardCarouselInstallmentSelectedOfferId:function(a){return(a=this._getCreditCardInstallmentCarouselHiddenInput(a))?this._mobileView()?a.val():a.value:""},_getCreditCardInstallmentSelectedOfferId:function(a){return(a=this._getCreditCardInstallmentSelectionHiddenInput(a))?a.val():""},_setCreditCardCarouselInstallmentSelectedOfferId:function(a,b){if(a=this._getCreditCardInstallmentCarouselHiddenInput(a))this._mobileView()?a.val(b):a.value=b},_extractInputs:function(a){var b={},c=this;
a.find("input").each(function(a,d){d&&d.type&&d.name&&d.value&&"radio"===d.type&&d.checked&&(b[d.name]=d.value,c.getDOMElement("creditCardListItemInstallmentOptionDropdown-"+d.value).first().find("select").each(function(a,c){c&&c.name&&c.options&&0<=c.selectedIndex&&0<=c.selectedIndex&&c.selectedIndex<c.options.length&&(b[c.name]=c.options[c.selectedIndex].value)}))});return b},_getPrimaryViewButtonDisplay:function(a){return this.getDOMElement("creditCardListItemInstallmentOfferButtonText-"+a).add(this.getDOMElement("creditCardListItemInstallmentOfferButtonText-"))},
_getCreditCardInstallmentMobileTouchLink:function(a){return this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-"+a).add(this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-"))},_getCreditCardInstallmentMobilePopover:function(a){return this.getDOMElement("creditCardListItemInstallmentsMobilePopover-"+a).add(this.getDOMElement("creditCardListItemInstallmentsMobilePopover-"))},_getCreditCardInstallmentMobileHiddenInput:function(a){return this._getCreditCardInstallmentSelectionHiddenInput(a)},
_getCreditCardInstallmentSelectionHiddenInput:function(a){return this.getDOMElement("creditCardListItemInstallmentsSelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemInstallmentsSelectionHiddenInput-"))},_getCreditCardInstallmentMobileHiddenTfxSelectionInput:function(a){return this.getDOMElement("creditCardListItemInstallmentsCurrencySelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemInstallmentsCurrencySelectionHiddenInput-"))},_updateCreditCardSelectionCurrency:function(a){this._getCreditCardInstallmentMobileHiddenTfxSelectionInput(this.currentInstrumentId).val(a)},
_getCreditCardInstallmentDownPaymentValueHiddenInput:function(a){return this.getDOMElement("creditCardListItemDownPaymentValueSelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemDownPaymentValueSelectionHiddenInput-"))},_getCreditCardInstallmentDownPaymentCurrencyHiddenInput:function(a){return this.getDOMElement("creditCardListItemDownPaymentCurrencySelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemDownPaymentCurrencySelectionHiddenInput-"))},displaySelectedInstallmentOfferDropdown:function(){var a=
this;a.data.installmentOffers.forEach(function(b){b=b[0];a._toggleInstallmentDropdownDisplay(b===a.selectedInstallmentOfferCategory&&1<a._getNumInstallmentOptionsInCategory(b),b)})},getInstallmentOfferDisplayString:function(a){return a[1][0].selectionDisplayStrings[0]},getInstallmentOfferId:function(a){return a[1][0].financialOfferId},bindToElements:function(){var a=this;this.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-").change(function(b){b.target.checked&&a._installmentOfferRowSelected(h(b.currentTarget))});
this.getDOMElementsByPrefix("creditCardListItemInstallmentsMobileTouchLink-").click(function(b){a.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"CardInstallmentSelectionButton"})});this.getDOMElementsByPrefix("installmentOptionsMobileAccordionRow-").change(function(b){b.target.selected&&a._installmentOfferRowSelected(h(b.currentTarget))});this._mobileView()&&(this.getDOMElement("creditCardListItemInstallmentsPrimaryContinueButton").click(e.bind(this.creditCardInstallmentsPopoverContinueButtonClick,
this)),this.getDOMElement("creditCardListItemInstallmentsSecondaryContinueButton").click(e.bind(this.creditCardInstallmentsPopoverContinueButtonClick,this)),this.getDOMElementsByPrefix("installmentOptionsMobileAccordionRowContinueButton").click(e.bind(this.creditCardInstallmentsPopoverContinueButtonClick,this)),this.getDOMElementsByPrefix("creditCardListItemInstallmentOption-").click(e.bind(this.creditCardInstallmentsOptionClick,this)),this.getDOMElementsByPrefix("installmentOptionsMobileAccordionRow-").click(e.bind(this.creditCardInstallmentsOptionClick,
this)),this.getDOMElementsByPrefix("creditCardInstallmentOfferOptionCarouselRadioButton-").click(e.bind(this.creditCardCarouselInstallmentsOptionEventHandler,this)));if(this.isInstallmentsWithFeeInfoPopoverViewEnabled){this.getDOMElementsByPrefix("creditCardListItemInstallmentsPopoverButton-").click(e.bind(this._creditCardInstallmentPopoverAccordionButtonClickHandler,this));this.getDOMElementsByPrefix("creditCardInstallmentPopoverAccordionContinueButton-").click(e.bind(this._creditCardInstallmentPopoverAccordionContinueButtonClickHandler,
this));for(var b=document.querySelectorAll('input[name^\x3d"creditCardInstallmentPopoverAccordionContinueButton-"]'),c=0;c<b.length;c++)b[c].addEventListener("click",function(b){a._creditCardInstallmentPopoverAccordionContinueButtonClickHandler(b)})}this.getDOMElementsByPrefix("creditCardInstallmentOfferOptionCarouselRadioButton-").change(e.bind(this.creditCardCarouselInstallmentsOptionEventHandler,this));this.getDOMElement("creditCardListItemInstallmentOptionDropdownPrompt-INSTALLMENT").change(function(){a._initializeSelectedIndex();
var b=a._getSelectedInstallmentOptionSummaryDisplay();a._triggerInstallmentOptionChangedEvent(b,0<a.dropdownSelectedIndex);b=a._getSelectedInstallmentOptionSelectionDetailDisplay();a._selectionDetailDisplayContentChanged(b)});this.isInstallmentsCapEnabled&&!this._mobileView()&&l.when("A").execute(function(b){b.on("a:popover:show:ppw-"+a.currentInstrumentId+"_installmentsSelection_dropdown_INSTALLMENT",function(){a.installmentsDropdownListIsReady||(a._toggleInstallmentsOptionsBalanceEligibility(),
a.installmentsDropdownListIsReady=!0)})})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId===a.currentInstrumentId&&(a.selectedInstallmentOfferCategory=b.installmentOfferCategory,a.displaySelectedInstallmentOfferDropdown())});(this._mobileView()||this.isAccordionViewForDesktopEnabled)&&this.installmentOptionsAccordionHelper.bindToEvents();a.widget.on("toggleInstallmentDropDown",a,function(b){a._toggleInstallmentDisplay(!b.isAPBSelected||this.isAPBWithEMIEnabled,b.instrumentId)});
a.widget.on("apbSelectionChanged",a,function(b){this.widget.trigger("updateIBDonAPBSelectionEvent",{fosId:a.isInstallmentsCarouselView?a.$carouselInstallmentOptionSelectionHiddenInput.val():a.$installmentOptionSelectionHiddenInput.val(),instrumentId:a.currentInstrumentId})});a.widget.on("optionalInstrumentSelected",a,function(b){a.isMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&(a.isGiftCardCheckboxSelected=!0,a.isInstallmentsCarouselView?a._setCreditCardCarouselInstallmentSelectedOfferId(a.currentInstrumentId,
""):a._mobileView()?a.$installmentOptionSelectionHiddenInput.val(""):a.$dropdownPrompt.selectedIndex=-1,a._toggleInstallmentDisplay(!1,a.currentInstrumentId),this.widget.trigger("installmentsAvailabilityChanged",{isInstallmentsAvailable:!1}))});a.widget.on("optionalInstrumentDeselected",a,function(b){a.isMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&(a.isGiftCardCheckboxSelected=!1,a.isInstallmentsEligible()&&(a.isInstallmentsCarouselView?(a._initializeInstallmentCarouselFaster(),a._setCreditCardCarouselInstallmentSelectedOfferId(a.currentInstrumentId,
a.installmentOptionSelectionHiddenInputValue)):a._mobileView()?a.$installmentOptionSelectionHiddenInput.val(a.installmentOptionSelectionHiddenInputValue):a.$dropdownPrompt.selectedIndex=this.dropdownSelectedIndex,a._toggleInstallmentDisplay(!0,a.currentInstrumentId),this.widget.trigger("installmentsAvailabilityChanged",{isInstallmentsAvailable:!0})))});a.widget.on("tfxPreferredCurrencySelected",a,function(b){b.instrumentId===a.currentInstrumentId&&!0===a.isEligibleForFxInstallments&&(a.isMarketplaceCurrencySelected=
!1,a.isInstallmentsEligible()&&(a.$dropdownPrompt.selectedIndex=this.dropdownSelectedIndex,a._toggleInstallmentDisplay(!0,a.currentInstrumentId)))});a.widget.on("tfxSelectCurrencySelected",a,function(b){b.instrumentId===a.currentInstrumentId&&!0===a.isEligibleForFxInstallments&&(a.isMarketplaceCurrencySelected=!0,a.$dropdownPrompt.selectedIndex=-1,a._toggleInstallmentDisplay(!1,a.currentInstrumentId))});this.widget.on("installmentOptionsAccordionChanged",this,function(b){if(b.instrumentId===this.currentInstrumentId){this._getCreditCardInstallmentSelectionHiddenInput(b.instrumentId).val(b.financialofferid);
var c=a.isInstallmentOfferSelected(a);this._triggerInstallmentOptionChangedEvent(b.summaryDisplay,c)}});this.widget.on("updatePrimaryButtonDisplayString",this,function(a){if(this.currentInstrumentId===a.instrumentId){var b=this._getPrimaryViewButtonDisplay(this.currentInstrumentId),c=this._getCreditCardInstallmentSelectionHiddenInput(a.instrumentId);this.previouslySelectedInstallmentPlanId=c[0].value;""===a.displayString&&(this._isAmazonPayBalanceSelected()&&0<this.installmentOffersWithAPB.length?
(a.displayString=this.getInstallmentOfferDisplayString(this.installmentOffersWithAPB[0]),a.installmentPlanId=this.getInstallmentOfferId(this.installmentOffersWithAPB[0])):!this._isAmazonPayBalanceSelected()&&0<this.installmentOffers.length&&(a.displayString=this.getInstallmentOfferDisplayString(this.installmentOffers[0]),a.installmentPlanId=this.getInstallmentOfferId(this.installmentOffers[0])));b.html(a.displayString);c.val(a.installmentPlanId);this.isDownPaymentWithAPBSelectionFixEnabled&&a.downPaymentAmount!==
r&&""!==a.downPaymentAmount&&(b=this._getCreditCardInstallmentDownPaymentValueHiddenInput(a.instrumentId),c=this._getCreditCardInstallmentDownPaymentCurrencyHiddenInput(a.instrumentId),a=JSON.parse(a.downPaymentAmount),b.val(a.amount),c.val(a.currency))}});a.widget.on("apbSelectionChangedForAPBWithEMIFeature",a,function(a){a.selectedInstrumentId===this.currentInstrumentId&&""!==this.previouslySelectedInstallmentPlanId&&this._triggerResetSelectedPaymentMethodEvent()});if(a.useInstallmentsBalanceEligibility)a.widget.on("balanceSelectionChanged",
a,function(b){a.isInstallmentsCapEnabled?q.includes(b.paymentMethod)&&(a.otherPaymentMethodsBalance[b.paymentMethod]=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0,a._toggleInstallmentsOptionsBalanceEligibility()):"JPPoints"===b.paymentMethod?a.selectedJPPoints=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0:"GC"===b.paymentMethod?a.selectedGCAmount=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0:"PROMO"===b.paymentMethod?a.selectedPromoAmount=b.isSelected&&
!b.isBackingInstrument?parseFloat(b.balance):0:"RewardsAccount"===b.paymentMethod&&(a.selectedRewardsAmount=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0);a._toggleInstallmentsBalanceEligibility(a.isInstallmentsBalanceEligible())});a.widget.on(g,a,function(b){var c=b.instrumentId===this.currentInstrumentId;a._initializeSelectedInstallmentOffer(c);this._mobileView()&&!a.isInstallmentsCarouselView&&this._toggleInstallmentMobileTouchLinkDisplay(c&&this.isInstallmentsBalanceEligible(),
b.instrumentId);c&&(c=a.isInstallmentOfferSelected(a),b=this._getSelectedInstallmentOptionSummaryDisplay(b.instrumentId),this._triggerInstallmentOptionChangedEvent(b,c))});a.widget.on("initializeRecommendedInstrument",a,e.bind(this._initializeSelectedInstrument,this));l.when("A","a-popover","ready").execute(function(a,b){var c=a.$;c(document).delegate(".a-popover-wrapper","keydown",function(a){c("li.selected-card-installment-suppressed-dropdown-option").unbind("keydown").keydown(function(a){if(13===
a.keyCode)return a.preventDefault(),!1})})})},isInstallmentOfferSelected:function(a){a=a.isInstallmentsCarouselView?(a=a._getCreditCardCarouselInstallmentSelectedOfferId(a.currentInstrumentId))&&0<a.length:a.isInstallmentsWithFeeInfoPopoverViewEnabled?(a=a._getCreditCardInstallmentSelectedOfferId(a.currentInstrumentId))&&0<a.length:0<a.dropdownSelectedIndex;return a}})});m("components/SelectableCreditCardListComponent","events/InstrumentRowSelectedEvent events/CreateSecureFieldEvent events/RemoveSecureFieldEvent css-utils component lang clog jQuery continuable mixins/b2b-cross-wallet-mixin".split(" "),
function(c,g,f,h,l,b,e,n,q,a){var k,d=["GC","JPPoints","ProductVoucher","PROMO"],m={pmts_portal_payselect_cc_address_challenge_error_no_match:"-noMatch",pmts_portal_payselect_cc_address_challenge_error_security_code_invalid:"-securityCodeInvalid",pmts_portal_payselect_cc_address_challenge_error_unknown:"-unknown",pmts_portal_payselect_selectedPaymentMethodExpired:"-expirationDateInvalid"};return l.extend(q,a,{selectedInstrumentId:null,initialSelectedFixupInstrumentId:null,showAuthorizationFailureAlert:!1,
isAPBWithEMIEnabled:!1,shouldDecoupleCardsFromSavedCardsSection:!1,scrollAfterAddCardEvent:!1,cardInstrumentId:"",initialize:function(a,b){this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.showAuthorizationFailureAlert=b.data.showAuthorizationFailureAlert;this.initialSelectedFixupInstrumentId=b.data.initialSelectedFixupInstrumentId;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.shouldDecoupleCardsFromSavedCardsSection=b.data.shouldDecoupleCardsFromSavedCardsSection;
this.isPaySelectCvvSecureFieldEnabled=b.data.isPaySelectCvvSecureFieldEnabled;this.scrollAfterAddCardEvent=b.data.scrollAfterAddCardEvent;this.cardInstrumentId=b.data.cardInstrumentId;this.scrollAfterAddCardEvent!==r&&!0===this.scrollAfterAddCardEvent&&this.widget.scrollToElementWithCompensation(this.getDOMElement("creditCardContainer-"+this.cardInstrumentId))},_instrumentRowSelected:function(a,b){this._deselectingInstrument(b);this._removeSecureFieldFrame(b);this.getDOMElement("instrumentRowSelection-"+
a).prop("checked",!0);b=this._getCreditCardRow(a);this.showAuthorizationFailureAlert&&this.initialSelectedFixupInstrumentId===a?b.addClass("pmts-fixup-selected"):b.addClass("pmts-selected");this._triggerCreditCardRowSelectedEvent(a);this._createSecureFieldFrame(a)},_deselectingInstrument:function(a){this.getDOMElement("instrumentRowSelection-"+a).prop("checked",!1);a=this._getCreditCardRow(a);a.removeClass("pmts-selected");this.showAuthorizationFailureAlert&&a.removeClass("pmts-fixup-selected");h.hideElement(this.getDOMElementsByPrefix("addressChallengeMessages-"));
h.hideElement(this.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-"));h.hideElement(this.getDOMElementsByPrefix("addressChallengeScan-"));h.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationExpander-"));h.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationRetryExceededAlert-"));h.hideElement(this.getDOMElementsByPrefix("inactiveMbccMessages-"))},_creditCardRowClicked:function(a){var b=n(a.currentTarget);a=b.data("instrument-id");var c=b.data("co-brand"),
d=b.data("disabled"),f=b.data("is-owned");b=b.data("is-recurring-charge");"AmazonVisaSignature"===c&&e.logCounterMetric({feature:"selected-cbcc",resource:"_Count"});"AmazonVisaSignature"===k&&"AmazonVisaSignature"!==c&&e.logCounterMetric({feature:"deselected-cbcc",resource:"_Count"});k=c;!d&&a&&this.selectedInstrumentId!==a&&this._triggerInstrumentRowSelectedEvent(a,b,f)},_showAddressChallengeErrors:function(a){var c=this;0<a.errorMessages.length&&(b.forEach(a.errorMessages,function(b){h.showElement(c.getDOMElement(c._getJsRefForErrorMessage(a.instrumentId,
b)))}),h.showElement(c.getDOMElement("addressChallengeErrors-"+a.instrumentId)))},_getJsRefForErrorMessage:function(a,b){b=m[b.messageStringId];"undefined"===typeof b&&(b="-unknown");return"addressChallengeError-"+a+b},_getCreditCardRow:function(a){return this.getDOMElement("creditCardContainer-"+a)},_getAllCreditCardRows:function(){return this.getDOMElementsByPrefix("creditCardContainer-")},_triggerInstrumentRowSelectedEvent:function(a,b,d){this.widget.trigger(c,{instrumentId:a,isRecurringChargePaymentMethod:b,
paymentMethod:"CC",isInstrumentOwned:d})},_confirmButtonClicked:function(a){this.widget.trigger("confirmButtonClicked",{instrumentId:this.selectedInstrumentId})},_triggerCreditCardRowSelectedEvent:function(a,b){var c=this.getDOMElement("instrumentRowSelection-"+a).val();h.showElement(this.getDOMElement("creditCardInstallmentActivationRetryExceededAlert-"+a));this.widget.trigger("creditCardRowSelected",{instrumentId:a,instrumentSelectionValue:c,isInstrumentOwned:b})},isCurrentPaymentMethodOwnedByOrderingCustomer:function(){return!1!==
this._getCreditCardRow(this.selectedInstrumentId).data("is-owned")},_deselectCreditCardInstrumentRow:function(){var a=this._getCreditCardRow(this.selectedInstrumentId);a.hasClass("pmts-selected")&&(this._deselectingInstrument(a.data("instrument-id")),this.selectedInstrumentId="",this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},_updateBackingInstrumentState:function(a){var b=this._getCreditCardRow(this.selectedInstrumentId);a=!1!==a.isInstrumentOwned;var c=!1!==b.data("is-owned");
b.hasClass("pmts-selected")&&c!==a&&this._deselectCreditCardInstrumentRow()},_createSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(g,{secureFieldId:"secureFieldsCVV-"+a})},_removeSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(f,{secureFieldId:"secureFieldsCVV-"+a})},bindToElements:function(){var a=this;this.shouldDecoupleCardsFromSavedCardsSection||(a.getDOMElementsByPrefix("creditCardContainer-").click(b.bind(this._creditCardRowClicked,
this)),a.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-").click(b.bind(this._confirmButtonClicked,this)),a.getDOMElementsByPrefix("installmentActivationMobileConfirmButtons-").click(b.bind(this._confirmButtonClicked,this)));a.getDOMElement("CardListLearnMoreLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"Click",ActionValueType:"LearnMorePopover",ActionParentValue:"LearnMoreOnSavedCards",ActionParentValueType:"LearnMoreLinkPosition"})})},bindToEvents:function(){var a=
this;a.widget.on("initializeRecommendedInstrument",a,function(b){if(!this.shouldDecoupleCardsFromSavedCardsSection){a.selectedInstrumentId=b.instrumentId;a.showAuthorizationFailureAlert&&!a.initialSelectedFixupInstrumentId&&(a.initialSelectedFixupInstrumentId=b.instrumentId);var c=a._getCreditCardRow(b.instrumentId);if(null!==c&&1===c.length&&null!==c[0].attributes){var d="true"===c[0].attributes.getNamedItem("data-is-recurring-charge").value?!0:!1;c=this.isABCrossCustomerMultiTenderSuppressionEnabled&&
null!==c[0].attributes.getNamedItem("data-is-owned")&&"false"===c[0].attributes.getNamedItem("data-is-owned").value?!1:!0;a._triggerInstrumentRowSelectedEvent(b.instrumentId,d,c)}}});a.widget.on("showInstallmentActivation",a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||h.showElement(a.getDOMElement("creditCardInstallmentActivationExpander-"+b.instrumentId))});a.widget.on(c,a,function(b){if(!this.shouldDecoupleCardsFromSavedCardsSection){var c=a.selectedInstrumentId;a.selectedInstrumentId=
b.instrumentId;a._instrumentRowSelected(b.instrumentId,c)}});a.widget.on("showAddressChallenge",a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||(h.showElement(a.getDOMElement("addressChallengeMessages-"+b.instrumentId)),h.showElement(a.getDOMElement("addressChallengeMobileConfirmButtons-"+b.instrumentId)),h.showElement(a.getDOMElement("addressChallengeScan-"+b.instrumentId)))});a.widget.on("addressChallengePassed",a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||(h.hideElement(a.getDOMElement("addressChallengeMessages-"+
b.instrumentId)),h.hideElement(a.getDOMElement("addressChallengeMobileConfirmButtons-"+b.instrumentId)),h.hideElement(a.getDOMElement("addressChallengeScan-"+b.instrumentId)))});a.widget.on("showAddressChallengeErrors",a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||a._showAddressChallengeErrors(b)});a.widget.on("hideAddressChallengeErrors",a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||(h.hideElement(a.getDOMElementsByPrefix("addressChallengeError-"+b.instrumentId)),h.hideElement(a.getDOMElement("addressChallengeErrors-"+
b.instrumentId)))});a.widget.on("apbSelectionChanged",a,function(b){if(!this.shouldDecoupleCardsFromSavedCardsSection){var c=a._getCreditCardRow(a.selectedInstrumentId).hasClass("pmts-selected");a.widget.get("apbCheckboxSelected")!==r&&c&&this.widget.trigger("toggleInstallmentDropDown",{isAPBSelected:b.isSelected,instrumentId:a.selectedInstrumentId});a.isAPBWithEMIEnabled&&this.widget.trigger("apbSelectionChangedForAPBWithEMIFeature",{selectedInstrumentId:a.selectedInstrumentId})}});a.widget.on("resetSelectedPaymentMethod",
a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||(this._deselectingInstrument(a.selectedInstrumentId),a.selectedInstrumentId="",this.setContinuable(!1),b=b.isInstallmentPlansAvailable?a.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"):a.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message"),this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:b}),this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",
{message:b}))});a.widget.on("inactiveMbccSelected",a,function(b){this.shouldDecoupleCardsFromSavedCardsSection||h.showElement(a.getDOMElementsByPrefix("inactiveMbccMessages-"+b.instrumentId))});a.widget.on("balanceSelectionChanged",a,function(c){if(!this.shouldDecoupleCardsFromSavedCardsSection){var e=0<=b.indexOf(d,c.paymentMethod);!0===a._isB2BCrossWalletMultitenderEnforcementEnabled?!0===a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",c)&&a._deselectCreditCardInstrumentRow():
this.isABCrossCustomerMultiTenderSuppressionEnabled&&e&&!c.isBackingInstrument&&c.isSelected&&this._updateBackingInstrumentState(c)}})}})});m("components/CreditCardAddressChallengeComponent","lang css-utils server jQuery form-component validation-functions keyboard public-event-registry events/PaymentMethodChallengedEvent attributes cc-spacing".split(" "),function(c,g,f,h,l,b,e,n,q,a,k){return l.extend(a,{addressChallenge:!0,installmentActivation:!1,_issuer:"",_creditCardTail:"",_instrumentSelectionValue:"",
isStandalone:!1,initialize:function(a,b){n.register(q.eventName);this._issuer=b.data.issuer;this._creditCardTail=b.data.cardNumberTail;this.isStandalone=b.data.isStandalone;this.installmentActivation=b.data.installmentActivation||this.installmentActivation;this.useNewAddressChallengeFormat=b.data.useNewAddressChallengeFormat||!1;this.form.formModel.registerAdditionalData("issuerFn",this._issuer);this.form.formModel.registerAdditionalData("creditCardTail",this._creditCardTail);b.data.disableConfirmButton&&
g.disableElement(this.getDOMElement("addressChallengeConfirmButton"));this.set("ConfirmButtonEnabledAttribute",!b.data.disableConfirmButton);this.watch("ConfirmButtonEnabledAttribute",this,function(a){this.widget.log({confirmButtonEnabled:a});a?g.enableElement(this.getDOMElement("addressChallengeConfirmButton")):g.disableElement(this.getDOMElement("addressChallengeConfirmButton"))})},bindToElements:function(){var a=this;a.getDOMElement("addressChallengeConfirmButton").click(function(b){b.preventDefault();
a.confirmButtonClicked()});a.getDOMElement("addressChallengeCreditCardNumber").keypress(function(b){b.which===e.keys.VK_RETURN&&(b.preventDefault(),a.confirmButtonClicked())});var b,c;a.getDOMElement("addressChallengeCreditCardNumber").keydown(function(a){b=this.value;c=this.selectionStart});a.getDOMElement("addressChallengeCreditCardNumber").keyup(function(a){"number"!==this.type&&this.value!==b&&(a=this.selectionStart,this.value=k.fixSpacing(this.value),a=k.fixCaret(a,this.value,b,c),this.setSelectionRange(a,
a))})},bindToEvents:function(){var a=this;a.widget.on("creditCardRowSelected",a,function(b){var c=!1;if(a.data.instrumentId===b.instrumentId){a._instrumentSelectionValue=b.instrumentSelectionValue;if(a.addressChallenge)a.installmentActivation?a.widget.trigger("showInstallmentActivation",{instrumentId:b.instrumentId}):a.widget.trigger("showAddressChallenge",{instrumentId:b.instrumentId});else return;c=!0}a.toggleAddressChallengeForm(c)});a.widget.on("confirmButtonClicked",a,function(b){a.data.instrumentId===
b.instrumentId&&a.confirmButtonClicked()});a.widget.on("addressChallengePassed",a,function(b){a.data.instrumentId===b.instrumentId&&(a.widget.trigger(q.eventName,q.successStatus),a.addressChallenge=!1,a.toggleAddressChallengeForm(!1),a.getDOMElement("addressChallengeCreditCardNumber").remove(),a.getDOMElement("addressChallengeCreditCardVerificationNumber").remove())});a.widget.on("addressChallengeCreditCardInfo",a,function(b){b.creditCardNumber&&a.getDOMElement("addressChallengeCreditCardNumber").val(b.creditCardNumber)});
a.widget.on("addressChallengeConfirmButtonClicked",a,function(b){a.confirmButtonClicked()});a.widget.on("hideAddressChallengeErrors",a,function(b){a.data.instrumentId===b.instrumentId&&a.form.clearValidationErrors()});a.widget.on("expirationDateValidated",a,function(b){a.data.instrumentId===b.instrumentId&&a.validateAddressChallengeForm(b.isExpirationDateValid,b.expMonth,b.expYear)})},confirmInstrument:function(a,b){var d=this,e=d.form.getFormValues(),f=d.data.instrumentId;e={"ppw-widgetEvent":d.isStandalone?
"ConfirmCreditCardEvent":"ConfirmAndUpdateCreditCardEvent","ppw-instrumentId":f,"ppw-installmentActivation":d.installmentActivation.toString(),"ppw-refreshView":d.installmentActivation.toString(),addCreditCardNumber:e.addCreditCardNumber,addCreditCardVerificationNumber:e.addCreditCardVerificationNumber,"ppw-instrumentRowSelection":d._instrumentSelectionValue,"ppw-widgetState":d.widget.options.serializedState};d.useNewAddressChallengeFormat||(e["ppw-expirationDate_month"]=a,e["ppw-expirationDate_year"]=
b);a={success:c.bind(d.onConfirmCreditCardSuccess,d),error:function(){d._showAddressChallengeErrors(f,[{messageStringId:"pmts_portal_payselect_cc_address_challenge_error_unknown"}])},resumeContinueQueueOnError:!0};d.widget.submitFormAJAX(e,a)},onConfirmCreditCardSuccess:function(a){a=a.additionalWidgetResponseData.additionalData;if("ok"===a.status)this.widget.trigger("addressChallengePassed",{instrumentId:this.data.instrumentId});else{"true"===a.retryExceeded&&this.set("ConfirmButtonEnabledAttribute",
!1);var b=a.errors?a.errors.split(","):[],d=[];c.forEach(b,function(a){d.push({messageStringId:a})});this.useNewAddressChallengeFormat&&this.form.renderErrorMessages(this.form._getLocalizedErrorMessages(d));this._showAddressChallengeErrors(this.data.instrumentId,d)}this.useNewAddressChallengeFormat||"ok"!==a.updateCreditCardStatus||this.widget.trigger("creditCardUpdated",{instrumentId:this.data.instrumentId,newExpMonth:a.newExpMonth,newExpYear:a.newExpYear})},_showAddressChallengeErrors:function(a,
b){this.widget.trigger(q.eventName,q.failureStatus);this.widget.trigger("showAddressChallengeErrors",{instrumentId:a,errorMessages:b})},toggleAddressChallengeForm:function(a){g.toggleElement(this.getDOMElement("addressChallengeForm"),a);a&&(this.widget.trigger(q.eventName,q.showStatus),this.widget.publishSuccessSushiMetrics({ActionType:"ShowCreditCardAddressChallenge",ActionValueType:"PaymentInstrument",ActionValue:this.data.instrumentId}))},validateAddressChallengeForm:function(a,b,c){var d=this.form.validateForm();
0<d.length?this._showAddressChallengeErrors(this.data.instrumentId,d):this.useNewAddressChallengeFormat?this.confirmInstrument():a&&this.confirmInstrument(b,c)},confirmButtonClicked:function(){this.get("ConfirmButtonEnabledAttribute")&&(this.widget.trigger("hideAddressChallengeErrors",{instrumentId:this.data.instrumentId}),this.useNewAddressChallengeFormat?this.validateAddressChallengeForm():this.widget.trigger("addressChallengeValidate",{instrumentId:this.data.instrumentId}))}})});m("events/PaymentMethodChallengedEvent",
[],function(){return{eventName:"PaymentMethodChallengedEvent",showStatus:"SHOW",successStatus:"SUCCESS",failureStatus:"FAILURE"}});m("components/FinancialOfferComponent","css-utils component lang clog jQuery AUI!P".split(" "),function(c,g,f,h,l,b){var e;b.when("A").execute(function(b){b.on("a:dropdown:pmts-financial-offers-dropdown-native-id:select",function(b){var a=e.filter(function(a){if(a.financialOfferId===b.value&&"Financing"===a.offerCategory)return a});1===a.length?h.logCounterMetric({feature:"equal-pay-financing-selected",
resource:"_Count"}):console.log((1<a.length?"Duplicate":"No matching")+" financial offer detected.")})});return g.extend({initialize:function(b,c){this.instrumentId=c.data.instrumentId;this.isMobile="mobile"===b.options.deviceType;this.financialOfferDisplayStringsMap=c.data.financialOfferDisplayStringsMap;e=c.data.financialOfferBOs},bindToEvents:function(){this.widget.on("toggleFinancialOffer",this,function(b){this.instrumentId===b.instrumentId&&this._toggleFinancialOffers(b.isSelected,b.isAddressChallenged)})},
bindToElements:function(){this.getDOMElement("financialOffersContinueButton").click(f.bind(this._financialOfferContinueButtonClicked,this))},_toggleFinancialOffers:function(b,e){var a=this.getDOMElement("financialOffers-Mobile"),f=this.getDOMElement("financialOffers-Desktop"),d=this.getDOMElement("financialOfferTermsAndConditions-"+this.instrumentId),g=this.getDOMElement("deferredPaymentsWarning-Desktop"),l=this.getDOMElement("deferredPaymentsWarning-Mobile"),h=this.getDOMElement("financialOfferMessages-Desktop"),
n=this.getDOMElement("financialOfferMessages-Mobile"),q=this.getDOMElement("financialOffersMobileButtonContainer-"+this.instrumentId);c.toggleElement(a,!(b&&(this.isMobile||e)));c.toggleElement(l,b&&this.isMobile&&!e);c.toggleElement(f,b&&!e);b=b&&!e;c.toggleElement(d,b);c.toggleElement(q,b);c.toggleElement(g,b);c.toggleElement(h,b);c.toggleElement(n,b&&this.isMobile)},_financialOfferContinueButtonClicked:function(){this._updateFinancialOfferMobileButtonContent(this.instrumentId);this._closeFinancialOfferSecondaryPopover(this.instrumentId)},
_updateFinancialOfferMobileButtonContent:function(b){var c=this.getDOMElement("financialOffersMobileButton-"+b);c.find("input").remove();var a=this.getDOMElement("financialOffersMobilePopover-"+b);if(a=this._getSelectedFinancialOfferId(a))this._appendHiddenInput(a,c),this._updateButtonDisplayText(a,c),b=this.getDOMElement("financialOfferDisplayString-"+b),this._updateFinancialOfferDisplayText(a,b)},_updateFinancialOfferDisplayText:function(b,c){c.text(this.financialOfferDisplayStringsMap[b])},_updateButtonDisplayText:function(b,
c){c.find("span").find("span").text(this.financialOfferDisplayStringsMap[b])},_appendHiddenInput:function(b,c){l('\x3cinput type\x3d"hidden"\x3e').attr({name:"ppw-"+this.instrumentId+"_financialOfferId",value:b}).appendTo(c)},_getSelectedFinancialOfferId:function(b){var c="";b.find("input").each(function(a,b){b&&b.type&&b.name&&b.value&&"radio"===b.type&&b.checked&&(c=b.value)});return c},_closeFinancialOfferSecondaryPopover:function(c){b.when("a-secondary-view").execute(function(b){b&&(b=b.get("financialOffersSecondaryPopover-"+
c))&&b.hide()})}})});m("mixins/tfx-currency-mixin",["events/InstrumentRowSelectedEvent","clog"],function(c,g){var f=!1,h,l,b,e=null,n=!1,m=!1;return{initialize:function(a,c){this.isEligibleForTfxRevise=c.data.isEligibleForTfxRevise;this.isTfxReviseJsImprovementsWeblabEnabled=c.data.isTfxReviseJsImprovementsWeblabEnabled;this.isEligibleForTfxRevise&&(f=!0,h=c.data.tfxReviseEligibleCurrencyCode,l=c.data.tfxReviseEligibleCurrencyCodeFormatted,b=c.data.marketplaceCurrencyCode)},bindToEvents:function(){var a=
this,b=a.form.fields.currencySelection;if(a.isTfxReviseJsImprovementsWeblabEnabled)a.widget.on(c,a,function(c){c.instrumentId===a.data.instrumentId?((c=a.form.getFormValues()[b.radioButtonName])||(c=a.form.getFormValues()[b.dropdownName]),a._updateTfxComponentsForRevise(c),n=!0):e||(e=p.setTimeout(function(){n||a._updateTfxComponentsForRevise();n=!1;e=null},100));g.publishMetrics()})},bindToElements:function(){var a=this,b=a.form.fields.currencySelection;a.isTfxReviseJsImprovementsWeblabEnabled&&
(a.form.bindToParameter(b.radioButtonName,"change",function(c){a._updateTfxComponentsForRevise(a.form.getFormValues()[b.radioButtonName],a.marketplaceCurrency);g.logCounterMetric({feature:"CurrencySelectionFieldRadioButtonChanged",resource:"_Count"});g.publishMetrics()}),a.form.bindToParameter(b.dropdownName,"change",function(c){a._updateTfxComponentsForRevise(a.form.getFormValues()[b.dropdownName],a.marketplaceCurrency);g.logCounterMetric({feature:"CurrencySelectionFieldDropdownChanged",resource:"_Count"});
g.publishMetrics()}))},_updateTfxComponentsForRevise:function(a){f&&(this.isEligibleForTfxRevise&&a===h?(this._changeTextOnContinueButton("pmts_portal_continue_button_with_tfx_currency",{currencyCode:a}),this._updateRevisePaymentErrorMessage("revisepayment_tfxPaymentRevisionEnabled_title_success","revisepayment_tfxPaymentRevisionEnabled_body_success",{currencyCode:l},"success"),g.logCounterMetric({feature:"TfxRevisePaymentValidSelection",resource:"_Count"})):(a?this._changeTextOnContinueButton("pmts_portal_continue_button_with_tfx_currency",
{currencyCode:b}):this._changeTextOnContinueButton("pmts_portal_select_instrument_box_side_button_continue"),this._updateRevisePaymentErrorMessage("revisepayment_tfxPaymentRevisionEnabled_title_failure","revisepayment_tfxPaymentRevisionEnabled_body_failure",{currencyCode:l,marketplaceCurrencyCode:b},"warning"),g.logCounterMetric({feature:"TfxRevisePaymentInvalidSelection",resource:"_Count"})))},_changeTextOnContinueButton:function(a,b){this.widget.trigger("setContinueButtonText",{stringId:a,parameters:b})},
_updateRevisePaymentErrorMessage:function(a,b,c,e){m?this.widget.trigger("updateRevisePaymentErrorMessage",{titleStringId:a,bodyStringId:b,parameters:c,notificationType:e}):m=!0}}});m("components/SelectableDPMInstrumentListItemComponent",["components/SelectablePaymentMethodListItemComponent"],function(c){return c});m("components/SelectableHBAListComponent",["css-utils","jQuery","form-component"],function(c,g,f){return f.extend({initialize:function(c,f){this._showModernFrameCx=f.data.showModernFrameCx;
this._descriptorId=f.data.descriptorId;this._toggleSwitchName=f.data.toggleSwitchName;this._multipleHBAEligibleSubtotalJsBinding=f.data.multipleHbaEligibleSubtotal;this._multipleHBAEligibleSubtotalExcludePromoJsBinding=f.data.multipleHbaEligibleSubtotalExcludePromo;this.$instrumentItemListContent=this.getDOMElement("instrumentItemListContent");this.$hbaListSelection=this._showModernFrameCx?g("input[name\x3d"+this._toggleSwitchName+"]"):this.getDOMElement("hbaListSelection")},_handleSelectionChange:function(f){c.toggleElement(this.$instrumentItemListContent,
f);this.widget.trigger("optionalInstrumentListSelectionChanged",{paymentMethodCode:"HealthBenefitsCard",selected:f})},bindToElements:function(){var c=this;if(this._showModernFrameCx){E.when("a-switch","jQuery").execute(function(){c.$hbaListSelection.val(c._descriptorId)});var f="a:switch:"+this._toggleSwitchName+":flip";this.widget.offAui(f);this.widget.onAui(f,function(b){c._handleSelectionChange(b.switchState.isOn)})}else this.$hbaListSelection.change(function(){var b=g(this).is(":checked");c._handleSelectionChange(b)})},
bindToEvents:function(){this.widget.on("componentsInitialized",this,function(){this.$hbaListSelection.length&&!this.$hbaListSelection.is(":checked")&&this._handleSelectionChange(!1)});this.widget.on("balanceSelectionChanged",this,function(c){"PROMO"===c.paymentMethod&&this._onPromoSelected(c.isSelected)})},_onPromoSelected:function(f){"amzn1.poa.poda.HealthBenefitsCard"===this._descriptorId&&(c.toggleElement(this.getDOMElement(this._multipleHBAEligibleSubtotalJsBinding),f),c.toggleElement(this.getDOMElement(this._multipleHBAEligibleSubtotalExcludePromoJsBinding),
!f))}})});m("components/SelectableHBAListItemComponent",["components/SelectablePaymentMethodListItemComponent"],function(c){return c});m("SelectableHbaListItemHelper",["css-utils","jQuery","events/InstrumentRowSelectedEvent"],function(c,g,f){return function(h){function l(a){return"apx-".concat(u._paymentMethodCode).concat("-"+a)}function b(a){y=a;w?(c.toggleElement(u.getDOMElement(l("eligible-amount-details")),!0),c.toggleElement(u.getDOMElement(l("amount-field")),a)):B?(t.prop("checked",a),c.toggleElement(u.getDOMElement(l("eligible-amount-details")),
!0),c.toggleElement(u.getDOMElement(l("amount-field")),a),C[a?"addClass":"removeClass"]("pmts-selected")):(t.prop("checked",a),c.toggleElement(u.getDOMElement(l("eligible-amount-details")),a));e(a?"optionalInstrumentSelected":"optionalInstrumentDeselected",u.data.errors)}function e(b,c){u.widget.trigger(b,{instrumentId:u._instrumentId,errors:c,paymentMethodCode:u._paymentMethodCode,balance:a()})}function n(a){G===a.instrumentId&&y&&(e("optionalInstrumentSelected",u._getDisplayableErrors(a.errors)),
m(!0))}function m(b){if(b){b=parseFloat(u.data.purchaseTotal);var c=a()+F;c>=b?k():A>=u.data.purchaseTotal||c+A>=b&&k()}else d(!1)}function a(){var a=g("[data-pmts-component-id\x3d"+u.id+"] .apx-hba-requested-amount-input input");return a.length?parseFloat(a.val())+parseFloat(u.data.taxExcludedFromEligibleSubtotal):parseFloat(u.data.eligibleSubtotal)+parseFloat(u.data.taxExcludedFromEligibleSubtotal)}function k(){u.widget.trigger(f,{paymentMethod:u._paymentMethodCode,instrumentId:u._instrumentId});
u.widget.trigger("backingInstrumentDeselected",{});d(!0)}function d(a){u.widget.trigger("hbaCoverageChanged",{coversPurchaseTotal:a})}function p(a){E.when("a-switch","jQuery").execute(function(b){b=b.getSwitch(z);null!=b&&b.isOn(a)})}function v(a){w?p(a):(b(a),m(a))}var u=h,r=u.data.index,t=u.getDOMElementsByPrefix("hbaCardSelection"),F=0,A=0,G=u._instrumentId.replace("HealthBenefitsCard","HBA"),z=g("input[name\x3d"+u.data.toggleSwitchName+"]"),w=u._shouldDisplayModernizedFrame&&"radio"!==t.prop("type"),
B=u._shouldDisplayModernizedFrame&&"radio"===t.prop("type"),y=w?z.is(":checked"):t.is(":checked"),C=u.getDOMElementsByPrefix("pmts-modern-hba-box");return{bindToEvents:function(){u.widget.on("componentsInitialized",u,function(){v(y)});u.widget.on("UserRequestedUpperAmountLimitValidated",u,n);u.widget.on("optionalInstrumentListSelectionChanged",u,function(a){a.paymentMethodCode===this._paymentMethodCode&&(a=a.selected&&0===r,a!==y&&v(a))});u.widget.on("optionalInstrumentSelected",u,function(a){a.paymentMethodCode===
u._paymentMethodCode&&a.instrumentId!==u._instrumentId&&y&&b(!1)});u.widget.on("balanceSelectionChanged",u,function(b){if("GC"===b.paymentMethod||"PROMO"===b.paymentMethod)"GC"===b.paymentMethod?A=b.isSelected?parseFloat(b.balance):0:"PROMO"===b.paymentMethod&&(F=b.isSelected?parseFloat(b.balance):0,c.toggleElement(u.getDOMElement("pmts-hba-eligible-subtotal-text"),b.isSelected),c.toggleElement(u.getDOMElement("pmts-hba-eligible-subtotal-exclude-promo-text"),!b.isSelected)),y&&(b=a()>=parseFloat(u.data.purchaseTotal)-
F-A,d(b))})},bindToElements:function(){if(w){E.when("a-switch","jQuery").execute(function(){y=z.is(":checked");z.val(u._instrumentId)});var a="a:switch:"+u.data.toggleSwitchName+":flip";u.widget.offAui(a);u.widget.onAui(a,function(a){b(a.switchState.isOn);m(a.switchState.isOn)})}else B&&C.click(function(a){g(a.currentTarget).data("disabled")||v(!0)}),t.change(function(){var a=t.is(":checked");v(a)})}}}});m("components/SelectableIdealListComponent",["form-component"],function(c){return c});m("components/SelectableIdealListItemComponent",
["components/SelectablePaymentMethodListItemComponent","jQuery"],function(c,g){return c.extend({bindToElements:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToElements();else{var c=this;c.getDOMElementsByPrefix("POAInstrumentContainer").click(function(f){g(f.currentTarget).data("disabled")||c.poaInstrumentClicked(c._instrumentId)});c.widget.on("initializeRecommendedInstrument",c,function(f){f.instrumentId!==c._instrumentId||c.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||
(c._poaInstrumentSelected(),c.poaInstrumentClicked(c._instrumentId))})}}})});m("components/SelectableOtherPaymentMethodListComponent",["component","lang"],function(c,g){return c.extend({})});m("components/CashOnDeliveryListComponent",["component"],function(c){return c.extend({})});m("components/CashOnDeliveryListItemComponent","continuable css-utils components/SimplePaymentOptionListItemComponent lang events/InstrumentRowSelectedEvent mixins/b2b-cross-wallet-mixin".split(" "),function(c,g,f,h,l,b){var e=
["GC","JPPoints","ProductVoucher","PROMO"];return f.extend(c,b,{containerName:null,initialize:function(b,c){this.isPaymentOptionEditable=!0===c.data.isEditable;this.containerName=c.data.cashOnDeliveryContainerName;this.isSuppressed=c.data.isSuppressed;this.isMultiTenderDisabledWithGiftCard=c.data.isMultiTenderDisabledWithGiftCard;this.isPaylastEligible=c.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;this._shouldDisplayModernizedFrameCX=
c.data.shouldDisplayModernizedFrameCX;this._modernizedPaymentArtGridCssClass=c.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=c.data.disabledSectionCssClass;this.paystationInstrumentId=c.data.paystationInstrumentId;this._toggleOTPVerificationComponent(!1);this.$apbDeselectMessage=this.getDOMElement("apbDeselectMessageOnCodSelection");this.data.isValid!==r&&(this.isValid=this.data.isValid);this.data.newOTPVerificationFlowEnabled!==r&&(this.newOTPVerificationFlowEnabled=this.data.newOTPVerificationFlowEnabled);
this.isAPVEnabledForCustomer=c.data.isAPVEnabledForCustomer},_getContainerElement:function(){return this.getDOMElement(this.containerName)},bindToEvents:function(){var b=this,c=!this._shouldDisplayModernizedFrameCX;h.bind(f.prototype.bindToEvents,this).apply();b.widget.on("apbSelectionChanged",b,function(a){b.widget.get("apbCheckboxSelected")!==r&&(this._isInstrumentSelected()&&a.isSelected&&(this.setContinuable(!1),b.widget.trigger("PaymentPlanSelected",{isValid:!1})),a.isCODAPBToggleEnabled?this.isSuppressed?
this.setDisabled(!0,c):a.isSelected&&this._onInstrumentDeselected(a):this.setDisabled(a.isSelected||this.isSuppressed,c));this._toggleOTPVerificationComponent(!1)});if(this.isAPVEnabledForCustomer)b.widget.on("apvSelectionChanged",b,function(a){a&&!a.canCoverPurchaseStandalone&&a.isSelected&&this._isInstrumentSelected()&&(this.setContinuable(!1),b.widget.trigger("PaymentPlanSelected",{isValid:!1,message:this.widget.getLocalizedString("apx_checkout_disable_conitnue_when_apv_selected_after_cod")}),
this._onInstrumentDeselected(a))});b.widget.on("OTPVerificationSuccessful",b,function(){this._triggerBackingInstrumentSelectedEvent()});b.widget.on("initializeRecommendedInstrument",b,function(a){a.instrumentId===b.data.paystationInstrumentId&&this._onInstrumentSelected()});b.widget.on("optionalInstrumentSelected",b,function(a){b.isMultiTenderDisabledWithGiftCard&&"GC"===a.paymentMethod&&this.setDisabled(!0,c)});b.widget.on("optionalInstrumentDeselected",b,function(a){b.isMultiTenderDisabledWithGiftCard&&
"GC"===a.paymentMethod&&this.setDisabled(this.isSuppressed,c)});b.widget.on("apbDeselectMessageEventOnCodSelection",b,function(a){g.showElement(b.getDOMElement("apbDeselectMessageOnCodSelection"))});b.widget.on("balanceSelectionChanged",b,function(a){var c=!1!==a.isInstrumentOwned,d=!1!==b._getIsOwned();!0===b._isB2BCrossWalletMultitenderEnforcementEnabled?!0===b.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",a)&&b._updateBackingInstrumentState():b.data.isABCrossCustomerMultiTenderSuppressionEnabled&&
0<=h.indexOf(e,a.paymentMethod)&&d!==c&&!a.isBackingInstrument&&a.isSelected&&this._updateBackingInstrumentState()})},onDisabledChange:function(b){this._shouldDisplayModernizedFrameCX&&this._getContainerElement().find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!!b)},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);if(!this.isValid&&this.newOTPVerificationFlowEnabled){this._toggleOTPVerificationComponent(!0);
var b=[this.widget.getLocalizedString("pmts_portal_otp_required_for_cod")];this._triggerBackingInstrumentSelectedEvent(b)}else this.widget.trigger("selectableCashOnDeliverySelected"),this._triggerBackingInstrumentSelectedEvent(null);this.showFloatingContinueBarOnNonPaylastPSP||this.widget.trigger("SetContinueButtonTextToPlaceOrder");(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();this.widget.trigger("codSelectionEvent")},_onInstrumentDeselected:function(b){this._getContainerElement().removeClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!1);this.widget.trigger("selectableCashOnDeliveryDeselected");!this.isValid&&this.newOTPVerificationFlowEnabled&&this._toggleOTPVerificationComponent(!1);this.widget.trigger("SetContinueButtonTextToPlaceOrderAndPay");g.hasAUIHiddenClass(this.$apbDeselectMessage)||g.hideElement(this.getDOMElement("apbDeselectMessageOnCodSelection"))},_triggerBackingInstrumentSelectedEvent:function(b){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),
instrumentType:this._getInstrumentType(),errors:b,paymentMethod:this.data.paymentMethod})},_toggleOTPVerificationComponent:function(b){g.toggleElement(this.getDOMElement("OTPComponent"),b)},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})}})});m("components/ConvenienceStorePaymentListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent",
"lang","mixins/b2b-cross-wallet-mixin"],function(c,g,f,h,l){return f.extend(l,{initialize:function(b,c){this.isPaymentOptionEditable=!0===c.data.isEditable},bindToEvents:function(){var b=this;h.forEach(["initializeRecommendedInstrument",c],function(c){b.widget.on(c,b,function(c){c.instrumentId===b._getInstrumentId()?b._onInstrumentSelected():b._onInstrumentDeselected()})});b.widget.on("balanceSelectionChanged",b,function(c){!0===b.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",
c)&&b._updateBackingInstrumentState()})},_getContainerElement:function(){return this.getDOMElement("cvsBalanceContainer")}})});m("components/DebitCardListItemComponent",["component","events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang"],function(c,g,f,h,l){return h.extend({initialize:function(b,c){this._fundingSourceIds=c.data.fundingSourceIds||[];this._inPickAddressWorkflow=!1;this._isRecommended=c.data.isRecommended||!1;this._initiallySelectedBank=
c.data.initiallySelectedBank||"";this._creatableDebitCards=c.data.creatableDebitCards||[];this._debitCardDropdown=this.getDOMElement("indiaDebitCardDropdown");this.isPaymentOptionEditable=!0===c.data.isEditable;this._toggleMobileContentWrapper(!1);this._disableAllDropdownMessages()},_onInstrumentSelected:function(){var b=this._debitCardDropdown.val();this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._disableAllDropdownMessages();
this._toggleMobileContentWrapper(!0);this._disableContinueButton(b);this._inPickAddressWorkflow||-1!==this._creatableDebitCards.indexOf(b)?this._enableAddDebitCardFormWorkflow(b):this._isRecommended?this._enableAddDebitCardFormWorkflow(this._initiallySelectedBank):b&&this._enableContinueButtonWorkflow(b)},_onInstrumentDeselected:function(){this._toggleSelectedDropdownMessage(!1);this._getContainerElement().removeClass("pmts-selected");this._disableAllDropdownMessages();this._toggleMobileContentWrapper(!1);
this.widget.trigger("selectableAddDebitCardDeselected")},bindToElements:function(){var b=this;l.bind(h.prototype.bindToElements,this).apply();b.getDOMElement("indiaDebitCardDropdown").change(function(){b.widget.trigger(g,{instrumentId:b._getInstrumentId(),instrumentType:b._getInstrumentType()})})},_disableAllDropdownMessages:function(){var b=this;l.forEach(this._fundingSourceIds,function(c){b._toggleSelectedDropdownMessage(c,!1)})},_getContainerElement:function(){return this.getDOMElement("indiaDebitCardContainer")},
bindToEvents:function(){var b=this;l.forEach(["initializeRecommendedInstrument",g],function(c){b.widget.on(c,b,function(c){c.instrumentId===this._getInstrumentId()?b._onInstrumentSelected():b._onInstrumentDeselected()})});this.widget.on("selectableAddDebitCardSelectedOnInitialize",this,function(b){this._inPickAddressWorkflow=b.inPickAddressWorkflow;this._onInstrumentSelected();b.inPickAddressWorkflow&&(b=this.getDOMElement("indiaDebitCardDropdown").closest("div"),f.hideElement(b))})},_toggleMobileContentWrapper:function(b){0<
this.getDOMElement("mobileContentWrapper").length&&f.toggleElement(this.getDOMElement("mobileContentWrapper"),b)},_toggleSelectedDropdownMessage:function(b,c){f.toggleElement(this.getDOMElement(b),c)},_enableContinueButtonWorkflow:function(b){this.widget.trigger("selectableAddDebitCardDeselected");this._toggleSelectedDropdownMessage(b,!0);this._triggerBackingInstrumentSelectedEvent()},_enableAddDebitCardFormWorkflow:function(b){this._toggleSelectedDropdownMessage(b,!1);this.widget.trigger("selectableAddDebitCardSelected");
this.widget.trigger("debitCardTypeSelected",{selectedBank:b})},_disableContinueButton:function(b){b&&-1===this._creatableDebitCards.indexOf(b)||this.widget.trigger("selectableDebitCardSelectedDisableContinue")}})});m("components/ExternalPaymentListComponent",["component"],function(c){return c.extend({})});m("components/ExternalPaymentListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang"],function(c,g,f,h){return f.extend({containerName:null,
externalPaymentDropdownJSBinding:null,initialize:function(c,b){this.isPaymentOptionEditable=!0===b.data.isEditable;this.containerName=b.data.externalPaymentContainerName;this.externalPaymentDropdownJSBinding=b.data.externalPaymentDropdownJSBinding},bindToElements:function(){var g=this;h.bind(f.prototype.bindToElements,this).apply();g.getDOMElement(g.externalPaymentDropdownJSBinding).change(function(){g.widget.trigger(c,{instrumentId:g._getInstrumentId(),instrumentType:g._getInstrumentType()})})},
bindToEvents:function(){h.bind(f.prototype.bindToEvents,this).apply();this.widget.on("initializeRecommendedInstrument",this,function(c){-1!==h.indexOf(this.data.fundingSourceIds,c.instrumentId)&&this._triggerBackingInstrumentSelectedEvent(this._getDisplayableErrors(this.form.validateForm(!0)))});this.widget.on(c,this,function(c){c.instrumentId===this.data.instrumentId?(this._toggleInstallmentOffers(!0),""===this.getDOMElement("installmentSelections")[0].innerHTML&&this._triggerInstallmentDetails()):
this._toggleInstallmentOffers(!1)})},_getContainerElement:function(){return this.getDOMElement(this.containerName)},_toggleInstallmentOffers:function(c){g.toggleElement(this.getDOMElement("installmentSelections"),c)},_triggerInstallmentDetails:function(){this.widget.trigger("installmentOptionChanged")}})});m("components/NetBankingListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang","payment-method-fee-utils"],function(c,g,f,h,
l){var b={SUPPRESSED:"SuppressedNetBankingOptionSelected",ACTIVE:"ValidNetBankingOptionSelected",EMPTY_SELECTION:"NoNetBankingOptionSelected"};return f.extend({initialize:function(b,c){this.isPaymentOptionEditable=!0===c.data.isEditable;this.isPaylastEligible=c.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;this._toggleMobileNetBankingContentWrapper(!1);this.NB_InstrumentId=c.data.instrumentId;this.isNomenclatureWave2Enabled=c.data.isNomenclatureWave2Enabled;
this.paymentMethodFeeData=c.data.paymentMethodFeeData;this.isConvenienceFeeEnabled=c.data.isConvenienceFeeEnabled},_getContainerElement:function(){return this.getDOMElement("netBankingContainer")},_togglePaymentMethodFeeSection:function(b){this.isConvenienceFeeEnabled&&g.toggleElement(this.getDOMElement("netBankingPaymentMethodFeeSection"),b)},_updateAndTogglePaymentMethodFeeSection:function(){if(this.isConvenienceFeeEnabled)try{var b=l.getFeeApplied(this.paymentMethodFeeData,"NetBanking");null!==
b&&null!==b.valueToken?(this.getDOMElement("netBankingPaymentMethodFeeString")[0].innerHTML=this.widget.getLocalizedString("pmts_portal_pay_select_convenience_fee_content",{fee_amount:b.valueToken}),this._togglePaymentMethodFeeSection(!0)):this._togglePaymentMethodFeeSection(!1)}catch(n){console.log(n),clog.logCounterMetric({feature:"NetBankingUpdatePaymentMethodFeeException",resource:"_Count"}),this._togglePaymentMethodFeeSection(!1)}},bindToElements:function(){var b=this;h.bind(f.prototype.bindToElements,
this).apply();b.widget.on("initializeRecommendedInstrument",b,function(b){b.instrumentId===this.NB_InstrumentId&&this._toggleMobileNetBankingContentWrapper(!0)});this._isDesktop?b.getDOMElement("NetBankingRecommendationLink").mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"NetBankingRecommendationPopover",ActionValueType:"Mouseover"})}):b.getDOMElement("NetBankingRecommendationLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"NetBankingRecommendationPopover",
ActionValueType:"Click"})});b.getDOMElement("netBankingDropDown").change(function(){b.widget.trigger(c,{instrumentId:b._getInstrumentId(),instrumentType:b._getInstrumentType()})});b.widget.on(c,b,function(c){this.isNomenclatureWave2Enabled&&b._toggleNetbankingDropdown(c&&c.instrumentId===b._getInstrumentId());b.getDOMElement("mobileNetbankingContentWrapper").length&&(c&&c.instrumentId===b._getInstrumentId()?b._toggleMobileNetBankingContentWrapper(!0):b._toggleMobileNetBankingContentWrapper(!1));c&&
c.instrumentId===b._getInstrumentId()?b._updateAndTogglePaymentMethodFeeSection():b._togglePaymentMethodFeeSection(!1);b._toggleNudgeMessage(c&&c.instrumentId===b._getInstrumentId());b._disableContinueIfSuppressed(c);(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&c&&c.instrumentId===b._getInstrumentId()&&b._resetOrderTotalComputation()})},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",
{noCostEMIValue:0})},_disableContinueIfSuppressed:function(b){if(b.instrumentId!==this.NB_InstrumentId)this._showNBSuppressionMessage(!1);else{b="EMPTY_SELECTION";var c=this.getDOMElement("netBankingDropdownSelect")[0].value;var e=c&&0<=c.indexOf(" ")?c.substr(0,c.indexOf(" ")):c;if(this.data.suppressedFsIdMap&&-1!==h.keys(this.data.suppressedFsIdMap).indexOf(e)&&""!==e){if(c=this.getDOMElement("netBankingSuppressionMsg")[0])b=this.data.suppressedFsIdMap[e],this.data.isNomenclatureWave2Enabled?c.textContent=
b+" "+this.widget.getLocalizedString("apx_netbanking_bank_unavailable_message"):c.getElementsByClassName("a-alert-content")[0].textContent=b+" "+this.widget.getLocalizedString("payselect_bankTemporaryUnavailableInline"),this._showNBSuppressionMessage(!0),b="SUPPRESSED"}else this._showNBSuppressionMessage(!1),b=""!==e?"ACTIVE":"EMPTY_SELECTION";this._toggleContinueButtonForSuppressedNB(b)}},_showNBSuppressionMessage:function(b){g.toggleElement(this.getDOMElement("netBankingSuppressionMsgContainer"),
b)},_toggleContinueButtonForSuppressedNB:function(c){this.widget.trigger(b[c])},_toggleMobileNetBankingContentWrapper:function(b){g.toggleElement(this.getDOMElement("mobileNetbankingContentWrapper"),b)},_toggleNudgeMessage:function(b){g.toggleElement(this.getDOMElement("netBankingNudgeMsg"),b)},_toggleNetbankingDropdown:function(b){g.toggleElement(this.getDOMElement("netBankingDropDown"),b)}})});m("components/SelectablePaymentFinanceListComponent",["component","lang"],function(c,g){return c.extend({})});
m("components/SelectablePaymentServiceListComponent",["component","lang"],function(c,g){return c.extend({})});m("components/SelectablePOAInstrumentListComponent",["css-utils","form-component","lang","jQuery"],function(c,g,f,h){return g.extend({initialize:function(f,b){this._descriptorId=b.data.descriptorId;this._showModernFrameCx=b.data.showModernFrameCx;this._preSelectedInstrumentId=b.data.preSelectedInstrumentId;this._firstUsableInstrumentId=b.data.firstUsableInstrumentId;this._toggleSwitchElementName=
b.data.toggleSwitchElementName;this._multipleEBTEligibleSubtotalJsBinding=b.data.multipleEBTEligibleSubtotal;this._multipleEBTEligibleSubtotalExcludePromoJsBinding=b.data.multipleEBTEligibleSubtotalExcludePromo;this.$poaListSelection=this._showModernFrameCx?h("input[name\x3d"+this._toggleSwitchElementName+"]"):this.getDOMElementsByPrefix("ebtListSelection");this.$instrumentItemListContent=this.getDOMElement("instrumentItemListContent");c.toggleElement(this.$instrumentItemListContent,!1)},bindToElements:function(){var c=
this;if(this._showModernFrameCx){this.$poaListSelection.val(c._descriptorId);var b="a:switch:"+this._toggleSwitchElementName+":flip";this.widget.offAui(b);this.widget.onAui(b,function(b){b.switchState.clicked&&c._onToggleSwitchFlippedAppliedChange(b.switchState.isOn)})}else c.$poaListSelection.change(function(){c.$poaListSelection.prop("checked")?c._selectOptionalInstrumentRow():c._deselectOptionalInstrumentRow()})},bindToEvents:function(){var f=this;f.widget.on("optionalInstrumentRowSelected",f,
function(b){f._descriptorId===b.descriptorId&&c.toggleElement(this.$instrumentItemListContent,!0)});f.widget.on("balanceSelectionChanged",f,function(b){"RewardsAccount"===b.paymentMethod&&f._onRewardsAccountSelected(b.isSelected);"PROMO"===b.paymentMethod&&f._onPromoSelected(b.isSelected)})},_triggerEvent:function(c,b){this.widget.trigger(c,{instrumentId:b,descriptorId:this._descriptorId})},_onPromoSelected:function(f){"amzn1.poa.poda.EBTSNAP"===this._descriptorId&&(c.toggleElement(this.getDOMElement(this._multipleEBTEligibleSubtotalJsBinding),
f),c.toggleElement(this.getDOMElement(this._multipleEBTEligibleSubtotalExcludePromoJsBinding),!f))},_onRewardsAccountSelected:function(c){if("amzn1.poa.poda.EBTSNAP"===this._descriptorId&&f.isDefined(this._firstUsableInstrumentId)&&f.isDefined(this.$poaListSelection)){var b=this.getDOMElement("poaCheckboxText");this._showModernFrameCx||this.$poaListSelection.prop("disabled",c);c?(this._showModernFrameCx?(this._changeToggleSwitchEditability(!1),this._onToggleSwitchFlippedAppliedChange(!1)):this.$poaListSelection.prop("checked")&&
(this.$poaListSelection.prop("checked",!1),this._deselectOptionalInstrumentRow()),b.removeClass("a-color-base"),b.addClass("a-color-tertiary")):(this._showModernFrameCx&&this._changeToggleSwitchEditability(!0),b.addClass("a-color-base"),b.removeClass("a-color-tertiary"))}},_changeToggleSwitchEditability:function(c){var b=this;E.when("a-switch","jQuery").execute(function(e){var f=e.getSwitch(b.$poaListSelection);null!=f&&(f.enabled(!0),b.widget.onAui("a:switch:"+b._toggleSwitchElementName+":off",function k(a){c||
f.enabled(!1);b.widget.offAui("a:switch:"+b._toggleSwitchElementName+":off",k)}),f.isOn(!1))})},_onToggleSwitchFlippedAppliedChange:function(c){c?this._selectOptionalInstrumentRow():this._deselectOptionalInstrumentRow()},_selectOptionalInstrumentRow:function(){this._triggerEvent("optionalInstrumentRowSelected",this._preSelectedInstrumentId?this._preSelectedInstrumentId:this._firstUsableInstrumentId)},_deselectOptionalInstrumentRow:function(){this._triggerEvent("optionalInstrumentRowDeselected");c.toggleElement(this.$instrumentItemListContent,
!1)}})});m("EbtInstrumentListItemHelper",["jQuery","css-utils","lang","events/spinner-events","AUI!P"],function(c,g,f,h,l){c(document).ready(function(){c(".pmts-portal-list-item-ebt-balance-check-last-updated-time-reference").map(function(b,c){b=(new Date(c.textContent)).toLocaleString("UTC",{timeZoneName:"short"});c.textContent=b})});return function(b){function e(a){return"apx-".concat(t._paymentMethodCode).concat(a)}function n(a){t._shouldDisplayModernizedFrame&&w?r(a):B.prop("checked",a);g.toggleElement(t.getDOMElement(e("-subtotal")),
a);g.toggleElement(t.getDOMElement(e("-amount-field")),a);g.toggleElement(t.getDOMElement(e("-balance-check")),a)}function m(a,b){t.widget.trigger(a,{instrumentId:t._instrumentId,errors:b,paymentMethodCode:t._paymentMethodCode})}function a(a){t.widget.trigger(a,{instrumentId:t._instrumentId,descriptorId:t._descriptorId})}function k(a){t._instrumentId===a.instrumentId&&m("optionalInstrumentSelected",t._getDisplayableErrors(a.errors))}function d(a){l.when("a-switch","jQuery").execute(function(b){var c=
b.getSwitch(B);null!=c&&(c.enabled(!0),t.widget.onAui("a:switch:"+t._toggleSwitchName+":off",function J(b){a||c.enabled(!1);t.widget.offAui("a:switch:"+t._toggleSwitchName+":off",J)}),c.isOn(!1))})}function r(a){l.when("a-switch","jQuery").execute(function(b){b=b.getSwitch(B);null!=b&&b.isOn(a)})}function v(a){a.descriptorId===t._descriptorId&&(n(!1),m("optionalInstrumentDeselected"))}function u(){t.widget.submitFormAJAX({"ppw-widgetState":t.widget.options.serializedState,"ppw-widgetEvent":"ViewBalanceEvent",
"ppw-iid":t._instrumentId,"ppw-accountType":"ElectronicBenefitTransfer","ppw-redirectUri":p.location.pathname},{success:function(a){a=a.additionalWidgetResponseData.additionalData;"true"===a.authorizationRequired&&null!=a.interstitialPageUrl&&(p.location.href=a.interstitialPageUrl)}})}function D(a){a.preventDefault();a=c(".pmts-select-payment-instrument-form");t.widget.trigger(h.showSpinner);c.ajax({type:a.get(0).method,url:a.get(0).action,data:a.serialize(),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",success:u,error:u})}var t=b,F=t.data.EBTEligibleSubtotal,A=t.data.EBTEligibleSubtotalExcludePromo,G=t.getDOMElement("pmts-portal-list-item-ebt-balance-check-link-reference"),z=t.getDOMElementsByPrefix("pmts-modern-ebt-box-"),w=z.hasClass("single-ebt-row"),B=t._shouldDisplayModernizedFrame&&w?c("input[name\x3d"+t._toggleSwitchName+"]"):t.getDOMElementsByPrefix("ebtCardSelection");return{bindToEvents:function(){if(t._shouldDisplayModernizedFrame&&w){var b="a:switch:"+t._toggleSwitchName+
":flip";t.widget.offAui(b);t.widget.onAui(b,function(b){b.switchState.clicked&&(b.switchState.isOn?a("optionalInstrumentRowSelected"):a("optionalInstrumentRowDeselected"))})}t.widget.on("optionalInstrumentRowSelected",t,function(a){if(!w){var b=a.instrumentId,c=t._instrumentId;b===c?t.getDOMElement("pmts-modern-ebt-box-"+b).addClass("pmts-selected"):t.getDOMElement("pmts-modern-ebt-box-"+c).removeClass("pmts-selected")}n(t._instrumentId===a.instrumentId)});t.widget.on("optionalInstrumentRowDeselected",
t,v);t.widget.on("UserRequestedUpperAmountLimitValidated",t,k);t.widget.on("balanceSelectionChanged",t,function(a){"PROMO"===a.paymentMethod&&(g.toggleElement(this.getDOMElement(F),a.isSelected),g.toggleElement(this.getDOMElement(A),!a.isSelected))});t.widget.on("balanceSelectionChanged",t,function(b){if("RewardsAccount"===b.paymentMethod&&(this.getDOMElement("POAInstrumentContainer").prop("disabled",b.isSelected),b=b.isSelected,f.isDefined(B)))if(t._shouldDisplayModernizedFrame&&w?d(!b):B.prop("disabled",
b),b&&a("optionalInstrumentRowDeselected"),t._shouldDisplayModernizedFrame)t.getDOMElement("pmts-modern-ebt-box-"+t._instrumentId).find("."+t._modernizedPaymentArtGridCssClass).toggleClass(t._disabledSectionCssClass,!!b);else{var c=t.getDOMElementsByPrefix("poaCheckbox");b?(c.removeClass("a-color-base"),c.addClass("a-color-tertiary")):(c.addClass("a-color-base"),c.removeClass("a-color-tertiary"))}});t.widget.on("componentsInitialized",t,function(b){if(t._isPreselected||t._poaInstrumentRecommended)t._shouldDisplayModernizedFrame&&
w?r(!0):B.prop("checked",!0),a("optionalInstrumentRowSelected")})},bindToElements:function(){t._shouldDisplayModernizedFrame?w?B.val(t._instrumentId):z.click(function(b){c(b.currentTarget).data("disabled")||a("optionalInstrumentRowSelected")}):B.change(function(){B.prop("checked")?a("optionalInstrumentRowSelected"):a("optionalInstrumentRowDeselected")});G.click(f.bind(D,this))}}}});m("components/POAInstrumentListItemComponent","events/InstrumentRowSelectedEvent css-utils components/SimplePaymentOptionListItemComponent lang jQuery EbtInstrumentListItemHelper SelectableHbaListItemHelper mixins/b2b-cross-wallet-mixin".split(" "),
function(c,g,f,h,l,b,e,n){var m=["amzn1.pm.puma.TG9hbjpHbG9iYWxJbnN0YWxsbWVudExlbmRpbmdDcmVkaXRDYXJk","amzn1.pm.puma.TG9hbjpHbG9iYWxJbnN0YWxsbWVudExlbmRpbmdCYW5rQWNjb3VudA\x3d\x3d","amzn1.pm.puma.TG9hbjpHbG9iYWxJbnN0YWxsbWVudExlbmRpbmdDcmVkaXRMaW5l"],a=["GC","JPPoints","ProductVoucher","PROMO"];return f.extend(n,{initialize:function(a,c){this._paymentMethodCode=c.data.paymentMethod;this._descriptorId=c.data.descriptorId;this._isPoaAccountUsable=c.data.isPoaAccountUsable;this._isPreselected=c.data.isPreselected;
this._paymentMethodCodeInLowerCase=c.data.paymentMethod?c.data.paymentMethod.toLowerCase():r;this._instrumentId=c.data.instrumentId;this._deviceType=c.data.deviceType;this._showAlertsAndButtons=c.data.showAlertsAndButtons;this._requireRegistrationForPOAInstruments=c.data.requireRegistrationForPOAInstruments;this._poaInstrumentRecommended=c.data.poaInstrumentRecommended;this._isOwned=c.data.isOwned;this._isABCrossCustomerMultiTenderSuppressionEnabled=c.data.isABCrossCustomerMultiTenderSuppressionEnabled;
this._modernizedPaymentArtGridCssClass=c.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=c.data.disabledSectionCssClass;this._shouldDisplayModernizedFrame=c.data.shouldDisplayModernizedFrame;this._toggleSwitchName=c.data.toggleSwitchName;this._poaInstrumentRecommended||this._poaInstrumentUnselected();this._updateRegistrationStatus(c.data.registrationStatus);"amzn1.poa.poda.EBTSNAP"===this._descriptorId&&this._isPoaAccountUsable?this.instrumentSpecificHelper=new b(this):"amzn1.poa.poda.HealthBenefitsCard"===
this._descriptorId&&this._isPoaAccountUsable&&(this.instrumentSpecificHelper=new e(this))},_updateRegistrationStatus:function(a){this._registrationStatus=a;a=this.getDOMElement("poa-pending-status");var b=this.getDOMElement("poa-approved-status");0<a.length&&0<b.length&&("Approved"===this._registrationStatus?(g.showElement(b),g.hideElement(a)):(g.showElement(a),g.hideElement(b)),"Pending"===this._registrationStatus&&p.setTimeout(h.bind(this._pollForRegistrationStatus,this),1E4))},_pollForRegistrationStatus:function(){var a=
this;a.widget.continueRequest({"ppw-widgetEvent":"PollForRegistrationStatusEvent","ppw-instrumentId":a._instrumentId,"ppw-widgetState":a.widget.options.serializedState},{success:function(b){(b=b.additionalWidgetResponseData.additionalData)&&b[a._instrumentId]&&a._updateRegistrationStatus(b[a._instrumentId])}})},_getContainerElement:function(){var a="POAInstrumentContainer-".concat(this._instrumentId);return this.getDOMElement(a)},_showAlert:function(){this._toggleAlert(!0)},_showButtons:function(){this._toggleButtons(!0)},
_showStatus:function(){this._toggleStatus(!0)},_showExpandedStatus:function(){this._toggleExpandedStatus(!0)},_hideAlert:function(){this._toggleAlert(!1)},_hideStatus:function(){this._toggleStatus(!1)},_hideButtons:function(){this._toggleButtons(!1)},_hideExpandedStatus:function(){this._toggleExpandedStatus(!1)},_makeSelector:function(a){return"pmts-".concat(this._paymentMethodCodeInLowerCase).concat(a)},_toggleAlert:function(a){g.toggleElement(this.getDOMElement(this._makeSelector("-alert")),a)},
_toggleButtons:function(a){g.toggleElement(this.getDOMElement(this._makeSelector("-buttons")),a)},_toggleStatus:function(a){g.toggleElement(this.getDOMElement(this._makeSelector("-status")),a)},_toggleExpandedStatus:function(a){g.toggleElement(this.getDOMElement(this._makeSelector("-status-expanded")),a)},_toggleDisplayAdditionalText:function(a){g.toggleElement(this.getDOMElement("displayAdditionalText"),a)},_toggleRecurringPaymentEligibilityMessage:function(a){this.widget.trigger("toggleRecurringPaymentEligibilityMessage",
{instrumentId:this._instrumentId,isSelected:a})},_poaInstrumentSelected:function(){this._onInstrumentSelected();this._showAlert();this._showButtons();"Declined"===this._registrationStatus&&"desktop"===this._deviceType&&this._showAlertsAndButtons&&this._hideStatus();this._maybeTriggerInvalidRegistrationMessage();this._showExpandedStatus();this._toggleDisplayAdditionalText(!0);this._checkIneligibleItemsInCart();this._toggleRecurringPaymentEligibilityMessage(!0)},_maybeTriggerInvalidRegistrationMessage:function(){var a=
this._registrationStatusErrorStrings[this._registrationStatus];(a=a?[this.widget.getLocalizedString(a)]:null)&&this._triggerBackingInstrumentSelectedEvent(a)},_checkIneligibleItemsInCart:function(){for(var a in m)if(this._instrumentId&&-1<this._instrumentId.search(m[a])){this.widget.trigger("gilCheckIneligibleItemsInCartEvent");break}},_poaInstrumentUnselected:function(){this._onInstrumentDeselected();this._hideAlert();this._hideButtons();"Declined"===this._registrationStatus&&"desktop"===this._deviceType&&
this._showStatus();this._hideExpandedStatus();this._toggleDisplayAdditionalText(!1);this._toggleRecurringPaymentEligibilityMessage(!1)},poaInstrumentClicked:function(a){this.widget.trigger(c,{instrumentId:a,isInstrumentOwned:this._getIsOwned(),paymentMethod:this._paymentMethodCode})},_instrumentRowSelected:function(a){a===this._instrumentId?this._poaInstrumentSelected():this._poaInstrumentUnselected()},bindToEvents:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToEvents();
else{var b=this;b.widget.on("poaInstrumentRowSelected",b,function(a){b._instrumentRowSelected(a.instrumentId)});b.widget.on(c,b,function(a){b._instrumentRowSelected(a.instrumentId)});b.widget.on("gilIneligibleItemsInCartEvent",b,function(a){b._triggerBackingInstrumentSelectedEvent([a])});b.widget.on("balanceSelectionChanged",this,function(c){var d=!1!==c.isInstrumentOwned,e=!1!==this._getIsOwned();!0===b._isB2BCrossWalletMultitenderEnforcementEnabled?!0===b.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",
c)&&b._updateBackingInstrumentState():this._isABCrossCustomerMultiTenderSuppressionEnabled&&0<=h.indexOf(a,c.paymentMethod)&&e!==d&&!c.isBackingInstrument&&c.isSelected&&this._updateBackingInstrumentState()})}},bindToElements:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToElements();else{var a=this;a.getDOMElementsByPrefix("POAInstrumentContainer").click(function(b){l(b.currentTarget).data("disabled")||a.poaInstrumentClicked(a._instrumentId)});a.widget.on("initializeRecommendedInstrument",
a,function(b){b.instrumentId===a._instrumentId&&(a.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||a._poaInstrumentSelected())});a.getDOMElement("activateCimarronPopoverButton").click(function(b){b.preventDefault();a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"BusinessInvoicingActivationStartEvent"})});a.getDOMElement("activateCimarronTooltipContentButton").click(function(b){b.preventDefault();a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,
"ppw-widgetEvent":"BusinessInvoicingActivationStartEvent"})})}},_registrationStatusErrorStrings:{Unstarted:"pmts_portal_registration_method_failure_unstarted",Pending:"pmts_portal_registration_method_failure_pending",Declined:"pmts_portal_registration_method_failure_declined"}})});m("components/UserRequestedUpperAmountLimitComponent",["css-utils","form-component","lang","input-helper"],function(c,g,f,h){return g.extend({field:"UAL",initialize:function(c,b){this._instrumentId=b.data.instrumentId;this._userRequestInitialAmount=
b.data.userRequestInitialAmount;this._excludePromoAmount=b.data.excludePromoAmount;this._showMCXModernFrame=b.data.showMCXModernFrame;this._subtotalInputAppendedTextJSBinding=b.data.upperAmountLimitSubtotalText;this._subtotalInputAppendedExcludePromoTextJSBinding=b.data.upperAmountLimitSubtotalExcludePromoText;c=this._instrumentId.concat("_").concat("UAL");this.$userRequestedUpperAmountInput=this.getDOMElement(c);this._showMCXModernFrame&&this.$userRequestedUpperAmountInput.attr("inputmode","decimal")},
bindToElements:function(){var c=this;this._showMCXModernFrame&&(h.limitToNumericInput(c.$userRequestedUpperAmountInput),h.limitNumericInputDigits(c.$userRequestedUpperAmountInput,2));c.$userRequestedUpperAmountInput.change(function(){c._validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent()})},bindToEvents:function(){var f=this;f.widget.on("optionalInstrumentRowSelected",f,function(b){f._instrumentId===b.instrumentId&&f._validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent()});f.widget.on("balanceSelectionChanged",
f,function(b){"PROMO"===b.paymentMethod&&(f.$userRequestedUpperAmountInput[0].value=b.isSelected?this._userRequestInitialAmount:this._excludePromoAmount,null!=this._subtotalInputAppendedTextJSBinding&&null!=this._subtotalInputAppendedExcludePromoTextJSBinding&&(c.toggleElement(f.getDOMElement(this._subtotalInputAppendedTextJSBinding),b.isSelected),c.toggleElement(f.getDOMElement(this._subtotalInputAppendedExcludePromoTextJSBinding),!b.isSelected)),f._validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent())})},
_validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent:function(){this._resetFormErrorMessages();var c=this.form.validateForm();0<c.length&&this._displayFormErrorMessages(c);this.widget.trigger("UserRequestedUpperAmountLimitValidated",{instrumentId:this._instrumentId,errors:c})},_validationToErrorMap:{apx_non_numeric_input_error_message:"FailureNonNumericInput",apx_exceeds_balance_or_eligible_subtotal:"FailureExceedsEligibleSubtotal",apx_exceeds_balance:"FailureExceedsBalance",apx_non_positive_input_error_message:"FailureNonPositiveInput"},
_getErrorMessageContainer:function(){return this.getDOMElement("errorMessages")},_resetFormErrorMessages:function(){var g=this;c.hideElement(g._getErrorMessageContainer());f.forEachKeyValue(g._validationToErrorMap,function(b,c){g.form.resetErrorMessage(g.field,g.getDOMElement(c))},g)},_displayFormErrorMessages:function(f){0!==f.length&&(f=f[0],f.field===this.field&&(f=this.getDOMElement(this._validationToErrorMap[f.messageStringId]),this.form.displayErrorMessage(this.field,f)),c.showElement(this._getErrorMessageContainer()))}})});
m("components/SwipeACardListItemComponent",["css-utils","components/SimplePaymentOptionListItemComponent"],function(c,g){return g.extend({initialize:function(c,g){this.isPaymentOptionEditable=!0===g.data.isEditable},_getContainerElement:function(){return this.getDOMElement("swipeACardContainer")}})});m("components/SelectAddressComponent","css-utils form-component form-helper lang jQuery events/form-submitted-event".split(" "),function(c,g,f,h,l,b){return g.extend({initialize:function(b,f){this._action=
f.data.action;this.$useSelectedAddress=this.getDOMElement("useSelectedAddress");this.defaultSelectedAddressID=f.data.defaultId;if("mobile"===f.data.deviceType){b=this.getDOMElementsByPrefix("addressSelectButton-");c.hideElement(b);c.hideElement(l(".pmts-address-phoneNumber-field"));var e=this;b=this._getAddressRows();h.forEach(b,function(a){e._addressRowSelected(l(a),f.data.defaultId)},e)}},bindToElements:function(){this._getAddressRows().click(h.bind(this._triggerAddressRowSelectedEvent,this));this.$useSelectedAddress.click(h.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var c=this;c.widget.on("addressRowSelected",c,function(b){var e=c._getAddressRows();h.forEach(e,function(a){c._addressRowSelected(l(a),b.addressId)},c)});this.widget.on(b,this,function(b){if(b.action===this._action){var c=this.getDOMElement("useSelectedAddress").closest("form");this.getDOMElement("useSelectedAddress").find("input").each(function(a,b){f.ensureWidgetEventInput(c,b.name)});c.submit()}});c.widget.on("componentsInitialized",c,function(){this.widget.trigger("sendDefaultAddressRowSelected",
{addressId:this.defaultSelectedAddressID})})},_getAddressRows:function(){return this.getDOMElementsByPrefix("addressSelectionRow-")},_triggerAddressRowSelectedEvent:function(b){b=l(b.currentTarget).data("address-id");this.widget.trigger("addressRowSelected",{addressId:b})},_addressRowSelected:function(b,f){var e=b.data("address-id"),a=b.find("input[type\x3dradio]"),g=b.find(".pmts-select-this-address"),d=b.find(".pmts-address-phoneNumber-field");f===e?(b.addClass("pmts-selected"),a.prop("checked",
!0),0<g.length&&c.showElement(g),0<d.length&&c.showElement(d)):(b.removeClass("pmts-selected"),a.prop("checked",!1),0<g.length&&c.hideElement(g,!1),0<d.length&&c.hideElement(d))},_handleFormSubmission:function(c){var e=this.getDOMElement("useSelectedAddress").closest("form");e=this.getFormSubmissionParameters(e,this.$useSelectedAddress);this.widget.trigger(b,{submissionParameters:e,event:c,action:this._action});return!1}})});m("components/SetPaymentPlanComponent",["component","lang"],function(c,g){return c.extend({})});
m("events/AwaitInstrumentPreparedEvent",["public-event-registry"],function(c){c.register("AwaitInstrumentPrepared");return"AwaitInstrumentPrepared"});m("AwaitingEventStatusConstants",[],function(){return{Pending:"Pending",Success:"Success",Failure:"Failure",TimedOut:"TimedOut",UnknownFailure:"UnknownFailure",NotRequired:"NotRequired"}});m("events/InstrumentPreparedEvent",["public-event-registry"],function(c){c.register("InstrumentPrepared");return"InstrumentPrepared"});m("events/PreparedInstrumentContinueErrorEvent",
["public-event-registry"],function(c){c.register("PreparedInstrumentContinueError");return"PreparedInstrumentContinueError"});m("SetPaymentPlanOrderSummary","jQuery lang form-helper css-utils clog form-constants events/SetPaymentPlanTrial events/SetPaymentPlanSelectContinueEvent".split(" "),function(c,g,f,h,l,b,e,n){function m(a){h.showElement(c(".apx-order-summary-api-error"));h.showElement(c(".apx-order-summary-api-error-desktop"));a?(h.hideElement(c(".apx-order-summary-api-error-retry")),h.showElement(c(".apx-order-summary-api-error-retry-failed"))):
(h.showElement(c(".apx-order-summary-api-error-retry")),h.hideElement(c(".apx-order-summary-api-error-retry-failed")))}function a(a){var c=b.WIDGET_EVENT_KEY+b.KEY_VALUE_SEPARATOR,d=a.find("input[type\x3d'hidden'][name^\x3d'"+c+n+"']")[0];a=f.serializeObject(a);d&&delete a[d.name];a[c+e]="";return a}var k=null,d=null,r=!1;return{fetchOrderSummary:function(b,e,g,n){var t=(new Date).getTime();g||(g=0);e=e.closest("form");if(b&&k)c(".apx-order-summary-content").html(k),c(".apx-order-summary-content-desktop")&&
c(".apx-order-summary-content-desktop").html(k);else{var q="/gp/buy/cricket/payments/payLast/ordersummary/display.html?showIncompleteOrderSummary\x3d0";b&&(q="/gp/buy/cricket/payments/payLast/ordersummary/display.html?showIncompleteOrderSummary\x3d1");n?c.ajax({type:"POST",url:q,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},dataType:"text",data:f.serializeObject(e),async:!0,success:function(a){l.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",
resource:"_Latency",startTime:t});l.logCounterMetric({feature:"PaylastOrderSummaryApiLoadSuccess",resource:"_Count"});k=a},error:function(){l.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",resource:"_Latency",startTime:t});l.logCounterMetric({feature:"PaylastOrderSummaryApiLoadError",resource:"_ErrorCount"});h.hideElement(c(".apx-order-summary-spinner"));h.hideElement(c(".apx-order-summary-spinner-desktop"))}}):(d=c.ajax({type:"POST",url:q,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:{"x-amz-checkout-transition":"ajax"},dataType:"text",data:a(e),async:!0,beforeSend:function(){null!=d&&(d.abort(),l.logCounterMetric({feature:"PaylastOrderSummaryApiLoadRequestAborted",resource:"_Count"}));h.hideElement(c(".apx-order-summary-api-error"));h.hideElement(c(".apx-order-summary-api-error-desktop"));h.showElement(c(".apx-order-summary-spinner"));c(".apx-order-summary-content").html("");c(".apx-order-summary-content-desktop")&&c(".apx-order-summary-content-desktop").html("");h.showElement(c(".apx-order-summary-spinner-desktop"))},
success:function(a){l.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",resource:"_Latency",startTime:t});l.logCounterMetric({feature:"PaylastOrderSummaryApiLoadSuccess",resource:"_Count"});if(0<c(a).find("#sc-active-cart").length||c(a).find("#activeCartViewForm")[0]&&"undefined"!==c(a).find("#activeCartViewForm")[0].action&&(c(a).find("#activeCartViewForm")[0].action.includes("/gp/aw/c/")||c(a).find("#activeCartViewForm")[0].action.includes("/gp/cart/view.html")))r=!0,a="",m(!0);c(".apx-order-summary-content").html(a);
c(".apx-order-summary-content-desktop")&&c(".apx-order-summary-content-desktop").html(a);h.hasAUIHiddenClass(c(".apx-order-summary-content-desktop"))||(c(".apx-order-total-label")&&h.hideElement(c(".apx-order-total-label")),c(".apx-order-total-divider")&&h.hideElement(c(".apx-order-total-divider")));null==k&&b&&(k=a);h.hideElement(c(".apx-order-summary-spinner"));h.hideElement(c(".apx-order-summary-spinner-desktop"))},error:function(a){l.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",resource:"_Latency",
startTime:t});l.logCounterMetric({feature:"PaylastOrderSummaryApiLoadError",resource:"_ErrorCount"});h.hideElement(c(".apx-order-summary-spinner"));h.hideElement(c(".apx-order-summary-spinner-desktop"));m(g)},cache:!1}),l.publishMetrics())}},redirectToCart:function(a,b){if(r||a)p.location.href=b},getFormData:a}});m("components/SetPaymentPlanSelectComponent","AUI!P events/InstrumentRowSelectedEvent events/SetPaymentPlanSelectContinueEvent events/SelectablePaymentOptionEvents events/SetPaymentPlanTrial events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/InstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent events/spinner-events events/js-continue-failure-event events/SubmitSecureFieldDataEvent events/SecureFieldDataReadyEvent css-utils jQuery component lang form-helper ExecutionsWidgetUtils components/SetPaymentPlanSelectComponent/validators SetPaymentPlanOrderSummary clog AddPaymentMethodTouchLinkSupport AwaitingEventStatusConstants mash-helper metrics-helper mixins/secure-container-support form-constants mixins/SecureFieldsFormComponent events/ShowAddPaymentInstrumentPage events/ShowMessageOnContinueButton".split(" "),
function(c,g,f,h,l,b,e,n,m,a,k,d,x,v,u,D,t,F,A,G,z,w,B,y,C,H,E,K,J,O,Q){var q=!1,L=!1,N=!1,P=4500;return D.extend(B,E,J,{showSecondaryView:!1,adjustedOrderTotalAmount:0,appliedIbdAmount:0,appliedApbBalance:0,appliedPromoBalance:0,appliedNoCostEMIDiscount:0,fetchCompleteOrderSummary:!1,isPaymentPlanComplete:!1,numberOfTimesPaymentMethodChanged:0,adjustedDisplayOrderTotalString:r,countryCode:r,DECIMAL_PLACES:2,isJigsawEligible:!1,isCardSelected:!1,consentCheckBoxStatus:!1,selectedInstrumentId:r,displayExplicitConsentPopover:!1,
isMCXModernizedFrameEnabled:!1,isPromoBalanceSelected:!1,isProductVoucherSelected:!1,isGiftCardSelected:!1,isRewardsAccountSelected:!1,appliedRewardsValue:0,appliedTotalValue:0,totalBeforeSpecialString:"",totalBeforeSpecialValue:0,localStringFormat:"en-US",shippingDiscountValue:0,currentRA:"",delegateUpiProcessing:!1,bypassContinueWidgetCall:!1,isSkipContinueWithSameFormWeblabEnabled:!1,upiInstrumentId:r,selectedPaystationInstrumentId:r,selectedPaystationPaymentMethodCategory:r,maybeInstallmentsOfferIds:r,
maybeSelectedInstallmentsOfferId:r,totalAPBBalance:r,redeemableAPBBalance:r,availableAPLBalance:r,deviceSignatureCheckStatus:"Pending",isINMarketplace:r,ssnapFeatureLoadModeForApp:"none",initialize:function(a,b){this.showSecondaryView=b.data.showSecondaryView;this.isJigsawEligible=b.data.isJigsawEligible;this.isSkipContinueWithSameFormWeblabEnabled=b.data.isSkipContinueWithSameFormWeblabEnabled;this.ajaxSubstitutionEnabled=b.data.ajaxSubstitutionEnabled;this.orderSummaryHeaderEnabled=b.data.orderSummaryHeaderEnabled;
b.data.showFloatingContinueBarOnNonPaylastPSP&&(this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP);b.data.showFloatingContinueBarOnNonPaylastPspWithViewDetails&&(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails=b.data.showFloatingContinueBarOnNonPaylastPspWithViewDetails);b.data.paylastOrderSummaryEnabled&&(L=b.data.paylastOrderSummaryEnabled);b.data.trialPrefetchEnabled&&(q=b.data.trialPrefetchEnabled);b.data.optimiseFetchOrderSummaryCalls&&(N=b.data.optimiseFetchOrderSummaryCalls);
if((this.isOrderTotalDisplayedInFloatingCTAContainer=b.data.isOrderTotalDisplayedInFloatingCTAContainer)||this.showFloatingContinueBarOnNonPaylastPSP)this.adjustedOrderTotalAmount=b.data.adjustedOrderTotalAmount||0,this.adjustedDisplayOrderTotalString=b.data.adjustedDisplayOrderTotalString||r,this.countryCode=b.data.countryCode||r;var c=this.getDOMElement("payment-plan-select-form-to-submit");this.isPaylastEnabledForDesktop=b.data.isPaylastEnabledForDesktop;this.isStickyContinueButtonDesktopEnabled=
b.data.isStickyContinueButtonDesktopEnabled;this.isDesktop="desktop"===a.options.deviceType;c.append(A.buildHiddenInput("ppw-jsEnabled","true"));this.isUpiIssuanceEnabled=b.data.isUpiIssuanceEnabled;this.isAPPIssuanceEnabled=b.data.isAPLInlineIssuanceEnabled;this.hideSpinner=b.data.hideSpinner;this.isWaitAtContinueEnabled=b.data.isWaitAtContinueEnabled;this.isAPPInstrumentRedirectionRequired=this.isUpiRedirectionRequired=!1;this.awaitingEventStatuses={};this.awaitingEventStatuses[n]=y.NotRequired;
this.awaitingEventStatuses[x]=y.NotRequired;this.widgetDoneOnJSFailure=b.data.widgetDoneOnContinueFailures;this.isRequestForMobileApp=b.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=b.data.securePaymentMethodAddedEvent;this._mobileAppSecureRegistrationTreatment=b.data.mobileAppSecureRegistrationTreatment;this.ssnapFeatureLoadModeForApp=b.data.ssnapFeatureLoadModeForApp;this._dynamicContinueEnabled=b.data.dynamicContinueEnabled;this.isPaySelectCvvSecureFieldEnabled=b.data.paySelectCvvSecureFieldEnabled;
this.isMCXModernizedFrameEnabled=b.data.isMCXModernizedFrameEnabled;this.isModernizedSetPaymentPlanSelectOptimizationEnabled=b.data.isModernizedSetPaymentPlanSelectOptimizationEnabled;this.totalBeforeSpecialString=b.data.totalBeforeSpecialString||"";this.shippingDiscountValue=parseFloat(b.data.shippingDiscountValue)||0;this.totalBeforeSpecialValue=parseFloat(b.data.totalBeforeSpecialValue)+this.shippingDiscountValue||0;this.supportedPaymentMethods=b.data.supportedPaymentMethods;this.isSkipAddCreditCardWeblabEnabled=
b.data.isSkipAddCreditCardWeblabEnabled;this.mcxFloatingFooterElement=this.getDOMElement("mcx-floating-footer");this.isEstimatedTotalEnabled=b.data.isEstimatedTotalEnabled;this.paymentsPageAdvertisementHTMLElement=this.getDOMElement("payments-page-advertisement-reference");this.paymentsPageAdvertisementWrapperHTMLElement=this.getDOMElement("payments-page-advertisement-wrapper-reference");this.paymentsPageAdvertisementHTMLContent=b.data.maybePaymentsPageAdvertisementHTMLContent;this.delegateUpiProcessing=
b.data.delegateUpiProcessing;this.bypassContinueWidgetCall=b.data.bypassContinueWidgetCall;this.isINMarketplace=b.data.isINMarketplace;this.isInlineEMIPlanChangeMessageExperienceEnabled=b.data.isInlineEMIPlanChangeMessageExperienceEnabled;var d=this;d.isRequestForMobileApp&&(console.log("listener.securePaymentMethodAddedEvent: "+d._securePaymentMethodAddedEvent),C.addEventListener(d._securePaymentMethodAddedEvent,function(a){d._addEventListenerSPPSHandler(a,"0")}),C.addEventListener("APX3RegisterSuccessEvent",
function(a){d._addEventListenerSPPSHandler(a,"1")}),C.addEventListener("APX3RegisterFallbackEvent",function(a){d._addEventListenerAPX3RegisterFallbackEvent(a)}),C.addEventListener("DisableCheckoutRefreshEvent",function(a){d._addEventListenerSPPSDisableRefresh(a)}),C.setBookmark("spps-widget"),d.ssnapFeatureLoadModeForApp&&"none"!==d.ssnapFeatureLoadModeForApp&&(H.emitCounterMetric("PaysheetSsnapFeatureLoadMode",[d.ssnapFeatureLoadModeForApp]),C.dispatchEvent("PaysheetSsnapFeatureLoadMode",{mode:d.ssnapFeatureLoadModeForApp})));
this.isEstimatedTotalEnabled&&(this.$displayedEstimatedTotalAmountContainer=r,0<this.getDOMElement("estimated-total-value").length?this.$displayedEstimatedTotalAmountContainer=this.getDOMElement("estimated-total-value")[0]:this.$displayedEstimatedTotalAmountContainer=null,null!=this.$displayedEstimatedTotalAmountContainer&&d._updateEstimatedTotal(0));this.widget.trigger(Q,{shouldShowMessageOnContinueButton:this.isINMarketplace});I(this)},_addEventListenerSPPSHandler:function(a,b){a.detail.canProceedToSPC?
this._triggerContinueButtonWithSelectedInstrument(a.detail.paymentInstrumentId,a.detail.paymentMethod,a.detail.instrumentRegistrationType,a.detail.issuer,a.detail.executionStartTime):(C.backToBookmark("spps-widget"),this._disableSPPSRefreshEvent(),this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(a.detail.paymentInstrumentId,a.detail.widgetAction,a.detail.walletId,"post",b):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent",
"ppw-paymentMethodId":a.detail.paymentInstrumentId,"ppw-widgetAction":a.detail.widgetAction,"ppw-maybeWalletId":a.detail.walletId,"ppw-maybeShouldRecordAPX3Metric":b}))},_addEventListenerAPX3RegisterFallbackEvent:function(a){console.log("APX3Register fallback to APX2");C.publishCountMetrics("APX3RegisterNativeFallbackEvent");this._triggerShowAddPaymentInstrumentPageEvent()},_addEventListenerSPPSDisableRefresh:function(a){console.log("Disable refresh when entering auth");this._disableSPPSRefreshEvent()},
_updatePMDetails:function(a){"Completed"===a.getPMS2SCallStatus?(this.getPMS2SCallStatus=a.getPMS2SCallStatus,this.issuingPsp=a.issuingPsp,this.responseClientContext=a.responseClientContext,this.bankTail=a.bankTail,this.mPinLength=a.mPinLength,this.paymentMethodIdVersion=a.paymentMethodIdVersion,this.deviceSignature=a.deviceSignature,this.npciKey=a.npciKey,this.customerVpa=a.customerVpa,this.bankAccountUniqueId=a.bankAccountUniqueId,this.customerMobileNumber=a.customerMobileNumber,this.bankName=a.bankName,
this.upiInstrumentId=a.instrumentId):this.getPMS2SCallStatus=a.getPMS2SCallStatus},_removePMDetails:function(){this.bankName=this.customerMobileNumber=this.bankAccountUniqueId=this.customerVpa=this.npciKey=this.deviceSignature=this.paymentMethodIdVersion=this.mPinLength=this.bankTail=this.responseClientContext=this.issuingPsp=this.getPMS2SCallStatus=null},bindToElements:function(){var a=this;if(a.isOrderTotalDisplayedInFloatingCTAContainer||a.showFloatingContinueBarOnNonPaylastPspWithViewDetails)a.getDOMElement("apx-order-total-container").click(function(b){a.widget.trigger("hideViewDetailsPopover");
a._toggleOrderSummaryFloatingContainer();"mobile"===a.widget.options.deviceType?z.redirectToCart(!1,"/gp/aw/c"):z.redirectToCart(!1,"/gp/cart/view.html")}),a.getDOMElement("apx-close-order-summary-icon").click(function(b){a._toggleOrderSummaryFloatingContainer()}),a.getDOMElement("apx-order-summary-overlay-container").click(function(b){a._toggleOrderSummaryFloatingContainer()}),c.when("A","ready").execute(function(b){b.delay(function(){a.widget.trigger("hideViewDetailsPopover")},1E4)});a.isPaylastEnabledForDesktop&&
(a.getDOMElement("order-summary-view-details-desktop").click(function(b){b=a.getDOMElement("apx-order-summary-content-desktop");var c=a.getDOMElement("apxOrderTotalLabelDesktop"),d=a.getDOMElement("apxOrderTotalDivider"),e=a.getDOMElement("apx-order-summary-error-message-desktop-container"),f=a.getDOMElement("apx-order-summary-and-error-container-desktop");b&&f&&b.hasClass("a-hidden")&&a.getDOMElement("order-summary-view-details-desktop")[0]?(a.getDOMElement("order-summary-view-details-desktop")[0].innerHTML=
a.widget.getLocalizedString("apx_order_total_hide_details"),N&&a.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:a.isPaymentPlanComplete,fetchOSTriggeredByViewDetails:!0}),v.toggleElement(f,!0),v.toggleElement(b,!0),""!==b[0].innerHTML&&(v.toggleElement(c,!1),v.toggleElement(d,!1)),!a.fetchCompleteOrderSummary&&e?v.showElement(e):v.hideElement(e)):(a.getDOMElement("order-summary-view-details-desktop")[0].innerHTML=a.widget.getLocalizedString("apx_order_total_view_details"),v.toggleElement(b,
!1),v.toggleElement(f,!1),v.toggleElement(c,!0),v.toggleElement(d,!0),v.hideElement(a.getDOMElement("apx-order-summary-error-message-desktop-container")))}),u(p).scroll(function(a){if(u(p)){a=u(p).scrollTop();var b=u(".pmts-payment-instruments-container-classic");b&&(b=b.offset().top,a>b?u(".apx-desktop-sticky-continue-button").addClass("apx-stick-to-top"):u(".apx-desktop-sticky-continue-button").removeClass("apx-stick-to-top"));1200>u(p).width()?u(".apx-desktop-sticky-continue-button").addClass("apx-stick-to-right"):
u(".apx-desktop-sticky-continue-button").removeClass("apx-stick-to-right")}}));a.isDesktop&&!a.isPaylastEnabledForDesktop&&a.isStickyContinueButtonDesktopEnabled&&u(p).scroll(function(a){if(u(p)){a=u(p).scrollTop();var b=u(".pmts-payment-instruments-container-classic");b&&(b=b.offset().top,a>b?u(".apx-sticky-continue-button-container-desktop").addClass("apx-desktop-stick-to-top"):u(".apx-sticky-continue-button-container-desktop").removeClass("apx-desktop-stick-to-top"))}});B.bindToElements.apply(a);
if(L||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)a.getDOMElement("apx-order-summary-api-error-retry-button").click(function(b){var c=a.getDOMElement("payment-plan-select-form-to-submit");z.fetchOrderSummary(b.isValid,c,1)}),a.getDOMElement("apx-order-summary-api-error-retry-failed-button").click(function(b){"mobile"===a.widget.options.deviceType?z.redirectToCart(!0,"/gp/aw/c"):z.redirectToCart(!0,"/gp/cart/view.html")});a.getDOMElement("mcx-registration-touch-link").click(function(){a.widget.trigger("showRegistrationEvent")})},
bindToEvents:function(){var b=this,c={grepIdentifier:"multipleInitiateChargeInvocations",customerId:this.widget.options.customerId,widgetInstanceId:this.widget.options.widgetInstanceId,sessionId:this.widget.options.sessionId};t.forEach(["ContinueButtonClicked","SecondaryContinueButtonClicked","CompleteWidget"],function(a){b.widget.on(a,b,function(b){c.eventName=a;w.log(c);this._closeViewDetailsPopover();t.every(G,function(a){return a()})&&this._showExplicitConsentPopover()})});if(!q&&b.data.prefetchEnabled)b.widget.on(h.paymentPlanSelectedPrepare,
b,function(a){a=b.getDOMElement("payment-plan-select-form-to-submit");F.ensureWidgetEventInput(a,f)});this.widget.on("ConsentPopoverContinueButtonClicked",this,function(a){this._continueButtonClicked()});this.widget.on("UpdateSelectedCardData",this,function(a){this.selectedInstrumentId=a.instrumentId});this.widget.on("updateConsentCheckBoxStatus",this,function(a){this.consentCheckBoxStatus=a.consentCheckBoxStatus;this.isCardSelected=a.isCardSelected});this.widget.on("RemoveSetPaymentPlanSelectContinueEvent",
this,function(a){var c=b.getDOMElement("payment-plan-select-form-to-submit"),d=K.WIDGET_EVENT_KEY+K.KEY_VALUE_SEPARATOR+f;a=function(){return c.find("input[type\x3d'hidden'][name^\x3d'"+d+"']")};a().length&&a().remove()});this.widget.on(h.PaymentPlanSelected,this,function(a){this.isAPPInstrumentRedirectionRequired=this.isUpiRedirectionRequired=!1;!L&&!this.showFloatingContinueBarOnNonPaylastPspWithViewDetails||b.data.skipFormValidation&&a.paymentMethod&&"CC"===a.paymentMethod||this.widget.trigger("fetchOrderSummary",
{fetchCompleteOrderSummary:a.isValid,fetchOSTriggeredByViewDetails:!1})});this.widget.on("fetchOrderSummary",this,function(a){var c=b.getDOMElement("payment-plan-select-form-to-submit"),d=[{name:"ppw-dummyPostalCode",value:"000000"},{name:"addCreditCardVerificationNumber99",value:"123"}],e=c.closest("form");e&&e[0]&&t.forEach(d,function(a){e[0].elements[a.name]||e.append(A.buildHiddenInput(a.name,a.value))});if(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails&&!a.fetchOSTriggeredByViewDetails)this.isPaymentPlanComplete=
a.fetchCompleteOrderSummary;else{if(!this.showFloatingContinueBarOnNonPaylastPspWithViewDetails&&N)if(this.isPaymentPlanComplete=a.fetchCompleteOrderSummary,a.fetchOSTriggeredByViewDetails)if(6<this.numberOfTimesPaymentMethodChanged)z.fetchOrderSummary(!a.fetchCompleteOrderSummary,c);else return;else if(a.fetchCompleteOrderSummary&&(this.numberOfTimesPaymentMethodChanged+=1),6>=this.numberOfTimesPaymentMethodChanged)z.fetchOrderSummary(!a.fetchCompleteOrderSummary,c);else return;else z.fetchOrderSummary(!a.fetchCompleteOrderSummary,
c);a.fetchCompleteOrderSummary?this.widget.trigger("HideOrderSummaryIncompletePaymentPlanErrorMessageEvent"):this.widget.trigger("ShowOrderSummaryIncompletePaymentPlanErrorMessageEvent");this.isPaylastEnabledForDesktop&&(this.fetchCompleteOrderSummary=a.fetchCompleteOrderSummary)}});b.widget.on(f,b,function(a){c.eventName=f;w.log(c);var d=b.getDOMElement("payment-plan-select-form-to-submit");a=[{name:"ppw-javaEnabled",value:p&&p.navigator&&p.navigator.javaEnabled()},{name:"ppw-language",value:p&&
p.navigator&&p.navigator.language},{name:"ppw-screenColorDepth",value:p&&p.screen&&p.screen.colorDepth},{name:"ppw-screenHeight",value:p&&p.screen&&p.screen.height},{name:"ppw-screenWidth",value:p&&p.screen&&p.screen.width},{name:"ppw-timeZone",value:(new Date).getTimezoneOffset()}];t.forEach(a,function(a){d.append(A.buildHiddenInput(a.name,a.value))});b.widget.widgetFormData=JSON.stringify(d.serializeArray());d.submit()});b.widget.on(g,b,function(a){b.orderSummaryHeaderEnabled&&b._updateOrderSummaryHeaderPaymentMethod(a.instrumentId);
var c=b.getDOMElement("redeem-claim-mobile");c.length&&(a&&"CashOnDelivery"===a.instrumentType?v.hideElement(c):v.showElement(c));v.hideElement(b.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-floating-container"));v.hideElement(b.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-container"));v.hideElement(b.getDOMElementsByPrefix("apx-emi-specific-info-message-content"));v.hideElement(b.getDOMElement("apx-order-summary-floating-container"));v.hideElement(b.getDOMElement("apx-order-summary-overlay-container"));
v.hideElement(b.getDOMElement("apx-order-summary-content"));b.isInlineEMIPlanChangeMessageExperienceEnabled&&v.hideElement(u(".emi-changed-info-message"));b.isPaylastEnabledForDesktop&&b._collapseOrderSummaryContainerDesktop()});b.isPaySelectCvvSecureFieldEnabled&&J.bindToEvents.apply(b);b.widget.on("useECardEvent",b,function(a){v.showElement(this.getDOMElement("order-summary-wrapper"));b.getDOMElement("top-sidebar-wrapper").addClass("a-box-group")});b.widget.on("ShowOrderSummaryIncompletePaymentPlanErrorMessageEvent",
b,function(a){b.getDOMElement("apx-order-summary-content").addClass("apx-height-55pct");b.getDOMElement("apx-order-summary-content").removeClass("apx-height-70pct");b.getDOMElement("apx-order-summary-api-error").addClass("apx-height-55pct");b.getDOMElement("apx-order-summary-api-error").removeClass("apx-height-70pct");v.showElement(this.getDOMElement("apx-order-summary-error-message-container"))});b.widget.on("HideOrderSummaryIncompletePaymentPlanErrorMessageEvent",b,function(a){b.getDOMElement("apx-order-summary-content").removeClass("apx-height-55pct");
b.getDOMElement("apx-order-summary-content").addClass("apx-height-70pct");b.getDOMElement("apx-order-summary-api-error").removeClass("apx-height-55pct");b.getDOMElement("apx-order-summary-api-error").addClass("apx-height-70pct");v.hideElement(this.getDOMElement("apx-order-summary-error-message-container"))});b.widget.on(O,b,function(a){"mobile"!==b.widget.options.deviceType||"false"!==b.showSecondaryView||b._isOnlyCcAvailableWeblabGated()||(a||{}).isForAPX3Register||b._hideSPPS()});b.widget.on("showRegistrationEvent",
b,function(a){"mobile"===b.widget.options.deviceType&&(v.showElement(b.getDOMElement("mcx-registration-wrapper")),v.hideElement(b.getDOMElement("mcx-registration-touch-link")),b._hideSPPS())});if(b.isEstimatedTotalEnabled&&null!=this.$displayedEstimatedTotalAmountContainer)b.widget.on("updateEstimatedTotal",b,function(a){"RewardsAccount"===a.type?b._updateEstimatedTotalForRewardsAccount(a.status,a.balance,a.instrumentId,a.isValid):"ProductVoucher"===a.type?b._updateEstimatedTotalForProductVoucher(a.status,
a.balance):"GC"===a.type?b._updateEstimatedTotalForGiftCard(a.status,a.balance):"PROMO"===a.type&&b._updateEstimatedTotalForPromoBalance(a.status,a.balance)});if(this.isOrderTotalDisplayedInFloatingCTAContainer||this.showFloatingContinueBarOnNonPaylastPSP)b.widget.on("UpdateOrderTotalForIBDEvent",b,function(a){this.appliedIbdAmount=a&&a.ibdAmountDisplayed?parseFloat(a.ibdAmountDisplayed):0;this._updateDisplayedOrderTotal()}),b.widget.on("UpdateOrderTotalForAPBEvent",b,function(a){this.appliedApbBalance=
a&&a.isApbSelected&&a.apbBalance?parseFloat(a.apbBalance.replace(/[^\d\.]/g,"")):0;this._updateDisplayedOrderTotal()}),b.widget.on("UpdateOrderTotalForNoCostEMIDiscount",b,function(a){this.appliedNoCostEMIDiscount=a&&a.noCostEMIValue?parseFloat(a.noCostEMIValue):0;this._updateDisplayedOrderTotal()}),b.widget.on("UpdateOrderTotalForPromoBalanceEvent",b,function(a){this.appliedPromoBalance=a&&a.isSelected&&a.promoBalance?"string"===typeof a.promoBalance?parseFloat(a.promoBalance.replace(/[^\d\.]/g,
"")):parseFloat(a.promoBalance):0;this._updateDisplayedOrderTotal()});b.widget.on("ContinueButtonClickedWithInvalidPaymentPlanEvent",b,function(a){if("mobile"===b.widget.options.deviceType){v.hideElement(b.getDOMElementsByPrefix("apx-emi-specific-info-message-content"));var c=b.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-container");a.message||(a.message=b.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"));v.showElement(b.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-floating-container"));
v.showElement(c);"undefined"!==typeof c[0]&&(c[0].getElementsByClassName("a-alert-content")[0].textContent=a.message);"undefined"!==typeof c[1]&&(c[1].getElementsByClassName("a-alert-content")[0].textContent=a.message);b.isOrderTotalDisplayedInFloatingCTAContainer&&(v.hideElement(b.getDOMElement("apx-order-summary-floating-container")),v.hideElement(b.getDOMElement("apx-order-summary-overlay-container")),v.hideElement(b.getDOMElement("apx-order-summary-content")),b._toggleTextOnOrderTotalsDisplay(!1))}});
b.widget.on("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",b,function(a){if("mobile"===b.widget.options.deviceType&&!b.isInlineEMIPlanChangeMessageExperienceEnabled){v.hideElement(b.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-container"));var c=b.getDOMElementsByPrefix("apx-emi-specific-info-message-content");a.message||(a.message=b.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"));1<c.length&&(v.showElement(c),c[0].getElementsByClassName("a-alert-content")[0].textContent=
a.message,c[1].getElementsByClassName("a-alert-content")[0].textContent=a.message)}});b.widget.on("storePaymentMethodDetailsResponse",b,function(a){b._updatePMDetails(a)});b.widget.on("removePaymentMethodDetailsResponse",b,function(a){this.upiInstrumentId===a.instrumentId&&b._removePMDetails()});b.widget.on("updateDeviceSignatureCheckStatus",b,function(a){this.deviceSignatureCheckStatus=a.deviceSignatureCheckStatus});b.widget.on(e,b,function(a){this.awaitingEventStatuses[n]=y.Pending;a&&a.errorMessage&&
(this.errorMessage=a.errorMessage)});b.widget.on(n,b,function(b){if(b){var c=this.awaitingEventStatuses[n]===y.Pending;this.awaitingEventStatuses[n]=b.instrumentPreparationStatus;this.isUpiRedirectionRequired=b.isUpiRedirectionRequired;this.isAPPInstrumentRedirectionRequired=b.isAPPInstrumentRedirectionRequired;this.failureReason=b.failureReason;this.errorMessage=b.errorMessage;c&&(p.clearTimeout(this.awaitInstrumentPrepareTimeoutFunction),this.hideSpinner||this.widget.trigger(a.hideSpinner),this.awaitingEventStatuses[n]===
y.Success?this.isPaySelectCvvSecureFieldEnabled?this._proceedWithContinueAfterEvents():this._proceedWithContinue():this._handleInstrumentPreparationFailure(this.failureReason));w.logCounterMetric({feature:"InstrumentPreparedEvent:"+b.instrumentPreparationStatus,resource:"_Count"});w.publishMetrics()}else this._handleInstrumentPreparationFailure(y.UnknownFailure);w.logCounterMetric({feature:"InstrumentPreparedEvent",resource:"_Count"});w.publishMetrics()});b.widget.on(x,b,function(a){a.contextId===
this.id&&(w.logCounterMetric({feature:"SecureFieldDataReadySuccess",resource:"_Count"}),w.publishMetrics(),b.awaitingEventStatuses[x]=y.Success,this._proceedWithContinueAfterEvents())});if(this.isUpiIssuanceEnabled)this.widget.on("UpiRedirectionRequiredEvent",this,function(a){this.isUpiRedirectionRequired=!0});if(this.isAPPIssuanceEnabled)this.widget.on("APPRedirectionRequiredEvent",this,function(a){this.isAPPInstrumentRedirectionRequired=!0});if(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)this.widget.on("componentsInitialized",
this,function(a){a=this.getDOMElement("payment-plan-select-form-to-submit");z.fetchOrderSummary(!0,a,0,!0)});if(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails||this.paylastOrderSummaryEnabled)this.widget.on("UpiRedirectionRequiredEvent",this,function(a){this.isPaymentPlanComplete=!1});b.widget.on("hideViewDetailsPopover",this,function(){this._closeViewDetailsPopover()});b.widget.on("updateRevisePaymentErrorMessage",this,function(a){a.titleStringId&&a.bodyStringId&&a.parameters&&a.notificationType&&
(this._changeTextOnRevisePaymentErrorMessage(a.titleStringId,a.bodyStringId,a.parameters),this._changeNotificationTypeOnRevisePaymentErrorMessage(a.notificationType))});b.widget.on("backingInstrumentSelected",this,function(a){if(a!==r){var b=a.paystationPaymentMethodCategory,c=a.instrumentId;this.redeemableAPBBalance=this.totalAPBBalance=this.maybeInstallmentsOfferIds=this.maybeSelectedInstallmentsOfferId=this.availableAPLBalance=r;if("AmazonPay"===b)c=a.giftCardId||a.storedValueId,this.totalAPBBalance=
a.totalAPBBalance,this.redeemableAPBBalance=a.redeemableAPBBalance;else if("AmazonCredit"===b&&(this.availableAPLBalance=a.availableAPLBalance,a.installmentOfferBOsWithoutAPB!==r)){var d=a.installmentOfferBOsWithoutAPB.filter(function(a){return 1===a.numberOfInstallments});d!==r&&0<d.length&&(this.maybeSelectedInstallmentsOfferId=d[0].financialOfferId);this.maybeInstallmentsOfferIds=a.installmentOfferBOsWithoutAPB.map(function(a){return a.financialOfferId})}this.selectedPaystationInstrumentId=c;this.selectedPaystationPaymentMethodCategory=
b}});0!==this.mcxFloatingFooterElement.length&&p.chrome&&addEventListener("resize",function(){var a="0px"===b.mcxFloatingFooterElement.css("bottom")?"0.001px":"0px";b.mcxFloatingFooterElement.css("bottom",a)});this.isRequestForMobileApp&&this.isMCXModernizedFrameEnabled&&C.hideAppOverlays();this.isModernizedSetPaymentPlanSelectOptimizationEnabled&&this.paymentsPageAdvertisementHTMLContent&&0!==this.paymentsPageAdvertisementHTMLElement.length&&0!==this.paymentsPageAdvertisementWrapperHTMLElement.length&&
this.renderAdvertisementContentAfterPageLoad()},_proceedWithContinueAfterEvents:function(){Object.values(this.awaitingEventStatuses).every(function(a){return a===y.NotRequired||a===y.Success})&&this._proceedWithContinue()},_changeTextOnRevisePaymentErrorMessage:function(a,b,c){var d=this.getDOMElement("revise-payment-error-message");d&&(d.find(".a-alert-heading")[0].innerHTML=this.widget.getLocalizedString(a,c),d.find(".a-alert-content")[0].innerHTML=this.widget.getLocalizedString(b,c))},_changeNotificationTypeOnRevisePaymentErrorMessage:function(a){var b=
this.getDOMElement("revise-payment-error-message");if(b)switch(a){case "warning":b.removeClass("a-alert-success");b.addClass("a-alert-warning");break;case "success":b.removeClass("a-alert-warning"),b.addClass("a-alert-success")}},getSecureRegistrationMobileAppTreatment:function(a){return this._mobileAppSecureRegistrationTreatment.toUpperCase()===a.toUpperCase()},_updateOrderSummaryHeaderPaymentMethod:function(a){var b=u("div[data-instrument-id\x3d'"+a+"']");a=b.find(".pmts-cc-issuer-name").data("issuer-name-short");
var c=b.find(".pmts-cc-number").data("number");b=b.find(".pmts-ba-account-tail").data("account-tail");var d=this.getDOMElement("issuer-and-tail"),e="";c!==r?e=a===r||a.isEmpty||""===a?this.widget.getLocalizedString("apx_order_summary_header_credit_card_number_tail",{number_tail:c}):this.widget.getLocalizedString("apx_order_summary_header_payment_method_number_tail",{number_tail:c,issuer:a}):b!==r&&(e=this.widget.getLocalizedString("apx_order_summary_header_bank_account_number_tail",{number_tail:b}));
d.html(e)},_showExplicitConsentPopover:function(){this.widget.trigger("validateConsentCheckBoxStatus"+this.selectedInstrumentId);this.isCardSelected&&!this.consentCheckBoxStatus?this.widget.trigger("DisplayConsentPopover"+this.selectedInstrumentId):this._continueButtonClicked()},_shouldProceedWithContinueAfterEvents:function(){this.isPaySelectCvvSecureFieldEnabled&&(this.awaitingEventStatuses[x]=y.Pending);return this.isWaitAtContinueEnabled&&this._shouldWaitForInstrumentPreparation()||this._shouldWaitForSecureFieldData()},
_shouldWaitForSecureFieldData:function(){return this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(d,{contextId:this.id})},_continueButtonClicked:function(){this._shouldProceedWithContinueAfterEvents()||this._proceedWithContinue()},_proceedWithContinue:function(){var a=this.getDOMElement("payment-plan-select-form-to-submit");t.isDefined(this.ajaxSubstitutionEnabled)&&this.widget.setAjaxSubstitutionEnabled(a,this.ajaxSubstitutionEnabled);if(this.widget.widgetFormData===JSON.stringify(a.serializeArray())){w.logCounterMetric({feature:"DuplicateContinueWidgetCallWithSameForm",
resource:"_Count"});w.publishMetrics();if(this.isSkipContinueWithSameFormWeblabEnabled&&this.widget.processingContinueRequest)return w.logCounterMetric({feature:"DuplicateContinueWidgetCallWithSameFormRejected",resource:"_Count"}),w.publishMetrics(),this.widget.log({multipleContinueWidgetCallsWithSameFormRejected:!0}),!1;this.widget.log({multipleContinueWidgetCallsWithSameFormAllowed:!0})}if(this.isUpiRedirectionRequired||this.isAPPInstrumentRedirectionRequired)this.widget.widgetFormData=JSON.stringify(a.serializeArray());
if(this.isUpiIssuanceEnabled&&this.isUpiRedirectionRequired)return w.logCounterMetric({feature:"UpiRedirectionContinueEvent",resource:"_Count"}),w.publishMetrics(),this.widget.publishSuccessSushiMetrics({ActionType:"UpiRedirectionContinueEvent"}),this.widget.trigger("UpiRedirectionContinueEvent"),!1;if(this.isAPPIssuanceEnabled&&this.isAPPInstrumentRedirectionRequired)return w.logCounterMetric({feature:"APPRedirectionContinueEvent",resource:"_Count"}),w.publishMetrics(),this.widget.publishSuccessSushiMetrics({ActionType:"AppRedirectionContinueEvent"}),
this.widget.trigger("APPRedirectionContinueEvent"),!1;if(this.bypassContinueWidgetCall)return a={bypassContinueWidgetCall:!0},this.delegateUpiProcessing&&"Completed"===this.getPMS2SCallStatus?(a.delegateUPIProcessing=!0,a.upiPMDetails={getPMS2SCallStatus:this.getPMS2SCallStatus,issuingPsp:this.issuingPsp,responseClientContext:this.responseClientContext,bankTail:this.bankTail,mPinLength:this.mPinLength,paymentMethodIdVersion:this.paymentMethodIdVersion,deviceSignature:this.deviceSignature,npciKey:this.npciKey,
customerVpa:this.customerVpa,bankAccountUniqueId:this.bankAccountUniqueId,customerMobileNumber:this.customerMobileNumber,bankName:this.bankName,instrumentId:this.upiInstrumentId}):(a.delegateUPIProcessing=!1,a.selectedPMDetails={selectedPaystationPaymentMethodCategory:this.selectedPaystationPaymentMethodCategory,selectedPaystationInstrumentId:this.selectedPaystationInstrumentId,availableAPLBalance:this.availableAPLBalance,totalAPBBalance:this.totalAPBBalance,redeemableAPBBalance:this.redeemableAPBBalance,
maybeInstallmentsOfferIds:this.maybeInstallmentsOfferIds,maybeSelectedInstallmentsOfferId:this.maybeSelectedInstallmentsOfferId}),this.widget.publishSuccessSushiMetrics({ActionType:"SetPaymentPlanSelectContinueEvent"}),this.widget.trigger(f,a),this.widget.trigger("Done",{WidgetResponseStatusCode:"200",delegatedPaymentMethodProcessing:!0}),!1;F.ensureWidgetEventInput(a,f);w.logLatencyMetric({feature:this.isJigsawEligible?"TimeSpentOnSteeringPSP":"TimeSpentOnRegularPSP",resource:"_Latency",startTime:PaymentsPortal2.widgetStartTime});
w.publishMetrics();this.widget.publishSuccessSushiMetrics({ActionType:"SetPaymentPlanSelectContinueEvent"});this.widget.trigger(f)},_shouldWaitForInstrumentPreparation:function(){this.awaitingEventStatuses[n]=y.NotRequired;this.failureReason=this.errorMessage=null;this.widget.trigger(b);if(this.awaitingEventStatuses[n]===y.NotRequired||this.awaitingEventStatuses[n]===y.Success)return!1;if(this.awaitingEventStatuses[n]===y.Failure)return this._firePreparedInstrumentContinueError(this.failureReason),
!0;if(this.awaitingEventStatuses[n]===y.Pending){this.hideSpinner||this.widget.trigger(a.showSpinner);var c=this;c.delegateUpiProcessing&&c.awaitingEventStatuses[n]!==y.Pending&&"Pending"!==c.deviceSignatureCheckStatus&&(P=2E3);c.awaitInstrumentPrepareTimeoutFunction=p.setTimeout(function(){c.awaitingEventStatuses[n]===y.Pending&&"Pending"===c.deviceSignatureCheckStatus?c._handleInstrumentPreparationFailure(y.TimedOut):(c.awaitingEventStatuses[n]===y.Pending&&"Pending"===c.getPMS2SCallStatus&&(c.getPMS2SCallStatus=
"TimedOut"),c._proceedWithContinue());c.hideSpinner||c.widget.trigger(a.hideSpinner)},P);return!0}return!1},_handleInstrumentPreparationFailure:function(a){this.awaitingEventStatuses[n]=y.Failure;this._firePreparedInstrumentContinueError(a)},_firePreparedInstrumentContinueError:function(a){this.widget.trigger(m,{reason:a});this.widgetDoneOnJSFailure&&this.widget.trigger(k);this.errorMessage&&this.widget.trigger("ContinueButtonClickedWithInvalidPaymentPlanEvent",{message:this.errorMessage})},_toggleOrderSummaryFloatingContainer:function(){var a=
this.getDOMElement("apx-order-summary-content"),b=this.getDOMElement("apx-order-summary-floating-container"),c=this.getDOMElement("apx-order-summary-overlay-container"),d=!1;b.hasClass("a-hidden")&&(d=!0,w.logCounterMetric({feature:"PaylastOrderSummaryApiLoadView",resource:"_Count"}));v.toggleElement(b,d);v.toggleElement(a,d);v.toggleElement(c,d);v.toggleElement(this.getDOMElement("apx-invalid-payment-plan-error-message-floating-container"),!d);this._toggleTextOnOrderTotalsDisplay(d);w.publishMetrics()},
_toggleTextOnOrderTotalsDisplay:function(a){a&&this.getDOMElement("apx-order-summary-view-details")[0]?(this.getDOMElement("apx-order-summary-view-details")[0].innerHTML=this.widget.getLocalizedString("apx_order_total_hide_details"),(N||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)&&this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:this.isPaymentPlanComplete,fetchOSTriggeredByViewDetails:!0})):this.getDOMElement("apx-order-summary-view-details")[0].innerHTML=this.widget.getLocalizedString("apx_order_total_view_details")},
_updateEstimatedTotalForPromoBalance:function(a,b){this._updateAppliedTotalValueAndToggleStatus("promoBalance",a,b)},_updateEstimatedTotalForGiftCard:function(a,b){this._updateAppliedTotalValueAndToggleStatus("giftCard",a,b)},_updateEstimatedTotalForProductVoucher:function(a,b){(b=b.match(/[\d]*[.]{0,1}[\d]+/))&&this._updateAppliedTotalValueAndToggleStatus("productVoucher",a,b[0])},_updateAppliedTotalValueAndToggleStatus:function(a,b,c){"promoBalance"===a?b&&!this.isPromoBalanceSelected?(this.isPromoBalanceSelected=
!0,this.appliedTotalValue+=parseFloat(c)):!b&&this.isPromoBalanceSelected&&(this.isPromoBalanceSelected=!1,this.appliedTotalValue-=parseFloat(c)):"giftCard"===a?b&&!this.isGiftCardSelected?(this.isGiftCardSelected=!0,this.appliedTotalValue+=parseFloat(c)):!b&&this.isGiftCardSelected&&(this.isGiftCardSelected=!1,this.appliedTotalValue-=parseFloat(c)):"productVoucher"===a&&(b&&!this.isProductVoucherSelected?(this.isProductVoucherSelected=!0,this.appliedTotalValue+=parseFloat(c)):!b&&this.isProductVoucherSelected&&
(this.isProductVoucherSelected=!1,this.appliedTotalValue-=parseFloat(c)));this._updateEstimatedTotal(this.appliedTotalValue)},_updateEstimatedTotalForRewardsAccount:function(a,b,c,d){d&&a&&!this.isRewardsAccountSelected?(this.isRewardsAccountSelected=!0,this.currentRA=c,this.appliedRewardsValue=parseFloat(b),this.appliedTotalValue+=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue)):a&&this.isRewardsAccountSelected?this.currentRA===c&&d?(this.appliedTotalValue-=this.appliedRewardsValue,
this.appliedRewardsValue=parseFloat(b),this.appliedTotalValue+=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue)):this.currentRA!==c&&(d?(this.currentRA=c,this.appliedTotalValue-=this.appliedRewardsValue,this.appliedRewardsValue=parseFloat(b),this.appliedTotalValue+=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue)):(this.currentRA=c,this.appliedTotalValue-=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue),this.appliedRewardsValue=
0)):!a&&this.isRewardsAccountSelected&&this.currentRA===c&&(this.isRewardsAccountSelected=!1,this.appliedTotalValue-=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue),this.appliedRewardsValue=0,this.currentRA="")},_updateEstimatedTotal:function(a){a=this.totalBeforeSpecialValue-a;0>a&&(a=0);this.$displayedEstimatedTotalAmountContainer.innerHTML=this._getAdjustedEstimatedTotalCurrency(a)},_getAdjustedEstimatedTotalCurrency:function(a){a=a.toLocaleString(this.localStringFormat,
{minimumFractionDigits:this.DECIMAL_PLACES,maximumFractionDigits:this.DECIMAL_PLACES});return this.totalBeforeSpecialString.replace(/[,.]/g,"").replace(/\d+/g,a)},_updateDisplayedOrderTotal:function(){var a=this.adjustedOrderTotalAmount-this.appliedIbdAmount-this.appliedApbBalance-this.appliedPromoBalance-this.appliedNoCostEMIDiscount;0>a&&(a=0);a=this._getDisplayedOrderCurrency(a);var b=this.getDOMElement("apx-order-total-container")[0],c=this.getDOMElement("apxOrderTotalLabelDesktop")[0];b&&(b.getElementsByClassName("apx-order-total-currency-container")[0].innerHTML=
a);c&&(c.getElementsByClassName("apx-order-total-currency-container")[0].innerHTML=a,this._collapseOrderSummaryContainerDesktop())},_getDisplayedOrderCurrency:function(a){if("IN"===this.countryCode||!this.adjustedDisplayOrderTotalString)return" "+Math.round(a).toLocaleString("en-IN");a=a.toFixed(this.DECIMAL_PLACES);return this.adjustedDisplayOrderTotalString.replace(/[,.]/g,"").replace(/\d+/g,a)},_collapseOrderSummaryContainerDesktop:function(){var a=this.getDOMElement("apx-order-summary-content-desktop"),
b=this.getDOMElement("apxOrderTotalLabelDesktop"),c=this.getDOMElement("order-summary-view-details-desktop"),d=this.getDOMElement("apxOrderTotalDivider"),e=this.getDOMElement("apx-order-summary-error-message-desktop-container"),f=this.getDOMElement("apx-order-summary-and-error-container-desktop");c&&(c[0].innerHTML=this.widget.getLocalizedString("apx_order_total_view_details"));a&&v.toggleElement(a,!1);b&&v.toggleElement(b,!0);d&&v.toggleElement(d,!0);e&&v.hideElement(e);f&&v.hideElement(f)},_closeViewDetailsPopover:function(){var a=
this.getDOMElement("apx-view-order-summary-popover"),b=this.getDOMElement("apx-view-order-summary-popover-down-arrow");a&&(v.toggleElement(a,!1),v.toggleElement(b,!1))},_hideSPPS:function(){v.hideElement(this.getDOMElement("payment-option-list-alert-messages"));v.hideElement(this.getDOMElement("payselect-title"));v.hideElement(this.getDOMElement("payment-option-list-page"));v.hideElement(this.getDOMElement("balances-and-secondary-button"));v.hideElement(this.getDOMElement("mcx-floating-footer"))},
_isOnlyCcAvailableWeblabGated:function(){if(!this.isSkipAddCreditCardWeblabEnabled)return!1;var a=this.supportedPaymentMethods.filter(this.filterPaymentMethods),b=1===a.length;a=a.includes("CC");return b&&a},_disableSPPSRefreshEvent:function(){if(!u("#stop-mash-reappear").length){var a=document.createElement("div");a.id="stop-mash-reappear";u("body").append(a)}},_triggerShowAddPaymentInstrumentPageEvent:function(){this.widget.trigger(O)},filterPaymentMethods:function(a){return"GC"!==a&&"DC"!==a},
renderAdvertisementContentAfterPageLoad:function(){var a=this;c.when("jQuery","load").execute(function(){a.paymentsPageAdvertisementHTMLElement.html(a.paymentsPageAdvertisementHTMLContent);v.showElement(a.paymentsPageAdvertisementWrapperHTMLElement)})},_triggerContinueButtonWithSelectedInstrument:function(a,b,c,d,e){this._publishCountMetrics("PaymentInstrumentAdded.CC.RegType_TapToPay");this._upsertSelectedPaymentInForm(a,b,c,d);this._attachSPCTransitionObservers(e);this.widget.trigger(f,{})},_upsertSelectedPaymentInForm:function(a,
b,c,d){var e=this.getDOMElement("payment-plan-select-form-to-submit");Array.from(e[0].elements).forEach(function(a){"ppw-instrumentRowSelection"===a.name&&"radio"===a.type&&(a.checked=!1)});a=this._buildEncodedInstrumentRowSelection(a,b);e.append(A.buildHiddenInput("ppw-instrumentRowSelection",a));e.append(A.buildHiddenInput("ppw-paymentMethodEntryMode",c));e.append(A.buildHiddenInput("ppw-paymentMethodIssuer",d))},_buildEncodedInstrumentRowSelection:function(a,b){return"instrumentId\x3d"+a+"\x26"+
("paymentMethod\x3d"+b)},_attachSPCTransitionObservers:function(a){var b=new Date(a),c=this;(new MutationObserver(function(a,d){a.forEach(function(a){Array.from(a.addedNodes).forEach(function(a){if(1===a.nodeType&&(a=a.querySelectorAll("#address-select, #checkout-payment-option-block, #prime-actions-section"),0!==a.length)){for(var e=0;e<a.length;e++)"checkout-payment-option-block"===a[e].id?(c._publishCountMetrics("PaymentPlanCreated.CC.RegType_TapToPay.RedirectedPage_SPC"),c._publishLatencyMetrics("PaymentPlanCreated.CC.RegType_TapToPay.RedirectedPage_SPC",
b)):"address-select"===a[e].id?(c._publishCountMetrics("PaymentPlanCreated.CC.RegType_TapToPay.RedirectedPage_Address"),c._publishLatencyMetrics("PaymentPlanCreated.CC.RegType_TapToPay.RedirectedPage_Address",b)):"prime-actions-section"===a[e].id&&(c._publishCountMetrics("PaymentPlanCreated.CC.RegType_TapToPay.RedirectedPage_SubscribePrime"),c._publishLatencyMetrics("PaymentPlanCreated.CC.RegType_TapToPay.RedirectedPage_SubscribePrime",b));C.backToBookmark("spps-widget");d.disconnect()}})})})).observe(document.body,
{attributes:!1,childList:!0,subtree:!0})},_publishCountMetrics:function(a){w.logCounterMetric({feature:a,resource:"_Count"});w.publishMetrics()},_publishLatencyMetrics:function(a,b){b&&(w.logLatencyMetric({feature:a,resource:"_Latency",startTime:b}),w.publishMetrics())}})});m("components/SetPaymentPlanSelectComponent/validators",[],function(){return[]});m("events/SetPaymentPlanSelectContinueEvent",["public-event-registry"],function(c){c.register("SetPaymentPlanSelectContinueEvent");return"SetPaymentPlanSelectContinueEvent"});
m("events/SetPaymentPlanTrial",["public-event-registry"],function(c){c.register("SetPaymentPlanTrialEvent");return"SetPaymentPlanTrialEvent"});m("events/ShowMessageOnContinueButton",["public-event-registry"],function(c){c.register("ShowMessageOnContinueButton");return"ShowMessageOnContinueButton"});m("events/ValidateInstrumentPreparationEvent",["public-event-registry"],function(c){c.register("ValidateInstrumentPreparation");return"ValidateInstrumentPreparation"});m("components/SetPaymentPlanSelectWorkflowComponent",
["workflow-component"],function(c){return c.extend()});m("components/SetPaymentPreferenceComponent",["workflow-component","lang","mash-helper","mixins/secure-container-support"],function(c,g,f,h){return c.extend(h,{initialize:function(c,b){this._isRequestForMobileApp=b.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=b.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=b.data.dynamicContinueEnabled;var e=this;e._isRequestForMobileApp&&(f.addEventListener(e._securePaymentMethodAddedEvent,
function(b){e._addEventListenerSPPHandler(b,"0")}),f.addEventListener("APX3RegisterSuccessEvent",function(b){e._addEventListenerSPPHandler(b,"1")}),f.setBookmark("spp-widget"))},_addEventListenerSPPHandler:function(c,b){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(c.detail.paymentInstrumentId,c.detail.widgetAction,r,"post",b):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":c.detail.paymentInstrumentId,
"ppw-widgetAction":c.detail.widgetAction,"ppw-maybeShouldRecordAPX3Metric":b});f.backToBookmark("spp-widget")}})});m("components/PaymentPreferenceSummaryComponent",["lang","continuable-component","public-event-registry","events/SelectedInstrumentIdsEvent","events/SelectedBillingAddressIdEvent"],function(c,g,f,h,l){return g.extend({_selectedInstrumentIds:[],_selectedBillingAddressId:r,initialize:function(b,c){this._selectedInstrumentIds=c.data.selectedInstrumentIds;this._selectedBillingAddressId=c.data.selectedBillingAddressId;
f.register(h);f.register(l)},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(){b.setContinuable(!0);b.widget.trigger(h,{instrumentIds:b._selectedInstrumentIds});b._selectedBillingAddressId!==r?b.widget.trigger(l,{billingAddressId:b._selectedBillingAddressId,error:null}):b.widget.trigger(l,{billingAddressId:b._selectedBillingAddressId,error:"Failed to get billing addressId"})});b.widget.on(b.data.eventCompleteWidget,b,function(){b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,
"ppw-widgetEvent":b.data.savePreferenceEvent},{success:b.widget.createAjaxContinueSuccessHandler()})})}})});m("events/SelectedBillingAddressIdEvent",[],function(){return"SelectedBillingAddressIdEvent"});m("events/SelectedInstrumentIdsEvent",[],function(){return"SelectedInstrumentIdsEvent"});m("components/SetPaymentPreferenceSelectComponent","css-utils form-helper jQuery component lang AddPaymentMethodTouchLinkSupport events/ShowAddPaymentInstrumentPage".split(" "),function(c,g,f,h,l,b,e){return h.extend(b,
{_showSecondaryView:!1,_deviceType:"desktop",initialize:function(b,c){this._showSecondaryView=c.data.showSecondaryView;this._deviceType=b.options.deviceType},bindToEvents:function(){var b=this;b.widget.on("ContinueButtonClicked",b,function(c){b.widget.trigger("ManualFormSubmission")});b.widget.on("SecondaryContinueButtonClicked",b,function(c){b.widget.trigger("ManualFormSubmission")});b.widget.on("CompleteWidget",b,function(c){b.widget.trigger("ManualFormSubmission")});b.widget.on("ManualFormSubmission",
b,function(){var c=b.getDOMElement("payment-preference-select-form-to-submit");g.ensureWidgetEventInput(c,"PreferencePaymentOptionSelectionEvent");c.submit()});b.widget.on(e,b,function(e){"mobile"===b._deviceType&&"false"===b._showSecondaryView&&(c.hideElement(b.getDOMElement("payselect-title")),c.hideElement(b.getDOMElement("payment-option-list-page")),c.hideElement(b.getDOMElement("balances-and-secondary-button")))})}})});m("components/SetPayNowInstrumentSelectComponent","css-utils form-helper jQuery component lang AddPaymentMethodTouchLinkSupport events/InstrumentRowSelectedEvent events/ShowAddPaymentInstrumentPage".split(" "),
function(c,g,f,h,l,b,e,n){return h.extend(b,{_showSecondaryView:!1,_deviceType:"desktop",_enableDisclaimer:!0,_arvatoDisclaimerDisplayablePaymentMethodCodesArray:[],_paymentMethodCode:null,_isDisclaimerHidden:!1,_addedInstrumnetEvent:!1,_addInstrumnetEvent:!1,_isIdealSameBankAccountErrorEnabled:!1,initialize:function(b,a){this._showSecondaryView=a.data.showSecondaryView;this._deviceType=b.options.deviceType;this._arvatoDisclaimerDisplayablePaymentMethodCodesArray=a.data.arvatoDisclaimerDisplayableArray;
if(this._isIdealSameBankAccountErrorEnabled=a.data.isIdealSameBankAccountErrorEnabled)this._addedInstrumnetEvent=a.data.addedInstrumnetEvent,this._addInstrumnetEvent=a.data.addInstrumnetEvent},_displayDisclaimer:function(){var b=this.getDOMElement("pay-now-arvato-disclaimer-checkbox");this._enableDisclaimer?c.showElement(b):c.hideElement(b);this._setIsDisclaimerHidden()},bindToElements:function(){var b=this;this.$checkbox=this.getDOMElement("pay-now-arvato-disclaimer-checkbox").find("input");b.$checkbox.change(function(){this._isDisclaimerHidden||
f(".pmts-arvato-disclaimer input[type\x3dcheckbox]").is(":checked")?b._enableContinueButton():b._disableContinueButton()});this._isIdealSameBankAccountErrorEnabled&&"mobile"===this._deviceType&&!0===this._addInstrumnetEvent&&!1===this._addedInstrumnetEvent&&b._idealDuplicateInstrumentError()},_checkPaymentMethodCode:function(){this._enableDisclaimer=this._paymentMethodCode&&this._arvatoDisclaimerDisplayablePaymentMethodCodesArray&&0!==this._arvatoDisclaimerDisplayablePaymentMethodCodesArray.length?
this._arvatoDisclaimerDisplayablePaymentMethodCodesArray.includes(this._paymentMethodCode):!0},_onInstrumentSelected:function(){this._checkPaymentMethodCode();this._displayDisclaimer();this._arvatoDisclaimerCheckBoxChecked=f(".pmts-arvato-disclaimer input[type\x3dcheckbox]").is(":checked");this._isDisclaimerHidden||this._arvatoDisclaimerCheckBoxChecked?this._enableContinueButton():this._disableContinueButton()},_setIsDisclaimerHidden:function(){this._isDisclaimerHidden=c.hasAUIHiddenClass(this.getDOMElement("pay-now-arvato-disclaimer-checkbox"))},
bindToEvents:function(){var b=this;b.widget.on("ContinueButtonClicked",b,function(a){b.widget.trigger("ManualFormSubmission")});b.widget.on("ManualFormSubmission",b,function(){var a=b.getDOMElement("pay-now-instrument-select-form-to-submit");g.ensureWidgetEventInput(a,"PayNowInstrumentSelectionEvent");a.submit()});b.widget.on(n,b,function(a){"mobile"===b._deviceType&&"false"===b._showSecondaryView&&(c.hideElement(b.getDOMElement("payselect-title")),c.hideElement(b.getDOMElement("payment-option-list-page")))});
l.forEach(["initializeRecommendedInstrument",e],function(a){b.widget.on(a,b,function(a){b._paymentMethodCode=a.paymentMethod;b._onInstrumentSelected()})})},_disableContinueButton:function(){if("mobile"!==this._deviceType)f(".pmts-sidebar-wrapper .a-box-inner").css("pointer-events","none"),f(".pmts-sidebar-wrapper .a-box-inner").addClass("a-button-disabled");else{var b="#"+this._elementReferences["pay-now-mobile-instrument-select-continue-button"]+" .pmts-portal-component";f(b).css("pointer-events",
"none");f(b).addClass("a-button-disabled")}},_idealDuplicateInstrumentError:function(){this.widget.trigger(n)},_enableContinueButton:function(){if("mobile"!==this._deviceType)f(".pmts-sidebar-wrapper .a-box-inner").css("pointer-events",""),f(".pmts-sidebar-wrapper .a-box-inner").removeClass("a-button-disabled");else{var b="#"+this._elementReferences["pay-now-mobile-instrument-select-continue-button"]+" .pmts-portal-component";f(b).css("pointer-events","");f(b).removeClass("a-button-disabled")}}})});
m("components/SidebarContinueButtonComponent",["components/ContinueButtonComponent","popover","clog","lang"],function(c,g,f,h){return c.extend({initialize:function(c,b){this.metricName=b.data.metricName;this.popover=new g(this.getDOMElement(this.continueButton),{position:"triggerLeft",closeButton:!1},{position:"triggerLeft"})},bindToElements:function(){var g=this;h.bind(c.prototype.bindToElements,g).apply();g.getDOMElement("apx-verify-later-button").click(function(){g.metricName!==r&&null!==g.metricName&&
""!==g.metricName&&(f.logCounterMetric({feature:g.metricName+".VerifyLater",resource:"_Count"}),f.publishMetrics())})}})});m("components/PayNowComponent",["component","css-utils"],function(c,g){return c.extend({bindToElements:function(){var c=this;c.getDOMElement("changePaymentMethod").click(function(){c.widget.trigger("changePaymentMethodEvent")})},bindToEvents:function(){var c=this;c.widget.on("changePaymentMethodEvent",c,function(f){c.widget.submitFormAJAX({"ppw-widgetEvent":"SelectPayNowPaymentMethodEvent",
"ppw-widgetState":c.widget.options.serializedState})});c.widget.on("componentsInitialized",c,function(f){g.showElement(c.getDOMElement("payNowSummaryContainer"))})}})});m("components/PayNowSelectedIDealComponent",["component","css-utils"],function(c,g){return c.extend({})});m("components/PayNowSelectedSepaDDComponent",["component","css-utils"],function(c,g){return c.extend({})});m("components/StatementDetailsComponent",["component","css-utils"],function(c,g){return c.extend({bindToElements:function(){var c=
this;c.getDOMElement("printInvoiceLink").click(function(){var f=[c.getDOMElement("payNowComponent"),c.getDOMElement("beneficiaryExpander"),c.getDOMElement("invoicePaymentMethodDivider"),c.getDOMElement("headerAlerts"),c.getDOMElement("mandateDetails"),c.getDOMElement("faqSection")];c.hideElementsIfExists(f);p.print();c.unhideElementsIfExists(f)})},bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(f){g.hideElement(c.getDOMElement("statementDetailsAsyncSpinner"))})},
hideElementsIfExists:function(c){c.filter(Boolean).forEach(function(c){c.css("display","none")})},unhideElementsIfExists:function(c){c.filter(Boolean).forEach(function(c){c.css("display","block")})}})});m("components/StickyContinueButtonAndOrderSummaryComponent","component jQuery css-utils events/InstrumentRowSelectedEvent form-constants form-helper ExecutionsWidgetUtils lang events/SetPaymentPlanSelectContinueEvent events/SelectablePaymentOptionEvents clog".split(" "),function(c,g,f,h,l,b,e,n,m,
a,k){var d=null,q="",r="",u="",D={};return c.extend({initialize:function(a,b){this.isStickyContinueButtonEnabled=b.data.isStickyContinueButtonEnabled;this.isAddOrderSummaryToStickyContinueButtonEnabled=b.data.isAddOrderSummaryToStickyContinueButtonEnabled;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;this.grandTotalCurrencySymbol=b.data.grandTotalCurrencySymbol;this.isDesktop="desktop"===a.options.deviceType;this.isMobile="mobile"===a.options.deviceType;this.isPaymentPlanComplete=
!1;this.stickyOrderSummaryHideDetailsString=a.getLocalizedString("apx_order_total_hide_details");this.stickyOrderSummaryViewDetailsString=a.getLocalizedString("apx_order_total_view_details");this.invalidPaymentPlanEventErrorMessage=a.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.enterCVVMessages=[a.getLocalizedString("pmts_portal_add_instrument_credit_card_error_security_code_invalid"),a.getLocalizedString("emi_invalid_verification_error")];this.staticOrderTotal=parseFloat(b.data.staticOrderTotal)},
bindToEvents:function(){var b=this;b.isDesktop&&b.isStickyContinueButtonEnabled&&g(p).scroll(function(a){if(g(p)){a=g(p).scrollTop();var b=g(".pmts-payment-instruments-container-classic");b&&(b=b.offset().top,a>b?g(".sticky-continue-button-and-order-summary-container-desktop").addClass("desktop-stick-to-top-right"):g(".sticky-continue-button-and-order-summary-container-desktop").removeClass("desktop-stick-to-top-right"))}});b.isMobile&&b.isStickyContinueButtonEnabled&&(b.widget.on("ContinueButtonClickedWithInvalidPaymentPlanEvent",
b,function(a){var c=b.getDOMElement("apx-invalid-payment-plan-error-message-container");a.message||(a.message=b.invalidPaymentPlanEventErrorMessage);f.showElement(c);"undefined"!==typeof c[0]&&(c[0].getElementsByClassName("a-alert-content")[0].textContent=a.message)}),b.widget.on(h,b,function(a){f.hideElement(b.getDOMElement("apx-invalid-payment-plan-error-message-container"))}));b.isDynamicOrderSummaryEnabled&&(b.widget.on(a.PaymentPlanSelected,b,function(a){u=a.instrumentId;D=a.selectedOptionalInstruments;
var c=a.isValid,d=b.isInstrumentSelectionChanged(a.instrumentId);if("CC"!==a.paymentMethod||null!==a.message&&!b.enterCVVMessages.includes(a.message))r="";else if(d)c=!0;else return;b.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:c})}),b.widget.on("installmentOptionChanged",b,function(){b.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:!0})}),n.forEach(["UpiRedirectionRequiredEvent","APPRedirectionRequiredEvent"],function(a){b.widget.on(a,b,function(a){b.widget.trigger("FetchOrderSummaryDataEvent",
{isPaymentPlanComplete:!1});r=""})}),b.widget.on("FetchOrderSummaryDataEvent",b,function(a){b.updateEstimatedOrderTotal();(b.isPaymentPlanComplete=a.isPaymentPlanComplete)?(b.toggleIncompletePaymentPlanContainer(!1),b.fetchOrderSummaryData()):(d&&(d.abort(),k.logCounterMetric({feature:"FetchOrderSummaryDataRequestAborted",resource:"_Count"})),b.toggleIncompletePaymentPlanContainer(!0),b.toggleOrderSummaryContent(!1),b.toggleOrderSummaryRetryContainer(!1),b.toggleOrderSummarySpinner(!1));k.publishMetrics()}))},
bindToElements:function(){var a=this;a.isMobile&&a.isAddOrderSummaryToStickyContinueButtonEnabled&&(a.getDOMElement("apx-sticky-order-total-and-view-details-mobile").click(function(){a.toggleStickyOrderSummaryContainer();k.logCounterMetric({feature:"OrderSummaryViewDetailsClicked",resource:"_Count"});k.publishMetrics()}),a.getDOMElement("apx-sticky-order-summary-close-icon").click(function(){a.toggleStickyOrderSummaryContainer()}),a.getDOMElement("apx-sticky-order-summary-overlay-container").click(function(){a.toggleStickyOrderSummaryContainer()}));
a.isDynamicOrderSummaryEnabled&&(a.getDOMElement("apx-sticky-order-summary-retry-button").click(function(){a.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:a.isPaymentPlanComplete});k.logCounterMetric({feature:"FetchOrderSummaryDataRequestRetry",resource:"_Count"})}),k.publishMetrics())},updateEstimatedOrderTotal:function(){var a=this;if("undefined"==typeof u||"undefined"==typeof D){var b=a.staticOrderTotal.toLocaleString("en-IN",{useGrouping:!0,minimumFractionDigits:2});this.updateGrandTotalAmount(b,
a.grandTotalCurrencySymbol+b)}else{b=a._getInstrumentHiddenInputValue(u);var c=0;n.forEachKeyValue(D,function(b,d){b&&d&&d.instrumentId&&(c+=a._getInstrumentHiddenInputValue(b))});b=parseFloat(b)+parseFloat(c);b=(0>a.staticOrderTotal+b?0:a.staticOrderTotal+b).toLocaleString("en-IN",{useGrouping:!0,minimumFractionDigits:2});this.updateGrandTotalAmount(b,a.grandTotalCurrencySymbol+b)}},_getInstrumentHiddenInputValue:function(a){a=document.getElementsByName("ppw-"+a+"_instrumentOrderTotalBalance")[0];
var b=0;try{var c=a&&a.value?a.value.toString():JSON.stringify({}),d=JSON.parse(c),e;for(e in d)b+=parseFloat(d[e])}catch(w){console.log(w)}finally{return b}},toggleStickyOrderSummaryContainer:function(a){var b=this.getDOMElement("apx-sticky-order-summary-container"),c=this.getDOMElement("apx-sticky-order-summary-overlay-container"),d=this.getDOMElement("apx-invalid-payment-plan-error-message-container");"undefined"===typeof a&&b.hasClass("a-hidden")&&(a=!0);f.toggleElement(b,a);f.toggleElement(c,
a);f.toggleElement(d,!1);this.toggleTextOnOrderTotalsDisplay(a)},toggleTextOnOrderTotalsDisplay:function(a){var b=this.getDOMElement("apx-sticky-order-summary-view-details")[0];b&&(b.innerHTML=a?this.stickyOrderSummaryHideDetailsString:this.stickyOrderSummaryViewDetailsString)},toggleOrderSummarySpinner:function(a){var b=this.getDOMElement("apx-sticky-order-summary-spinner");f.toggleElement(b,a)},toggleIncompletePaymentPlanContainer:function(a){var b=this.getDOMElement("apx-sticky-order-summary-incomplete-payment-plan");
f.toggleElement(b,a)},toggleOrderSummaryRetryContainer:function(a){var b=this.getDOMElement("apx-sticky-order-summary-retry-container");f.toggleElement(b,a)},toggleOrderSummaryContent:function(a){var b=this.getDOMElement("apx-sticky-order-summary-content");f.toggleElement(b,a)},fetchOrderSummaryData:function(){var a=this,b=(new Date).getTime(),c=a.getPaymentPlanSelectionFormData(),e=a.getDOMElement("apx-sticky-order-summary-purchase-category");c["ppw-purchaseCategory"]=e?e.val():"";d=a.widget.asyncContinueRequest(c,
{beforeSend:function(){d&&(d.abort(),k.logCounterMetric({feature:"FetchOrderSummaryDataRequestAborted",resource:"_Count"}));a.toggleOrderSummarySpinner(!0);a.toggleOrderSummaryRetryContainer(!1);a.toggleOrderSummaryContent(!1)},success:function(c){try{var d=JSON.parse(c.additionalWidgetResponseData.additionalData.subtotals),e=JSON.parse(c.additionalWidgetResponseData.additionalData.grandTotal);a.updateOrderSummaryData(e,d);a.toggleOrderSummaryRetryContainer(!1);k.logCounterMetric({feature:"FetchOrderSummaryDataRequestSuccessful",
resource:"_Count"});k.logLatencyMetric({feature:"FetchOrderSummaryDataRequestSuccessful",resource:"_Latency",startTime:b})}catch(y){k.logCounterMetric({feature:"FetchOrderSummaryDataRequestException",resource:"_Count"}),k.logLatencyMetric({feature:"FetchOrderSummaryDataRequestException",resource:"_Latency",startTime:b}),a.toggleOrderSummaryRetryContainer(!0),a.toggleOrderSummaryContent(!1)}finally{a.toggleOrderSummarySpinner(!1)}},error:function(){a.toggleOrderSummaryRetryContainer(!0);a.toggleOrderSummaryContent(!1);
a.toggleOrderSummarySpinner(!1);k.logCounterMetric({feature:"FetchOrderSummaryDataRequestError",resource:"_Count"});k.logLatencyMetric({feature:"FetchOrderSummaryDataRequestError",resource:"_Latency",startTime:b})},retryLimit:0})},updateOrderSummaryData:function(a,b){var c=Object.keys(b).length,d=parseFloat(a.grandTotal.currency.value).toLocaleString("en-IN",{useGrouping:!0,minimumFractionDigits:2});a=a.grandTotal.currency.displayString;var e=this.getDOMElement("apx-sticky-order-summary-line-items"),
g=e.children().first().clone();e.children().remove();for(var h in b)if(!(2<c&&"itemDiscount"===h)){var l=b[h].maybeStringIdParams,n=this.widget.getLocalizedString(b[h].stringId);l&&(n=this.widget.getLocalizedString(b[h].stringId,l));l=b[h].currency.displayString;l.includes("-")&&(l="-"+l.replace("-",""));var m=g.clone(!0,!0),p=m.find(".sticky-subtotal-label-text"),q=m.find(".sticky-subtotal-amount-value"),t=m.find(".sticky-subtotal-expander-button"),r=m.find(".sticky-subtotal-expander-content"),v=
b[h].maybeExpanderContentStringId;this.isMobile&&v&&(v=this.widget.getLocalizedString(v),f.showElement(t),r.html(v));p.html(n);q.html(l);e.append(m)}this.toggleOrderSummaryContent(!0);(b=this.getDOMElement("apx-sticky-order-total-amount")[0])&&a!==b.innerHtml&&k.logCounterMetric({feature:"FetchOrderSummaryDataGrandTotalMismatch",resource:"_Count"});this.updateGrandTotalAmount(d,a)},updateGrandTotalAmount:function(a,b){var c=this.getDOMElement("apx-sticky-order-total-amount-mobile")[0],d=this.getDOMElement("apx-sticky-order-total-amount")[0],
e=g(".continue-button-text")[0];c&&(c.innerHTML=this.widget.getLocalizedString("apx_currency_symbol_and_amount_with_space",{currency_symbol:this.grandTotalCurrencySymbol,amount:a}));e&&this.isDesktop&&(e.innerHTML=this.widget.getLocalizedString("apx_continue_button_text_pay_with_amount",{order_total:b}));d&&(d.innerHTML=b)},getPaymentPlanSelectionFormData:function(){var a=g(".pmts-select-payment-instrument-form").closest("form");a.append(e.buildHiddenInput("addCreditCardVerificationNumber99","123"));
var c=a.find("input[type\x3d'hidden'][name^\x3d'"+(l.WIDGET_EVENT_KEY+l.KEY_VALUE_SEPARATOR)+m+"']")[0];a=b.serializeObject(a);c&&delete a[c.name];a[l.WIDGET_EVENT_KEY]="FetchOrderSummaryDataEvent";return a},isInstrumentSelectionChanged:function(a){var c=g(".pmts-select-payment-instrument-form").closest("form").clone().find("input[type\x3d'checkbox'][name^\x3d'ppw']"),d=b.serializeObject(c);c="";for(var e in d)c+=d[e];e=c!==q||a!==r;q=c;r=a;return e}})});m("components/TrustedBeneficiaryComponent",
["component"],function(c){return c.extend({bindToElements:function(){var c=this;if(this.data.paymentMethodId)this.widget.onAui("a:switch:trusted-beneficiary-toggle-switch:"+this.data.paymentMethodId+":flip",function(f){c.widget.submitFormAJAX({"ppw-widgetEvent":"UpdateTrustedBeneficiaryStatusEvent","ppw-paymentMethodId":c.data.paymentMethodId,"ppw-optInTrustedBeneficiary":f.switchState.isOn.toString(),"ppw-widgetState":c.widget.options.serializedState})})}})});m("components/PerformUpdateEverywhereWorkflowComponent",
["modal-popover","component"],function(c,g){return g.extend({initialize:function(f,g){g.data.showInPopover&&(this.popover=new c(f,g,this))},bindToEvents:function(){this.widget.on("ue-cancelClicked",this,function(c){this.getDOMElement("pmts-ue-js-popover-cancel-form").submit()})}})});m("components/UpdateEverywhereConfirmationComponent",["component","lang"],function(c,g){return c.extend({})});m("components/UpdateEverywhereFixInstrumentComponent","events/InstrumentRowSelectedEvent css-utils component lang jQuery attributes".split(" "),
function(c,g,f,h,l,b){return f.extend(b,{selectedInstrumentId:null,initialize:function(b,c){this.set("UpdateButtonEnabledAttribute",!0);this.watch("UpdateButtonEnabledAttribute",this,function(b){this.widget.log({updateButtonEnabled:b});b?g.enableElement(this.getDOMElement("pmts-ue-js-credit_card_fixup-update-button")):g.disableElement(this.getDOMElement("pmts-ue-js-credit_card_fixup-update-button"))})},_instrumentRowSelected:function(b){this._getAllCreditCardRows().removeClass("pmts-selected");this._getCreditCardRow(b).addClass("pmts-selected");
this.getDOMElement("instrumentRowSelection-"+b).prop("checked",!0);var c=this.getDOMElement("instrumentRowSelection-"+b).val();this._triggerCreditCardRowSelectedEvent(b,c)},_creditCardRowClicked:function(b){(b=l(b.currentTarget).data("instrument-id"))&&this.selectedInstrumentId!==b&&this._triggerInstrumentRowSelectedEvent(b)},_getCreditCardRow:function(b){return this.getDOMElement("creditCardContainer-"+b)},_getAllCreditCardRows:function(){return this.getDOMElementsByPrefix("creditCardContainer-")},
_triggerInstrumentRowSelectedEvent:function(b,f){this.widget.trigger(c,{instrumentId:b,errors:f})},_triggerCreditCardRowSelectedEvent:function(b,c){this.widget.trigger("creditCardRowSelected",{instrumentId:b,instrumentSelectionValue:c})},_selectBackingInstrument:function(b){b=b&&b.instrumentId?b:null;this._updatePaymentPlanState(b)},_updatePaymentPlanState:function(b){b=b?this._firstElement(b.errors):this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.set("UpdateButtonEnabledAttribute",
!b)},_firstElement:function(b){return h.isArray(b)&&0<b.length?b[0]:null},_initFixupView:function(){this.getDOMElementsByPrefix("creditCardContainer-").trigger("click")},_handleClickEvent:function(b){this.get("UpdateButtonEnabledAttribute")&&this.getDOMElement("pmts-ue-js-credit_card_fixup-cc-list-item-form").submit()},bindToElements:function(){var b=this;b.getDOMElementsByPrefix("creditCardContainer-").click(h.bind(this._creditCardRowClicked,this));b.getDOMElement("pmts-ue-js-credit_card_fixup-update-button").click(h.bind(this._handleClickEvent,
b));b.getDOMElement("pmts-ue-js-credit_card_fixup-cancel-button").click(function(c){b.getDOMElement("pmts-ue-js-credit_card_fixup-cancel-button-form").submit()})},bindToEvents:function(){var b=this;this.widget.on("initializeRecommendedInstrument",this,function(b){this.selectedInstrumentId=b.instrumentId});b.widget.on("componentsInitialized",b,function(){this._initFixupView()});b.widget.on(c,b,function(c){b.selectedInstrumentId=c.instrumentId;b._instrumentRowSelected(c.instrumentId)});b.widget.on("backingInstrumentSelected",
this,function(c){b._selectBackingInstrument(c)})}})});m("components/PerformUpdateEverywhereComponent",["component","lang"],function(c,g){return c.extend({})});m("components/UpdateEverywhereSelectInstrumentComponent",["component","css-utils","jQuery","lang","attributes"],function(c,g,f,h,l){return c.extend(l,{initialize:function(b,c){(this._forDeleteAndUpdateEverywhere=c.data.forDeleteAndUpdateEverywhere)||this._initializeUESelectInstrumentComponent(this)},bindToElements:function(){this._forDeleteAndUpdateEverywhere||
this._bindToElementsUESelectInstrumentComponent(this)},bindToEvents:function(){this._forDeleteAndUpdateEverywhere||this._bindToEventsSelectInstrumentComponent(this)},_initializeUESelectInstrumentComponent:function(b){b.set("UpdateButtonEnabledAttribute",!0);b.watch("UpdateButtonEnabledAttribute",b,function(c){b.widget.log({updateButtonEnabled:c});c?g.enableElement(b.getDOMElement("pmts-ue-select-instrument-update-button")):g.disableElement(b.getDOMElement("pmts-ue-select-instrument-update-button"))})},
_bindToElementsUESelectInstrumentComponent:function(b){b.getDOMElement("pmts-ue-select-instrument-update-button").click(h.bind(this._handleClickEvent,b));b.getDOMElement("pmts-ue-select-instrument-cancel-button").click(function(){b.getDOMElement("pmts-ue-select-instrument-cancel-button-form").submit()})},_bindToEventsSelectInstrumentComponent:function(b){b.widget.on("componentsInitialized",b,function(){b.data&&b.data.recommendedInstrumentId?(b._checkInstrumentErrorsAndUpdateButton({instrumentId:b.data.recommendedInstrumentId,
errors:null}),b._triggerInitializeRecommendedInstrumentEvent(b.data.recommendedInstrumentId)):b.set("UpdateButtonEnabledAttribute",!1)});b.widget.on("backingInstrumentSelected",this,function(c){b._selectBackingInstrument(c)})},_selectBackingInstrument:function(b){b=b&&b.instrumentId?b:null;this._checkInstrumentErrorsAndUpdateButton(b)},_handleClickEvent:function(){this.get("UpdateButtonEnabledAttribute")&&this.getDOMElement("pmts-ue-select-instrument-cc-list-form").submit()},_triggerInitializeRecommendedInstrumentEvent:function(b){this.widget.trigger("initializeRecommendedInstrument",
{instrumentId:b})},_checkInstrumentErrorsAndUpdateButton:function(b){b=b?this._firstElement(b.errors):this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.set("UpdateButtonEnabledAttribute",!b)},_firstElement:function(b){return h.isArray(b)&&0<b.length?b[0]:null}})});m("components/UpdateEverywhereConfirmCancelComponent",["component","lang"],function(c,g){return c.extend({})});m("AddPaymentMethodTouchLinkSupport",["events/spinner-events","events/StartAddInstrumentEvent"],
function(c,g){return{bindToElements:function(){var f=this;f.getDOMElement("pmts-mobile-add-payment-method-touchlink").click(function(h){h.preventDefault();f.widget.trigger(c.showSpinner);f.widget.continueRequest({"ppw-widgetState":f.widget.options.serializedState,"ppw-widgetEvent":g},{success:f.widget.createAjaxContinueSuccessHandler(),complete:function(){f.widget.trigger(c.hideSpinner)}})})}}});m("block-add-credit-card-trigger-helper",["jQuery"],function(c){return function(){var g=c(".pmts-add-credit-card-content-trigger-row-common");
0<g.length&&(g.addClass("pmts-disabled-add-credit-card-content-trigger-row-common"),0<g.find(".a-button.apx-secure-registration-content-trigger-js").length&&g.find(".a-button.apx-secure-registration-content-trigger-js").addClass("a-button-disabled"),0<g.find("a.apx-secure-registration-content-trigger-js").length&&g.find("a.apx-secure-registration-content-trigger-js").addClass("pmts-disabledadd-add-credit-card-link"),0<g.find(".pmts-add-cc-default-trigger-link").length&&g.addClass("pmts-disabledadd-add-credit-card-link"))}});
m("cc-validation-inline-message-helper",["jQuery"],function(c){return{display:function(){var g=c(".pmts-add-credit-card-component-container");1===g.find(".pmts-add-cc-number-validation").length&&g.find(".pmts-add-cc-number-validation").removeClass("a-hidden aok-hidden");1===g.find(".pmts-account-Number").length&&g.find(".pmts-account-Number").addClass("a-form-warning")},hide:function(){var g=c(".pmts-add-credit-card-component-container");1===g.find(".pmts-add-cc-number-validation").length&&g.find(".pmts-add-cc-number-validation").addClass("a-hidden aok-hidden");
1===g.find(".pmts-account-Number").length&&g.find(".pmts-account-Number").removeClass("a-form-warning")}}});m("cc-holder-name-validation-inline-message-helper",["jQuery"],function(c){return{display:function(){var g=c(".pmts-add-credit-card-component-container");1===g.find(".pmts-add-cc-holder-name-validation").length&&g.find(".pmts-add-cc-holder-name-validation").removeClass("a-hidden aok-hidden");1===g.find(".apx-add-credit-card-account-holder-name-input").length&&g.find(".apx-add-credit-card-account-holder-name-input").addClass("a-form-error")},
hide:function(){var g=c(".pmts-add-credit-card-component-container");1===g.find(".pmts-add-cc-holder-name-validation").length&&g.find(".pmts-add-cc-holder-name-validation").addClass("a-hidden aok-hidden");1===g.find(".apx-add-credit-card-account-holder-name-input").length&&g.find(".apx-add-credit-card-account-holder-name-input").removeClass("a-form-error")}}});m("cvv-rate-limiting-inline-message-helper",["jQuery"],function(c){var g={},f=c(".pmts-add-credit-card-component-container"),h=f.find(".pmts-add-cc-rate-limiting-sentence-string");
g.display=function(f){var b=c(".pmts-add-credit-card-component-container");0<b.find(".pmts-add-cc-rate-limiting-container").length&&(b.find(".pmts-add-cc-rate-limiting-container").removeClass("a-hidden aok-hidden"),900<=f?0<b.find(".pmts-add-cc-rate-limiting-24hrs-string").length&&b.find(".pmts-add-cc-rate-limiting-24hrs-string").removeClass("a-hidden aok-hidden"):0<b.find(".pmts-add-cc-rate-limiting-15mins-string").length&&b.find(".pmts-add-cc-rate-limiting-15mins-string").removeClass("a-hidden aok-hidden"))};
g.displayTimer=function(c,b,e,g,m,a){function k(d){var f="";rateLimitDurationInHours=Math.floor(c/3600);1<rateLimitDurationInHours?f=e+" ":1==rateLimitDurationInHours&&(f=g+" ");g=f.replace("{}",String(rateLimitDurationInHours));rateLimitDurationInMinutes=Math.floor(c%3600/60);m=(1==rateLimitDurationInMinutes?" "+m:" "+a).replace("{}",String(rateLimitDurationInMinutes));f=b;g&&m||(f="");b=f;h.text(d.replace("{} {} {}",g+b+m));c-=60}function d(a){setTimeout(function(){clearInterval(a);0<f.find(".pmts-add-cc-rate-limiting-container").length&&
f.find(".pmts-add-cc-rate-limiting-container").addClass("a-hidden aok-hidden")},1E3*c)}(function(){if(0<f.find(".pmts-add-cc-rate-limiting-container").length&&(f.find(".pmts-add-cc-rate-limiting-container").removeClass("a-hidden aok-hidden"),0<h.length)){var a=h.text();k(a);a=setInterval(k,6E4,a);h.removeClass("a-hidden aok-hidden");d(a)}})()};return g});m("digital-wallet-utils",["lang"],function(c){var g={isInstrumentSelectionWithoutMultitender:function(f){return g.isInstrumentSelection(f)&&c.isDefined(f.isMultiTenderEnabled)&&
(!f.isMultiTenderEnabled||f.isAuthenticationRetryEnabled)},isInstrumentSelectionWithNoMultiTender:function(c,h){return g.isInstrumentSelection(c)&&(h||c.isAuthenticationRetryEnabled)},isInstrumentSelection:function(f){return null!=f&&c.isDefined(f.instrumentId)&&c.isDefined(f.instrumentCategory)&&c.isDefined(f.isAuthenticationRetryEnabled)&&"DigitalWallet"===f.instrumentCategory}};return g});m("mock-helper",[],function(){var c={"add-credit-card":function(c){c.widget.trigger("WidgetAction",{widgetActionType:"add-payment-instrument",
widgetAction:"add-credit-card-workflow-complete",paymentInstrumentId:"MockPaymentInstrumentId"})}};return{mocked:function(g,f,h){var l;g.widget.options.isMock&&(l=c[f]);l?l(g):h()}}});m("payment-method-fee-utils",["lang"],function(c){return{getKey:function(c,f){return{Card:["Card","APB","APV"],NetBanking:["NetBanking","APB","APV"],AmazonCredit:["AmazonCredit","APB","APV"]}[f].filter(function(f){return c.includes(f)}).join("_")},getFeeApplied:function(c,f){c=c[f];f=null;c&&c.feeValue&&c.feeValue.fixedAmount&&
(f=c.feeValue.fixedAmount);return f}}});m("post-pay-utils",["lang"],function(c){return{isInstrumentSelection:function(g,f){return f&&null!=g&&c.isDefined(g.instrumentId)&&-1!==g.instrumentId.indexOf("amzn1.pm.pma.pop")}}});m("events/StartAddInstrumentEvent",["public-event-registry"],function(c){c.register("StartAddInstrumentEvent");return"StartAddInstrumentEvent"});m("apx3-register-experience-provider",["mash-helper","metrics-helper","events/postToSecureIframeEvent","AUI!P","clog"],function(c,g,f,
h,l){return{webPostToSecureIframe:function(b,c,g){g!==r?b.trigger(f,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:["APX3"],iFrameName:c,isForAPX3Register:!0,startTimestamp:g.startTimestamp,startTimestampSource:g.startTimestampSource}}):b.trigger(f,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:["APX3"],iFrameName:c,isForAPX3Register:!0}})},nativeMashNavigate:function(b,e){c.navigateToUrl(b);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_MashNavigate",
"_Count",1);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHrefThenHidePageSpinner","_Count",0);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHref","_Count",0);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_Other","_Count",0);g.publishMetricsWithDimensions(e)},nativeAssignHrefNavigate:function(b,c,f){p.location.href=b;c?(g.recordResourceMetric("RegisterHowToOpenSsnapUrl_MashNavigate","_Count",0),g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHrefThenHidePageSpinner",
"_Count",0),g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHref","_Count",1),g.recordResourceMetric("RegisterHowToOpenSsnapUrl_Other","_Count",0)):(g.recordResourceMetric("RegisterHowToOpenSsnapUrl_MashNavigate","_Count",0),g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHrefThenHidePageSpinner","_Count",0),g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHref","_Count",0),g.recordResourceMetric("RegisterHowToOpenSsnapUrl_Other","_Count",1));g.publishMetricsWithDimensions(f)},
nativeAssignHrefThenHidePageSpinner:function(b,c){p.location.href=b;g.recordResourceMetric("RegisterHowToOpenSsnapUrl_MashNavigate","_Count",0);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHrefThenHidePageSpinner","_Count",1);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_AssignHref","_Count",0);g.recordResourceMetric("RegisterHowToOpenSsnapUrl_Other","_Count",0);g.publishMetricsWithDimensions(c);h.when("page-spinner-controller").execute(function(b){b.hide()})},publishAddPaymentLinkClickedMetrics:function(b,
c,f,h){g.recordResourceMetric("AddPaymentLinkClicked-"+b+"-"+f,"_Count",b&&c&&f?1:0);h&&g.publishMetricsWithDimensions(h)},attachTransitionTimeStampToSnapUrl:function(b,c,f){b=new URL(b);var e=b.searchParams.get("endpoint");b.searchParams.delete("endpoint");b.searchParams.append("startTimestamp",f);b.searchParams.append("startTimestampSource",c);return b.href+"\x26endpoint\x3d"+e},triggerWeblabOnClientSide:function(b,c,f,h){var a=!1;try{p.ue&&p.ue.trigger?(p.ue.trigger(b,c),g.recordResourceMetric(f+
"WeblabTrigger","_SuccessCount",1),g.recordResourceMetric(f+"WeblabTrigger_MissingCSMIntegration","_ErrorCount",0)):(g.recordResourceMetric(f+"WeblabTrigger","_SuccessCount",0),g.recordResourceMetric(f+"WeblabTrigger_MissingCSMIntegration","_ErrorCount",1)),g.publishMetricsWithDimensions(h)}catch(k){a=!0}finally{g.recordResourceMetric(f+"WeblabTrigger","_ErrorCount",a?1:0),g.publishMetricsWithDimensions(h)}}}});m("AddPaymentInstrumentStorageConsentHelper",["css-utils","lang","clog","jQuery"],function(c,
g,f,h){return{initialize:function(c,b){this._isStorageConsentRequired=b.data.isStorageConsentRequired||!1;this._storageConsentOptInRadioButtonBinding=b.data.storageConsentOptInRadioButtonBinding;this._storageConsentOptOutRadioButtonBinding=b.data.storageConsentOptOutRadioButtonBinding;this._storageConsentOptInBlameElementBinding=b.data.storageConsentOptInBlameElementBinding;this._storageConsentOptOutBlameElementBinding=b.data.storageConsentOptOutBlameElementBinding;this._performUpdateEverywhereEnabled=
b.data.performUpdateEverywhereEnabled||!1;this._updateEverywhereContainerBinding=b.data.updateEverywhereContainerBinding;this._setBuyingPreferenceEnabled=b.data.setBuyingPreferenceEnabled||!1;this._setBuyingPreferenceContainerBinding=b.data.setBuyingPreferenceContainerBinding;this._paymentMethodCategory=b.data.paymentMethodCategory;this._purchaseId=b.data.purchaseId},bindToElements:function(){var f=this;if(f._isStorageConsentRequired){var b=this.getDOMElement(this._storageConsentOptInRadioButtonBinding),
e=this.getDOMElement(this._storageConsentOptOutRadioButtonBinding),m=this._performUpdateEverywhereEnabled,p=this.getDOMElement(this._updateEverywhereContainerBinding),a=this._setBuyingPreferenceEnabled,k=this.getDOMElement(this._setBuyingPreferenceContainerBinding);b.click(function(b){b=c.showElement;m&&g.isDefined(p)&&b(p);b=c.showElement;a&&g.isDefined(k)&&b(k)});e.click(function(b){b=c.hideElement;m&&g.isDefined(p)&&b(p);b=c.hideElement;a&&g.isDefined(k)&&b(k)});h(".apx-storage-consent-learn-more-"+
f._paymentMethodCategory).bind("click",function(){f.widget.publishSuccessSushiMetrics({ActionType:"Add"+f._paymentMethodCategory,ActionValueType:"AddMethod",ActionValue:"StorageConsentLearnMoreLinkClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:f._purchaseId})})}},blameFormField:function(c){if(this._isStorageConsentRequired){(c=0<g.filter(c,function(b){return"storageConsent"===b.field}).length)&&this.widget.publishFailureSushiMetrics({ActionType:"Add"+this._paymentMethodCategory,
ActionValueType:"ErrorField",ActionValue:"StorageConsentSelectionRequiredError",ActionParentValueType:"PurchaseDocument",ActionParentValue:this._purchaseId});var b=this.getDOMElement(this._storageConsentOptInBlameElementBinding),e=this.getDOMElement(this._storageConsentOptOutBlameElementBinding);b.toggleClass("storage-consent-form-error",c);e.toggleClass("storage-consent-form-error",c)}}}});m("components/VerifyInstrumentComponent",["component"],function(c){return c.extend({_verifyingInstrumentId:null,
_spinnerName:null,initialize:function(c,f){this._verifyingInstrumentId=f.data.verifyingInstrumentId;this._spinnerName=f.data.spinnerName},triggerSpinnerChangeAppearanceEvent:function(c){this.widget.trigger("SpinnerChangeAppearanceEvent",{spinnerName:this._spinnerName,display:c})},bindToEvents:function(){var c=this;if(c._verifyingInstrumentId)c.widget.on("componentsInitialized",c,function(){c.triggerSpinnerChangeAppearanceEvent(!0);p.setTimeout(function(){c.widget.continueRequest({"ppw-widgetState":c.widget.options.serializedState,
"ppw-widgetEvent":"VerifyInstrumentEvent","ppw-instrumentId":c._verifyingInstrumentId},{success:c.widget.createAjaxContinueSuccessHandler(),complete:function(){c.triggerSpinnerChangeAppearanceEvent(!1)}})},2500)})}})});m("components/VerifyInstrumentSpinnerComponent",["components/SpinnerComponent"],function(c){return c.extend({})});m("events/ViewOneClickPreferredPaymentMethodEvent",["public-event-registry"],function(c){c.register("ViewOneClickPreferredPaymentMethodEvent");return"ViewOneClickPreferredPaymentMethodEvent"});
m("components/ViewOneClickComponent",["component","events/ViewOneClickPreferredPaymentMethodEvent"],function(c,g){return c.extend({bindToEvents:function(){var c=this;this.widget.on("CompleteWidget",this,function(){c.widget.submitFormAJAX({"ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent"})});this.widget.on("componentsInitialized",this,function(){c.widget.trigger(g,{preferredPaymentMethodId:c.data.preferredPaymentMethodId})})}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,g=d._namespace||d.attributeErrors,a=g?g("APXWidgetsAssets@APXWidgets-FusePartnerBilling","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,d,g){(function(){var a=PaymentsPortal2.modules.define;a("components/AddFusePartnerBillingWorkflowComponent",["component","lang"],function(b,c){return b.extend({})});a("components/AddFusePartnerBillingComponent",["form-component","events/form-submitted-event",
"lang","jQuery"],function(b,c,a,h){return b.extend({initialize:function(a,b){this.addFPBSubmitButton=b.data.addFPBSubmitButton;this.addFPBForm=b.data.addFPBForm;this.addFPBAction=b.data.addFPBAction},bindToElements:function(){this.getDOMElement(this.addFPBSubmitButton).click(a.bind(this.handleContinue,this))},handleContinue:function(b){if(0<this.getDOMElement("pmpt-add-fpb-phone-number-input-js").length){var a=h("select[name\x3dppw-fuseOTPCountryCode] option").filter(":selected").val(),e=this.getDOMElement("pmpt-add-fpb-phone-number-input-js").val();
this.getDOMElement("pmpt-add-fpb-hidden-form-field-js").val(a+e)}a=this.form.validateForm();e=this.getFormSubmissionParameters(this.addFPBForm);0===a.length?this.widget.trigger(c,{action:this.addFPBAction,event:b,submissionParameters:e}):b.preventDefault()}})});a("components/FusePartnerBillingDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(b,a,e){return b.extend(a,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=
b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/FusePartnerBillingEditComponent",["component","EditComponentSupport"],function(b,a){return b.extend(a,{initialize:function(b,c){a._initializePopover(b,c,this)},bindToEvents:function(){a._bindPopoverCloseButtonClickedEvent(this)}})});a("components/FusePartnerBillingEditMainPageComponent",["form-component","lang"],function(a,c){return a.extend({bindToElements:function(){this.getDOMElement("EditMainPageChangeButtonJSBinding").click(c.bind(this.handleContinueToBillingAddressFormSubmission,
this))},handleContinueToBillingAddressFormSubmission:function(a){this.widget.trigger("EditMainPageContinueButtonSelected")}})});a("components/SelectableFusePartnerBillingListComponent",["form-component"],function(a){return a});a("components/SelectableFusePartnerBillingListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(a,c){return a.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,
function(){this.widget.trigger(c,{instrumentId:this._instrumentId})});this.widget.on(c,this,function(a){this._instrumentRowSelected(a.instrumentId)})}})});a("components/FusePartnerBillingSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,c){return a.extend(c,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(f){var g=window.AmazonUIPageJS||window.P,e=g._namespace||g.attributeErrors,d=e?e("APXWidgetsAssets@APXWidgets-Rewards","APXWidgetsAssets"):g;d.guardFatal?d.guardFatal(f)(d,window):d.execute(function(){f(d,window)})})(function(f,g,e){(function(){var d=PaymentsPortal2.modules.define;d("components/CreditCardListItemRewardsComponent","events/InstrumentRowSelectedEvent css-utils component lang aui-helper jQuery keyboard clog".split(" "),function(d,c,f,k,m,n,p,h){return f.extend({isAPBSelected:!1,
isIBDMessagingEnabled:!1,isIBDOnFullPayment:!1,isIBDOnEMIAndFullPayment:!1,isIBDOnEMIOnly:!1,isDifferentialIBDPromotionSupportedForPaylast:!1,instantBankOfferMap:{},balanceWithAPB:null,balanceWithoutAPB:null,isPaylastEligible:!1,showIBDToastMessage:!1,isAPBWithEMIEnabled:!1,isCardSelected:!1,ibdAmountDisplayed:null,isEMISelected:!1,rewardsMessageStringMapping:{},isIBDOnEMIAvailable:!1,isTotalRewardsAvailable:!1,showAggregatedIBDAndCBCCRewards:!1,isAccordionEnabled:!1,fullPaymentBalanceWithAPB:null,
fullPaymentBalanceWithoutAPB:null,maxEmiBalanceWithAPB:null,maxEmiBalanceWithoutAPB:null,isTotalRewardsAvailableWithAPB:!1,isIBDOnEMIAvailableWithAPB:!1,inlineMessagingForCashBackTreatment:"C",cashbackWithAPB:null,cashbackWithoutAPB:null,showCashbackAndIBDRewards:!1,instrumentType:"",isMultiTenderWithAPBEnabled:!0,isIBDOnSpecificEMITenureEnabled:!1,fosIdToInstantBankDiscountMapWithAPB:{},fosIdToInstantBankDiscountMapWithoutAPB:{},initialize:function(a,b){this._isDesktop="desktop"===a.options.deviceType;
this.isIBDMessagingEnabled=b.data.isIBDMessagingEnabled;this.isIBDOnFullPayment=b.data.isIBDOnFullPayment;this.isIBDOnEMIAndFullPayment=b.data.isIBDOnEMIAndFullPayment;this.isIBDOnEMIOnly=b.data.isIBDOnEMIOnly;this.isDifferentialIBDPromotionSupportedForPaylast=b.data.differentialIBDPromotionEnabledForPaylast;this.instantBankOfferMap=b.data.instantBankOfferMap;this.balanceWithAPB=b.data.balanceWithAPB;this.balanceWithoutAPB=b.data.balanceWithoutAPB;this.isPaylastEligible=b.data.isPaylastEligible;this.showIBDToastMessage=
b.data.showIBDToastMessage;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.ibdAmountDisplayed=b.data.balanceWithoutAPB;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;this.showAggregatedIBDAndCBCCRewards=b.data.showAggregatedIBDAndCBCCRewards;this.isAccordionEnabled=b.data.isAccordionEnabled;this.fullPaymentBalanceWithAPB=b.data.fullPaymentBalanceWithAPB;this.fullPaymentBalanceWithoutAPB=b.data.fullPaymentBalanceWithoutAPB;this.maxEmiBalanceWithAPB=b.data.maxEmiBalanceWithAPB;
this.maxEmiBalanceWithoutAPB=b.data.maxEmiBalanceWithoutAPB;this.inlineMessagingForCashBackTreatment=b.data.inlineMessagingForCashBackTreatment;this.cashbackWithAPB=b.data.cashbackWithAPB;this.cashbackWithoutAPB=b.data.cashbackWithoutAPB;this.showCashbackAndIBDRewards=b.data.showCashbackAndIBDRewards;this.instrumentType=b.data.instrumentType;this.isMultiTenderWithAPBEnabled=b.data.isMultiTenderWithAPBEnabled;this.isIBDOnSpecificEMITenureEnabled=b.data.isIBDOnSpecificEMITenureEnabled;this.fosIdToInstantBankDiscountMapWithAPB=
b.data.fosIdToInstantBankDiscountMapWithAPB;this.fosIdToInstantBankDiscountMapWithoutAPB=b.data.fosIdToInstantBankDiscountMapWithoutAPB;this.showAggregatedIBDAndCBCCRewards&&(this.rewardsMessageStringMapping=b.data.rewardsMessageStringMapping,this.isIBDOnEMIAvailable=b.data.isIBDOnEMIAvailable,this.isTotalRewardsAvailable=b.data.isTotalRewardsAvailable,this.isTotalRewardsAvailableWithAPB=b.data.isTotalRewardsAvailableWithAPB,this.isIBDOnEMIAvailableWithAPB=b.data.isIBDOnEMIAvailableWithAPB)},displayIBDMessages:function(){this.showAggregatedIBDAndCBCCRewards||
this.showCashbackAndIBDRewards?this.toggleRewards():this.toggleRewardsDisplayMessage()},toggleRewardsDisplayMessage:function(){this.isIBDMessagingEnabled&&(!this.isAPBSelected||this.shouldDisplayMessageWithAPB()?this._toggleIBDAmount(this.isAPBSelected):this.isMultiTenderWithAPBEnabled&&0!==this.balanceWithAPB||"APB"===this.instrumentType?"APB"!==this.instrumentType&&this.displayEmptyCaseString(this.isAPBSelected):this.displayZeroCaseString(this.isAPBSelected))},toggleRewards:function(){this.toggleRewardsPopupIcons();
this.toggleRewardsPopupText(this.isAPBSelected);var a=this.isIBDOnEMIAvailable&&this.isEMISelected||this.isTotalRewardsAvailable&&!this.isEMISelected,b=this.isIBDOnEMIAvailableWithAPB&&this.isEMISelected||this.isTotalRewardsAvailableWithAPB&&!this.isEMISelected;a=this.isAPBSelected?b:a;c.toggleElement(this.getDOMElement("IconForRewardsMessage"),this.isCardSelected&&a);this.toggleRewardsDisplayMessage()},toggleRewardsPopupIcons:function(){var a=this.isCardSelected&&!this.isEMISelected,b=this.isCardSelected&&
this.isEMISelected;c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBExpanderIcon"),a);c.toggleElement(this.getDOMElement("EMIWithoutAPBExpanderIcon"),b);c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBContentIcon"),a);c.toggleElement(this.getDOMElement("EMIWithoutAPBContentIcon"),b);c.toggleElement(this.getDOMElement("FullPaymentWithAPBExpanderIcon"),a);c.toggleElement(this.getDOMElement("EMIWithAPBExpanderIcon"),b);c.toggleElement(this.getDOMElement("FullPaymentWithAPBContentIcon"),
a);c.toggleElement(this.getDOMElement("EMIWithAPBContentIcon"),b)},toggleRewardsPopupText:function(a){c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBExpander"),!a);c.toggleElement(this.getDOMElement("EMIWithoutAPBExpander"),!a);c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBContent"),!a);c.toggleElement(this.getDOMElement("EMIWithoutAPBContent"),!a);c.toggleElement(this.getDOMElement("FullPaymentWithAPBExpander"),a);c.toggleElement(this.getDOMElement("EMIWithAPBExpander"),a);c.toggleElement(this.getDOMElement("FullPaymentWithAPBContent"),
a);c.toggleElement(this.getDOMElement("EMIWithAPBContent"),a);this.showCashbackAndIBDRewards&&(c.toggleElement(this.getDOMElement("CashbackWithoutAPBContent"),!a),c.toggleElement(this.getDOMElement("CashbackWithAPBContent"),a))},getRewardsMappingKey:function(){var a=this.isAPBSelected?"WithAPB":"WithoutAPB";return this.isCardSelected?(this.isEMISelected?"EMISelected":"FullPaymentSelected")+"#"+a:"CardDeselected#"+a},_toggleIBDAmount:function(a){this.ibdAmountDisplayed=a?this.balanceWithAPB:this.balanceWithoutAPB;
c.toggleElement(this.getDOMElement("IBDWithAPB"),a);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!0)},displayZeroCaseString:function(a){this.ibdAmountDisplayed=this.balanceWithoutAPB;c.toggleElement(this.getDOMElement("IBDWithAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),
!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),a);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!a);"T2"===this.inlineMessagingForCashBackTreatment&&(c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!a),c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),!a))},displayEmptyCaseString:function(a){this.ibdAmountDisplayed=a?null:this.balanceWithoutAPB;c.toggleElement(this.getDOMElement("IBDWithAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),
!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),a);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!a);"T2"===this.inlineMessagingForCashBackTreatment&&(c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!a),c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),!a))},toggleCreditCardSelection:function(a,b){a===b&&"APB"!==this.instrumentType?(this.isCardSelected=!0,this.performActionOnCreditCardSelection()):
"APB"!==this.instrumentType?(this.isCardSelected=!1,this.performActionOnCreditCardDeselection()):this.toggleAPBRewardsMessage(this.isAPBSelected||a===b)},toggleAPBRewardsMessage:function(a){a||"T1"===this.inlineMessagingForCashBackTreatment?(this.toggleSelectedCardMessage(!0),this.toggleRewardsPopupText(!0)):(this.toggleUnSelectedCardMessage(!a),this.toggleRewardsPopupText(!a))},shouldDisplayMessageWithAPB:function(){return this.isAPBSelected&&this.isMultiTenderWithAPBEnabled&&(0<this.balanceWithAPB||
this.showCashbackAndIBDRewards&&0<this.cashbackWithAPB)},getTermsAndConditionsLinkElements:function(){return[this.getDOMElement("TurboPSPTermsAndConditionsLink"),this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithAPB"),this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithoutAPB"),this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithAPBIsEmpty"),this.getDOMElement("TurboPSPTermsAndConditionsLink-SavingsWithoutAPBDeselected"),this.getDOMElement("TurboPSPTermsAndConditionsLink-SavingsWithAPBDeselected"),
this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithAPBAsZero")]},getDetailsPopoverElements:function(){return[this.getDOMElement("DetailsPopover-IBDWithAPB"),this.getDOMElement("DetailsPopover-IBDWithoutAPB"),this.getDOMElement("DetailsPopover-IBDWithAPBIsEmpty"),this.getDOMElement("DetailsPopover-InfluencingMessage"),this.getDOMElement("DetailsPopover-IBDWithCBCC")]},getDetailsBottomSheetElements:function(){return[this.getDOMElement("DetailsBottomsheet-IBDWithCBCC"),this.getDOMElement("DetailsBottomsheet-DetailRewardsInlineMessaging")]},
bindTurboPSPTermsAndConditionsLinkElements:function(a,b){a.click(function(){h.logCounterMetric({feature:"TurboPSPTermsAndConditionsLinkClicked",resource:"_Count"});h.publishMetrics();b.widget.publishSuccessSushiMetrics({ActionValue:"Click",ActionValueType:"TurboPSPTermsAndConditionsLink"})})},bindDetailsPopoverElements:function(a,b){b._isDesktop?a.mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionParentValue:"Popover",ActionValue:"Mouseover",ActionValueType:"DetailsLink"})}):a.click(function(){b.widget.publishSuccessSushiMetrics({ActionParentValue:"Popover",
ActionValue:"Click",ActionValueType:"DetailsLink"})})},bindDetailsBottomsheetElements:function(a,b){a.click(function(){b.widget.publishSuccessSushiMetrics({ActionParentValue:"Bottomsheet",ActionValue:"Click",ActionValueType:"DetailsLink"})})},bindToElements:function(){var a=this;a.getTermsAndConditionsLinkElements().forEach(function(b){a.bindTurboPSPTermsAndConditionsLinkElements(b,a)});a.getDetailsPopoverElements().forEach(function(b){a.bindDetailsPopoverElements(b,a)});a.getDetailsBottomSheetElements().forEach(function(b){a.bindDetailsBottomsheetElements(b,
a)})},bindToEvents:function(){var a=this;k.forEach(["initializeRecommendedInstrument","creditCardRowSelected"],function(b){a.widget.on(b,a,function(b){this.toggleCreditCardSelection(b.instrumentId,a.data.instrumentId);this.isDynamicOrderSummaryEnabled&&a.widget.trigger("UpdateOrderTotalHiddenInputForIBD",{fosId:"",instrumentId:b.instrumentId})})});if(this.showAggregatedIBDAndCBCCRewards||this.showCashbackAndIBDRewards)a.widget.on(d,a,function(b){this.toggleCreditCardSelection(b.instrumentId,a.data.instrumentId)});
a.widget.on("addressChallengePassed",a,function(b){b.instrumentId===a.data.instrumentId&&a.displayIBDMessages()});a.widget.on("installmentPlanChanged",a,function(b){a.showAggregatedIBDAndCBCCRewards&&a.isCardSelected&&(a.isEMISelected=b.instrumentId===a.data.instrumentId&&!!b.installmentPlanId,a.toggleRewards())});if(!this.isAccordionEnabled&&this.showAggregatedIBDAndCBCCRewards)a.widget.on("installmentOptionChanged",a,function(b){this.isCardSelected&&(this.isEMISelected=b!==e&&b.isInstallmentOfferSelected&&
b.instrumentId===a.data.instrumentId,this.toggleRewards())});if(this.isPaylastEligible||this.showIBDToastMessage)a.widget.on("UpdateOrderTotalForIBDonEMIOnly",a,function(b){if(b.instrumentId===a.data.instrumentId||b.instrumentId==="EMI-"+a.data.instrumentId)this.isDifferentialIBDPromotionSupportedForPaylast&&b.emiOptionSelected&&a.updateIBDValueForEMI(b.fosId),a.updateOrderTotalForIBD(a.isIBDOnFullPayment&&!b.emiOptionSelected||(a.isAPBWithEMIEnabled||!a.isAPBSelected)&&a.isIBDOnEMIOnly&&b.emiOptionSelected)});
if(this.isDynamicOrderSummaryEnabled)a.widget.on("UpdateOrderTotalHiddenInputForIBD",a,function(b){var c=""!==b.fosId;if(b.instrumentId===a.data.instrumentId||b.instrumentId==="EMI-"+a.data.instrumentId)this.isDifferentialIBDPromotionSupportedForPaylast&&c?a.updateIBDValueForEMI(b.fosId):a.updateIBDValueForFullPayment(),(a.isIBDOnFullPayment&&!c||(a.isAPBWithEMIEnabled||!a.isAPBSelected)&&a.isIBDOnEMIOnly&&c)&&a.updateOrderTotalHiddenInputForIBD(b.fosId,b.instrumentId)});a.widget.on("apbSelectionChanged",
a,function(b){this.isAPBSelected=b.isSelected;"APB"===this.instrumentType?a.toggleAPBRewardsMessage(this.isAPBSelected):this.isCardSelected?a.performActionOnCreditCardSelection():a.performActionOnCreditCardDeselection()});if(this.showAggregatedIBDAndCBCCRewards||this.showCashbackAndIBDRewards)a.widget.on("updatePrimaryButtonDisplayString",a,function(b){b.instrumentId===a.data.instrumentId&&(this.isEMISelected=!!b.installmentPlanId,this.toggleRewards())});a.widget.on("resetSelectedPaymentMethod",a,
function(b){(this.showAggregatedIBDAndCBCCRewards||this.showCashbackAndIBDRewards)&&this.isCardSelected&&(this.isCardSelected=!1);a.performActionOnCreditCardDeselection()});a.widget.on("UpdateIBDAmount",a,function(b){(this.isPaylastEligible||this.showIBDToastMessage)&&this.isDifferentialIBDPromotionSupportedForPaylast?b.instrumentId===a.data.instrumentId&&(a.updateIBDValue(b.fosId),a.updateOrderTotalForIBD(!0)):this.isDynamicOrderSummaryEnabled&&b.instrumentId===a.data.instrumentId&&(a.updateIBDValue(b.fosId),
a.updateOrderTotalHiddenInputForIBD(b.fosId,b.instrumentId))});a.widget.on("updateIBDonAPBSelectionEvent",this,function(b){(this.isPaylastEligible||this.showIBDToastMessage)&&this.isDifferentialIBDPromotionSupportedForPaylast?b.instrumentId===a.data.instrumentId&&a.updateIBDValue(b.fosId):this.isDynamicOrderSummaryEnabled&&b.instrumentId===a.data.instrumentId&&(a.updateIBDValue(b.fosId),a.updateOrderTotalHiddenInputForIBD(b.fosId,b.instrumentId))})},updateIBDValue:function(a){""===a?this.updateIBDValueForFullPayment():
this.updateIBDValueForEMI(a)},updateOrderTotalHiddenInputForIBD:function(a,b){a=this.ibdAmountDisplayed?-1*this.ibdAmountDisplayed:0;try{var c=document.getElementsByName("ppw-"+b+"_instrumentOrderTotalBalance")[0],d=JSON.parse(c&&c.value?c.value.toString():"{}");d&&0!==Object.keys(d).length?d.ibdDiscount=a:d={ibdDiscount:a};c&&(c.value=JSON.stringify(d))}catch(l){console.log(l)}},updateIBDValueForFullPayment:function(){this.fullPaymentBalanceWithAPB!==e&&this.fullPaymentBalanceWithoutAPB!==e?(this.balanceWithoutAPB=
this.ibdAmountDisplayed=this.fullPaymentBalanceWithoutAPB,this.balanceWithAPB=this.fullPaymentBalanceWithAPB,this.isIBDOnFullPayment=!0):(this.ibdAmountDisplayed=0,this.isIBDOnFullPayment=!1);this.isIBDOnEMIOnly=!1},updateIBDValueForEMI:function(a){if(this.isIBDOnSpecificEMITenureEnabled){if(null!==a){var b=this.fosIdToInstantBankDiscountMapWithAPB.get(a);var c=this.fosIdToInstantBankDiscountMapWithoutAPB.get(a)}}else b=this.maxEmiBalanceWithAPB,c=this.maxEmiBalanceWithoutAPB;c!==e&&b!==e?(this.balanceWithoutAPB=
this.ibdAmountDisplayed=c,this.balanceWithAPB=b,this.isIBDOnEMIOnly=!0):(this.ibdAmountDisplayed=0,this.isIBDOnEMIOnly=!1);this.isIBDOnFullPayment=!1},toggleSelectedCardMessage:function(a){c.toggleElement(this.getDOMElement("IBDWithAPB"),a);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!1);c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),
!1);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!0)},toggleUnSelectedCardMessage:function(a){c.toggleElement(this.getDOMElement("IBDWithAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!a);c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),a);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),
!0)},performActionOnCreditCardSelection:function(){var a=this;this.showPCIComplianceComponent||this.displayIBDMessages();!this.showCashbackAndIBDRewards||"T2"!==this.inlineMessagingForCashBackTreatment||this.isAPBSelected&&!this.shouldDisplayMessageWithAPB()||this.toggleSelectedCardMessage(this.isAPBSelected);(this.isPaylastEligible||this.showIBDToastMessage)&&g.setTimeout(function(){var b=a.getDOMElement("installmentSelections")[0]&&a.getDOMElement("installmentSelections")[0].innerText&&-1!==a.getDOMElement("installmentSelections")[0].innerText.indexOf("EMI");
a.updateOrderTotalForIBD(a.isIBDOnFullPayment&&!b||(a.isAPBWithEMIEnabled||!a.isAPBSelected)&&a.isIBDOnEMIOnly&&b)},0)},performActionOnCreditCardDeselection:function(){!this.showCashbackAndIBDRewards||"T2"!==this.inlineMessagingForCashBackTreatment||this.isAPBSelected&&!this.shouldDisplayMessageWithAPB()?this.displayIBDMessages():this.toggleUnSelectedCardMessage(this.isAPBSelected)},updateOrderTotalForIBD:function(a){a&&0<this.ibdAmountDisplayed?(this.widget.trigger("UpdateOrderTotalForIBDEvent",
{ibdAmountDisplayed:this.ibdAmountDisplayed}),this.displayToastMessageForIBD()):this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0})},displayToastMessageForIBD:function(){this.data.displayToastMessageForIBDOffer&&0<this.getDOMElement("toastMessageContainer").size()&&(this.getDOMElement("toastMessageContainer")[0].querySelector(".a-size-medium").innerHTML="\x3cspan\x3e\x26#8377 \x3c/span\x3e"+this.ibdAmountDisplayed+this.widget.getLocalizedString("apx_toast_ibd_discount_applied"),
c.toggleElement(this.getDOMElement("toastMessageContainer"),!0))}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-PAGE","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,d,e){(function(){var a=PaymentsPortal2.modules.define;a("components/DiscoveryUpsellComponent",["component","jQuery","events/ShowAddPaymentInstrumentPage","AUI!P","clog"],function(a,h,f,g,e){return a.extend({initialize:function(){},_hideDiscoveryUpsellBottomSheet:function(){var b=
this;g.when("a-sheet").execute("hide-bottom-sheet",function(a){try{var c=a.get("discovery-upsell-bottomsheet");c&&a.hideSheet(c)}catch(k){b._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellBottomsheetHideError")}})},_onAddPaymentMethodBottomSheetButtonClick:function(b){this._hideDiscoveryUpsellBottomSheet();this._triggerShowAddPaymentInstrumentPageEvent()},_triggerShowAddPaymentInstrumentPageEvent:function(){this.widget.trigger(f,{category:"IDEAL"});this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellAddIdealClicked");
this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellAddIdealClicked","Status","Success")},_onNotNowBottomSheetButtonClick:function(b){this._hideDiscoveryUpsellBottomSheet();this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellNotNowClicked");this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellNotNowClicked","Status","Success")},_onDontShowAgainButtonClick:function(b){this._hideDiscoveryUpsellBottomSheet();this.widget.trigger("DiscoveryUpsellCustomerOptOut");this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellDontShowAgainClicked");
this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellDontShowAgainClicked","Status","Success")},_showDiscoveryUpsellBottomSheet:function(){try{this.getDOMElement("discovery-upsell-bottomsheet-trigger-id").length&&h(".pmts-add-payment-link.pmts-portal-component").is(":visible")&&(this.getDOMElement("discovery-upsell-bottomsheet-trigger-id").click(),this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellBottomsheetShown"),this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellBottomsheetShown",
"Status","Success"))}catch(b){this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellBottomsheetShownError")}},_publishCounterMetricsForDiscoveryUpsell:function(b){e.logCounterMetric({feature:b,resource:"_Count"});e.publishMetrics()},_publishBIMetricForDiscoveryUpsell:function(b,a,c){this.widget.publishSuccessSushiMetrics({ActionType:b,ActionValueType:a,ActionValue:c})},bindToEvents:function(){var b=this;b.widget.on("DiscoveryUpsellCustomerOptOut",b,function(a){b.widget.asyncContinueRequest({"ppw-widgetEvent":"DiscoveryUpsellCustomerOptOutEvent",
"ppw-widgetState":b.widget.options.serializedState},{success:function(b){},error:function(){}})})},bindToElements:function(){var b=this;g.when("A","a-sheet","ready").execute(function(a){a.on("a:sheet:beforeShow:discovery-upsell-bottomsheet",function(){var a=b.getDOMElement("discovery-upsell-bottomsheet-button");h(a).bind("click",function(a){b._onAddPaymentMethodBottomSheetButtonClick(a)});a=b.getDOMElement("not-now-bottomsheet-button");h(a).bind("click",function(a){b._onNotNowBottomSheetButtonClick(a)});
a=b.getDOMElement("discovery-upsell-do-not-show-again");h(a).bind("click",function(a){b._onDontShowAgainButtonClick(a)})});a.on("a:sheet:afterHide:discovery-upsell-bottomsheet",function(){g.when("a-sheet").execute("destroy-bottom-sheet",function(a){try{var c=a.get("discovery-upsell-bottomsheet");c&&c.destroy()}catch(l){b._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellBottomsheetDestroyError")}})});b._showDiscoveryUpsellBottomSheet()});g.when("mash").execute(function(a){try{d.amazon&&d.amazon.mash&&
d.addEventListener("popstate",function(a){a=a.state;"hide"==a.action&&"a-sheet-web"==a.component||g.when("a-sheet").execute("hide-bottom-sheet",function(a){var b=a.get("discovery-upsell-bottomsheet");b&&a.hideSheet(b)})})}catch(c){b._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellBottomsheetHideOnBackButtonError")}})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BankAccountVerification","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BankAccountVerificationComponent",["component","metrics-helper","lang","jQuery"],function(a,b,c,d){return a.extend({initialize:function(a,b){this._continueButton=this.getDOMElement(b.data.jsBindingContinueButtonId)},
bindToElements:function(){var a=this;a._continueButton.click(function(){a._triggerClick()})},_triggerClick:function(){}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,g=d._namespace||d.attributeErrors,c=g?g("APXWidgetsAssets@APXWidgets-PurchaseFinancing","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,d,g){(function(){var c=PaymentsPortal2.modules.define;c("components/PurchaseFinancingOfferComponent","css-utils lang component components/SetPaymentPlanSelectComponent/validators jQuery AUI!P".split(" "),function(c,e,d,f,g,h){return d.extend({initialize:function(a,
b){this.instrumentId=b.data.instrumentId;this.isDisplayable=b.data.isDisplayable;this.financialOfferDisplayStringsMap=b.data.financialOfferDisplayStringsMap;this.isMobile="mobile"===a.options.deviceType;this.isPurchaseFinancingPopoverShown=this.shouldShowPurchaseFinancingPopover=!1;this.defaultPurchaseFinancingOffer=this.highlightedPurchaseFinancingOffer=this.selectedPurchaseFinancingOffer=b.data.maybeSelectedOfferId;f.push(e.bind(this._validator,this));this.eventRegistryCompleted=this.isCardSelected=
!1},bindToElements:function(){this.getDOMElementsByPrefix("purchaseFinancingMobileTouchLink-").click(e.bind(this._handleTouchLinkClick,this))},bindToEvents:function(){this.widget.on("togglePurchaseFinancingOffers",this,function(a){this.isDisplayable&&this.instrumentId===a.instrumentId&&(this._selectDefaultOffer(),this._togglePurchaseFinancingOffers(a.isSelected))})},bindToDesktopPopUpElements:function(){this.getDOMElement("purchaseFinancingAcceptButton-"+this.instrumentId).click(e.bind(this._handleOnClickAccept,
this));this.getDOMElement("purchaseFinancingDeclineButton-"+this.instrumentId).click(e.bind(this._handleOnClickDecline,this))},bindToMobilePopUpElements:function(){var a=this;h.when("A","a-popover","ready").execute(function(b,c){a.getDOMElement("purchaseFinancingAcceptButton-"+a.instrumentId).click(e.bind(a._handleOnClickAccept,a));a.getDOMElement("purchaseFinancingDeclineButton-"+a.instrumentId).click(e.bind(a._handleOnClickDecline,a));a.getDOMElementsByPrefix("purchaseFinancingOfferRadioButton-").click(function(b){a._purchaseFinancingOfferSelected(g(b.currentTarget))})})},
_togglePurchaseFinancingOffers:function(a){var b=this.getDOMElement("financialOfferViolationsPF");c.toggleElement(b,a);this.isCardSelected=a;b=this.getDOMElement(this.isMobile?"purchaseFinancingMobileTouchLink-"+this.instrumentId:"purchaseFinancingOffers");c.toggleElement(b,a);this.widget.trigger("toggleFinancialOffer",{instrumentId:this.instrumentId,isSelected:!0,isAddressChallenged:!0})},_handleOnClickAccept:function(){if(this.isCardSelected){if(this.isMobile)this.selectedPurchaseFinancingOffer=
this.highlightedPurchaseFinancingOffer,this.getDOMElement("selectedPurchaseFinancingOfferText-"+this.instrumentId).text(this.financialOfferDisplayStringsMap[this.selectedPurchaseFinancingOffer]),this.getDOMElement("hiddenFinancialOfferIdInput"+this.instrumentId).val(this.selectedPurchaseFinancingOffer),this._updateSelectedOffer(this.selectedPurchaseFinancingOffer);else{this.shouldShowPurchaseFinancingPopover=!1;this.isPurchaseFinancingPopoverShown=!0;var a=this.getDOMElement("purchaseFinancingDropDownSelector-"+
this.instrumentId)[0];this._updateSelectedOffer(a.options[a.selectedIndex].value);this.widget.trigger("ContinueButtonClicked")}this._closePopover()}},_handleOnClickDecline:function(){if(this.isCardSelected){if(this.isMobile)this.selectedPurchaseFinancingOffer=this.defaultPurchaseFinancingOffer,this.getDOMElement("selectedPurchaseFinancingOfferText-"+this.instrumentId).text(this.financialOfferDisplayStringsMap[this.selectedPurchaseFinancingOffer]),this.getDOMElement("hiddenFinancialOfferIdInput"+this.instrumentId).val(this.selectedPurchaseFinancingOffer);
else{var a=this.instrumentId,b=this.defaultPurchaseFinancingOffer;h.when("a-dropdown").execute(function(c){c.setValue("pmts-financial-offer-dropdown-native-id-"+a,b)});this.isPurchaseFinancingPopoverShown=this.shouldShowPurchaseFinancingPopover=!1}this._updateSelectedOffer(this.defaultPurchaseFinancingOffer);this._closePopover()}},_validator:function(){if(!this.isCardSelected)return!0;var a=this.getDOMElement("purchaseFinancingDropDownSelector-"+this.instrumentId)[0];!this.isPurchaseFinancingPopoverShown&&
a&&a.selectedIndex&&1<a.selectedIndex&&(this.getDOMElement("purchaseFinancingPopover-"+this.instrumentId).click(),this.eventRegistryCompleted||(this.bindToDesktopPopUpElements(),this.eventRegistryCompleted=!0),this.shouldShowPurchaseFinancingPopover=!0);!this.isPurchaseFinancingPopoverShown&&a&&a.selectedIndex&&1===a.selectedIndex&&this._handleOnClickAccept();this.isMobile?this._updateSelectedOffer(this.selectedPurchaseFinancingOffer):a&&a.selectedIndex?this._updateSelectedOffer(a.options[a.selectedIndex].value):
this._updateSelectedOffer(this.defaultPurchaseFinancingOffer);return!this.shouldShowPurchaseFinancingPopover},_purchaseFinancingOfferSelected:function(a){var b=a.data("financial-offer-id");b&&this.highlightedPurchaseFinancingOffer!==b&&(this.getDOMElement("purchaseFinancingOfferRadioButton-"+this.highlightedPurchaseFinancingOffer).removeClass("pmts-selected"),a.addClass("pmts-selected"),a.find("input[type\x3dradio]").prop("checked",!0),this.highlightedPurchaseFinancingOffer=b)},_updateSelectedOffer:function(a){this.isMobile?
document.getElementsByName("ppw-"+this.instrumentId+"_financialOfferId").forEach(function(b){"hidden"===b.type&&(b.value=a)}):h.when("a-dropdown").execute(function(b){try{b.setValue("pmts-financial-offers-dropdown-native-id",a)}catch(k){}})},_handleTouchLinkClick:function(){this.eventRegistryCompleted||(this.bindToMobilePopUpElements(),this.eventRegistryCompleted=!0);var a=this.getDOMElement("purchaseFinancingOfferRadioButton-"+this.selectedPurchaseFinancingOffer),b=a.find("input[type\x3dradio]");
a.addClass("pmts-selected");b.prop("checked",!0);this.selectedPurchaseFinancingOffer!==this.highlightedPurchaseFinancingOffer&&(a=this.getDOMElement("purchaseFinancingOfferRadioButton-"+this.highlightedPurchaseFinancingOffer),b=a.find("input[type\x3dradio]"),a.removeClass("pmts-selected"),b.prop("checked",!1),this.highlightedPurchaseFinancingOffer=this.selectedPurchaseFinancingOffer)},_selectDefaultOffer:function(){if(!this.isMobile){var a=this.instrumentId,b=this.defaultPurchaseFinancingOffer;h.when("a-dropdown").execute(function(c){c.setValue("pmts-financial-offer-dropdown-native-id-"+
a,b)})}},_closePopover:function(){this.getDOMElement("close-purchaseFinancingAcceptButton-"+this.instrumentId).click()}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Card","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/CardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery","lang","clog"],function(a,b,c,f,e){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType;this._foregroundColor=b.data.foregroundColor;this._isDefault=b.data.isDefault;this._cardTail=b.data.cardTail},bindToElements:function(){this.getDOMElement("walletAuthVerifyLink").click(f.bind(this._verifyAuthLinkClicked,this));this._bindEditPMLink();c(".apx-wallet-card-art-foreground-color").css("color",this._foregroundColor)},_verifyAuthLinkClicked:function(){e.logCounterMetric({feature:"VerifyAuthLinkClicked",resource:"_Count"});e.publishMetrics();
this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"LaunchAddCardAuthEvent","ppw-instrumentId":this._paymentMethodId,"ppw-cardTail":this._cardTail})}})});a("components/CardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,c){var d=c.bindToElements;return a.extend(c,{initialize:function(b,a){this._instrumentId=a.data.instrumentId;this._isLydiaDebitCard=a.data.isLydiaDebitCard;this._isRequestForApp=a.data.isRequestForApp;
this._isLydiaFinancialAccount=a.data.isLydiaFinancialAccount},bindToElements:function(){this._isLydiaDebitCard&&this._isRequestForApp&&this._isLydiaFinancialAccount?this._ingressToLydiaDashboard():d.call(this)},_ingressToLydiaDashboard:function(){var a="/debit/account/dashboard?ingressSource\x3dwallet\x26preSelectedPaymentMethodId\x3d"+this._instrumentId;this.getDOMElement("walletSelectablePMTab").click(function(){b.location.href=a});this.getDOMElement("walletSelectablePMButton").click(function(){b.location.href=
a})}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-GiftCard","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/AddGiftCardComponent",["component","clog"],function(a,b){return a.extend({bindToElements:function(){this.getDOMElement("WalletAddBalanceRedeemGCBalance").bind("click",function(){b.logCounterMetric({feature:"WalletAddBalanceRedeemGCBalance",
resource:"_Count"});b.publishMetrics()});this.getDOMElement("WalletAddBalanceReloadGCBalance").bind("click",function(){b.logCounterMetric({feature:"WalletAddBalanceReloadGCBalance",resource:"_Count"});b.publishMetrics()})}})});a("components/GiftCardDetailsSlotComponent",["component","metrics-helper","clog"],function(a,b,c){return a.extend({initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId},_publishWalletGCViewActivityMetrics:function(){this.getDOMElement("gc-view-activity-link").bind("click",
function(){c.logCounterMetric({feature:"WalletGCViewActivity",resource:"_Count"});console.log("add count");c.publishMetrics()})},bindToElements:function(){this._publishWalletGCViewActivityMetrics();b.publishOnClickSuccessSushiMetrics(this,[{JsBindElementId:"gc-reload-link",MetricsObject:{ActionType:"GCReloadLink"}},{JsBindElementId:"gc-redeem-link",MetricsObject:{ActionType:"GCRedeemLink"}}])}})});a("components/GiftCardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],
function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BankAccount","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BankAccountDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","events/spinner-events"],function(a,c,b){return a.extend(c,{initialize:function(e,a){this._paymentMethodId=
a.data.paymentMethodId;this._paymentMethodType=a.data.paymentMethodType;this._instrumentId=a.data.instrumentId},bindToElements:function(){var a=this;a._bindEditPMLink();a.getDOMElement("apx-wallet-direct-debit-view-mandate-id").click(function(){a._triggerViewMandateEvent()})},_triggerViewMandateEvent:function(){var a=this;a.widget.trigger(b.showSpinner);a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"ViewMandateEvent","ppw-instrumentId":a._instrumentId},
{success:a.widget.createAjaxContinueSuccessHandler(),complete:function(){a.widget.trigger(b.hideSpinner)}})}})});a("components/BankAccountSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,c=d._namespace||d.attributeErrors,a=c?c("APXWidgetsAssets@APXWidgets-PbBA","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,d,c){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableBankPayListComponent",["form-component"],function(a){return a});a("components/SelectableBankPayListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],
function(a,e){return a.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(e,{instrumentId:this._instrumentId})});this.widget.on(e,this,function(a){this._instrumentRowSelected(a.instrumentId)})}})});a("components/AddPbBAComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,e,d,f,c){return d.extend({_hasErrors:!1,initialize:function(b,a){this.addPbBAPopover=this.getDOMElement(this.data.addPbBAPopoverJSBinding);
this._action=a.data.action;this._hasErrors=a.data.hasErrors;this._isSIPTreatmentEnabled=a.data.isSIPTreatmentEnabled;this._interstitialPageUrl=a.data.interstitialPageUrl},_initPopoverState:function(){this.data.hasErrors&&this.addPbBAPopover.trigger("click")},bindToElements:function(){var a=this;this._isSIPTreatmentEnabled?this.getDOMElement("addPbBASubmitButton").click(f.bind(this._handleFormSubmission,this)):c.when("A","a-modal","ready").execute(function(b,c){a.getDOMElement("apx-add-pbba-modal-continue-button").click(function(){a._hidePopoverModal()})})},
bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(a){b._isSIPTreatmentEnabled?this._initPopoverState():b._interstitialPageUrl&&b._showPopoverModal()});b.widget.on(a,b,function(a){a.action===b._action&&e(b.getDOMElement("addPbBAForm")).submit()})},_showPopoverModal:function(){this.getDOMElement("apx-add-pbba-modal-trigger").trigger("click")},_hidePopoverModal:function(){c.when("a-modal").execute(function(a){a&&(a=a.get("apx-add-pbba-modal"))&&a.hide()})},_handleFormSubmission:function(b){var c=
this.form.validateForm(),e=this.getFormSubmissionParameters("addPbBAFormContainer");this.closeAddPbBAPopover();0===c.length?this.widget.trigger(a,{event:b,submissionParameters:e,action:this._action}):b.preventDefault()},closeAddPbBAPopover:function(){var a=this.data.addPbBAPopoverName;c.when("a-modal").execute(function(b){b&&(b=b.get(a))&&b.hide()})}})});a("components/SelectablePbBAListComponent",["form-component"],function(a){return a});a("components/SelectablePbBAListItemComponent",["components/SelectableDPMInstrumentListItemComponent",
"events/InstrumentRowSelectedEvent"],function(a,c){return a.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(c,{instrumentId:this._instrumentId})});this.widget.on(c,this,function(a){this._instrumentRowSelected(a.instrumentId)})}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,c=e?e("APXWidgetsAssets@APXWidgets-AggregatedAmazonProductVouchers","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,d,e){(function(){var c=PaymentsPortal2.modules.define;c("components/AggregatedAmazonProductVoucherComponent","events/InstrumentRowSelectedEvent jQuery css-utils component mixins/disable-component lang".split(" "),function(c,d,f,e,g,h){return e.extend(g,
{initialize:function(a,b){this.productVoucherId=b.data.productVoucherId;this.productVoucherIdentifier=b.data.productVoucherIdentifier;this.productVoucherBalance=b.data.productVoucherBalance;this.isRadioButtonDisplay=b.data.canCoverPurchaseStandalone;this.productVoucherInstrumentIdPrefix=b.data.productVoucherInstrumentIdPrefix;this.isAPVPreselected=b.data.isAPVPreselected;this.isSuppressed=h.isDefined(b.data.isSuppressed)&&b.data.isSuppressed;this.isNomenclatureWave1Enabled=b.data.isNomenclatureWave1Enabled;
this.$container=this.getDOMElement("apvContainer");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.productVoucherId);this.$checkbox=this.getDOMElement("productVoucherBalanceSelection")},_setProductVoucher:function(a){a?this._selectProductVoucher():this._unselectProductVoucher()},_selectProductVoucher:function(){this.isRadioButtonDisplay?(this.$container.toggleClass("pmts-selected",!0),this.$radioButton.prop("checked",!0),this._triggerBackingInstrumentSelectedEvent(this.productVoucherId),
this._triggerInstrumentRowSelectedEvent()):(this.isNomenclatureWave1Enabled&&this.$container.toggleClass("pmts-selected",!0),this.$checkbox.prop("checked",!0),this._triggerOptionalInstrumentSelectedEvent());this._triggerAPVSelectionChangedEvent(!0)},_unselectProductVoucher:function(){this.$container.toggleClass("pmts-selected",!1);this.isRadioButtonDisplay?this.$radioButton.prop("checked",!1):(this.$checkbox.prop("checked",!1),this._triggerOptionalInstrumentDeselectedEvent());this._triggerAPVSelectionChangedEvent(!1)},
_toggleOptionalProductVoucher:function(){var a=this.$checkbox.prop("checked");this._setProductVoucher(!a)},_handleAPVRowSelectedEvent:function(){this.isRadioButtonDisplay?this._isAPVSelected()||this._setProductVoucher(!0):this._toggleOptionalProductVoucher()},_isAPVSelected:function(){return this.isRadioButtonDisplay&&this.$container.hasClass("pmts-selected")||!this.isRadioButtonDisplay&&this.$checkbox.prop("checked")},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.productVoucherId,
paymentMethod:this.productVoucherIdentifier})},_triggerOptionalInstrumentSelectedEvent:function(){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,paymentMethod:this.productVoucherIdentifier})},_triggerAPVSelectionChangedEvent:function(a){this.widget.trigger("apvSelectionChanged",{isSelected:a,canCoverPurchaseStandalone:this.isRadioButtonDisplay})},
_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId===a.productVoucherId?a._handleAPVRowSelectedEvent():a.isRadioButtonDisplay?a._isAPVSelected()&&a._setProductVoucher(!1):a.$checkbox.prop("disabled",this.isSuppressed)});a.widget.on("codSelectionEvent",a,function(b){this._isAPVSelected()&&
a._setProductVoucher(!1)});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId.startsWith(this.productVoucherInstrumentIdPrefix)&&a._setProductVoucher(!0)});a.widget.on("componentsInitialized",a,function(){a._setProductVoucher(this.isAPVPreselected)});a.widget.on("apbSelectionChanged",a,function(b){b.isSelected&&!b.canCoverPurchaseStandalone&&this.isRadioButtonDisplay&&this._isAPVSelected()&&a._setProductVoucher(!1)})},bindToElements:function(){var a=this;a.$container.click(function(b){a.isRadioButtonDisplay||
b.preventDefault();a.isSuppressed||a._handleAPVRowSelectedEvent()});a.$checkbox.click(function(b){b.stopPropagation();b=a.$checkbox.prop("checked");a._setProductVoucher(b)})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-LineOfCredit","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/LineOfCreditDetailsSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/LineOfCreditSleeveItemSlotComponent",["component"],function(a){return a.extend({_triggerFallbackToMPO:!1,
initialize:function(a,b){this._triggerFallbackToMPO=b.data.triggerFallbackToMPO},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO")})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-DigitalCurrency","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableDigitalCurrencyListComponent",["component"],function(a){return a.extend({})});a("components/SelectableDigitalCurrencyListItemComponent",["component","events/InstrumentRowSelectedEvent",
"lang","jQuery"],function(a,b,c,d){return a.extend({initialize:function(e,a){this._instrumentId=a.data.instrumentId},bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===a._instrumentId?(this.getDOMElement("instrumentRowSelection-"+a._instrumentId).prop("checked",!0),this.getDOMElement("digitalCurrencyItemContainer-"+a._instrumentId).addClass("pmts-selected")):(this.getDOMElement("instrumentRowSelection-"+a._instrumentId).prop("checked",!1),this.getDOMElement("digitalCurrencyItemContainer-"+
a._instrumentId).removeClass("pmts-selected"))})},bindToElements:function(){this.getDOMElementsByPrefix("digitalCurrencyItemContainer-").click(c.bind(this._instrumentRowClicked,this))},_instrumentRowClicked:function(a){a=d(a.currentTarget).data("instrument-id");this.widget.trigger(b,{instrumentId:a});this.widget.trigger("backingInstrumentSelected",{instrumentId:a})}})})})()});
/* ******** */
(function(S){var u=window.AmazonUIPageJS||window.P,F=u._namespace||u.attributeErrors,w=F?F("APXWidgetsAssets@PaymentsPortalWidgetFramework2","APXWidgetsAssets"):u;w.guardFatal?w.guardFatal(S)(w,window):w.execute(function(){S(w,window)})})(function(S,u,F){(function(){var w=PaymentsPortal2.modules.define;S.when("A").execute(function(f){var d=f.state("apx")||{};if(!d.apxSecondaryViewRegistered){var b=f.$(u);f.declarative("apx-secondary-view","click",function(a){if(a.data.widgetInstanceId){var c=a.data.widgetInstanceId,
e=a.data.id||1,d=a.data.header,g=a.data.backButtonText||"Back",m=a.data.hideHeader||!1,p=a.data.alternateBackground||!1,l=a.data.paddingClass||"",t=a.data.inlineContent||a.data.content,v=".pmts-portal-root-"+c,A=".apx-secondary-view-root-"+c,D="#apx-secondary-view-"+e,y=b.scrollTop(),x=a.$target.closest(v).last();x.hide();v=f.$(A).last();v.length||(x.after('\x3cdiv class\x3d"apx-secondary-view-root-'+c+' pmts-portal-component"\x3e\x3c/div\x3e'),v=f.$(A));var z=v.find(D);z.remove();A=d?['\x3cdiv class\x3d"a-span8 a-column a-span-last a-text-right"\x3e',
'\x3ch4 id\x3d"apx-secondary-view-header-'+e+'"\x3e',d,"\x3c/h4\x3e\n\x3c/div\x3e"].join("\n"):"";v.append(['\x3cdiv class\x3d"a-popover a-popover-secondary a-declarative" data-action\x3d"a-popover-a11y" id\x3d"apx-secondary-view-'+e+'"\x3e','\x3cdiv class\x3d"a-popover-wrapper"\x3e','\x3cdiv class\x3d"a-popover-header-secondary'+(m?" a-popover-no-header":"")+'"\x3e','\x3cdiv class\x3d"a-row"\x3e','\x3cdiv class\x3d"'+(d?"a-span4":"a-span12 a-span-last")+' a-column"\x3e','\x3ca class\x3d"a-declarative" data-action\x3d"apx-secondary-view-close"  href\x3d"#" data-apx-secondary-view-close\x3d"{\x26quot;widgetInstanceId\x26quot;:\x26quot;'+
c+"\x26quot;, \x26quot;scrollTop\x26quot;:"+y+", \x26quot;id\x26quot;:\x26quot;"+e+'\x26quot;}"\x3e','\x3ci class\x3d"a-icon a-icon-page-back"\x3e\x3c/i\x3e\n\x3ch4\x3e',g||"Back","\x3c/h4\x3e\n\x3c/a\x3e\n\x3c/div\x3e",A,"\x3c/div\x3e\n\x3c/div\x3e",'\x3cdiv class\x3d"a-popover-inner'+(p?" a-color-alternate-background":"")+'"\x3e','\x3cdiv class\x3d"a-popover-header-spacing'+(m?" a-popover-no-header":"")+'"\x3e\x3c/div\x3e','\x3cdiv class\x3d"a-container a-secondary-view-inner'+l+'" id\x3d"apx-secondary-view-content-'+
e+'"\x3e',t,"\x3c/div\x3e\n\x3c/div\x3e\n\x3c/div\x3e\n\x3c/div\x3e"].join("\n"));z=v.find(D);c=function(){var a=f.viewport();z.width(a.width);z.css("min-height",a.height);z.find(".a-popover-wrapper, .a-popover-inner").css("min-height",a.height)};c();f.on("resize",c);z.show().css("visibility","visible").removeClass("a-popover-hidden");b.scrollTop(0)}a.$event.preventDefault()});f.declarative("apx-secondary-view-close","click",function(a){var c=a.data.widgetInstanceId,e=a.data.id,d=a.data.scrollTop;
c&&e&&(e=a.$target.closest("#apx-secondary-view-"+e).last(),c=f.$(".pmts-portal-root-"+c),e.remove(),c.show(),d&&b.scrollTop(d));a.$event.preventDefault()});d.apxSecondaryViewRegistered=!0;f.state("apx",d)}});w("attributes",["lang","events"],function(f,d){return f.extend({},d,{attributes:{},resetQuietly:function(b){this.attributes={};if(null!=b)for(var a in b){var c=b[a];c!==F&&(this.attributes[a]=c)}},toJSON:function(){return f.clone(this.attributes)},get:function(b){if(f.has(this.attributes,b))return this.attributes[b]},
has:function(b){return this.get(b)!==F},set:function(b,a){if(f.isString(b)){var c={};c[b]=a}else c=b;var e,d;for(d in c)b=c[d],a=this.get(d),this.isAttributeEqual(d,a,b)||(e||(e={}),e[d]=a,b!==F?this.attributes[d]=b:delete this.attributes[d]);if(e){for(var g in e)f.has(e,g)&&(b=this.get(g),a=e[g],this.trigger("change:"+g,b,g,this,a));this.trigger("change",this)}},unset:function(){var b={};if(0===arguments.length)for(var a in this.attributes)f.has(this.attributes,a)&&(b[a]=F);else f.forEach(arguments,
function(a){b[a]=F});return this.set(b)},reset:function(b){var a={},c;for(c in this.attributes)f.has(this.attributes,c)&&(a[c]=F);null!=b&&f.extend(a,b);return this.set(a)},isAttributeEqual:function(b,a,c){return a===c},watch:function(){if(2===arguments.length){var b=arguments[0];var a=arguments[1];for(e in a){var c=a[e];this.on("change:"+e,b,c)}}else{var e=arguments[0];b=arguments[1];c=arguments[2];this.on("change:"+e,b,c)}return this}})});w("aui-helper",["jQuery","lang","css-utils","AUI!P"],function(f,
d,b,a){return{_dropdown:function(c){return{getControlElement:function(){return this._getSpan().prev()},_getSpan:function(){return c},error:function(a){var c=this._getSpan();if("undefined"!==typeof a)c.toggleClass("a-form-error a-button-error",a);else return c.hasClass("a-button-error")||c.hasClass("a-form-error")},val:function(c){var e=this.getControlElement(),b=this._getSpan();if("undefined"!==typeof c)a.when("a-dropdown").execute("apx-aui-helper-val",function(a){var d=e.attr("id");f.isFunction(a.getSelect)?
a.getSelect(d).setValue(c):(e.val(c),f(b.find(".a-dropdown-prompt")[0]).html(c))});else return e.val()},getOptionTextForValue:function(a){var c=this.getControlElement();return c?c.find("[value\x3d"+a+"]").first().text():""},toggleDisabled:function(c){if(a){var e=this._getSpan(),d=this.getControlElement();"undefined"===typeof c&&(c=!b.hasAUIDisabledButtonClass(d));a.when("a-dropdown").execute("apx-aui-helper-toggleDisabled",function(a){var n=d.attr("id"),g=c?"disabled":"normal";f.isFunction(a.getSelect)?
a.getSelect(n).update({status:g}):b.toggleDisabledElement(e,!c)})}},isEnabled:function(){return!b.hasAUIDisabledButtonClass(this._getSpan())}}},_radio:function(a,e){var c=a.getDOMElementsByPrefix(e+"-");return{getControlElement:function(){return c},error:function(a){},val:function(a){if("undefined"!==typeof a){var e=c.filter(function(c,e){return e.value===a})[0];e&&(e.checked=!0)}else return c.filter(":checked").val()},isEnabled:function(){return!this.getControlElement().prop("disabled")},isChecked:function(){return this.getControlElement()[0].checked}}},
_textInput:function(a,e){return{getControlElement:function(){return a},getParent:function(){return a.parent()},error:function(a){var c=this.getParent();c=c.hasClass("a-input-text-wrapper")?c:this.getControlElement();if("undefined"!==typeof a)c.toggleClass("a-form-error",a);else return c.hasClass("a-form-error")},val:function(c){if("undefined"!==typeof c)a.val(c);else return a.val()},isEnabled:function(){return!a.hasClass("a-form-disabled")}}},_generic:function(a){return{getControlElement:function(){return a},
error:function(c){if("undefined"!==typeof c)a.toggleClass("a-form-error",c);else return a.hasClass("a-form-error")},val:function(c){if("undefined"!==typeof c)a.val(c);else return a.val()},isEnabled:function(){return!a.hasClass("a-form-disabled")}}},getAUITagHelper:function(a,e){switch(a.getElementTagType(e)){case "RadioButtonTag":return this._radio(a,e);case "DropdownTag":return this._dropdown(a.getDOMElement(e));case "TextInputTag":return this._textInput(a.getDOMElement(e));default:return this._generic(a.getDOMElement(e))}},
getFormAlertsContainerHelper:function(a,e){return{render:function(c){c&&c.length&&0<c.length?("inline"===a?this._renderInlineAlerts(c):this._renderBoxAlerts(c),b.showElement(e)):(f(e.find("ul")).empty(),b.hideElement(e))},_renderInlineAlerts:function(a){e.find(".pmts-error-message-inline").remove();var c=e.find(".pmts-error-message-inline-template");d.forEach(a,function(a){var b=c.clone().removeClass("pmts-error-message-inline-template").addClass("pmts-error-message-inline");b.find("p").text(a.localizedMessageString);
b.appendTo(e)})},_renderBoxAlerts:function(a){var c=f(e.find("ul")).empty();d.forEach(a,function(a){f("\x3cspan\x3e").attr("class","a-list-item").text(a.localizedMessageString).appendTo(f("\x3cli\x3e").appendTo(c))})}}},dynamicTriggeredWidgetEvent:function(a){var c=f("form"),b=document.createElement("input");b.name="ppw-widgetEvent:"+a;b.type="hidden";c.append(b);c.submit()},getExpanderHelper:function(a){var c;return{isExpanded:function(){return"true"===this.getContainer().find("div.a-expander-inline-content").attr("aria-expanded")},
getContainer:function(){return c||(c=a.closest("div.a-expander-inline-container"))}}}}});(function(){var f=null;"undefined"!==typeof AmazonUIPageJS?f=AmazonUIPageJS:"undefined"!==typeof S&&(f=S);f?(w("AUI!P",[],function(){return f}),f.when("A").execute(function(d){w("AUI!A",[],function(){return d})})):(w("AUI!P",[],function(){return null}),w("AUI!A",[],function(){return null}))})();w("base",["lang"],function(f){function d(a,e){return function(){a.apply(this,arguments);e.apply(this,arguments)}}function b(a,
e){for(var c=e.length-1;0<=c;c--){var g=e[c];if(f.has(g,"constructor"))return g.constructor;if(f.has(g,"initialize"))return 0<c&&(a=b(a,f.slice(e,0,c))),d(a,g.initialize)}return function(){a.apply(this,arguments)}}var a=function(){};a.extend=function(){var a=b(this,arguments);a.extend=this.extend;a.prototype=f.create(this.prototype);a.prototype.constructor=a;for(var e=0,d=arguments.length;e<d;e++){var g=arguments[e],m;for(m in g)f.has(g,m)&&"constructor"!==m&&"initialize"!==m&&(a.prototype[m]=g[m])}return a};
return a});w("cc-spacing",["jQuery"],function(f){return{fixSpacing:function(d){d=d.replace(/\s/g,"");0<d.length&&(d=d.match(/^3[47]/)?f.trim([d.substr(0,4),d.substr(4,6),d.substr(10,5),d.substr(15)].join(" ")):d.match(/.{1,4}/g).join(" "));return d},fixCaret:function(d,b,a,c){if(b&&a)if(b.length===a.length+2){if(c===a.length||" "===a.charAt(c))d+=1}else b.length===a.length+1&&c<a.length&&" "===a.charAt(c)&&(d+=1);return d}}});w("clientSideEventLogger",["lang","clog"],function(f,d){function b(){if(0!=
c.length){var b=f.extend(e,c);d.log(b);a=c.length=0}}var a=0,c=[],e;setInterval(function(){b()},6E4);u.onbeforeunload=function(){b()};return{storeEventsData:function(d,g,m){e=g;c.push(d);a+=1;50<=a?b():"Done"===m&&b()}}});w("component",["base","jQuery","lang","aui-helper","AUI!P"],function(f,d,b,a,c){return f.extend({initialize:function(a,c){this.id=c.id;this.widget=a;this._elementReferences=c.elementReferences;this._elementDOMEventMethodBindings=c.elementDOMEventMethodBindings;this._elementReferenceTagType=
c.elementReferenceTagType;this.data=c.data},initializeOnReady:function(){this.bindToEvents();this._processDOMElementEventMethodBindings();this.bindToElements();this._handleScrollToPosition(this.data);this._setFocusOnElement(this.data)},_processDOMElementEventMethodBindings:function(){var a=this;a._elementDOMEventMethodBindings&&b.forEach(a._elementDOMEventMethodBindings,function(c){if(c.method in a)d("#"+c.elementId).bind(c.event,b.bind(a[c.method],a));else throw Error("Could not find method "+c.method+
" on component.");})},getDOMElement:function(a){a=this._elementReferences[a];var c=d("#"+a);return a&&1===c.length?c:d([])},getDOMElements:function(){var a=d([]);b.forEach(b.keys(this._elementReferences),function(c){a=a.add(this.getDOMElement(c))},this);return a},getDOMElementsByPrefix:function(a){var c=d([]);b.forEach(b.keys(this._elementReferences),function(e){b.startsWith(e,a)&&(c=c.add(this.getDOMElement(e)))},this);return c},getElementTagType:function(a){return this._elementReferenceTagType[a]},
_setFocusOnElement:function(a){a!==F&&a.focusElementIdReference!==F&&this.widget.focusToElement(this._elementReferences[a.focusElementIdReference])},_handleScrollToPosition:function(a){a!==F&&a.scrollOption!==F&&("toElementByReference"===a.scrollOption?this.widget.scrollToElementOnInitialize(this._elementReferences[a.scrollElementIdReference]):"toTopOfThePage"===a.scrollOption&&this.widget.scrollToTopOfThePage())},bindToElements:function(){},bindToEvents:function(){},onExpanderClick:function(c){c=
d(c.currentTarget);c=a.getExpanderHelper(c);var b=c.getContainer();if(b.length&&!c.isExpanded()){this.widget.scrollToElement(b);var e=b.find("input[type\x3d'text'], input[type\x3d'tel']").first();u.setTimeout(function(){e.focus()},150)}},detach:function(){var a=this;b.forEach(b.keys(a._elementReferences),function(c){a.getDOMElement(c).unbind()})},getRootDOMElements:function(){return d(".pmts-portal-components-"+this.id)},widgetState:null,getWidgetState:function(a){this.widgetState||(this.widgetState=
this.getDOMElement(a).closest("form").find("input[name\x3dppw-widgetState]").val());return this.widgetState},isWidgetRootComponent:function(){return this.getRootDOMElements().is(this.widget.getRootDOMElements())},registerSecondaryView:function(a){var d=this,e=this.widget,m=this.getDOMElement(a);c.when("a-secondary-view").execute(function(c){if(c=c.get(m)){var b={instance:c,reference:a};d.secondaryViews=d.secondaryViews||[];d.secondaryViews.push(b);a===e.get("activeSecondaryViewReference")&&c.show()}});
c.when("a-popover-util").execute(function(a){d.popoverUtilModule=a});e.on("widget:clean",this,function(){e.unset("activeSecondaryViewReference");d.popoverUtilModule&&d.secondaryViews&&b.forEach(d.secondaryViews,function(a){var c=a.instance;c.isActive()&&(c.unlock().hide(),d.popoverUtilModule.trigger("dismiss",c),e.set("activeSecondaryViewReference",a.reference))})})}})});w("config",[],function(){var f={useNativeFunctions:!0,useNativeHasOwnProperty:!0};return{getAttribute:function(d){var b=("undefined"!==
typeof u.APXConfig?u.APXConfig:"undefined"!==typeof u.PaymentsPortal2Config?u.PaymentsPortal2Config:{})[d];return"undefined"!==typeof b?b:f[d]}}});w("continuable-component",["component","continuable","clog","public-event-registry"],function(f,d,b,a){return f.extend(d,{CONTINUABLE_EVENT_NAME:"WidgetContinuableStatusEvent",initialize:function(c,b){a.register(this.CONTINUABLE_EVENT_NAME);this.fireWidgetContinuableStatusEvent=b.data.fireWidgetContinuableStatusEvent;this._watchContinuable()},_watchContinuable:function(){var a=
this;this.watchContinuable(this,function(c){var d={widgetName:a.widget.type,isContinuable:c};a.widget.log(d);"undefined"!==typeof c&&(b.logCounterMetric({feature:c?"ContinuableStatusEnabled":"ContinuableStatusDisabled",resource:"_Count"}),b.publishMetrics());a.fireWidgetContinuableStatusEvent&&"undefined"!==typeof c&&a.widget.trigger(this.CONTINUABLE_EVENT_NAME,d)})}})});w("continuable",["lang","attributes"],function(f,d){return f.extend({},d,{setContinuable:function(b){this.set("ContinuableAttribute",
b)},getContinuable:function(){return this.get("ContinuableAttribute")},watchContinuable:function(){if(2===arguments.length){var b=arguments[0];var a=arguments[1]}else b=this,a=arguments[0];this.watch("ContinuableAttribute",b,a)}})});w("count-down-timer-helper",[],function(){return{startCountDownTimer:function(f,d,b,a){f.countdownTimerIntervalId=setInterval(function(){var c=(new Date).getTime();c=d-c;var e=Math.floor(c/6E4)+":"+Math.floor(c/1E3%60).toString().padStart(2,"0");0>c?(clearInterval(f.countdownTimerIntervalId),
a(f)):b(f,e)},1E3);return f.countdownTimerIntervalId}}});w("css-utils",[],function(){var f=function(a){a.addClass("a-hidden aok-hidden");a.hide()},d=function(a){a.removeClass("a-hidden aok-hidden");a.show()},b=function(a){a.addClass("a-button-disabled")},a=function(a){a.removeClass("a-button-disabled")},c=function(a){return a.hasClass("a-hidden")||a.hasClass("aok-hidden")},e=function(a){return a.hasClass("a-button-disabled")};return{hideElement:f,showElement:d,toggleElement:function(a,b){"undefined"===
typeof b&&(b=c(a));b?d(a):f(a)},hasAUIHiddenClass:c,hasAUIDisabledButtonClass:e,disableElement:b,enableElement:a,toggleDisabledElement:function(c,d){"undefined"===typeof d&&(d=e(c));d?a(c):b(c)},disableTextInput:function(a){a.addClass("a-form-disabled");a.prop("disabled",!0)},enableTextInput:function(a){a.removeClass("a-form-disabled");a.prop("disabled",!1)},makeTextInputReadOnly:function(a){a.addClass("a-form-disabled");a.prop("readonly",!0)},makeTextInputReadWrite:function(a){a.removeClass("a-form-disabled");
a.prop("readonly",!1)},isTextInputReadOnly:function(a){return a.hasClass("a-form-disabled")&&a.is("[readonly]")},setElementBackgroundImage:function(a,c,b){b?a.css("background","url('"+c+"')"+b):a.css("background-image","url('"+c+"')")}}});w("mixins/disable-component",["lang"],function(f){return f.extend({},{_disabled:!1,toggleDisabled:function(){this.setDisabled(!this._disabled)},isDisabled:function(){return this._disabled},setDisabled:function(d,b){d=d===F?!0:d;b=b===F?!0:b;if(d!==this._disabled){this._disabled=
d;var a=this.getDOMElements();a.find("input").andSelf().filter("input").prop("disabled",d);b&&(d?(a.find("span.a-color-base").removeClass("a-color-base").addClass("a-color-tertiary"),a.find("div.pmts-payment-method-title-slot").addClass("pmts-payment-method-text-disabled"),a.find("div.pmts-payment-method-icon-slot").addClass("pmts-logo-disabled")):(a.find("span.a-color-tertiary").removeClass("a-color-tertiary").addClass("a-color-base"),a.find("div.pmts-payment-method-title-slot").removeClass("pmts-payment-method-text-disabled"),
a.find("div.pmts-payment-method-icon-slot").removeClass("pmts-logo-disabled")));this.onDisabledChange(d)}},onDisabledChange:function(d){}})});w("events",["lang","AUI!A"],function(f,d){function b(a,c){f.every(a,function(a){return a.callback.apply(a.thisArg,c)!==PaymentsPortal2.events.STOP_EVENT_PROCESSING},this)}"undefined"===typeof PaymentsPortal2.events&&(PaymentsPortal2.events={},PaymentsPortal2.events.STOP_EVENT_PROCESSING="STOP_EVENT_PROCESSING");return{on:function(){if(2===arguments.length){var a=
arguments[0];var c=arguments[1];for(d in c){var b=c[d];this.on(d,a,b)}return this}var d=arguments[0];a=arguments[1];b=arguments[2];if(null==a)throw new TypeError("Events.on: thisArg must not be null or undefined");if(!f.isFunction(b))throw new TypeError("Events.on: callback must be a function");c=this.listeners;c||(c=this.listeners={});f.has(c,d)||(c[d]=[]);c[d].push({callback:b,thisArg:a});return this},auiListeners:{},onAui:function(a,c){d&&(this.auiListeners[a]=this.auiListeners[a]||[],this.auiListeners[a].push(c),
d.on(a,c))},offAui:function(a,c){if(d)if(null==a){for(var b in this.auiListeners)this.auiListeners.hasOwnProperty(b)&&f.forEach(this.auiListeners[b],function(a){d.off(b,a)});this.auiListeners={}}else d.off(a,c)},off:function(a,c,b){if(null==a&&null==c&&null==b)return delete this.listeners,this;var d=this.listeners;if(!d)return this;a=null==a?f.keys(d):[a];f.forEach(a,function(a){f.has(d,a)&&(d[a]=f.filter(d[a],function(a){return null!=c&&c!==a.thisArg&&c!==a.thisArg.widget||null!=b&&b!==a.callback}))});
return this},trigger:function(a){var c=this.listeners;if(!c)return this;var d=f.slice(arguments,1);f.has(c,"all")&&b.call(this,c.all,f.merge([a],d));f.has(c,a)&&b.call(this,c[a],d);return this},triggerContinue:function(a,c){c&&c.submissionParameters&&c.submissionParameters.push({name:"ppw-jsEnabled",value:!0});this.trigger(a,c)}}});w("events/form-submitted-event",[],function(){return"FormSubmitted"});w("events/js-continue-failure-event",["public-event-registry"],function(f){f.register("JSContinueFailure");
return"JSContinueFailure"});w("events/spinner-events",[],function(){return{hideSpinner:"HideSpinner",showSpinner:"ShowSpinner"}});w("events/workflow-state-event",[],function(){return"WorkflowState"});w("form-component",["component","form","keyboard","lang"],function(f,d,b,a){return f.extend({initialize:function(a,b){this.form=new d(this,b.data.formQualifier,b.data.formDefinition)},bindFormSubmissionHandler:function(c,d,n){var e=this;e.getDOMElement(c).click(a.bind(n,e));e.getDOMElement(d).bind("keypress",
function(a){if(a.which===b.keys.VK_RETURN)return n.call(e)})},getFormSubmissionParameters:function(a,b){var c="string"===typeof a?this.getDOMElement(a):a,d=c.find("form").andSelf().filter("form");d=0!==d.length?d.serializeArray():c.find("input, select").serializeArray();c=1<arguments.length?("string"===typeof b?this.getDOMElement(b):b).find("input[type\x3dsubmit]").attr("name"):c.find("input[type\x3dsubmit]")[0].name;d.push({name:c,value:"Submit"});return d}})});w("form-constants",[],function(){return{WIDGET_EVENT_KEY:"ppw-widgetEvent",
KEY_VALUE_SEPARATOR:":"}});w("form-helper",["lang","jQuery","form-constants"],function(f,d,b){return{onSubmit:function(a,c){a.each(function(){var a=d(this),b=null;a.find("input[type\x3dsubmit]").click(function(a){b=d(a.target)});a.submit(function(d){c(a,d,b);b=null})})},serializeObject:function(a){return f.reduce(a.serializeArray(),function(a,b){a[b.name]=b.value;return a},{})},ensureWidgetEventInput:function(a,c){var d=b.WIDGET_EVENT_KEY+b.KEY_VALUE_SEPARATOR;c=f.startsWith(c,d)?c:d+c;var n=function(){return a.find("input[type\x3d'hidden'][name^\x3d'"+
d+"']")};n().not("[name^\x3d'"+c+"']'").remove();n().length||a.append("\x3cinput name\x3d"+c+" type\x3dhidden /\x3e")}}});w("form-model",["base","lang","validation-functions"],function(f,d,b){return f.extend({initialize:function(a){this.constraints=a.constraints;this.fields=a.fields;this.validationEvent=a.validationEvent;this.actionEvent=a.actionEvent;this.additionalData={}},validateForm:function(a){var c={},b=[];d.forEach(this.constraints,function(d){var e=d.metaData&&!c[d.field]&&!this.evalValidator(d,
a)&&d.metaData.prioritized;if(!d.metaData&&!c[d.field]&&!this.evalValidator(d,a)||e)c[d.field]=!0,e={field:d.field,validation:d.validation,messageStringId:d.failureMessageStringId,metaData:d.metaData},this.validationEvent&&this.actionEvent&&(e.fieldMetricValueType=d.metricValueType,e.fieldValue=this._getFieldValue(d,a)),b.push(e)},this);return b},_getFieldValue:function(a,c){var b="CRITICAL_OR_RESTRICTED_VALUE";a.isCriticalOrRestricted||(b=this.fields[a.field],"expirationDate"===a.field?(a=c[b.dayParameterName],
b=c[b.yearParameterName]+"-"+c[b.monthParameterName]+"-"+("undefined"===typeof a?"01":a)):b=c[b.defaultParameterName]);return b},evalValidator:function(a,c){var d=b[a.validation];return!d||a.metaData&&a.metaData.disabled?!0:d.call(null,this,c,this.fields[a.field],a.parameters)},registerAdditionalData:function(a,c){"string"===typeof a&&(this.additionalData[a]=c)},getAdditionalData:function(a){return this.additionalData[a]}})});w("form","base css-utils lang jQuery form-model aui-helper".split(" "),
function(f,d,b,a,c,e){var n=[/^addCreditCardVerificationNumber[0-9]*$/,/^apx-secure-field-addCreditCardVerificationNumber[0-9]*$/];return f.extend({initialize:function(a,b,d){this.component=a;this.formQualifier=b;this.formModel=new c(d);this.fields=d.fields},validateForm:function(a){this.clearValidationErrors();var c=this.getFormValues();c=this._getLocalizedErrorMessages(this.formModel.validateForm(c));0<c.length&&!a&&this.renderErrorMessages(c);return c},clearLowPrioField:function(a){this.clearValidationError(a.inputFieldName,
a.id)},validateField:function(a){var c=this.getFormValues();this.clearValidationError(a.inputFieldName,a.id);c=this._getLocalizedErrorMessages(this.formModel.validateForm(c));var b=!1;if(0<c.length)for(var d=0;d<c.length;d++){var e=c[d].metaData;e.id!=a.id||e.hideMessage||this.renderErrorMessages([c[d]]);""!=e.id&&e.messageDefinition&&"error"===e.messageDefinition.messageType&&(b=!0)}return b},renderErrorMessages:function(a){var c=this,d=[],g=[],n=[],v={};b.forEach(a,function(a){a.field&&(v[a.field]||
(v[a.field]=[]),v[a.field].push(a),(!a.metaData||a.metaData.messageDefinition&&"info"!=a.metaData.messageDefinition.messageType)&&c.blameFormField(a.field,!0));a.validation&&a.fieldMetricValueType&&a.fieldValue&&(d.push(a.validation),g.push(a.fieldMetricValueType),n.push(a.fieldValue))});var f=this._getFormFieldAlertContainers(a);b.forEach(b.keys(f),function(a){e.getFormAlertsContainerHelper("inline",f[a]).render(v[a])});a=a.filter(function(a){return a.metaData?!a.metaData.inLine:!0});var D=this._getFormAlertsContainer();
D.domElement!==F&&e.getFormAlertsContainerHelper(D.messageDisplayType,D.domElement).render(a)},_submitValidationMetrics:function(a,c,b){a&&c&&b&&this.component.widget.continueRequest({"ppw-widgetEvent":this.formModel.validationEvent,"ppw-actionEvent":this.formModel.actionEvent,"ppw-validations":a,"ppw-valueTypes":c,"ppw-values":b,"ppw-widgetState":this.component.widget.options.serializedState},{success:function(){}})},_getFormAlertsContainer:function(){var a=this.component.getDOMElement("errorMessagesBoxContainer");
return 0<a.length?{domElement:a,messageDisplayType:"box"}:{domElement:this.component.getDOMElement("errorMessagesInlineContainer"),messageDisplayType:"inline"}},_getFormFieldAlertContainers:function(a){var c=this,d={};b.forEach(b.keys(this.fields),function(e){b.forEach(a,function(a){a.field==e&&(a=a.metaData&&""!=a.metaData.id?c.component.getDOMElement("errorMessagesInlineContainer-"+a.metaData.id):c.component.getDOMElement("errorMessagesInlineContainer-"+e),a.length&&(d[e]=a))})});return d},_getLocalizedErrorMessages:function(a){var c=
this;return b.map(a,function(a){return{field:a.field,validation:a.validation,fieldMetricValueType:a.fieldMetricValueType,fieldValue:a.fieldValue,messageStringId:a.messageStringId,localizedMessageString:c.component.widget.getLocalizedString(a.messageStringId),metaData:a.metaData}})},getFormValues:function(){var a={},c=this;b.forEach(this._getParameterNames(),function(b){c.getAUITagHelperForParameter(b).isEnabled()&&(a[b]=c.getAUITagHelperForParameter(b).val())});a.widgetCreationEpochMilliseconds=this.component.widget.widgetCreationEpochMilliseconds;
return a},getQualifiedParameterName:function(a){if(this.formQualifier){var c=!1;n.forEach(function(b){c=c||b.test(a)});return c?a:this.formQualifier+"_"+a}return a},getAUITagHelperForParameter:function(a){return e.getAUITagHelper(this.component,this.getQualifiedParameterName(a))},bindToParameter:function(a,c){var b=[];Array.prototype.push.apply(b,arguments);b.shift();var d=this.getAUITagHelperForParameter(a).getControlElement();d.bind.apply(d,b)},_getParameterNames:function(a){if(a){var c=this.fields[a];
return b.map(b.keys(c),function(a){return c[a]})}var d=[],e=this;b.forEach(b.keys(this.fields),function(a){var c=e.fields[a];a=b.keys(c);b.forEach(a,function(a){d.push(c[a])})});return d},blameFormField:function(a,c){var d=this;a=this._getParameterNames(a);b.forEach(a,function(a){d.getAUITagHelperForParameter(a).error(c)})},resetErrors:function(){this.clearValidationErrors();d.hideElement(this.component.getDOMElement("errorMessagesBoxContainer"))},clearValidationErrors:function(){var a=this;b.forEach(b.keys(this.fields),
function(c){a.blameFormField(c,!1)});var c=this.component.getDOMElementsByPrefix("errorMessagesInlineContainer-");d.hideElement(c)},clearValidationError:function(a,c){a&&this.blameFormField(a,!1);c&&d.hideElement(this.component.getDOMElement("errorMessagesInlineContainer-"+c))},displayErrorMessage:function(a,c){this.blameFormField(a,!0);d.showElement(c)},resetErrorMessage:function(a,c){this.blameFormField(a,!1);d.hideElement(c)},isMCXValidationConstraint:function(a){return a&&a.metaData}})});w("global-event-bus",
["lang","events"],function(f,d){return f.extend({},d)});w("input-helper",[],function(){var f={truncateInput:function(d,b){return(d=d.match(new RegExp("^((\\d*)\\.(\\d{"+b+"}))(\\d+)$")))?d[1]:""},limitToNumericInput:function(d){d.bind("keypress",function(b){var a=String.fromCharCode(b.keyCode);("0">a||"9"<a)&&"."!==a&&b.preventDefault()})},limitNumericInputDigits:function(d,b){d.bind("input",function(a){var c=d.val();if(c=f.truncateInput(c,b))d.val(c),a.preventDefault()})}};return f});PaymentsPortal2.modules.when(["AUI!P"],
function(f){function d(b){w("jQuery",[],function(){return b})}f?f.when("jQuery").execute(d):"undefined"!==typeof jQuery&&d(jQuery)});w("keyboard",[],function(){return{keys:{VK_BACKSPACE:8,VK_RETURN:13,VK_DELETE:46,VK_ZERO:48,VK_NINE:57}}});w("lang",["config"],function(f){var d={id:function(a){return a}},b=Array.prototype.slice,a=Object.prototype.toString;d.slice=function(a){return b.apply(a,b.call(arguments,1))};d.isDefined=function(a){return!("undefined"===typeof a||null===a)};var c=d.isObject=function(a){return Object(a)===
a},e=d.isFunction=function(c){return"[object Function]"===a.call(c)},n=d.isString=function(c){return"[object String]"===a.call(c)};d.isNumber=function(c){return"[object Number]"===a.call(c)};var g=d.extend=function(a){a=Object(a);for(var c=1,b=arguments.length;c<b;c++){var d=arguments[c],e;for(e in d)a[e]=d[e]}return a};d.clone=function(a){return g({},a)};d.merge=function(a){for(var c=1,b=arguments.length;c<b;c++)for(var d=arguments[c],e=0,g=d.length;e<g;e++)a.push(d[e]);return a};d.force=function(a,
c){c=a[c];return e(c)?c.call(a):c};d.time=function(){return(new Date).getTime()};d.date=function(){return new Date(d.time())};d.intercept=function(a,c,b,d){var e=a[c];a[c]=function(){b.apply(d,arguments);e&&e.apply(this,arguments)};return a};d.NOOP=function(){};d.forEachKeyValue=function(a,c){for(var b in a)t(a,b)&&c(b,a[b])};var m=0;d.newLocalId=function(){return"pmts-id-"+ ++m};d.assert=function(a,c){if(!a)throw Error(c||"Assertion Error");};d.once=function(a){var c=!1,b;return function(){if(c)return b;
b=a.apply(this,arguments);c=!0;return b}};d.after=function(a,c){return function(){if(0>=--a)return c.apply(this,arguments)}};d.leftPad=function(a,c,b){a=String(a);c-=a.length;return 0>=c?a:Array(c+1).join(b)+a};d.endsWith=function(a,c){return-1!==a.indexOf(c,a.length-c.length)};d.startsWith=function(a,c){return a.substr(0,c.length)===c};d.keywordFormat=function(a,c){return a.replace(/\{(\w+)\}/g,function(a,b){return"undefined"!==typeof c[b]?c[b]:a})};d.stableSort=function(a,c){a=r(a,function(a,c){return{index:c,
elem:a}});a.sort(function(a,b){var d=c(a.elem,b.elem);return 0===d?a.index-b.index:d});return r(a,function(a){return a.elem})};var p=f.getAttribute("useNativeFunctions");f=f.getAttribute("useNativeHasOwnProperty");var l=Object.prototype.hasOwnProperty;var t=l&&f?function(a,c){return l.call(a,c)}:function(a,c){if(!(c in a))return!1;for(var b in a)if(b===c)return!0;return!1};d.has=t;f=Array.isArray;d.isArray=f&&p?f:function(c){return"[object Array]"===a.call(c)};if((f=Object.create)&&p)var v=f;else{var A=
function(){},D=A.prototype;v=function(a){if(null===a)throw Error("null prototypes are not supported");if(!c(a))throw new TypeError("prototype must be an object");if(1<arguments.length)throw Error("property descriptors are not supported");A.prototype=a;var b=new A;A.prototype=D;return b}}d.create=v;var y=Function.prototype.bind;d.bind=y&&p?function(a){return y.apply(a,b.call(arguments,1))}:function(a,d){var e=b.call(arguments,2),g=function(){if(this instanceof g){var n=v(a.prototype),h=a.apply(n,e.concat(b.call(arguments)));
return c(h)?h:n}return a.apply(d,e.concat(b.call(arguments)))};return g};var x=Array.prototype.forEach;var z=x&&p?function(a){x.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);for(var d=0,e=a.length>>>0;d<e;d++)d in a&&c.call(b,a[d],d,a)};d.forEach=z;var h=Array.prototype.filter;d.filter=h&&p?function(a){return h.apply(a,b.call(arguments,1))}:function(a,c,b){var d=[];z(a,function(a,e,g){c.call(b,a,e,g)&&d.push(a)});return d};var q=Array.prototype.map;var r=q&&p?function(a){return q.apply(a,
b.call(arguments,1))}:function(a,c,b){var d=[];z(a,function(a,e,g){d[e]=c.call(b,a,e,g)});return d};d.map=r;var G=Array.prototype.indexOf;d.indexOf=G&&p?function(a){return G.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);var d=a.length>>>0,e=2<arguments.length?+b:0;0>e&&(e+=d,0>e&&(e=0));for(;e<d;e++)if(e in a&&c===a[e])return e;return-1};var k=Array.prototype.lastIndexOf;d.lastIndexOf=k&&p?function(a){return k.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);var d=a.length>>>
0,e=2<arguments.length?+b:d;for(0>e?e+=d:e>d-1&&(e=d-1);0<=e;e--)if(e in a&&c===a[e])return e;return-1};var B=Array.prototype.reduce;d.reduce=B&&p?function(a){return B.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);var d=a.length>>>0,e=0;if(2>=arguments.length){for(var g=!1;e<d;e++)if(e in a){b=a[e];e++;g=!0;break}if(!g)throw new TypeError("reduce: no initial value specified for empty array");}for(;e<d;e++)e in a&&(b=c.call(null,b,a[e],e,a));return b};var C=Array.prototype.reduceRight;
d.reduceRight=C&&p?function(a){return C.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);var d=(a.length>>>0)-1;if(2>=arguments.length){for(var e=!1;0<=d;d--)if(d in a){b=a[d];d--;e=!0;break}if(!e)throw new TypeError("reduceRight: no initial value specified for empty array");}for(;0<=d;d--)d in a&&(b=c.call(null,b,a[d],d,a));return b};var M=Array.prototype.every;d.every=M&&p?function(a){return M.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);for(var d=0,e=a.length>>>0;d<e;d++)if(d in
a&&!c.call(b,a[d],d,a))return!1;return!0};var E=Array.prototype.some;d.some=E&&p?function(a){return E.apply(a,b.call(arguments,1))}:function(a,c,b){a=Object(a);for(var d=0,e=a.length>>>0;d<e;d++)if(d in a&&c.call(b,a[d],d,a))return!0;return!1};f=Object.keys;d.keys=f&&p?f:function(a){var c=[],b;for(b in a)t(a,b)&&c.push(b);return c};var K=String.prototype.trim;d.trim=K&&p?function(a){return K.apply(a)}:function(a){if(!n(a))throw new TypeError("trim: str must be a string");return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
"")};d.addEventListener=function(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent?a.attachEvent("on"+c,b):a["on"+c]=b};return d});w("localization-utils",[],function(){var f=/\{(\w+)\}/g;return{fillInStringTemplate:function(d,b){for(var a=d,c=f.exec(d);c;){var e=c[0];c=c[1];"string"===typeof b[c]&&(a=a.replace(e,b[c]));c=f.exec(d)}return a}}});w("clog",["lang"],function(f){function d(a){u.console&&u.console.error&&u.console.error(a)}function b(a){return u.Number(a)===a&&0===a%1}function a(a){return"[object String]"===
Object.prototype.toString.call(a)}function c(a){return!0===a||!1===a}function e(a,c){return u.JSON&&u.JSON.stringify?c+u.encodeURIComponent(u.JSON.stringify(a)):c+u.encodeURIComponent(a)}function n(a,c){return c+u.encodeURIComponent(a)}function g(c){c=c();a(c.name)&&"[object Function]"===Object.prototype.toString.call(c.send)&&"isPrimitive"in c&&(k[c.name]=c,++B)}function m(a,c){if(a){c=c||{};var b;if(b=!0===c.dontSendOnBFHit)b=u.ue&&"isBF"in u.ue?u.ue.isBF:(b=u.performance||u.webkitPerformance)&&
b.navigation?2===b.navigation.type:!1;if(!(b||1900<a.length)){b=c.client&&c.client in k?c.client:r;try{k[b].send(a,X+Z,e,c.chainedClientExecutionOrder)}catch(H){}}}}function p(a,c){z&&(x.numberOfTimberLogCalls++,x.numberOfTimberLogCalls===w?m("Max number of Forester Logs Reached"):x.numberOfTimberLogCalls<w&&m(a,c))}function l(a){var c;if(c=a&&"[object Array]"===Object.prototype.toString.call(a)&&0<a.length&&a.length<B)a:{for(c=0;c<a.length;++c)if(!(a[c]in k)){c=!1;break a}else if(!k[a[c]].isPrimitive){c=
!1;break a}c=!0}return c}function t(){return(new Date).getTime()}function v(){return u.PaymentsPortal2.widgetStartTime}function A(){if(h){for(var a="",c=0;c<M.length-1;++c)a+=M[c]+"\x3d"+C[M[c]]+"\x26";return a+=M[M.length-1]+"\x3d"+C[M[M.length-1]]}}function D(){var a="",c;for(c in E)if(E.hasOwnProperty(c)){a+="/"+c+":";for(var b in E[c])if(E[c].hasOwnProperty(b))for(var d=0;d<E[c][b].length;++d)a+=b+"@v\x3d"+E[c][b][d].value,E[c][b][d].unit&&(a+="|u\x3d"+E[c][b][d].unit),a+=",";a=a.substring(0,
a.length-1)}return a}function y(a,c){if(T)try{c==F&&(c=0);var b=new u.XMLHttpRequest;if(!("withCredentials"in b))throw"WithCredentials header not found Exception";var d=L+"1/events/"+U;b.onreadystatechange=function(){if(4===b.readyState){p({customerId:a.CustomerId,widgetInstanceId:a.WidgetInstanceId,sessionId:a.Session,status:b.status,message:a.ActionType+" , "+a.ActionValueType});var d=c+1;200!==b.status&&1>=d&&y(a,d)}};b.open("POST",d,!0);b.send(JSON.stringify({events:[{data:a}]}))}catch(ca){}}
var x={numberOfTimberLogCalls:0},z=!1,h=!1,q=!1,r="consoleLoggingClient",G=["ajaxLoggingClient","imageLoggingClient","consoleLoggingClient"],k={},B=0,C={},M="requestId session marketplaceId marketplace service method client".split(" "),E={},K=function(){},w=1E3,X="https://fls-devo.vipinteg.amazon.com/",Z="/1/payments-portal-log/1/TOP/",P="/1/action-impressions/1/TOP/payments-portal/action/",T=!1,L="",U="";g(function(){function a(){if(u.XDomainRequest){var a=new u.XDomainRequest;a.onerror=K;a.ontimeout=
K;a.onprogress=K;a.onload=K;a.timeout=0;return a}if(u.XMLHttpRequest){a=new u.XMLHttpRequest;if(!("withCredentials"in a))throw"WithCredentials header not found Exception";return a}if(u.ActiveXObject){for(var b=0;b<c.length&&!a;b++)try{a=new u.ActiveXObject(c[b]),c=[c[b]]}catch(ca){}return a}}var c="MSXML2.XMLHTTP.6.0 MSXML2.XMLHTTP.5.0 MSXML2.XMLHTTP.4.0 MSXML2.XMLHTTP.3.0 MSXML2.XMLHTTP Microsoft.XMLHTTP".split(" ");return{name:"ajaxLoggingClient",send:function(c,b,d){var e=a();if(!e)throw"unable to Create ajax object Exception";
c=d(c,b);e.open("GET",c,!0);e.send()},isPrimitive:!0}});g(function(){return{name:"imageLoggingClient",send:function(a,c,b){(new u.Image).src=b(a,c)},isPrimitive:!0}});g(function(){return{name:"consoleLoggingClient",send:function(a){if(u.console&&u.console.log)u.console.log(a);else throw"Cannot Find console.log";},isPrimitive:!0}});g(function(){return{name:"chainedLoggingClient",send:function(a,c,b,d){d=l(d)?d:G;for(var e=0;e<d.length;e++)try{return k[d[e]].send(a,c,b)}catch(fa){}throw"Failed to send log message using chainedLoggingClient";
},isPrimitive:!1}});x.getClientNames=function(){var a=[],c;for(c in k)a.push(c);return a};x.setConfiguration=function(e){e=e||{};"isTimberLoggingOn"in e&&(c(e.isTimberLoggingOn)?z=e.isTimberLoggingOn:d("isTimberLoggingOn must be a boolean"));"isPmetLoggingOn"in e&&(c(e.isPmetLoggingOn)?q=e.isPmetLoggingOn:d("isPmetLoggingOn must be a boolean"));e.foresterEndpoint&&a(e.foresterEndpoint)&&(X=f.trim(e.foresterEndpoint));e.timberLoggingChannel&&(a(e.timberLoggingChannel)?Z=e.timberLoggingChannel:d("timberLoggingChannel must be a string"));
e.pmetPostBackChannel&&(a(e.pmetPostBackChannel)?P=e.pmetPostBackChannel:d("pmetPostBackChannel must be a string"));e.defaultClient&&(e.defaultClient in k?r=e.defaultClient:d("Specified Client not found"));"maxTimberLogCalls"in e&&(b(e.maxTimberLogCalls)&&0<e.maxTimberLogCalls?w=e.maxTimberLogCalls:d("maxTimberLogCalls must be a integer \x3e 0"));e.defaultChainedClientExecutionOrder&&(l(e.defaultChainedClientExecutionOrder)?G=e.defaultChainedClientExecutionOrder:d("defaultChainedClientExecutionOrder must be a array of strings with names exactly matching the exsisting clients; To know the client names use getClientNames() method"));
e.isSushiEelLoggingOn&&(c(e.isSushiEelLoggingOn)?T=e.isSushiEelLoggingOn:d("isSushiEelLoggingOn must be a boolean"));e.sushiEelEndPoint&&(a(e.sushiEelEndPoint)?L=e.sushiEelEndPoint:d("sushiEelEndPoint must be a string"));e.sushiEelSourceGroup&&(a(e.sushiEelSourceGroup)?U=e.sushiEelSourceGroup:d("sushiEelSourceGroup must be a string"))};x.setPmetHeaders=function(a){if(a){h=!1;for(var c=0;c<M.length;c++)if(M[c]in a)C[M[c]]=a[M[c]];else{d(M[c]+" is not found");return}h=!0}else d("PMET headers undefined")};
x.log=p;x.logLatencyMetric=function(c){q&&h&&c&&c.feature&&a(c.feature)&&c.resource&&a(c.resource)&&(E[c.feature]=E[c.feature]||{},E[c.feature][c.resource]=E[c.feature][c.resource]||[],c.startTime=c.startTime||v(),c.unit=c.unit||"ms",E[c.feature][c.resource].push({value:t()-c.startTime,unit:c.unit}))};x.logCounterMetric=function(c){if(q&&h&&c&&c.feature&&a(c.feature)&&c.resource&&a(c.resource)){E[c.feature]=E[c.feature]||{};E[c.feature][c.resource]=E[c.feature][c.resource]||[];var d;if(d="amount"in
c)d=c.amount,d=b(d)&&0<=d;c.amount=d?c.amount:1;0===E[c.feature][c.resource].length?E[c.feature][c.resource].push({value:c.amount,unit:"Count"}):E[c.feature][c.resource][0].value+=c.amount}};x.publishMetrics=function(){if(q&&h)try{var a=D();a&&(a+="?"+A(),k.chainedLoggingClient.send(a,X+P,n),E={})}catch(I){}};x.publishMetricsWithDimensions=function(a){if(q&&h)try{var c=D();if(c){c+="?"+A();if(a){var b=c,d="",e;for(e in a)d+=e+"\x3d"+a[e]+"\x26";var g=d.slice(0,d.length-1);c=b+("\x26"+g)}k.chainedLoggingClient.send(c,
X+P,n);E={}}}catch(J){}};x.getCurrentTime=t;x.getWidgetStartTime=v;x.publishSushiEelMetrics=y;return x});w("mash-helper",["AUI!P","clog","metrics-helper"],function(f,d,b){return{openInExternalBrowser:function(a,c,b){f.when("mash").execute(function(d){d.openInExternalBrowser({url:a,successCallback:c,failCallback:b})})},launchIntentURL:function(a,c,b,d,g,m){var e=this;f.when("mash").execute(function(n){n.launchIntentURL({url:a,successCallback:function(){e.launchIntentUrlSuccessCallback(b,m)},failCallback:function(){e.launchIntentUrlFailCallBack(a,
c,b,d,g,m)}})})},launchIntentUrlSuccessCallback:function(a,c){b.emitCounterMetric("LaunchIntentUrlSuccess",[c]);a()},publishOpenBrowserFailureMetric:function(a,c){a?b.emitCounterMetric("LaunchUrlFallback_ToEmbeddedBrowserFail",[c]):b.emitCounterMetric("LaunchUrlFallback_ToExternalBrowserFail",[c])},launchIntentUrlFailCallBack:function(a,c,d,n,g,m){var e=this;e.openIn=c.openIn;e.httpMethod=c.httpMethod;e.additionalPostData=c.additionalPostData;b.emitCounterMetric("LaunchIntentUrlFallback",[m]);"externalBrowser"===
e.openIn?(b.emitCounterMetric("LaunchIntentUrlFallback_ToExternalBrowser",[m]),e.openInExternalBrowser(a,d,function(){e.publishOpenBrowserFailureMetric(!1,m);d()})):"embeddedBrowser"===e.openIn?(b.emitCounterMetric("LaunchIntentUrlFallback_ToEmbeddedBrowser",[m]),e.showEmbeddedBrowser(a,e.httpMethod,e.additionalPostData,function(){},function(){e.publishOpenBrowserFailureMetric(!0,m)},d)):"showFallbackTemplate"===e.openIn?(b.emitCounterMetric("LaunchIntentUrlFallback_ToFallbackTemplate",[m]),e.showMashFallbackTemplate(n,
g)):b.emitCounterMetric("LaunchIntentUrlFallback_Failure",[m])},showMashFallbackTemplate:function(a,c){c(a)},publishCountMetrics:function(a){d.logCounterMetric({feature:a,resource:"_Count"});d.publishMetrics()},showEmbeddedBrowser:function(a,c,b,d,g,m,p){f.when("mash").execute(function(e){e.showEmbeddedBrowser({targetURL:a,method:c,postParameters:b,doneButtonCallback:m,successCallback:d,failCallback:g,enableDeeplinking:p})})},navigateToUrl:function(a){f.when("mash").execute(function(c){c.navigate({url:a})})},
clearNavigationHistory:function(){f.when("mash").execute(function(a){a.navstack.clearHistory({})})},addEventListener:function(a,c){f.when("mash").execute(function(b){b.addEventListener(a,c)})},dispatchEvent:function(a,c){f.when("mash").execute(function(b){b.dispatchEvent({type:a,detail:c})})},setBookmark:function(a){f.when("mash").execute(function(c){c.navstack.setBookmark({bookmark:a,successCallback:function(){},failCallback:function(a){console.error(a)}})})},backToBookmark:function(a){f.when("mash").execute(function(c){c.navstack.begin().backToBookmark(a).end({failCallback:function(a){console.log("cannot find bookmark"+
a)}})})},disableAutoScreenShot:function(){var a=this;f.when("mash").execute(function(c){"function"===typeof c.updateSecureSettings&&c.updateSecureSettings({isSecure:!0,autoDisableScreenShot:!0,successCallback:function(){console.log("Successfully set page as secure");a.publishCountMetrics("SetSecurePageSuccess")},failCallback:function(c){console.log("Failed to set page as secure: "+c);a.publishCountMetrics("SetSecurePageFailed")}})})},hideAppOverlays:function(){f.when("mash").execute(function(a){a.dispatchEvent({type:"appOverlays.Hide"})})},
setUrlInCurrentWebview:function(a){f.when("mash").execute(function(c){c.navstack.begin().replace({url:a}).end()})},clearActiveStateEventListeners:function(){f.when("mash").execute(function(a){a.removeEventListener("appPause",handleAppPaused);a.removeEventListener("appResume",handleAppResumed)})}}});w("metrics-helper",["lang","jQuery","widget","component","clog"],function(f,d,b,a,c){return{publishOnClickSuccessSushiMetrics:function(a,c){f.forEach(c,function(c){a.getDOMElement(c.JsBindElementId).click(function(){a.widget.publishSuccessSushiMetrics(c.MetricsObject)})},
this)},emitCounterMetric:function(a,b,d){!1!==d&&c.logCounterMetric({feature:a,resource:"_Count"});(b=b&&b.filter(Boolean).join("."))&&c.logCounterMetric({feature:a+"."+b,resource:"_Count"});c.publishMetrics()},recordResourceMetric:function(a,b,d){c.logCounterMetric({feature:a,resource:b,amount:d})},publishMetricsWithDimensions:function(a){c.publishMetricsWithDimensions(a)},emitLatencyMetric:function(a,b,d,m){!1!==m&&c.logLatencyMetric({feature:a,resource:"_Latency",startTime:b});(d=d&&d.filter(Boolean).join("."))&&
c.logLatencyMetric({feature:a+"."+d,resource:"_Latency",startTime:b});c.publishMetrics()},logLatency:function(a,c,b){try{var d={};d[c]=(new Date).getTime()-b;b&&a.log(d)}catch(p){}}}});w("mini-browser-helper",[],function(){return{openInMiniBrowser:function(f,d,b){return u.open(f,d,"toolbar\x3d0,scrollbars\x3d0,location\x3d1,statusbar\x3d0,menubar\x3d0,resizable\x3d1,width\x3d"+b.width+",height\x3d"+b.height+",left\x3d"+(u.screen.availLeft+u.screen.availWidth/2-b.width/2)+",top\x3d"+(u.screen.availTop+
u.screen.availHeight/2-b.height/2))}}});w("modal-popover",["jQuery","base","AUI!P","clog"],function(f,d,b,a){return d.extend({initialize:function(a,b,d){this.widget=a;this.popoverName=b.data.popoverName;this.declarativeAction=b.data.declarativeAction;this.closeEventName=b.data.closeEventName||this.popoverName+":close";this.bindToComponent(d)},bindToComponent:function(a){var c=this,b=a.bindToElements;a.bindToElements=function(){c.bindToElements.call(c);b.call(a)}},bindToElements:function(){var c=this,
d=function(){c.widget.trigger(c.closeEventName)};b.when("A","a-modal").execute(function(a,b){var e=a.$("#"+c.declarativeAction);c.popoverInstance=b.get(e);c.popoverInstance.lock(100).show();a.on("a:declarative:a-popover-close:click",d)});c.widget.on(c.closeEventName,c,function(){c.popoverInstance&&c.popoverInstance.isActive()&&(c._hidePopoverAndOff(d),c.widget.log({popoverCloseButtonClicked:!0}),a.logCounterMetric({feature:"PopoverCloseEvent",resource:"_Count"}))});c.widget.on("widget:clean",c,function(){var a=
c.popoverInstance;a&&a.isActive()&&(delete a.typeSpecificFunctions.showMethod,delete a.typeSpecificFunctions.hideMethod,a=a.attrs("lightboxOptions"),a.showDuration=0,a.hideDuration=0,c._hidePopoverAndOff(d))})},_hidePopoverAndOff:function(a){var c=this;c.popoverInstance.unlock(100).hide();b.when("a-modal").execute(function(a){a.remove(c.declarativeAction)});b.when("A").execute(function(c){c.off("a:declarative:a-popover-close:click",a)})}})});w("number-format",["base","lang"],function(f,d){var b={AUD:"$",
BRL:"R$",CAD:"$",CNY:"",EUR:"",GBP:"",INR:"\x3cspan class\x3d'pmts-INR-currency-symbol'\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e",JPY:"",MXN:"$",RUB:"py6.",USD:"$"},a={AU:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},BR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},CA:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},CN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},DE:{fixedDecimalPrecision:2,numberDelim:".",radix:","},ES:{fixedDecimalPrecision:2,numberDelim:".",radix:","},FR:{fixedDecimalPrecision:2,
numberDelim:".",radix:","},GB:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},IT:{fixedDecimalPrecision:2,numberDelim:".",radix:","},IN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},JP:{fixedDecimalPrecision:0,numberDelim:",",radix:"."},MX:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},NL:{fixedDecimalPrecision:2,numberDelim:".",radix:","},RU:{fixedDecimalPrecision:2,numberDelim:".",radix:",",symbolAfterNumber:!0},US:{fixedDecimalPrecision:2,numberDelim:",",radix:"."}};return f.extend({SUPPORTED_COUNTRIES:d.keys(a),
initialize:function(c,e){if(-1===d.indexOf(this.SUPPORTED_COUNTRIES,c))throw Error("The country provided is invalid or not supported.");e&&e.currency&&!e.useCurrencyCode&&(e.currency=b[e.currency]);this.formatConfig=d.extend({},a[c],e)},format:function(a){var c=[],b=Number(a);if(null===a||""===a||isNaN(b))throw Error("The amount value is invalid. It must be represented as a decimal number in string format.");a=Math.abs(b);0>b&&c.push("- ");this.formatConfig.currency&&!this.formatConfig.symbolAfterNumber&&
(c.push(this.formatConfig.currency),this.formatConfig.useCurrencyCode&&c.push(" "));b=a.toFixed(this.formatConfig.fixedDecimalPrecision).split(".");for(var d=a=b[0].length,m;0<d;)m=(d-1)%3+1,c.push(b[0].substr(a-d,m)),d-=m,0<d&&c.push(this.formatConfig.numberDelim);0<this.formatConfig.fixedDecimalPrecision&&(c.push(this.formatConfig.radix),c.push(b[1]));this.formatConfig.currency&&this.formatConfig.symbolAfterNumber&&(c.push(" "),c.push(this.formatConfig.currency));return c.join("")},localizedParseNumber:function(a){if(d.isDefined(a)){a=
a.split(this.formatConfig.radix);if(2<a.length)return NaN;var c=this.formatConfig.numberDelim,b=a[0].split(c);if(2>b.length)c=a[0];else if((new RegExp("^-{0,1}[1-9]{1,3}(\\"+c+"[0-9]{3})*$")).test(a[0]))c=b.join("");else return NaN;return 1===a.length?Number(c):Number(c+"."+a[1])}return NaN}})});w("popover-base",["AUI!P","base","lang","jQuery"],function(f,d,b,a){return d.extend({auiOptions:null,customOptions:null,$elem:null,initialize:function(a,d,n){this.$elem=a;this.auiOptions=d;this.customOptions=
b.extend({},n)},auiShow:function(a,d,n){var c=this;d=c._defaultValue(d,{});n=c._defaultValue(n,!1);c._auiDefined(function(e){e&&(n&&(c.auiOptions={}),d=b.extend({},c.auiOptions,d),a?c._auiSet(c.$elem,d):c._auiRemove(c.$elem))})},customShow:function(a,d,n){var c=this;d=c._defaultValue(d,{});n=c._defaultValue(n,!1);c._auiDefined(function(e){e||(n&&(c.customOptions={}),d=b.extend({},c.customOptions,d),a?c._customSet(c.$elem,d):c._customHide(c.$elem))})},_auiSet:function(a,b){f&&this.componentName&&f.when("A",
this.componentName).execute(function(c,d){(c=d.get(a))?c.update(b):d.create(a,b)})},_auiDefined:function(a){f&&f.when("A",this.componentName).execute(function(c,b){a("undefined"!==typeof b)})},_auiRemove:function(a){f&&this.componentName&&f.when("A",this.componentName).execute(function(c,b){b.remove(a)})},_customSet:function(c,b){f&&f.when("A","a-popover-base").execute(function(d,e){(d=e.get(c))||(d=e.show({$trigger:c,skin:function(a){return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',
'\x3cdiv class\x3d"a-popover-inner"\x3e'+a+"\x3c/div\x3e",'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")},alone:!1,update:function(c){a(".a-popover-inner",this.$popover).html(c)},content:b.literalContent,position:b.position||"triggerLeft"}));d&&(d.update(b.literalContent),d.updatePosition())})},_customHide:function(a){f&&f.when("A","a-popover-base").execute(function(c,b){b.hide(a)})},_defaultValue:function(a,b){return"undefined"!==
typeof a?a:b}})});w("popover",["popover-base"],function(f){return f.extend({componentName:"a-popover"})});w("public-event-registry",["lang"],function(f){var d=[];return{register:function(b){var a=this;f.forEach(arguments,function(c){f.isString(c)&&!a.has(c)&&d.push(c)})},has:function(b){return f.isString(b)&&0<=f.indexOf(d,b)}}});w("redirection-helper",["jQuery","clog"],function(f,d){return{handleRedirection:function(b,a,c,d){b&&(c=JSON.parse(c),c=this.getQueryParameters(b,c),this.publishRedirectionMetrics(c,
d),d.log({httpMethod:a,redirectUrl:b,parsedHttpParameters:c}),b=b.split("?")[0],"POST"===a?this.post(b,c):this.get(b,c,d))},post:function(b,a){var c=document.createElement("form");c.setAttribute("method","post");c.setAttribute("action",this.decodeHtml(b));if(a)for(var d in a)a.hasOwnProperty(d)&&(b=document.createElement("input"),b.setAttribute("type","hidden"),b.setAttribute("name",d),b.setAttribute("value",this.decodeHtml(a[d])),c.appendChild(b));document.body.appendChild(c);c.submit()},get:function(b,
a,c){b=this.buildURL(b,a);if("true"===a.isJuspayRequired)try{"IndiaPayCategories"!==a.clientId&&(document.body.style.display="none"),(u.cordova&&u.cordova.require("cordova/exec"))(this.juspayRedirectionSuccess,this.juspayRedirectionFailed,"MASHJuspayPayment","ShowJuspayBrowser",[b,"POST",a])}catch(e){c.log({cordova_exec_error:e}),u.location.href=this.decodeHtml(b)}else u.location.href=this.decodeHtml(b)},buildURL:function(b,a){return a?(a=this.queryParams(a),b+"?"+a):b},decodeHtml:function(b){return(new DOMParser).parseFromString(b,
"text/html").documentElement.textContent},queryParams:function(b){var a=[],c;for(c in b)a.push(encodeURIComponent(c)+"\x3d"+encodeURIComponent(b[c]));return a.join("\x26")},getQueryParameters:function(b,a){(b=b.split("?")[1])&&b.split("\x26").forEach(function(c){c=c.split("\x3d");a[decodeURIComponent(c[0])]=decodeURIComponent(c[1])});return a},juspayRedirectionSuccess:function(){console.log("Juspay redirection successful")},juspayRedirectionFailed:function(){console.log("Juspay redirection failed")},
publishRedirectionMetrics:function(b,a){b.errorCode?(this.publishCountMetrics("RedirectionToFailureCallbackUrl_ErrorCode_"+b.errorCode),a.publishFailureSushiMetrics({ActionType:"RedirectionToFailureCallbackUrl",ActionParentValue:"ErrorCode",ActionParentValueType:b.errorCode,ActionValueType:"ErrorDetails",ActionValue:b.errorDetails})):b.status?(this.publishCountMetrics("RedirectionToCallbackUrl_Status_"+b.status),a.publishSuccessSushiMetrics({ActionType:"RedirectionToCallbackUrl",ActionValueType:"PaymentStatus",
ActionValue:b.status})):"true"===b.isJuspayRequired?(this.publishCountMetrics("RedirectionToJuspayBrowser"),a.publishSuccessSushiMetrics({ActionType:"RedirectionToJuspayBrowser",ActionValueType:"RedirectionStatus",ActionValue:"Success"})):(this.publishCountMetrics("RedirectionToAIPS"),a.publishSuccessSushiMetrics({ActionType:"RedirectionToAIPS",ActionValueType:"RedirectionStatus",ActionValue:"Success"}))},publishCountMetrics:function(b){d.logCounterMetric({feature:b,resource:"_Count"});d.publishMetrics()}}});
w("sdk-client",[],function(){try{var f=function(d){function b(c){if(a[c])return a[c].exports;var e=a[c]={i:c,l:!1,exports:{}};return d[c].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var a={};return b.m=d,b.c=a,b.d=function(a,d,n){b.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:n})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,d){if((1&d&&(a=b(a)),
8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(b.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)b.d(c,e,function(c){return a[c]}.bind(null,e));return c},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=275)}([function(d,b,a){(function(a){var c=function(a){return a&&
a.Math==Math&&a};d.exports=c("object"==typeof globalThis&&globalThis)||c("object"==typeof u&&u)||c("object"==typeof self&&self)||c("object"==typeof a&&a)||Function("return this")()}).call(this,a(170))},function(d,b,a){var c=a(0),e=a(37).f,n=a(16),g=a(17),m=a(101),p=a(135),l=a(106);d.exports=function(a,b){var d,t,v,f,z,h=a.target,q=a.global,r=a.stat;if(d=q?c:r?c[h]||m(h,{}):(c[h]||{}).prototype)for(t in b){if(f=b[t],v=a.noTargetGet?(z=e(d,t))&&z.value:d[t],!l(q?t:h+(r?".":"#")+t,a.forced)&&void 0!==
v){if(typeof f==typeof v)continue;p(f,v)}(a.sham||v&&v.sham)&&n(f,"sham",!0);g(d,t,f,a)}}},function(d,b){d.exports=function(a){try{return!!a()}catch(c){return!0}}},function(d,b,a){d=a(99);b=a(17);a=a(172);d||b(Object.prototype,"toString",a,{unsafe:!0})},function(d,b,a){b=a(0);var c=a(100),e=a(9),n=a(57),g=a(103);a=a(134);var m=c("wks"),p=b.Symbol,l=a?p:p&&p.withoutSetter||n;d.exports=function(a){return e(m,a)||(g&&e(p,a)?m[a]=p[a]:m[a]=l("Symbol."+a)),m[a]}},function(d,b){d.exports=function(a){return"object"==
typeof a?null!==a:"function"==typeof a}},function(d,b,a){d=a(1);b=a(7);d({target:"Object",stat:!0,forced:!b,sham:!b},{defineProperty:a(12).f})},function(d,b,a){b=a(2);d.exports=!b(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},,function(d,b){var a={}.hasOwnProperty;d.exports=function(c,b){return a.call(c,b)}},function(d,b,a){var c=a(5);d.exports=function(a){if(!c(a))throw TypeError(String(a)+" is not an object");return a}},function(d,b,a){var c=a(26);b=a(183);var e=
a(52),n=a(24);a=a(109);var g=n.set,m=n.getterFor("Array Iterator");d.exports=a(Array,"Array",function(a,b){g(this,{type:"Array Iterator",target:c(a),index:0,kind:b})},function(){var a=m(this),c=a.target,b=a.kind,d=a.index++;return!c||d>=c.length?(a.target=void 0,{value:void 0,done:!0}):"keys"==b?{value:d,done:!1}:"values"==b?{value:c[d],done:!1}:{value:[d,c[d]],done:!1}},"values");e.Arguments=e.Array;b("keys");b("values");b("entries")},function(d,b,a){d=a(7);var c=a(133),e=a(10),n=a(56),g=Object.defineProperty;
b.f=d?g:function(a,b,d){if(e(a),b=n(b,!0),e(d),c)try{return g(a,b,d)}catch(t){}if("get"in d||"set"in d)throw TypeError("Accessors not supported");return"value"in d&&(a[b]=d.value),a}},function(d,b,a){var c=a(40),e=Math.min;d.exports=function(a){return 0<a?e(c(a),9007199254740991):0}},function(d,b,a){var c,e,n;d=a(1);var g=a(35),m=a(0);b=a(27);var p=a(174),l=a(17),t=a(94),v=a(23),f=a(95),D=a(5),y=a(38),x=a(46),z=a(32),h=a(104),q=a(107),r=a(96),G=a(53),k=a(139).set,B=a(175),C=a(176),M=a(177),E=a(142),
K=a(178),u=a(24),X=a(106),Z=a(4),P=a(115),w=Z("species"),L=u.get,U=u.set,wa=u.getterFor("Promise"),I=p,Q=m.TypeError,H=m.document,ca=m.process,fa=b("fetch"),J=E.f,N=J,R="process"==z(ca),O=!!(H&&H.createEvent&&m.dispatchEvent);r=(a=X("Promise",function(){if(h(I)===String(I)&&(66===P||!R&&"function"!=typeof PromiseRejectionEvent)||g&&!I.prototype.finally)return!0;if(51<=P&&/native code/.test(I))return!1;var a=I.resolve(1),c=function(a){a(function(){},function(){})};return(a.constructor={})[w]=c,!(a.then(function(){})instanceof
c)}))||!r(function(a){I.all(a).catch(function(){})});var F=function(a){var c;return!(!D(a)||"function"!=typeof(c=a.then))&&c},ba=function(a,c,b){if(!c.notified){c.notified=!0;var d=c.reactions;B(function(){for(var e=c.value,h=1==c.state,g=0;d.length>g;){var k,q,m,r=d[g++],n=h?r.ok:r.fail,l=r.resolve,C=r.reject,p=r.domain;try{n?(h||(2===c.rejection&&da(a,c),c.rejection=1),!0===n?k=e:(p&&p.enter(),k=n(e),p&&(p.exit(),m=!0)),k===r.promise?C(Q("Promise-chain cycle")):(q=F(k))?q.call(k,l,C):l(k)):C(e)}catch(ea){p&&
!m&&p.exit(),C(ea)}}c.reactions=[];c.notified=!1;b&&!c.rejection&&V(a,c)})}},ra=function(a,c,b){var d,e;O?((d=H.createEvent("Event")).promise=c,d.reason=b,d.initEvent(a,!1,!0),m.dispatchEvent(d)):d={promise:c,reason:b};(e=m["on"+a])?e(d):"unhandledrejection"===a&&M("Unhandled promise rejection",b)},V=function(a,c){k.call(m,function(){var b,d=c.value;if(1!==c.rejection&&!c.parent&&(b=K(function(){R?ca.emit("unhandledRejection",d,a):ra("unhandledrejection",a,d)}),c.rejection=R||1!==c.rejection&&!c.parent?
2:1,b.error))throw b.value;})},da=function(a,c){k.call(m,function(){R?ca.emit("rejectionHandled",a):ra("rejectionhandled",a,c.value)})},Y=function(a,c,b,d){return function(e){a(c,b,e,d)}},W=function(a,c,b,d){c.done||(c.done=!0,d&&(c=d),c.value=b,c.state=2,ba(a,c,!0))},ia=function(a,c,b,d){if(!c.done){c.done=!0;d&&(c=d);try{if(a===b)throw Q("Promise can't be resolved itself");var e=F(b);e?B(function(){var d={done:!1};try{e.call(b,Y(ia,a,d,c),Y(W,a,d,c))}catch(ta){W(a,d,ta,c)}}):(c.value=b,c.state=
1,ba(a,c,!1))}catch(la){W(a,{done:!1},la,c)}}};a&&(I=function(a){x(this,I,"Promise");y(a);c.call(this);var b=L(this);try{a(Y(ia,this,b),Y(W,this,b))}catch(ka){W(this,b,ka)}},(c=function(a){U(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=t(I.prototype,{then:function(a,c){var b=wa(this),d=J(G(this,I));return d.ok="function"!=typeof a||a,d.fail="function"==typeof c&&c,d.domain=R?ca.domain:void 0,b.parent=!0,b.reactions.push(d),0!=b.state&&
ba(this,b,!1),d.promise},catch:function(a){return this.then(void 0,a)}}),e=function(){var a=new c,b=L(a);this.promise=a;this.resolve=Y(ia,a,b);this.reject=Y(W,a,b)},E.f=J=function(a){return a===I||a===ma?new e(a):N(a)},g||"function"!=typeof p||(n=p.prototype.then,l(p.prototype,"then",function(a,c){var b=this;return(new I(function(a,c){n.call(b,a,c)})).then(a,c)},{unsafe:!0}),"function"==typeof fa&&d({global:!0,enumerable:!0,forced:!0},{fetch:function(a){return C(I,fa.apply(m,arguments))}})));d({global:!0,
wrap:!0,forced:a},{Promise:I});v(I,"Promise",!1,!0);f("Promise");var ma=b("Promise");d({target:"Promise",stat:!0,forced:a},{reject:function(a){var c=J(this);return c.reject.call(void 0,a),c.promise}});d({target:"Promise",stat:!0,forced:g||a},{resolve:function(a){return C(g&&this===ma?I:this,a)}});d({target:"Promise",stat:!0,forced:r},{all:function(a){var c=this,b=J(c),d=b.resolve,e=b.reject,h=K(function(){var b=y(c.resolve),h=[],k=0,g=1;q(a,function(a){var q=k++,r=!1;h.push(void 0);g++;b.call(c,a).then(function(a){r||
(r=!0,h[q]=a,--g||d(h))},e)});--g||d(h)});return h.error&&e(h.value),b.promise},race:function(a){var c=this,b=J(c),d=b.reject,e=K(function(){var e=y(c.resolve);q(a,function(a){e.call(c,a).then(b.resolve,d)})});return e.error&&d(e.value),b.promise}})},function(d,b,a){(function(c){function b(a){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}
a(28);a(29);a(181);a(30);a(182);a(49);a(11);a(90);a(25);a(18);a(31);a(185);a(186);a(43);a(44);a(45);a(3);a(14);a(21);a(20);a(50);a(22);(function(a){function d(a,c,b,d){c=Object.create((c&&c.prototype instanceof n?c:n).prototype);d=new z(d||[]);return c._invoke=function(a,c,b){var d="suspendedStart";return function(h,k){if("executing"===d)throw Error("Generator is already running");if("completed"===d){if("throw"===h)throw k;return q()}b.method=h;for(b.arg=k;;){if(h=b.delegate)if(h=D(h,b)){if(h===K)continue;
return h}if("next"===b.method)b.sent=b._sent=b.arg;else if("throw"===b.method){if("suspendedStart"===d)throw d="completed",b.arg;b.dispatchException(b.arg)}else"return"===b.method&&b.abrupt("return",b.arg);d="executing";h=e(a,c,b);if("normal"===h.type){if(d=b.done?"completed":"suspendedYield",h.arg===K)continue;return{value:h.arg,done:b.done}}"throw"===h.type&&(d="completed",b.method="throw",b.arg=h.arg)}}}(a,b,d),c}function e(a,c,b){try{return{type:"normal",arg:a.call(c,b)}}catch(T){return{type:"throw",
arg:T}}}function n(){}function l(){}function t(){}function v(a){["next","throw","return"].forEach(function(c){a[c]=function(a){return this._invoke(c,a)}})}function f(a){var c;this._invoke=function(d,h){function k(){return new Promise(function(c,k){!function J(c,d,h,k){c=e(a[c],a,d);if("throw"!==c.type){var g=c.arg;return(c=g.value)&&"object"===b(c)&&G.call(c,"__await")?Promise.resolve(c.__await).then(function(a){J("next",a,h,k)},function(a){J("throw",a,h,k)}):Promise.resolve(c).then(function(a){g.value=
a;h(g)},function(a){return J("throw",a,h,k)})}k(c.arg)}(d,h,c,k)})}return c=c?c.then(k,k):k()}}function D(a,c){var b=a.iterator[c.method];if(void 0===b){if(c.delegate=null,"throw"===c.method){if(a.iterator.return&&(c.method="return",c.arg=void 0,D(a,c),"throw"===c.method))return K;c.method="throw";c.arg=new TypeError("The iterator does not provide a 'throw' method")}return K}b=e(b,a.iterator,c.arg);return"throw"===b.type?(c.method="throw",c.arg=b.arg,c.delegate=null,K):(b=b.arg)?b.done?(c[a.resultName]=
b.value,c.next=a.nextLoc,"return"!==c.method&&(c.method="next",c.arg=void 0),c.delegate=null,K):b:(c.method="throw",c.arg=new TypeError("iterator result is not an object"),c.delegate=null,K)}function y(a){var c={tryLoc:a[0]};1 in a&&(c.catchLoc=a[1]);2 in a&&(c.finallyLoc=a[2],c.afterLoc=a[3]);this.tryEntries.push(c)}function x(a){var c=a.completion||{};c.type="normal";delete c.arg;a.completion=c}function z(a){this.tryEntries=[{tryLoc:"root"}];a.forEach(y,this);this.reset(!0)}function h(a){if(a){var c=
a[B];if(c)return c.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var b=-1;c=function L(){for(;++b<a.length;)if(G.call(a,b))return L.value=a[b],L.done=!1,L;return L.value=void 0,L.done=!0,L};return c.next=c}}return{next:q}}function q(){return{value:void 0,done:!0}}var r=Object.prototype,G=r.hasOwnProperty,k="function"==typeof Symbol?Symbol:{},B=k.iterator||"@@iterator",C=k.asyncIterator||"@@asyncIterator",M=k.toStringTag||"@@toStringTag";k="object"===b(c);var E=a.regeneratorRuntime;
if(E)k&&(c.exports=E);else{(E=a.regeneratorRuntime=k?c.exports:{}).wrap=d;var K={};a={};a[B]=function(){return this};(k=(k=Object.getPrototypeOf)&&k(k(h([]))))&&k!==r&&G.call(k,B)&&(a=k);var u=t.prototype=n.prototype=Object.create(a);l.prototype=u.constructor=t;t.constructor=l;t[M]=l.displayName="GeneratorFunction";E.isGeneratorFunction=function(a){a="function"==typeof a&&a.constructor;return!!a&&(a===l||"GeneratorFunction"===(a.displayName||a.name))};E.mark=function(a){return Object.setPrototypeOf?
Object.setPrototypeOf(a,t):(a.__proto__=t,M in a||(a[M]="GeneratorFunction")),a.prototype=Object.create(u),a};E.awrap=function(a){return{__await:a}};v(f.prototype);f.prototype[C]=function(){return this};E.AsyncIterator=f;E.async=function(a,c,b,e){var h=new f(d(a,c,b,e));return E.isGeneratorFunction(c)?h:h.next().then(function(a){return a.done?a.value:h.next()})};v(u);u[M]="Generator";u[B]=function(){return this};u.toString=function(){return"[object Generator]"};E.keys=function(a){var c=[],b;for(b in a)c.push(b);
return c.reverse(),function L(){for(;c.length;){var b=c.pop();if(b in a)return L.value=b,L.done=!1,L}return L.done=!0,L}};E.values=h;z.prototype={constructor:z,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!a)for(var c in this)"t"===c.charAt(0)&&G.call(this,c)&&!isNaN(+c.slice(1))&&(this[c]=void 0)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if("throw"===a.type)throw a.arg;
return this.rval},dispatchException:function(a){function c(c,d){return h.type="throw",h.arg=a,b.next=c,d&&(b.method="next",b.arg=void 0),!!d}if(this.done)throw a;for(var b=this,d=this.tryEntries.length-1;0<=d;--d){var e=this.tryEntries[d],h=e.completion;if("root"===e.tryLoc)return c("end");if(e.tryLoc<=this.prev){var k=G.call(e,"catchLoc"),g=G.call(e,"finallyLoc");if(k&&g){if(this.prev<e.catchLoc)return c(e.catchLoc,!0);if(this.prev<e.finallyLoc)return c(e.finallyLoc)}else if(k){if(this.prev<e.catchLoc)return c(e.catchLoc,
!0)}else{if(!g)throw Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return c(e.finallyLoc)}}}},abrupt:function(a,c){for(var b=this.tryEntries.length-1;0<=b;--b){var d=this.tryEntries[b];if(d.tryLoc<=this.prev&&G.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=c&&c<=e.finallyLoc&&(e=null);b=e?e.completion:{};return b.type=a,b.arg=c,e?(this.method="next",this.next=e.finallyLoc,K):this.complete(b)},complete:function(a,
c){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&c&&(this.next=c),K},finish:function(a){for(var c=this.tryEntries.length-1;0<=c;--c){var b=this.tryEntries[c];if(b.finallyLoc===a)return this.complete(b.completion,b.afterLoc),x(b),K}},catch:function(a){for(var c=this.tryEntries.length-1;0<=c;--c){var b=this.tryEntries[c];if(b.tryLoc===a){a=b.completion;if("throw"===
a.type){var d=a.arg;x(b)}return d}}throw Error("illegal catch attempt");},delegateYield:function(a,c,b){return this.delegate={iterator:h(a),resultName:c,nextLoc:b},"next"===this.method&&(this.arg=void 0),K}}}})(function(){return this||"object"===("undefined"==typeof self?"undefined":b(self))&&self}()||Function("return this")())}).call(this,a(179)(d))},function(d,b,a){b=a(7);var c=a(12),e=a(39);d.exports=b?function(a,b,d){return c.f(a,b,e(1,d))}:function(a,c,b){return a[c]=b,a}},function(d,b,a){var c=
a(0),e=a(16),n=a(9),g=a(101),m=a(104);b=a(24);var p=b.get,l=b.enforce,t=String(String).split("String");(d.exports=function(a,b,d,m){var p=!!m&&!!m.unsafe,f=!!m&&!!m.enumerable;m=!!m&&!!m.noTargetGet;"function"==typeof d&&("string"!=typeof b||n(d,"name")||e(d,"name",b),l(d).source=t.join("string"==typeof b?b:""));a!==c?(p?!m&&a[b]&&(f=!0):delete a[b],f?a[b]=d:e(a,b,d)):f?a[b]=d:g(b,d)})(Function.prototype,"toString",function(){return"function"==typeof this&&p(this).source||m(this)})},function(d,b,
a){d=a(17);b=Date.prototype;var c=b.toString,e=b.getTime;"Invalid Date"!=new Date(NaN)+""&&d(b,"toString",function(){var a=e.call(this);return a==a?c.call(this):"Invalid Date"})},function(d,b,a){var c=a(36);d.exports=function(a){return Object(c(a))}},function(d,b,a){var c=a(119).charAt;d=a(24);a=a(109);var e=d.set,n=d.getterFor("String Iterator");a(String,"String",function(a){e(this,{type:"String Iterator",string:String(a),index:0})},function(){var a,b=n(this),d=b.string,e=b.index;return e>=d.length?
{value:void 0,done:!0}:(a=c(d,e),b.index+=a.length,{value:a,done:!1})})},function(d,b,a){d=a(17);var c=a(10);b=a(2);var e=a(156),n=RegExp.prototype,g=n.toString;a=b(function(){return"/a/b"!=g.call({source:"a",flags:"b"})});b="toString"!=g.name;(a||b)&&d(RegExp.prototype,"toString",function(){var a=c(this),b=a.flags;return"/"+String(a.source)+"/"+String(void 0===b&&a instanceof RegExp&&!("flags"in n)?e.call(a):b)},{unsafe:!0})},function(d,b,a){d=a(0);b=a(147);var c=a(11),e=a(16),n=a(4);a=n("iterator");
n=n("toStringTag");var g=c.values,m;for(m in b){var p=d[m];if(p=p&&p.prototype){if(p[a]!==g)try{e(p,a,g)}catch(t){p[a]=g}if(p[n]||e(p,n,m),b[m])for(var l in c)if(p[l]!==c[l])try{e(p,l,c[l])}catch(t){p[l]=c[l]}}}},function(d,b,a){var c=a(12).f,e=a(9),n=a(4)("toStringTag");d.exports=function(a,b,d){a&&!e(a=d?a:a.prototype,n)&&c(a,n,{configurable:!0,value:b})}},function(d,b,a){b=a(171);var c=a(0),e=a(5),n=a(16),g=a(9),m=a(86);a=a(51);c=c.WeakMap;if(b){var p=new c,l=p.get,t=p.has,f=p.set;var A=function(a,
c){return f.call(p,a,c),c};var D=function(a){return l.call(p,a)||{}};var y=function(a){return t.call(p,a)}}else{var x=m("state");a[x]=!0;A=function(a,c){return n(a,x,c),c};D=function(a){return g(a,x)?a[x]:{}};y=function(a){return g(a,x)}}d.exports={set:A,get:D,has:y,enforce:function(a){return y(a)?D(a):A(a,{})},getterFor:function(a){return function(c){var b;if(!e(c)||(b=D(c)).type!==a)throw TypeError("Incompatible receiver, "+a+" required");return b}}}},function(d,b,a){d=a(1);var c=a(5),e=a(48),n=
a(58),g=a(13),m=a(26),p=a(116);b=a(4);var l=a(155);a=a(60);l=l("slice");a=a("slice",{ACCESSORS:!0,0:0,1:2});var t=b("species"),f=[].slice,A=Math.max;d({target:"Array",proto:!0,forced:!l||!a},{slice:function(a,b){var d,l=m(this);var h=g(l.length);a=n(a,h);b=n(void 0===b?h:b,h);if(e(l)&&("function"!=typeof(d=l.constructor)||d!==Array&&!e(d.prototype)?c(d)&&null===(d=d[t])&&(d=void 0):d=void 0,d===Array||void 0===d))return f.call(l,a,b);d=new (void 0===d?Array:d)(A(b-a,0));for(h=0;a<b;a++,h++)a in l&&
p(d,h,l[a]);return d.length=h,d}})},function(d,b,a){var c=a(92),e=a(36);d.exports=function(a){return c(e(a))}},function(d,b,a){var c=a(136),e=a(0),n=function(a){return"function"==typeof a?a:void 0};d.exports=function(a,b){return 2>arguments.length?n(c[a])||n(e[a]):c[a]&&c[a][b]||e[a]&&e[a][b]}},function(d,b,a){d=a(1);var c=a(0),e=a(27);b=a(35);var n=a(7),g=a(103),m=a(134),p=a(2),l=a(9),f=a(48),v=a(5),A=a(10),D=a(19),y=a(26),x=a(56),z=a(39),h=a(33),q=a(97),r=a(59),G=a(180),k=a(113),B=a(37),C=a(12),
M=a(112),E=a(16),u=a(17),w=a(100),X=a(86),Z=a(51),F=a(57),T=a(4),L=a(143),U=a(89),wa=a(23),I=a(24),Q=a(34).forEach,H=X("hidden");a=T("toPrimitive");var ca=I.set,fa=I.getterFor("Symbol"),J=Object.prototype,N=c.Symbol,R=e("JSON","stringify"),O=B.f,aa=C.f,ba=G.f,ra=M.f,V=w("symbols"),da=w("op-symbols"),Y=w("string-to-symbol-registry"),W=w("symbol-to-string-registry");e=w("wks");c=c.QObject;var ia=!c||!c.prototype||!c.prototype.findChild,ma=n&&p(function(){return 7!=h(aa({},"a",{get:function(){return aa(this,
"a",{value:7}).a}})).a})?function(a,c,b){var d=O(J,c);d&&delete J[c];aa(a,c,b);d&&a!==J&&aa(J,c,d)}:aa,oa=function(a,c){var b=V[a]=h(N.prototype);return ca(b,{type:"Symbol",tag:a,description:c}),n||(b.description=c),b},S=m?function(a){return"symbol"==typeof a}:function(a){return Object(a)instanceof N},ka=function(a,c,b){a===J&&ka(da,c,b);A(a);c=x(c,!0);return A(b),l(V,c)?(b.enumerable?(l(a,H)&&a[H][c]&&(a[H][c]=!1),b=h(b,{enumerable:z(0,!1)})):(l(a,H)||aa(a,H,z(1,{})),a[H][c]=!0),ma(a,c,b)):aa(a,
c,b)},pa=function(a,c){A(a);var b=y(c);c=q(b).concat(la(b));return Q(c,function(c){n&&!na.call(b,c)||ka(a,c,b[c])}),a},na=function(a){a=x(a,!0);var c=ra.call(this,a);return!(this===J&&l(V,a)&&!l(da,a))&&(!(c||!l(this,a)||!l(V,a)||l(this,H)&&this[H][a])||c)};m=function(a,c){a=y(a);c=x(c,!0);if(a!==J||!l(V,c)||l(da,c)){var b=O(a,c);return!b||!l(V,c)||l(a,H)&&a[H][c]||(b.enumerable=!0),b}};c=function(a){a=ba(y(a));var c=[];return Q(a,function(a){l(V,a)||l(Z,a)||c.push(a)}),c};var la=function(a){var c=
a===J;a=ba(c?da:y(a));var b=[];return Q(a,function(a){!l(V,a)||c&&!l(J,a)||b.push(V[a])}),b};(g||(u((N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor");var a=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,c=F(a),b=function(a){this===J&&b.call(da,a);l(this,H)&&l(this[H],c)&&(this[H][c]=!1);ma(this,c,z(1,a))};return n&&ia&&ma(J,c,{configurable:!0,set:b}),oa(c,a)}).prototype,"toString",function(){return fa(this).tag}),u(N,"withoutSetter",function(a){return oa(F(a),
a)}),M.f=na,C.f=ka,B.f=m,r.f=G.f=c,k.f=la,L.f=function(a){return oa(T(a),a)},n&&(aa(N.prototype,"description",{configurable:!0,get:function(){return fa(this).description}}),b||u(J,"propertyIsEnumerable",na,{unsafe:!0}))),d({global:!0,wrap:!0,forced:!g,sham:!g},{Symbol:N}),Q(q(e),function(a){U(a)}),d({target:"Symbol",stat:!0,forced:!g},{for:function(a){a=String(a);if(l(Y,a))return Y[a];var c=N(a);return Y[a]=c,W[c]=a,c},keyFor:function(a){if(!S(a))throw TypeError(a+" is not a symbol");if(l(W,a))return W[a]},
useSetter:function(){ia=!0},useSimple:function(){ia=!1}}),d({target:"Object",stat:!0,forced:!g,sham:!n},{create:function(a,c){return void 0===c?h(a):pa(h(a),c)},defineProperty:ka,defineProperties:pa,getOwnPropertyDescriptor:m}),d({target:"Object",stat:!0,forced:!g},{getOwnPropertyNames:c,getOwnPropertySymbols:la}),d({target:"Object",stat:!0,forced:p(function(){k.f(1)})},{getOwnPropertySymbols:function(a){return k.f(D(a))}}),R)&&d({target:"JSON",stat:!0,forced:!g||p(function(){var a=N();return"[null]"!=
R([a])||"{}"!=R({a:a})||"{}"!=R(Object(a))})},{stringify:function(a,c,b){for(var d,e=[a],h=1;arguments.length>h;)e.push(arguments[h++]);if(d=c,(v(c)||void 0!==a)&&!S(a))return f(c)||(c=function(a,c){if("function"==typeof d&&(c=d.call(this,a,c)),!S(c))return c}),e[1]=c,R.apply(null,e)}});N.prototype[a]||E(N.prototype,a,N.prototype.valueOf);wa(N,"Symbol");Z[H]=!0},function(d,b,a){d=a(1);var c=a(7),e=a(0),n=a(9),g=a(5);b=a(12).f;a=a(135);var m=e.Symbol;if(c&&"function"==typeof m&&!("description"in m.prototype&&
void 0===m().description)){var p={},l=function(){var a=1>arguments.length||void 0===arguments[0]?void 0:String(arguments[0]),c=this instanceof l?new m(a):void 0===a?m():m(a);return""===a&&(p[c]=!0),c};a(l,m);a=l.prototype=m.prototype;a.constructor=l;var f=a.toString,v="Symbol(test)"==String(m("test")),A=/^Symbol\((.*)\)[^)]+$/;b(a,"description",{configurable:!0,get:function(){var a=g(this)?this.valueOf():this,c=f.call(a);if(n(p,a))return"";a=v?c.slice(7,-1):c.replace(A,"$1");return""===a?void 0:a}});
d({global:!0,forced:!0},{Symbol:l})}},function(d,b,a){a(89)("iterator")},function(d,b,a){d=a(7);a=a(12).f;b=Function.prototype;var c=b.toString,e=/^\s*function ([^ (]*)/;!d||"name"in b||a(b,"name",{configurable:!0,get:function(){try{return c.call(this).match(e)[1]}catch(n){return""}}})},function(d,b){var a={}.toString;d.exports=function(c){return a.call(c).slice(8,-1)}},function(d,b,a){var c,e=a(10),n=a(152),g=a(105);b=a(51);var m=a(140),p=a(102),l=a(86)("IE_PROTO"),f=function(){},v=function(){try{c=
document.domain&&new ActiveXObject("htmlfile")}catch(x){}var a;if(c){var b=c;b.write("\x3cscript\x3e\x3c/script\x3e");b.close();var d=b.parentWindow.Object}else d=((a=p("iframe")).style.display="none",m.appendChild(a),a.src="javascript:",(b=a.contentWindow.document).open(),b.write("\x3cscript\x3edocument.F\x3dObject\x3c/script\x3e"),b.close(),b.F);v=d;for(b=g.length;b--;)delete v.prototype[g[b]];return v()};b[l]=!0;d.exports=Object.create||function(a,c){var b;return null!==a?(f.prototype=e(a),b=new f,
f.prototype=null,b[l]=a):b=v(),void 0===c?b:n(b,c)}},function(d,b,a){var c=a(41),e=a(92),n=a(19),g=a(13),m=a(153),p=[].push;b=function(a){var b=1==a,d=2==a,l=3==a,f=4==a,y=6==a,x=5==a||y;return function(t,h,q,r){var v,k,B=n(t),C=e(B);h=c(h,q,3);q=g(C.length);var A=0;r=r||m;for(t=b?r(t,q):d?r(t,0):void 0;q>A;A++)if((x||A in C)&&(k=h(v=C[A],A,B),a))if(b)t[A]=k;else if(k)switch(a){case 3:return!0;case 5:return v;case 6:return A;case 2:p.call(t,v)}else if(f)return!1;return y?-1:l||f?f:t}};d.exports={forEach:b(0),
map:b(1),filter:b(2),some:b(3),every:b(4),find:b(5),findIndex:b(6)}},function(d,b){d.exports=!1},function(d,b){d.exports=function(a){if(null==a)throw TypeError("Can't call method on "+a);return a}},function(d,b,a){d=a(7);var c=a(112),e=a(39),n=a(26),g=a(56),m=a(9),p=a(133),l=Object.getOwnPropertyDescriptor;b.f=d?l:function(a,b){if(a=n(a),b=g(b,!0),p)try{return l(a,b)}catch(A){}if(m(a,b))return e(!c.f.call(a,b),a[b])}},function(d,b){d.exports=function(a){if("function"!=typeof a)throw TypeError(String(a)+
" is not a function");return a}},function(d,b){d.exports=function(a,c){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:c}}},function(d,b){var a=Math.ceil,c=Math.floor;d.exports=function(b){return isNaN(b=+b)?0:(0<b?c:a)(b)}},function(d,b,a){var c=a(38);d.exports=function(a,b,d){if(c(a),void 0===b)return a;switch(d){case 0:return function(){return a.call(b)};case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,
e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},,function(d,b,a){a(1)({target:"Object",stat:!0,sham:!a(7)},{create:a(33)})},function(d,b,a){d=a(1);b=a(2);var c=a(19),e=a(61);a=a(146);d({target:"Object",stat:!0,forced:b(function(){e(1)}),sham:!a},{getPrototypeOf:function(a){return e(c(a))}})},function(d,b,a){a(1)({target:"Object",stat:!0},{setPrototypeOf:a(54)})},function(d,b){d.exports=function(a,c,b){if(!(a instanceof c))throw TypeError("Incorrect "+(b?b+" ":"")+"invocation");
return a}},,function(d,b,a){var c=a(32);d.exports=Array.isArray||function(a){return"Array"==c(a)}},function(d,b,a){d=a(1);a=a(144);d({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},function(d,b,a){d=a(0);var c=a(147);b=a(144);a=a(16);for(var e in c)if((c=(c=d[e])&&c.prototype)&&c.forEach!==b)try{a(c,"forEach",b)}catch(n){c.forEach=b}},function(d,b){d.exports={}},function(d,b){d.exports={}},function(d,b,a){var c=a(10),e=a(38),n=a(4)("species");d.exports=function(a,b){var d;a=c(a).constructor;
return void 0===a||null==(d=c(a)[n])?b:e(d)}},function(d,b,a){var c=a(10),e=a(184);d.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a,b=!1,d={};try{(a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(d,[]),b=d instanceof Array}catch(p){}return function(d,g){return c(d),e(g),b?a.call(d,g):d.__proto__=g,d}}():void 0)},function(d,b,a){d=a(1);b=a(27);var c=a(38),e=a(10),n=a(5),g=a(33),m=a(150);a=a(2);var p=b("Reflect","construct"),l=a(function(){function a(){}return!(p(function(){},
[],a)instanceof a)}),f=!a(function(){p(function(){})});a=l||f;d({target:"Reflect",stat:!0,forced:a,sham:a},{construct:function(a,b){c(a);e(b);var d=3>arguments.length?a:c(arguments[2]);if(f&&!l)return p(a,b,d);if(a==d){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3])}d=[null];return d.push.apply(d,b),new (m.apply(a,d))}d=d.prototype;d=g(n(d)?d:Object.prototype);var t=Function.apply.call(a,
d,b);return n(t)?t:d}})},function(d,b,a){var c=a(5);d.exports=function(a,b){if(!c(a))return a;var d,e;if(b&&"function"==typeof(d=a.toString)&&!c(e=d.call(a))||"function"==typeof(d=a.valueOf)&&!c(e=d.call(a))||!b&&"function"==typeof(d=a.toString)&&!c(e=d.call(a)))return e;throw TypeError("Can't convert object to primitive value");}},function(d,b){var a=0,c=Math.random();d.exports=function(b){return"Symbol("+String(void 0===b?"":b)+")_"+(++a+c).toString(36)}},function(d,b,a){var c=a(40),e=Math.max,
n=Math.min;d.exports=function(a,b){a=c(a);return 0>a?e(a+b,0):n(a,b)}},function(d,b,a){var c=a(137),e=a(105).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(a){return c(a,e)}},function(d,b,a){var c=a(7),e=a(2),n=a(9),g=Object.defineProperty,m={},f=function(a){throw a;};d.exports=function(a,b){if(n(m,a))return m[a];b||(b={});var d=[][a],l=!!n(b,"ACCESSORS")&&b.ACCESSORS,p=n(b,0)?b[0]:f,t=n(b,1)?b[1]:void 0;return m[a]=!!d&&!e(function(){if(l&&!c)return!0;var a={length:-1};l?g(a,
1,{enumerable:!0,get:f}):a[1]=1;d.call(a,p,t)})}},function(d,b,a){var c=a(9),e=a(19);b=a(86);a=a(146);var n=b("IE_PROTO"),g=Object.prototype;d.exports=a?Object.getPrototypeOf:function(a){return a=e(a),c(a,n)?a[n]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?g:null}},,,,,,,,,,,,,,,,,,,,,,,,,function(d,b,a){b=a(100);var c=a(57),e=b("keys");d.exports=function(a){return e[a]||(e[a]=c(a))}},function(d,b,a){b=a(99);var c=a(32),e=a(4)("toStringTag"),
n="Arguments"==c(function(){return arguments}());d.exports=b?c:function(a){var b;if(void 0===a)var d="Undefined";else{if(null===a)var g="Null";else{a:{var f=a=Object(a);try{g=f[e];break a}catch(v){}g=void 0}g="string"==typeof(d=g)?d:n?c(a):"Object"==(b=c(a))&&"function"==typeof a.callee?"Arguments":b}d=g}return d}},function(d,b,a){var c=a(87),e=a(52),n=a(4)("iterator");d.exports=function(a){if(null!=a)return a[n]||a["@@iterator"]||e[c(a)]}},function(d,b,a){var c=a(136),e=a(9),n=a(143),g=a(12).f;d.exports=
function(a){var b=c.Symbol||(c.Symbol={});e(b,a)||g(b,a,{value:n.f(a)})}},function(d,b,a){d=a(1);var c=a(48),e=[].reverse;a=[1,2];d({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return c(this)&&(this.length=this.length),e.call(this)}})},,function(d,b,a){b=a(2);var c=a(32),e="".split;d.exports=b(function(){return!Object("z").propertyIsEnumerable(0)})?function(a){return"String"==c(a)?e.call(a,""):Object(a)}:Object},function(d,b,a){var c=a(26),e=a(13),n=a(58);b=
function(a){return function(b,d,g){var l;b=c(b);var m=e(b.length);g=n(g,m);if(a&&d!=d)for(;m>g;){if((l=b[g++])!=l)return!0}else for(;m>g;g++)if((a||g in b)&&b[g]===d)return a||g||0;return!a&&-1}};d.exports={includes:b(!0),indexOf:b(!1)}},function(d,b,a){var c=a(17);d.exports=function(a,b,d){for(var e in b)c(a,e,b[e],d);return a}},function(d,b,a){var c=a(27),e=a(12);b=a(4);var n=a(7),g=b("species");d.exports=function(a){a=c(a);var b=e.f;n&&a&&!a[g]&&b(a,g,{configurable:!0,get:function(){return this}})}},
function(d,b,a){var c=a(4)("iterator"),e=!1;try{var n=0;b={next:function(){return{done:!!n++}},return:function(){e=!0}};b[c]=function(){return this};Array.from(b,function(){throw 2;})}catch(g){}d.exports=function(a,b){if(!b&&!e)return!1;var d=!1;try{b={},b[c]=function(){return{next:function(){return{done:d=!0}}}},a(b)}catch(l){}return d}},function(d,b,a){var c=a(137),e=a(105);d.exports=Object.keys||function(a){return c(a,e)}},function(d,b,a){var c=a(2);d.exports=function(a,b){var d=[][a];return!!d&&
c(function(){d.call(null,b||function(){throw 1;},1)})}},function(d,b,a){b={};b[a(4)("toStringTag")]="z";d.exports="[object z]"===String(b)},function(d,b,a){b=a(35);var c=a(132);(d.exports=function(a,b){return c[a]||(c[a]=void 0!==b?b:{})})("versions",[]).push({version:"3.6.5",mode:b?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(d,b,a){var c=a(0),e=a(16);d.exports=function(a,b){try{e(c,a,b)}catch(m){c[a]=b}return b}},function(d,b,a){b=a(0);a=a(5);var c=b.document,e=a(c)&&
a(c.createElement);d.exports=function(a){return e?c.createElement(a):{}}},function(d,b,a){b=a(2);d.exports=!!Object.getOwnPropertySymbols&&!b(function(){return!String(Symbol())})},function(d,b,a){b=a(132);var c=Function.toString;"function"!=typeof b.inspectSource&&(b.inspectSource=function(a){return c.call(a)});d.exports=b.inspectSource},function(d,b){d.exports="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ")},function(d,b,a){var c=a(2),e=
/#|\.prototype\./;b=function(a,b){a=g[n(a)];return a==f||a!=m&&("function"==typeof b?c(b):!!b)};var n=b.normalize=function(a){return String(a).replace(e,".").toLowerCase()},g=b.data={},m=b.NATIVE="N",f=b.POLYFILL="P";d.exports=b},function(d,b,a){var c=a(10),e=a(114),f=a(13),g=a(41),m=a(88),p=a(138),l=function(a,c){this.stopped=a;this.result=c};(d.exports=function(a,b,d,n,y){var t,v;b=g(b,d,n?2:1);if(!y){if("function"!=typeof(y=m(a)))throw TypeError("Target is not iterable");if(e(y)){y=0;for(d=f(a.length);d>
y;y++)if((t=n?b(c(v=a[y])[0],v[1]):b(a[y]))&&t instanceof l)return t;return new l(!1)}a=y.call(a)}for(y=a.next;!(v=y.call(a)).done;)if("object"==typeof(t=p(a,b,v.value,n))&&t&&t instanceof l)return t;return new l(!1)}).stop=function(a){return new l(!0,a)}},function(d,b,a){b=a(27);d.exports=b("navigator","userAgent")||""},function(d,b,a){var c=a(1),e=a(154),f=a(61),g=a(54),m=a(23),p=a(16),l=a(17);b=a(4);var t=a(35),v=a(52);a=a(145);var A=a.IteratorPrototype,D=a.BUGGY_SAFARI_ITERATORS,y=b("iterator"),
x=function(){return this};d.exports=function(a,b,d,r,n,k,B){e(d,b,r);var h,q,G;r=function(a){if(a===n&&P)return P;if(!D&&a in w)return w[a];switch(a){case "keys":case "values":case "entries":return function(){return new d(this,a)}}return function(){return new d(this)}};var z=b+" Iterator",u=!1,w=a.prototype,F=w[y]||w["@@iterator"]||n&&w[n],P=!D&&F||r(n),T="Array"==b&&w.entries||F;if(T&&(h=f(T.call(new a)),A!==Object.prototype&&h.next&&(t||f(h)===A||(g?g(h,A):"function"!=typeof h[y]&&p(h,y,x)),m(h,
z,!0,!0),t&&(v[z]=x))),"values"==n&&F&&"values"!==F.name&&(u=!0,P=function(){return F.call(this)}),t&&!B||w[y]===P||p(w,y,P),v[b]=P,n)if(q={values:r("values"),keys:k?P:r("keys"),entries:r("entries")},B)for(G in q)!D&&!u&&G in w||l(w,G,q[G]);else c({target:b,proto:!0,forced:D||u},q);return q}},,,function(d,b,a){d={}.propertyIsEnumerable;var c=Object.getOwnPropertyDescriptor;a=c&&!d.call({1:2},1);b.f=a?function(a){a=c(this,a);return!!a&&a.enumerable}:d},function(d,b){b.f=Object.getOwnPropertySymbols},
function(d,b,a){b=a(4);var c=a(52),e=b("iterator"),f=Array.prototype;d.exports=function(a){return void 0!==a&&(c.Array===a||f[e]===a)}},function(d,b,a){var c,e;b=a(0);a=a(108);(b=(b=(b=b.process)&&b.versions)&&b.v8)?e=(c=b.split("."))[0]+c[1]:a&&(!(c=a.match(/Edge\/(\d+)/))||74<=c[1])&&(c=a.match(/Chrome\/(\d+)/))&&(e=c[1]);d.exports=e&&+e},function(d,b,a){var c=a(56),e=a(12),f=a(39);d.exports=function(a,b,d){b=c(b);b in a?e.f(a,b,f(0,d)):a[b]=d}},function(d,b,a){b=a(157);a=a(159);d.exports=b("Map",
function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},a)},,function(d,b,a){var c=a(40),e=a(36);b=function(a){return function(b,d){var g,l;b=String(e(b));d=c(d);var f=b.length;return 0>d||d>=f?a?"":void 0:55296>(g=b.charCodeAt(d))||56319<g||d+1===f||56320>(l=b.charCodeAt(d+1))||57343<l?a?b.charAt(d):g:a?b.slice(d,d+2):l-56320+(g-55296<<10)+65536}};d.exports={codeAt:b(!1),charAt:b(!0)}},function(d,b,a){a(1)({target:"Function",proto:!0},{bind:a(150)})},,,,,,,,,,,,function(d,
b,a){b=a(0);a=a(101);a=b["__core-js_shared__"]||a("__core-js_shared__",{});d.exports=a},function(d,b,a){b=a(7);var c=a(2),e=a(102);d.exports=!b&&!c(function(){return 7!=Object.defineProperty(e("div"),"a",{get:function(){return 7}}).a})},function(d,b,a){b=a(103);d.exports=b&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(d,b,a){var c=a(9),e=a(173),f=a(37),g=a(12);d.exports=function(a,b){for(var d=e(b),n=g.f,m=f.f,p=0;p<d.length;p++){var D=d[p];c(a,D)||n(a,D,m(b,D))}}},function(d,b,a){b=a(0);
d.exports=b},function(d,b,a){var c=a(9),e=a(26),f=a(93).indexOf,g=a(51);d.exports=function(a,b){var d;a=e(a);var n=0,m=[];for(d in a)!c(g,d)&&c(a,d)&&m.push(d);for(;b.length>n;)c(a,d=b[n++])&&(~f(m,d)||m.push(d));return m}},function(d,b,a){var c=a(10);d.exports=function(a,b,d,f){try{return f?b(c(d)[0],d[1]):b(d)}catch(p){throw b=a.return,void 0!==b&&c(b.call(a)),p;}}},function(d,b,a){var c,e,f,g=a(0);b=a(2);var m=a(32),p=a(41),l=a(140),t=a(102);a=a(141);var v=g.location,A=g.setImmediate,D=g.clearImmediate,
y=g.process,x=g.MessageChannel,z=g.Dispatch,h=0,q={},r=function(a){if(q.hasOwnProperty(a)){var c=q[a];delete q[a];c()}},G=function(a){return function(){r(a)}},k=function(a){r(a.data)},B=function(a){g.postMessage(a+"",v.protocol+"//"+v.host)};A&&D||(A=function(a){for(var b=[],d=1;arguments.length>d;)b.push(arguments[d++]);return q[++h]=function(){("function"==typeof a?a:Function(a)).apply(void 0,b)},c(h),h},D=function(a){delete q[a]},"process"==m(y)?c=function(a){y.nextTick(G(a))}:z&&z.now?c=function(a){z.now(G(a))}:
x&&!a?(f=(e=new x).port2,e.port1.onmessage=k,c=p(f.postMessage,f,1)):!g.addEventListener||"function"!=typeof postMessage||g.importScripts||b(B)||"file:"===v.protocol?c="onreadystatechange"in t("script")?function(a){l.appendChild(t("script")).onreadystatechange=function(){l.removeChild(this);r(a)}}:function(a){setTimeout(G(a),0)}:(c=B,g.addEventListener("message",k,!1)));d.exports={set:A,clear:D}},function(d,b,a){b=a(27);d.exports=b("document","documentElement")},function(d,b,a){b=a(108);d.exports=
/(iphone|ipod|ipad).*applewebkit/i.test(b)},function(d,b,a){var c=a(38),e=function(a){var b,d;this.promise=new a(function(a,c){if(void 0!==b||void 0!==d)throw TypeError("Bad Promise constructor");b=a;d=c});this.resolve=c(b);this.reject=c(d)};d.exports.f=function(a){return new e(a)}},function(d,b,a){d=a(4);b.f=d},function(d,b,a){var c=a(34).forEach;b=a(98);a=a(60);b=b("forEach");a=a("forEach");d.exports=b&&a?[].forEach:function(a){return c(this,a,1<arguments.length?arguments[1]:void 0)}},function(d,
b,a){var c,e,f;b=a(61);var g=a(16),m=a(9),p=a(4);a=a(35);p=p("iterator");var l=!1;[].keys&&("next"in(f=[].keys())?(e=b(b(f)))!==Object.prototype&&(c=e):l=!0);null==c&&(c={});a||m(c,p)||g(c,p,function(){return this});d.exports={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:l}},function(d,b,a){b=a(2);d.exports=!b(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype})},function(d,b){d.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,
DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(d,b,a){b=a(51);var c=a(5),e=a(9),f=a(12).f,g=a(57),m=a(188),
p=g("meta"),l=0,t=Object.isExtensible||function(){return!0},v=function(a){f(a,p,{value:{objectID:"O"+ ++l,weakData:{}}})},A=d.exports={REQUIRED:!1,fastKey:function(a,b){if(!c(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!e(a,p)){if(!t(a))return"F";if(!b)return"E";v(a)}return a[p].objectID},getWeakData:function(a,c){if(!e(a,p)){if(!t(a))return!0;if(!c)return!1;v(a)}return a[p].weakData},onFreeze:function(a){return m&&A.REQUIRED&&t(a)&&!e(a,p)&&v(a),a}};b[p]=!0},,function(d,b,a){var c=
a(38),e=a(5),f=[].slice,g={};d.exports=Function.bind||function(a){var b=c(this),d=f.call(arguments,1),n=function(){var c=d.concat(f.call(arguments));if(this instanceof n){var e=c.length;if(!(e in g)){for(var l=[],m=0;m<e;m++)l[m]="a["+m+"]";g[e]=Function("C,a","return new C("+l.join(",")+")")}c=g[e](b,c)}else c=b.apply(a,c);return c};return e(b.prototype)&&(n.prototype=b.prototype),n}},,function(d,b,a){b=a(7);var c=a(12),e=a(10),f=a(97);d.exports=b?Object.defineProperties:function(a,b){e(a);for(var d,
g=f(b),n=g.length,m=0;n>m;)c.f(a,d=g[m++],b[d]);return a}},function(d,b,a){var c=a(5),e=a(48),f=a(4)("species");d.exports=function(a,b){var d;return e(a)&&("function"!=typeof(d=a.constructor)||d!==Array&&!e(d.prototype)?c(d)&&null===(d=d[f])&&(d=void 0):d=void 0),new (void 0===d?Array:d)(0===b?0:b)}},function(d,b,a){var c=a(145).IteratorPrototype,e=a(33),f=a(39),g=a(23),m=a(52),p=function(){return this};d.exports=function(a,b,d){b+=" Iterator";return a.prototype=e(c,{next:f(1,d)}),g(a,b,!1,!0),m[b]=
p,a}},function(d,b,a){var c=a(2);b=a(4);var e=a(115),f=b("species");d.exports=function(a){return 51<=e||!c(function(){var c=[];return(c.constructor={})[f]=function(){return{foo:1}},1!==c[a](Boolean).foo})}},function(d,b,a){var c=a(10);d.exports=function(){var a=c(this),b="";return a.global&&(b+="g"),a.ignoreCase&&(b+="i"),a.multiline&&(b+="m"),a.dotAll&&(b+="s"),a.unicode&&(b+="u"),a.sticky&&(b+="y"),b}},function(d,b,a){var c=a(1),e=a(0),f=a(106),g=a(17),m=a(148),p=a(107),l=a(46),t=a(5),v=a(2),A=
a(96),D=a(23),y=a(158);d.exports=function(a,b,d){var h=-1!==a.indexOf("Map"),r=-1!==a.indexOf("Weak"),n=h?"set":"add",k=e[a],B=k&&k.prototype,C=k,x={},E=function(a){var c=B[a];g(B,a,"add"==a?function(a){return c.call(this,0===a?0:a),this}:"delete"==a?function(a){return!(r&&!t(a))&&c.call(this,0===a?0:a)}:"get"==a?function(a){return r&&!t(a)?void 0:c.call(this,0===a?0:a)}:"has"==a?function(a){return!(r&&!t(a))&&c.call(this,0===a?0:a)}:function(a,b){return c.call(this,0===a?0:a,b),this})};if(f(a,"function"!=
typeof k||!(r||B.forEach&&!v(function(){(new k).entries().next()}))))C=d.getConstructor(b,a,h,n),m.REQUIRED=!0;else if(f(a,!0)){var z=new C,u=z[n](r?{}:-0,1)!=z,w=v(function(){z.has(1)}),F=A(function(a){new k(a)}),P=!r&&v(function(){for(var a=new k,c=5;c--;)a[n](c,c);return!a.has(-0)});F||((C=b(function(c,b){l(c,C,a);c=y(new k,c,C);return null!=b&&p(b,c[n],c,h),c})).prototype=B,B.constructor=C);(w||P)&&(E("delete"),E("has"),h&&E("get"));(P||u)&&E(n);r&&B.clear&&delete B.clear}return x[a]=C,c({global:!0,
forced:C!=k},x),D(C,a),r||d.setStrong(C,a,h),C}},function(d,b,a){var c=a(5),e=a(54);d.exports=function(a,b,d){var f,g;return e&&"function"==typeof(f=b.constructor)&&f!==d&&c(g=f.prototype)&&g!==d.prototype&&e(a,g),a}},function(d,b,a){var c=a(12).f,e=a(33),f=a(94),g=a(41),m=a(46),p=a(107),l=a(109),t=a(95),v=a(7),A=a(148).fastKey;b=a(24);var D=b.set,y=b.getterFor;d.exports={getConstructor:function(a,b,d,q){var h=a(function(a,c){m(a,h,b);D(a,{type:b,index:e(null),first:void 0,last:void 0,size:0});v||
(a.size=0);null!=c&&p(c,a[q],a,d)}),l=y(b),k=function(a,c,b){var d,e,h=l(a),k=B(a,c);return k?k.value=b:(h.last=k={index:e=A(c,!0),key:c,value:b,previous:d=h.last,next:void 0,removed:!1},h.first||(h.first=k),d&&(d.next=k),v?h.size++:a.size++,"F"!==e&&(h.index[e]=k)),a},B=function(a,c){a=l(a);var b=A(c);if("F"!==b)return a.index[b];for(a=a.first;a;a=a.next)if(a.key==c)return a};return f(h.prototype,{clear:function(){for(var a=l(this),c=a.index,b=a.first;b;)b.removed=!0,b.previous&&(b.previous=b.previous.next=
void 0),delete c[b.index],b=b.next;a.first=a.last=void 0;v?a.size=0:this.size=0},delete:function(a){var c=l(this);if(a=B(this,a)){var b=a.next,d=a.previous;delete c.index[a.index];a.removed=!0;d&&(d.next=b);b&&(b.previous=d);c.first==a&&(c.first=b);c.last==a&&(c.last=d);v?c.size--:this.size--}return!!a},forEach:function(a){for(var c,b=l(this),d=g(a,1<arguments.length?arguments[1]:void 0,3);c=c?c.next:b.first;)for(d(c.value,c.key,this);c&&c.removed;)c=c.previous},has:function(a){return!!B(this,a)}}),
f(h.prototype,d?{get:function(a){return(a=B(this,a))&&a.value},set:function(a,c){return k(this,0===a?0:a,c)}}:{add:function(a){return k(this,a=0===a?0:a,a)}}),v&&c(h.prototype,"size",{get:function(){return l(this).size}}),h},setStrong:function(a,c,b){var d=c+" Iterator",e=y(c),h=y(d);l(a,c,function(a,c){D(this,{type:d,target:a,state:e(a),kind:c,last:void 0})},function(){for(var a=h(this),c=a.kind,b=a.last;b&&b.removed;)b=b.previous;return a.target&&(a.last=b=b?b.next:a.state.first)?"keys"==c?{value:b.key,
done:!1}:"values"==c?{value:b.value,done:!1}:{value:[b.key,b.value],done:!1}:(a.target=void 0,{value:void 0,done:!0})},b?"entries":"values",!b,!0);t(c)}}},,function(d,b,a){d=a(1);var c=a(93).indexOf;b=a(98);a=a(60);var e=[].indexOf,f=!!e&&0>1/[1].indexOf(1,-0);b=b("indexOf");a=a("indexOf",{ACCESSORS:!0,1:0});d({target:"Array",proto:!0,forced:f||!b||!a},{indexOf:function(a){return f?e.apply(this,arguments)||0:c(this,a,1<arguments.length?arguments[1]:void 0)}})},function(d,b,a){a(1)({target:"Date",
stat:!0},{now:function(){return(new Date).getTime()}})},,,,,function(d,b,a){var c=a(41),e=a(19),f=a(138),g=a(114),m=a(13),p=a(116),l=a(88);d.exports=function(a){var b=e(a);var d="function"==typeof this?this:Array;var n=arguments.length;var t=1<n?arguments[1]:void 0,x=void 0!==t;var z=l(b);var h=0;if(x&&(t=c(t,2<n?arguments[2]:void 0,2)),null==z||d==Array&&g(z))for(d=new d(n=m(b.length));n>h;h++)z=x?t(b[h],h):b[h],p(d,h,z);else for(n=(b=z.call(b)).next,d=new d;!(z=n.call(b)).done;h++)z=x?f(b,t,[z.value,
h],!0):z.value,p(d,h,z);return d.length=h,d}},function(d,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.AuthenticationStatusType=void 0;b.AuthenticationStatusType=void 0;d=b.AuthenticationStatusType={};d.InitializationSuccess="InitializationSuccess";d.AuthenticationSuccess="AuthenticationSuccess";d.AuthenticationFailure="AuthenticationFailure";d.ValidationError="ValidationError";d.FallbackRequiredError="FallbackRequiredError";d.SystemError="SystemError";d.ChallengeScreenRendered="ChallengeScreenRendered";
d.SdkAck="SdkAck";d.success="success";d.failure="failure"},,function(d,b){b=function(){return this}();try{b=b||(new Function("return this"))()}catch(a){"object"==typeof u&&(b=u)}d.exports=b},function(d,b,a){b=a(0);a=a(104);b=b.WeakMap;d.exports="function"==typeof b&&/native code/.test(a(b))},function(d,b,a){b=a(99);var c=a(87);d.exports=b?{}.toString:function(){return"[object "+c(this)+"]"}},function(d,b,a){b=a(27);var c=a(59),e=a(113),f=a(10);d.exports=b("Reflect","ownKeys")||function(a){var b=c.f(f(a)),
d=e.f;return d?b.concat(d(a)):b}},function(d,b,a){b=a(0);d.exports=b.Promise},function(d,b,a){var c,e,f,g,m,p,l,t,v=a(0),A=a(37).f,D=a(32),y=a(139).set;a=a(141);b=v.MutationObserver||v.WebKitMutationObserver;var x=v.process,z=v.Promise,h="process"==D(x);(A=(A=A(v,"queueMicrotask"))&&A.value)||(c=function(){var a;for(h&&(a=x.domain)&&a.exit();e;){var c=e.fn;e=e.next;try{c()}catch(G){throw e?g():f=void 0,G;}}f=void 0;a&&a.enter()},h?g=function(){x.nextTick(c)}:b&&!a?(m=!0,p=document.createTextNode(""),
(new b(c)).observe(p,{characterData:!0}),g=function(){p.data=m=!m}):z&&z.resolve?(l=z.resolve(void 0),t=l.then,g=function(){t.call(l,c)}):g=function(){y.call(v,c)});d.exports=A||function(a){a={fn:a,next:void 0};f&&(f.next=a);e||(e=a,g());f=a}},function(d,b,a){var c=a(10),e=a(5),f=a(142);d.exports=function(a,b){if(c(a),e(b)&&b.constructor===a)return b;a=f.f(a);return(0,a.resolve)(b),a.promise}},function(d,b,a){var c=a(0);d.exports=function(a,b){var d=c.console;d&&d.error&&(1===arguments.length?d.error(a):
d.error(a,b))}},function(d,b){d.exports=function(a){try{return{error:!1,value:a()}}catch(c){return{error:!0,value:c}}}},function(d,b){d.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children||(a.children=[]),Object.defineProperty(a,"loaded",{enumerable:!0,get:function(){return a.l}}),Object.defineProperty(a,"id",{enumerable:!0,get:function(){return a.i}}),a.webpackPolyfill=1),a}},function(d,b,a){var c=a(26),e=a(59).f,f={}.toString,g="object"==typeof u&&u&&Object.getOwnPropertyNames?
Object.getOwnPropertyNames(u):[];d.exports.f=function(a){if(g&&"[object Window]"==f.call(a))try{var b=e(a)}catch(l){b=g.slice()}else b=e(c(a));return b}},function(d,b,a){a(89)("asyncIterator")},function(d,b,a){a(89)("toStringTag")},function(d,b,a){b=a(4);var c=a(33);a=a(12);var e=b("unscopables"),f=Array.prototype;null==f[e]&&a.f(f,e,{configurable:!0,value:c(null)});d.exports=function(a){f[e][a]=!0}},function(d,b,a){var c=a(5);d.exports=function(a){if(!c(a)&&null!==a)throw TypeError("Can't set "+
String(a)+" as a prototype");return a}},function(d,b,a){d=a(0);a(23)(d.JSON,"JSON",!0)},function(d,b,a){a(23)(Math,"Math",!0)},,function(d,b,a){b=a(2);d.exports=!b(function(){return Object.isExtensible(Object.preventExtensions({}))})},,function(d,b,a){function c(a){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function e(a,c,b,d,e,
h,f){try{var k=a[h](f),q=k.value}catch(Qa){return void b(Qa)}k.done?c(q):Promise.resolve(q).then(d,e)}function f(a){return function(){var c=this,b=arguments;return new Promise(function(d,h){function k(a){e(q,d,h,k,f,"next",a)}function f(a){e(q,d,h,k,f,"throw",a)}var q=a.apply(c,b);k(void 0)})}}function g(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a){var c="function"==typeof Map?new Map:void 0;return(m=function(a){function b(){return p(a,
arguments,v(this).constructor)}if(null===a||(d=a,-1===Function.toString.call(d).indexOf("[native code]")))return a;var d;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if(void 0!==c){if(c.has(a))return c.get(a);c.set(a,b)}return b.prototype=Object.create(a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),t(b,a)})(a)}function p(a,c,b){return(p=l()?Reflect.construct:function(a,c,b){var d=[null];d.push.apply(d,c);a=new (Function.bind.apply(a,
d));return b&&t(a,b.prototype),a}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(q){return!1}}function t(a,c){return(t=Object.setPrototypeOf||function(a,c){return a.__proto__=c,a})(a,c)}function v(a){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}
function A(){return D.apply(this,arguments)}function D(){return(D=f(regeneratorRuntime.mark(function r(){var a,c=arguments;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a=0<c.length&&void 0!==c[0]?c[0]:200,b.abrupt("return",new Promise(function(c){return setTimeout(c,a)}));case 2:case "end":return b.stop()}},r)}))).apply(this,arguments)}function y(a){return x.apply(this,arguments)}function x(){return(x=f(regeneratorRuntime.mark(function G(a){var c,b=arguments;
return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(void 0!==(c=1<b.length&&void 0!==b[1]?b[1]:z).startTime){d.next=5;break}c.startTime=Date.now();d.next=7;break;case 5:if(!(Date.now()-c.startTime>c.maxPollingTime)){d.next=7;break}throw Error("Exhausted the number of retries within timeout");case 7:return d.prev=7,d.next=10,a();case 10:return d.abrupt("return",d.sent);case 13:if(d.prev=13,d.t0=d.catch(7),!(d.t0 instanceof h)){d.next=23;break}return d.next=18,A(c.delay);
case 18:return d.next=20,y(a,c);case 20:return d.abrupt("return",d.sent);case 23:if(!(0<c.maxRetries)){d.next=31;break}return d.next=26,A(c.delay);case 26:return d.next=28,y(a,{delay:c.delay,maxRetries:c.maxRetries-1,maxPollingTime:c.maxPollingTime,startTime:c.startTime});case 28:return d.abrupt("return",d.sent);case 31:throw d.t0;case 32:case "end":return d.stop()}},G,null,[[7,13]])}))).apply(this,arguments)}a(28);a(29);a(30);a(161);a(11);a(162);a(18);a(120);a(31);a(117);a(43);a(44);a(45);a(3);a(14);
a(55);a(21);a(20);a(22);a(191);Object.defineProperty(b,"__esModule",{value:!0});b.wait=A;b.retry=y;b.PollEnabledError=void 0;a(15);var z={delay:200,maxRetries:0,maxPollingTime:15E3},h=function(a){function b(a){var c;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");return c=e.call(this,a),Object.setPrototypeOf(g(c),(this instanceof b?this.constructor:void 0).prototype),c.name="PollEnabledError",c}!function(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function");
a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,writable:!0,configurable:!0}});c&&t(a,c)}(b,a);var d,e=(d=l(),function(){var a=v(b);if(d){var e=v(this).constructor;a=Reflect.construct(a,arguments,e)}else a=a.apply(this,arguments);return!a||"object"!==c(a)&&"function"!=typeof a?g(this):a});return b}(m(Error));b.PollEnabledError=h},function(d,b,a){d=a(1);b=a(0);a=a(108);var c=[].slice,e=function(a){return function(b,d){var e=2<arguments.length,f=e?c.call(arguments,2):void 0;return a(e?
function(){("function"==typeof b?b:Function(b)).apply(this,f)}:b,d)}};d({global:!0,bind:!0,forced:/MSIE .\./.test(a)},{setTimeout:e(b.setTimeout),setInterval:e(b.setInterval)})},,,,,,,,,,,,,,,,,,,,,function(d,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.ApiType=void 0;b.ApiType=void 0;d=b.ApiType={};d.Initialize="Initialize";d.Authenticate="Authenticate";d.initialize="initialize";d.challenge="challenge"},function(d,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.isFirstSameOrAfterSecond=
function(a,b){if(a.major>b.major)return!0;if(a.major===b.major){if(a.minor>b.minor)return!0;if(a.minor===b.minor){if(a.build>b.build)return!0;if(a.build===b.build)return a.revision>=b.revision}}return!1};b.CURRENT_SDK_VERSION=void 0;b.CURRENT_SDK_VERSION={major:0,minor:1,build:1,revision:2}},function(d,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.registerListener=function(a){try{if(u.addEventListener)return u.addEventListener("message",a),!0;console.warn("Cross-frame communication not supported")}catch(e){console.error("Unable to register listener",
e)}return!1}},function(d,b,a){b=a(2);var c=a(4),e=a(35),f=c("iterator");d.exports=!b(function(){var a=new URL("b?a\x3d1\x26b\x3d2\x26c\x3d3","http://a"),c=a.searchParams,b="";return a.pathname="c%20d",c.forEach(function(a,d){c.delete("b");b+=d+a}),e&&!a.toJSON||!c.sort||"http://a/c%20d?a\x3d1\x26c\x3d3"!==a.href||"3"!==c.get("c")||"a\x3d1"!==String(new URLSearchParams("?a\x3d1"))||!c[f]||"a"!==(new URL("https://a@b")).username||"b"!==(new URLSearchParams(new URLSearchParams("a\x3db"))).get("a")||
"xn--e1aybc"!==(new URL("http://")).host||"#%D0%B1"!==(new URL("http://a#")).hash||"a1c3"!==b||"x"!==(new URL("http://x",void 0)).host})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(d,b,a){a(20);d=a(1);var c=a(7);b=a(215);var e=a(0),f=a(152),g=a(17),m=a(46),p=a(9),l=a(270),t=a(167),v=a(119).codeAt,A=a(271),D=a(23),y=a(272);a=a(24);var x=e.URL,z=y.URLSearchParams,h=y.getState,q=a.set,r=a.getterFor("URL"),G=Math.floor,k=Math.pow,B=/[A-Za-z]/,C=/[\d+-.A-Za-z]/,u=/\d/,w=/^(0x|0X)/,
K=/^[0-7]+$/,F=/^\d+$/,X=/^[\dA-Fa-f]+$/,Z=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,P=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,T=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,L=/[\u0009\u000A\u000D]/g,U=function(a,c){var b,d;if("["==c.charAt(0)){if("]"!=c.charAt(c.length-1)||!(b=I(c.slice(1,-1))))return"Invalid host"}else if(O(a)){if((c=A(c),Z.test(c))||null===(b=S(c)))return"Invalid host"}else{if(P.test(c))return"Invalid host";b="";c=t(c);for(d=0;d<c.length;d++)b+=N(c[d],H)}a.host=b},S=function(a){var c,
b,d,e,h=a.split(".");if(h.length&&""==h[h.length-1]&&h.pop(),4<(c=h.length))return a;var f=[];for(b=0;b<c;b++){if(""==(d=h[b]))return a;if(e=10,1<d.length&&"0"==d.charAt(0)&&(e=w.test(d)?16:8,d=d.slice(8==e?1:2)),""===d)d=0;else{if(!(10==e?F:8==e?K:X).test(d))return a;d=parseInt(d,e)}f.push(d)}for(b=0;b<c;b++)if(d=f[b],b==c-1){if(d>=k(256,5-c))return null}else if(255<d)return null;a=f.pop();for(b=0;b<f.length;b++)a+=f[b]*k(256,3-b);return a},I=function(a){var c,b,d,e=[0,0,0,0,0,0,0,0],h=0,k=null,
f=0;var q=function(){return a.charAt(f)};if(":"==q()){if(":"!=a.charAt(1))return;f+=2;k=++h}for(;q();){if(8==h)return;if(":"!=q()){for(c=b=0;4>b&&X.test(q());)c=16*c+parseInt(q(),16),f++,b++;if("."==q()){if(0==b||(f-=b,6<h))return;for(c=0;q();){if(b=null,0<c){if(!("."==q()&&4>c))return;f++}if(!u.test(q()))return;for(;u.test(q());){if(d=parseInt(q(),10),null===b)b=d;else{if(0==b)return;b=10*b+d}if(255<b)return;f++}e[h]=256*e[h]+b;2!=++c&&4!=c||h++}if(4!=c)return;break}if(":"==q()){if(f++,!q())return}else if(q())return;
e[h++]=c}else{if(null!==k)return;f++;k=++h}}if(null!==k)for(q=h-k,h=7;0!=h&&0<q;)c=e[h],e[h--]=e[k+q-1],e[k+--q]=c;else if(8!=h)return;return e},Q=function(a){var c,b;if("number"==typeof a){var d=[];for(c=0;4>c;c++)d.unshift(a%256),a=G(a/256);return d.join(".")}if("object"==typeof a){d="";c=null;var e=1;for(var h=null,k=0,f=0;8>f;f++)0!==a[f]?(k>e&&(c=h,e=k),h=null,k=0):(null===h&&(h=f),++k);e=(k>e&&(c=h),c);for(c=0;8>c;c++)b&&0===a[c]||(b&&(b=!1),e===c?(d+=c?":":"::",b=!0):(d+=a[c].toString(16),
7>c&&(d+=":")));return"["+d+"]"}return a},H={},ca=l({},H,{" ":1,'"':1,"\x3c":1,"\x3e":1,"`":1}),fa=l({},ca,{"#":1,"?":1,"{":1,"}":1}),J=l({},fa,{"/":1,":":1,";":1,"\x3d":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),N=function(a,c){var b=v(a,0);return 32<b&&127>b&&!p(c,a)?a:encodeURIComponent(a)},R={ftp:21,file:null,http:80,https:443,ws:80,wss:443},O=function(a){return p(R,a.scheme)},aa=function(a){return!a.host||a.cannotBeABaseURL||"file"==a.scheme},ba=function(a,c){var b;return 2==a.length&&B.test(a.charAt(0))&&
(":"==(b=a.charAt(1))||!c&&"|"==b)},ra=function(a){var c;return 1<a.length&&ba(a.slice(0,2))&&(2==a.length||"/"===(c=a.charAt(2))||"\\"===c||"?"===c||"#"===c)},V=function(a){var c=a.path,b=c.length;!b||"file"==a.scheme&&1==b&&ba(c[0],!0)||c.pop()},da={},Y={},W={},ia={},ma={},oa={},Aa={},ka={},pa={},na={},la={},ta={},xa={},ya={},Ba={},za={},ua={},ha={},Ca={},qa={},ea={},ja=function(a,c,b,d){var e,h;var k=b||da;var f=0;var q="";var r=!1,l=!1,g=!1;b||(a.scheme="",a.username="",a.password="",a.host=null,
a.port=null,a.path=[],a.query=null,a.fragment=null,a.cannotBeABaseURL=!1,c=c.replace(T,""));c=c.replace(L,"");for(c=t(c);f<=c.length;){switch(e=c[f],k){case da:if(!e||!B.test(e)){if(b)return"Invalid scheme";k=W;continue}q+=e.toLowerCase();k=Y;break;case Y:if(e&&(C.test(e)||"+"==e||"-"==e||"."==e))q+=e.toLowerCase();else{if(":"!=e){if(b)return"Invalid scheme";q="";k=W;f=0;continue}if(b&&(O(a)!=p(R,q)||"file"==q&&(""!=a.username||""!=a.password||null!==a.port)||"file"==a.scheme&&!a.host))return;if(a.scheme=
q,b)return void(O(a)&&R[a.scheme]==a.port&&(a.port=null));q="";"file"==a.scheme?k=ya:O(a)&&d&&d.scheme==a.scheme?k=ia:O(a)?k=ka:"/"==c[f+1]?(k=ma,f++):(a.cannotBeABaseURL=!0,a.path.push(""),k=Ca)}break;case W:if(!d||d.cannotBeABaseURL&&"#"!=e)return"Invalid scheme";if(d.cannotBeABaseURL&&"#"==e){a.scheme=d.scheme;a.path=d.path.slice();a.query=d.query;a.fragment="";a.cannotBeABaseURL=!0;k=ea;break}k="file"==d.scheme?ya:oa;continue;case ia:if("/"!=e||"/"!=c[f+1]){k=oa;continue}k=pa;f++;break;case ma:if("/"==
e){k=na;break}k=ha;continue;case oa:if(a.scheme=d.scheme,void 0==e)a.username=d.username,a.password=d.password,a.host=d.host,a.port=d.port,a.path=d.path.slice(),a.query=d.query;else if("/"==e||"\\"==e&&O(a))k=Aa;else if("?"==e)a.username=d.username,a.password=d.password,a.host=d.host,a.port=d.port,a.path=d.path.slice(),a.query="",k=qa;else{if("#"!=e){a.username=d.username;a.password=d.password;a.host=d.host;a.port=d.port;a.path=d.path.slice();a.path.pop();k=ha;continue}a.username=d.username;a.password=
d.password;a.host=d.host;a.port=d.port;a.path=d.path.slice();a.query=d.query;a.fragment="";k=ea}break;case Aa:if(!O(a)||"/"!=e&&"\\"!=e){if("/"!=e){a.username=d.username;a.password=d.password;a.host=d.host;a.port=d.port;k=ha;continue}k=na}else k=pa;break;case ka:if(k=pa,"/"!=e||"/"!=q.charAt(f+1))continue;f++;break;case pa:if("/"!=e&&"\\"!=e){k=na;continue}break;case na:if("@"==e){r&&(q="%40"+q);r=!0;q=t(q);for(e=0;e<q.length;e++){var m=q[e];":"!=m||g?(m=N(m,J),g?a.password+=m:a.username+=m):g=!0}q=
""}else if(void 0==e||"/"==e||"?"==e||"#"==e||"\\"==e&&O(a)){if(r&&""==q)return"Invalid authority";f-=t(q).length+1;q="";k=la}else q+=e;break;case la:case ta:if(b&&"file"==a.scheme){k=za;continue}if(":"!=e||l){if(void 0==e||"/"==e||"?"==e||"#"==e||"\\"==e&&O(a)){if(O(a)&&""==q)return"Invalid host";if(b&&""==q&&(""!=a.username||""!=a.password||null!==a.port))return;if(k=U(a,q))return k;if(q="",k=ua,b)return;continue}"["==e?l=!0:"]"==e&&(l=!1);q+=e}else{if(""==q)return"Invalid host";if(k=U(a,q))return k;
if(q="",k=xa,b==ta)return}break;case xa:if(!u.test(e)){if(void 0==e||"/"==e||"?"==e||"#"==e||"\\"==e&&O(a)||b){if(""!=q){k=parseInt(q,10);if(65535<k)return"Invalid port";a.port=O(a)&&k===R[a.scheme]?null:k;q=""}if(b)return;k=ua;continue}return"Invalid port"}q+=e;break;case ya:if(a.scheme="file","/"==e||"\\"==e)k=Ba;else{if(!d||"file"!=d.scheme){k=ha;continue}if(void 0==e)a.host=d.host,a.path=d.path.slice(),a.query=d.query;else if("?"==e)a.host=d.host,a.path=d.path.slice(),a.query="",k=qa;else{if("#"!=
e){ra(c.slice(f).join(""))||(a.host=d.host,a.path=d.path.slice(),V(a));k=ha;continue}a.host=d.host;a.path=d.path.slice();a.query=d.query;a.fragment="";k=ea}}break;case Ba:if("/"==e||"\\"==e){k=za;break}d&&"file"==d.scheme&&!ra(c.slice(f).join(""))&&(ba(d.path[0],!0)?a.path.push(d.path[0]):a.host=d.host);k=ha;continue;case za:if(void 0==e||"/"==e||"\\"==e||"?"==e||"#"==e){if(!b&&ba(q))k=ha;else{if(""==q){if(a.host="",b)return}else{if(k=U(a,q))return k;if("localhost"==a.host&&(a.host=""),b)return;q=
""}k=ua}continue}q+=e;break;case ua:if(O(a)){if(k=ha,"/"!=e&&"\\"!=e)continue}else if(b||"?"!=e)if(b||"#"!=e){if(void 0!=e&&(k=ha,"/"!=e))continue}else a.fragment="",k=ea;else a.query="",k=qa;break;case ha:if(void 0==e||"/"==e||"\\"==e&&O(a)||!b&&("?"==e||"#"==e)){if(".."===(h=(h=q).toLowerCase())||"%2e."===h||".%2e"===h||"%2e%2e"===h?(V(a),"/"==e||"\\"==e&&O(a)||a.path.push("")):"."===q||"%2e"===q.toLowerCase()?"/"==e||"\\"==e&&O(a)||a.path.push(""):("file"==a.scheme&&!a.path.length&&ba(q)&&(a.host&&
(a.host=""),q=q.charAt(0)+":"),a.path.push(q)),q="","file"==a.scheme&&(void 0==e||"?"==e||"#"==e))for(;1<a.path.length&&""===a.path[0];)a.path.shift();"?"==e?(a.query="",k=qa):"#"==e&&(a.fragment="",k=ea)}else q+=N(e,fa);break;case Ca:"?"==e?(a.query="",k=qa):"#"==e?(a.fragment="",k=ea):void 0!=e&&(a.path[0]+=N(e,H));break;case qa:b||"#"!=e?void 0!=e&&("'"==e&&O(a)?a.query+="%27":a.query+="#"==e?"%23":N(e,H)):(a.fragment="",k=ea);break;case ea:void 0!=e&&(a.fragment+=N(e,ca))}f++}},sa=function(a){var b=
m(this,sa,"URL");var d=1<arguments.length?arguments[1]:void 0;var e=String(a),k=q(b,{type:"URL"});if(void 0!==d)if(d instanceof sa)var f=r(d);else if(d=ja(f={},String(d)))throw TypeError(d);if(d=ja(k,e,null,f))throw TypeError(d);var l=k.searchParams=new z;f=h(l);f.updateSearchParams(k.query);f.updateURL=function(){k.query=String(l)||null};c||(b.href=va.call(b),b.origin=Da.call(b),b.protocol=Ea.call(b),b.username=Fa.call(b),b.password=Ga.call(b),b.host=Ha.call(b),b.hostname=Ia.call(b),b.port=Ja.call(b),
b.pathname=Ka.call(b),b.search=La.call(b),b.searchParams=Ma.call(b),b.hash=Na.call(b))};a=sa.prototype;var va=function(){var a=r(this),b=a.scheme,c=a.username,d=a.password,e=a.host,h=a.port,k=a.path,f=a.query,q=a.fragment,l=b+":";return null!==e?(l+="//",(""!=a.username||""!=a.password)&&(l+=c+(d?":"+d:"")+"@"),l+=Q(e),null!==h&&(l+=":"+h)):"file"==b&&(l+="//"),l+=a.cannotBeABaseURL?k[0]:k.length?"/"+k.join("/"):"",null!==f&&(l+="?"+f),null!==q&&(l+="#"+q),l},Da=function(){var a=r(this),b=a.scheme,
c=a.port;if("blob"==b)try{return(new URL(b.path[0])).origin}catch(Ra){return"null"}return"file"!=b&&O(a)?b+"://"+Q(a.host)+(null!==c?":"+c:""):"null"},Ea=function(){return r(this).scheme+":"},Fa=function(){return r(this).username},Ga=function(){return r(this).password},Ha=function(){var a=r(this),b=a.host;a=a.port;return null===b?"":null===a?Q(b):Q(b)+":"+a},Ia=function(){var a=r(this).host;return null===a?"":Q(a)},Ja=function(){var a=r(this).port;return null===a?"":String(a)},Ka=function(){var a=
r(this),b=a.path;return a.cannotBeABaseURL?b[0]:b.length?"/"+b.join("/"):""},La=function(){var a=r(this).query;return a?"?"+a:""},Ma=function(){return r(this).searchParams},Na=function(){var a=r(this).fragment;return a?"#"+a:""};e=function(a,b){return{get:a,set:b,configurable:!0,enumerable:!0}};if(c&&f(a,{href:e(va,function(a){var b=r(this);if(a=ja(b,String(a)))throw TypeError(a);h(b.searchParams).updateSearchParams(b.query)}),origin:e(Da),protocol:e(Ea,function(a){var b=r(this);ja(b,String(a)+":",
da)}),username:e(Fa,function(a){var b=r(this);a=t(String(a));if(!aa(b)){b.username="";for(var c=0;c<a.length;c++)b.username+=N(a[c],J)}}),password:e(Ga,function(a){var b=r(this);a=t(String(a));if(!aa(b)){b.password="";for(var c=0;c<a.length;c++)b.password+=N(a[c],J)}}),host:e(Ha,function(a){var b=r(this);b.cannotBeABaseURL||ja(b,String(a),la)}),hostname:e(Ia,function(a){var b=r(this);b.cannotBeABaseURL||ja(b,String(a),ta)}),port:e(Ja,function(a){var b=r(this);aa(b)||(""==(a=String(a))?b.port=null:
ja(b,a,xa))}),pathname:e(Ka,function(a){var b=r(this);b.cannotBeABaseURL||(b.path=[],ja(b,a+"",ua))}),search:e(La,function(a){var b=r(this);""==(a=String(a))?b.query=null:("?"==a.charAt(0)&&(a=a.slice(1)),b.query="",ja(b,a,qa));h(b.searchParams).updateSearchParams(b.query)}),searchParams:e(Ma),hash:e(Na,function(a){var b=r(this);""!=(a=String(a))?("#"==a.charAt(0)&&(a=a.slice(1)),b.fragment="",ja(b,a,ea)):b.fragment=null})}),g(a,"toJSON",function(){return va.call(this)},{enumerable:!0}),g(a,"toString",
function(){return va.call(this)},{enumerable:!0}),x){var Oa=x.createObjectURL,Pa=x.revokeObjectURL;Oa&&g(sa,"createObjectURL",function(a){return Oa.apply(x,arguments)});Pa&&g(sa,"revokeObjectURL",function(a){return Pa.apply(x,arguments)})}D(sa,"URL");d({global:!0,forced:!b,sham:!c},{URL:sa})},function(d,b,a){var c=a(7);b=a(2);var e=a(97),f=a(113),g=a(112),m=a(19),p=a(92),l=Object.assign,t=Object.defineProperty;d.exports=!l||b(function(){if(c&&1!==l({b:1},l(t({},"a",{enumerable:!0,get:function(){t(this,
"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var a={},b={},d=Symbol();return a[d]=7,"abcdefghijklmnopqrst".split("").forEach(function(a){b[a]=a}),7!=l({},a)[d]||"abcdefghijklmnopqrst"!=e(l({},b)).join("")})?function(a,b){for(var d=m(a),l=arguments.length,n=1,t=f.f,h=g.f;l>n;)for(var q,r=p(arguments[n++]),G=t?e(r).concat(t(r)):e(r),k=G.length,B=0;k>B;)q=G[B++],c&&!h.call(r,q)||(d[q]=r[q]);return d}:l},function(d,b,a){var c=/[^\0-\u007E]/,e=/[.\u3002\uFF0E\uFF61]/g,f=Math.floor,g=String.fromCharCode,
m=function(a){return a+22+75*(26>a)},p=function(a){var b,c=[];var d=[];for(var e=0,l=a.length;e<l;){var n=a.charCodeAt(e++);if(55296<=n&&56319>=n&&e<l){var p=a.charCodeAt(e++);56320==(64512&p)?d.push(((1023&n)<<10)+(1023&p)+65536):(d.push(n),e--)}else d.push(n)}e=(a=d).length;l=128;var h=0,q=72;for(d=0;d<a.length;d++)128>(b=a[d])&&c.push(g(b));for((p=n=c.length)&&c.push("-");p<e;){var r=2147483647;for(d=0;d<a.length;d++)(b=a[d])>=l&&b<r&&(r=b);var G=p+1;if(r-l>f((2147483647-h)/G))throw RangeError("Overflow: input needs wider integers to process");
h+=(r-l)*G;l=r;for(d=0;d<a.length;d++){if((b=a[d])<l&&2147483647<++h)throw RangeError("Overflow: input needs wider integers to process");if(b==l){var k=h;for(r=36;;r+=36){var B=r<=q?1:r>=q+26?26:r-q;if(k<B)break;k-=B;var C=36-B;c.push(g(m(B+k%C)));k=f(k/C)}c.push(g(m(k)));q=G;r=0;h=p==n?f(h/700):h>>1;for(h+=f(h/q);455<h;r+=36)h=f(h/35);q=f(r+36*h/(h+38));h=0;++p}}++h;++l}return c.join("")};d.exports=function(a){var b=[],d=a.toLowerCase().replace(e,".").split(".");for(a=0;a<d.length;a++){var f=d[a];
b.push(c.test(f)?"xn--"+p(f):f)}return b.join(".")}},function(d,b,a){a(11);b=a(1);var c=a(27),e=a(215),f=a(17),g=a(94),m=a(23),p=a(154),l=a(24),t=a(46),v=a(9),A=a(41),u=a(87),y=a(10),x=a(5),z=a(33),h=a(39),q=a(273),r=a(88);a=a(4);var G=c("fetch"),k=c("Headers");a=a("iterator");var B=l.set,C=l.getterFor("URLSearchParams"),w=l.getterFor("URLSearchParamsIterator"),E=/\+/g,K=Array(4),F=function(a){return K[a-1]||(K[a-1]=RegExp("((?:%[\\da-f]{2}){"+a+"})","gi"))},X=function(a){try{return decodeURIComponent(a)}catch(fa){return a}},
Z=function(a){a=a.replace(E," ");var b=4;try{return decodeURIComponent(a)}catch(J){for(;b;)a=a.replace(F(b--),X);return a}},P=/[!'()~]|%20/g,T={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},L=function(a){return T[a]},U=function(a,b){if(b){var c,d;b=b.split("\x26");for(var e=0;e<b.length;)(c=b[e++]).length&&(d=c.split("\x3d"),a.push({key:Z(d.shift()),value:Z(d.join("\x3d"))}))}},S=function(a){this.entries.length=0;U(this.entries,a)},I=function(a,b){if(a<b)throw TypeError("Not enough arguments");
},Q=p(function(a,b){B(this,{type:"URLSearchParamsIterator",iterator:q(C(a).entries),kind:b})},"Iterator",function(){var a=w(this),b=a.kind;a=a.iterator.next();var c=a.value;return a.done||(a.value="keys"===b?c.key:"values"===b?c.value:[c.key,c.value]),a}),H=function(){t(this,H,"URLSearchParams");var a,b,c,d,e;var h=0<arguments.length?arguments[0]:void 0;var k=[];if(B(this,{type:"URLSearchParams",entries:k,updateURL:function(){},updateSearchParams:S}),void 0!==h)if(x(h))if("function"==typeof(a=r(h)))for(b=
(a=a.call(h)).next;!(h=b.call(a)).done;){if((h=(d=(c=q(y(h.value))).next).call(c)).done||(e=d.call(c)).done||!d.call(c).done)throw TypeError("Expected sequence with length 2");k.push({key:h.value+"",value:e.value+""})}else for(b in h)v(h,b)&&k.push({key:b,value:h[b]+""});else U(k,"string"==typeof h?"?"===h.charAt(0)?h.slice(1):h:h+"")};p=H.prototype;g(p,{append:function(a,b){I(arguments.length,2);var c=C(this);c.entries.push({key:a+"",value:b+""});c.updateURL()},delete:function(a){I(arguments.length,
1);for(var b=C(this),c=b.entries,d=a+"",e=0;e<c.length;)c[e].key===d?c.splice(e,1):e++;b.updateURL()},get:function(a){I(arguments.length,1);for(var b=C(this).entries,c=a+"",d=0;d<b.length;d++)if(b[d].key===c)return b[d].value;return null},getAll:function(a){I(arguments.length,1);for(var b=C(this).entries,c=a+"",d=[],e=0;e<b.length;e++)b[e].key===c&&d.push(b[e].value);return d},has:function(a){I(arguments.length,1);for(var b=C(this).entries,c=a+"",d=0;d<b.length;)if(b[d++].key===c)return!0;return!1},
set:function(a,b){I(arguments.length,1);for(var c,d=C(this),e=d.entries,h=!1,k=a+"",f=b+"",q=0;q<e.length;q++)(c=e[q]).key===k&&(h?e.splice(q--,1):(h=!0,c.value=f));h||e.push({key:k,value:f});d.updateURL()},sort:function(){var a,b,c=C(this),d=c.entries,e=d.slice();for(b=d.length=0;b<e.length;b++){var h=e[b];for(a=0;a<b;a++)if(d[a].key>h.key){d.splice(a,0,h);break}a===b&&d.push(h)}c.updateURL()},forEach:function(a){for(var b,c=C(this).entries,d=A(a,1<arguments.length?arguments[1]:void 0,3),e=0;e<c.length;)d((b=
c[e++]).value,b.key,this)},keys:function(){return new Q(this,"keys")},values:function(){return new Q(this,"values")},entries:function(){return new Q(this,"entries")}},{enumerable:!0});f(p,a,p.entries);f(p,"toString",function(){for(var a,b=C(this).entries,c=[],d=0;d<b.length;)a=b[d++],c.push(encodeURIComponent(a.key).replace(P,L)+"\x3d"+encodeURIComponent(a.value).replace(P,L));return c.join("\x26")},{enumerable:!0});m(H,"URLSearchParams");b({global:!0,forced:!e},{URLSearchParams:H});e||"function"!=
typeof G||"function"!=typeof k||b({global:!0,enumerable:!0,forced:!0},{fetch:function(a){var b,c,d,e=[a];return 1<arguments.length&&(x(b=arguments[1])&&(c=b.body,"URLSearchParams"===u(c)&&((d=b.headers?new k(b.headers):new k).has("content-type")||d.set("content-type","application/x-www-form-urlencoded;charset\x3dUTF-8"),b=z(b,{body:h(0,String(c)),headers:h(0,d)}))),e.push(b)),G.apply(this,e)}});d.exports={URLSearchParams:H,getState:C}},function(d,b,a){var c=a(10),e=a(88);d.exports=function(a){var b=
e(a);if("function"!=typeof b)throw TypeError(String(a)+" is not iterable");return c(b.call(a))}},,function(d,b,a){d.exports=a(276)},function(d,b,a){function c(a){try{e().handleMessage(a)}catch(v){console.warn("Unable to handle message from SDK",v)}}function e(a){if(!g){if(!a)throw Error("SDK window is not defined");(0,p.registerListener)(c);g=new m.WebSdkSenderClient(a)}return a&&g.assertSdkWindow(a),g}Object.defineProperty(b,"__esModule",{value:!0});var f={enableWebSdkClient:!0,disableWebSdkClient:!0,
initialize:!0,authenticate:!0};b.enableWebSdkClient=function(a){e(a)};b.disableWebSdkClient=function(){g=void 0};b.initialize=function(a,b,c){e(c).initialize(a,b)};b.authenticate=function(a,b,c){e(c).authenticate(a,b)};var g,m=a(277),p=a(214),l=a(168);Object.keys(l).forEach(function(a){"default"!==a&&"__esModule"!==a&&(Object.prototype.hasOwnProperty.call(f,a)||Object.defineProperty(b,a,{enumerable:!0,get:function(){return l[a]}}))})},function(d,b,a){function c(a,b,c,d,e,f,h){try{var q=a[f](h),r=
q.value}catch(G){return void c(G)}q.done?b(r):Promise.resolve(r).then(d,e)}function e(a){return function(){var b=this,d=arguments;return new Promise(function(e,f){function l(a){c(q,e,f,l,h,"next",a)}function h(a){c(q,e,f,l,h,"throw",a)}var q=a.apply(b,d);l(void 0)})}}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,
enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}a(11);a(18);a(117);a(6);a(3);a(14);a(21);a(20);a(22);a(269);Object.defineProperty(b,"__esModule",{value:!0});b.WebSdkSenderClient=void 0;a(15);var m=a(213),p=a(212),l=a(190),t=a(168);d=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!0;g(this,"SDK_ACK_TIMEOUT",200);g(this,"clientWindow",void 0);g(this,"sdkWindow",void 0);g(this,"sequence",0);g(this,"callMap",new Map);g(this,"sdkAck",!1);
g(this,"origin",void 0);this.clientWindow=u;this.sdkWindow=b}var b,c,d;return b=[{key:"assertSdkWindow",value:function(a){if(this.sdkWindow!==a)throw Error("SDK Client supports only a single paired iFrame");}},{key:"handleMessage",value:function(a){try{this.validateSender(a);console.log("Received from SDK ".concat(a.data));var b=JSON.parse(a.data.toString()),c=this.callMap.get(b.sequence);if(!c)throw Error("Unmatched call instance");this.handleMessageSync(b,c)}catch(q){console.error("Unable to handle SDK message",
q)}}},{key:"validateSender",value:function(a){if(a.source!==this.sdkWindow)throw Error("Unexpected sender window");if(a.origin!==this.ensureOrigin())throw Error("Unexpected sender origin");}},{key:"handleMessageSync",value:function(a,b){if(!b)throw Error("No matching callback has been set");t.AuthenticationStatusType.SdkAck===a.output.status?this.sdkAck=!0:b.callback(a.output)}},{key:"initialize",value:function(a,b){this.handleCall(p.ApiType.Initialize,a,b)}},{key:"authenticate",value:function(a,
b){this.handleCall(p.ApiType.Authenticate,a,b)}},{key:"handleCall",value:function(a,b,c){var d=this.sequence++;a={messageIn:{sequence:d,api:a,version:m.CURRENT_SDK_VERSION,input:b},callback:c};this.callMap.set(d,a);this.handleCallAsync(a).then(function(){console.log("SDK Client call processed")}).catch(function(a){console.error("Did not complete async call")})}},{key:"handleCallAsync",value:(d=e(regeneratorRuntime.mark(function h(a){var b,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=
e.next){case 0:if(e.prev=0,u.addEventListener){e.next=3;break}throw Error("Cross frame communication not supported");case 3:return b=JSON.stringify(a.messageIn),c=this.setOriginFromUrl(a.messageIn.input.url),this.sdkWindow.postMessage(b,c),e.next=8,this.confirmAckWithTimeout();case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.warn("Browser does not support SDK",e.t0),d={status:t.AuthenticationStatusType.FallbackRequiredError,errorDesc:"Browser does not support SDK"},a.callback(d);case 15:case "end":return e.stop()}},
h,this,[[0,10]])})),function(a){return d.apply(this,arguments)})},{key:"getTargetOriginFromUrl",value:function(a){try{return(new URL(a)).origin}catch(q){var b=document.createElement("a");return b.href=a,b.origin}}},{key:"confirmAckWithTimeout",value:(c=e(regeneratorRuntime.mark(function h(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,l.wait)(this.SDK_ACK_TIMEOUT);case 2:if(this.sdkAck){a.next=4;break}throw Error("SDK connection timed out");case 4:case "end":return a.stop()}},
h,this)})),function(){return c.apply(this,arguments)})},{key:"setOriginFromUrl",value:function(a){a=this.getTargetOriginFromUrl(a);if(void 0===this.origin)this.origin=a;else if(this.origin!==a)throw Error("Multiple origins not supported for SDK");return this.origin}},{key:"ensureOrigin",value:function(){if(void 0!==this.origin)return this.origin;throw Error("Origin has not been set for SDK");}}],f(a.prototype,b),a}();b.WebSdkSenderClient=d}])}catch(d){f=function(){}}return f});w("security",["base",
"clog","config","jQuery"],function(f,d,b,a){function c(a){a=a.not('[name^\x3d"ppw-"]').filter(function(){return this.value&&""!==this.value.trim()});for(var b=0;b<g.length;++b)a=a.not('[name\x3d"'+g[b]+'"]');return a}function e(b){return function(){c(b.getRootDOMElements().find("input")).each(function(b,c){b=a(c).attr("name");d.logCounterMetric({feature:"sec.exf.",resource:b,amount:n})});d.publishMetrics()}}var n=b.getAttribute("securePage")?0:1,g=["ie"];return f.extend({initialize:function(a){var b=
e(a);a.getRootDOMElements().find(":button,:submit").bind("click",b)}})});w("server",["jQuery","lang","clog"],function(f,d,b){function a(a,b,c){b in a&&(a[b]=d.bind(a[b],c))}function c(a){var b=[];d.forEach(a,function(a){null!=a&&b.push(e(a))});return b}function e(a){if(d.isArray(a))return c(a);if(d.isObject(a)){var b={},f;for(f in a){var l=a[f];null!=l&&(b[f]=e(l))}return b}return a}function n(a){var b=d.extend({},m,a);b.data=e(a.data);b.fatal||(b.fatal=d.NOOP);b.error||(b.error=function(a,c){p&&
"error"===c||b.fatal()});b.headers=d.extend(b.headers,{"Widget-Ajax-Attempt-Count":0});null==b.metricOperation&&(b.metricOperation=b.type);return b}function g(a){var b=0,c=500+Math.floor(500*Math.random());d.has(a,"retryLimit")||(a.retryLimit=2);var e=function(a){return 0===a?c:1E3*Math.pow(2,a)},g=a.retryDelayFn?a.retryDelayFn:e,l=a.error;return function(c,e){var h=500<=c.status&&600>c.status||408===c.status||"timeout"===e||0===c.status&&0===c.readyState;401===c.status?a.fatal({type:"auth"}):!h&&
l?l.apply(this,arguments):h&&b<a.retryLimit?(h=g(b),b++,a.headers=d.extend(a.headers,{"Widget-Ajax-Attempt-Count":b}),u.setTimeout(function(){f.ajax(a)},h)):b>=a.retryLimit&&l&&l.apply(this,arguments)}}var m={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",dataType:"json",cache:!1,globals:!1,timeout:3E4},p=!1;f(u).bind("beforeunload",function(){p=!0});return{ajax:function(c){var d=b.getCurrentTime();p=!1;c=n(c);this._addInterceptHandlers(c,d);if(d=c.context)delete c.context,a(c,
"beforeSend",d),a(c,"success",d),a(c,"error",d),a(c,"complete",d);if(d=c.query){var e=-1===c.url.indexOf("?")?"?":"\x26";c.url+=e+f.param(d,!0)}c.error=g(c);c.xhrFields={withCredentials:!0};return f.ajax(c)},_addInterceptHandlers:function(a,c){d.time();d.intercept(a,"error",function(c,d,e){a.data&&a.data["ppw-widgetEvent"]&&b.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_ErrorCount"})},this);d.intercept(a,"complete",function(){d.time();a.data&&a.data["ppw-widgetEvent"]&&(b.logCounterMetric({feature:a.data["ppw-widgetEvent"],
resource:"_Count"}),b.logLatencyMetric({feature:a.data["ppw-widgetEvent"],resource:"_Latency",startTime:c}))},this);d.intercept(a,"success",function(){a.data&&a.data["ppw-widgetEvent"]&&b.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_SuccessCount"})},this)}}});w("storage-helper",[],function(){return{putInSession:function(f,d){f&&d&&u.sessionStorage.setItem(f,JSON.stringify(d))},getFromSession:function(f){if(f)return f=u.sessionStorage.getItem(f),JSON.parse(f)}}});w("testAjaxCapability",
["clog"],function(f){return{makeCall:function(d){var b=this,a=d.options.clientId+"_testAjaxCapability";d.continueRequest({"ppw-widgetState":d.options.serializedState},{success:function(c){b.logMetric(a,0)},error:function(c){b.logMetric(a,1)},fatal:function(c){b.logMetric(a,1)}})},logMetric:function(d,b){f.logCounterMetric({feature:d,resource:"_Count",amount:b})}}});w("tooltip",["popover-base"],function(f){return f.extend({componentName:"a-tooltip"})});w("url-helper",[],function(){return{getParameterFromCurrentURL:function(f){try{return(new URLSearchParams(u.location.search)).get(f)}catch(d){return""}}}});
w("validation-functions",["lang","number-format","jQuery"],function(f,d,b){var a=function(a){if(!a||0===a.length)return!1;for(var b=0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10},c=function(a,b){return f.some(b,function(b){return a.test(b)})},e=function(a){return f.some(a,function(a){return!!a&&""!==f.trim(a)})},n=function(a){a=a.split("").map(function(a){return parseInt(a,10)});var b=a.length+1;a=a.map(function(a,c){return a*(b-c)}).reduce(function(a,
b){return a+b})%11;return 2>a?0:11-a},g=function(a){var b=2;a=a.split("").reduce(function(a,b){return[parseInt(b,10)].concat(a)},[]).reduce(function(a,c){a+=c*b;b=9===b?2:b+1;return a},0)%11;return 2>a?0:11-a},m=function(a,b){return a!==F&&null!==a&&!0!==a&&!1!==a&&""!==f.trim(a)?(a=(new d(b)).localizedParseNumber(a),isNaN(a)?null:a):null},p=function(a){return a&&null!==a.match(/^[0-9]+$/)},l=function(a){a=a.getAdditionalData("isMbccFn");return f.isFunction(a)&&a()},t=function(a){var b=/^\d{3,4}$/;
"AmericanExpress"===a?b=/^\d{4}$/:a&&(b=/^\d{3}$/);return b},v=function(a,b){return!b.fieldRequiredParameterName||"true"===a[b.fieldRequiredParameterName]},u=function(a){return a&&a.replace(/-|\s/g,"")},w=function(a,b,c){var d="";a!==F&&(d=a);a=b[c.defaultParameterName];return a!==F&&(a=u(a),4<=a.length)?a.substr(a.length-d.length)===d:!1},y=function(a,b,c){var d=a.getAdditionalData("isCvvForMbcc");b=b[c.defaultParameterName];d?a=l(a)?/^\d{3,8}$/:/.*?/:(a=a.getAdditionalData("issuerFn"),a=f.isFunction(a)?
a():"",a=t(a));return!!b&&a.test(f.trim(b))},x=function(a,b,c){b=b[c.defaultParameterName];a=a.getAdditionalData("issuerFn");return"AmericanExpress"===(f.isFunction(a)?a():"")?(a=/^\d{4}$/,!!b&&a.test(f.trim(b))):!0},z={NonEmptyFieldConstraint:function(a,b,c){a=b[c.defaultParameterName];return!!a&&""!==f.trim(a)},RegexMatchFieldConstraint:function(a,b,c,d){return(new RegExp(d.pattern)).test(b[c.defaultParameterName])},NonEmptyComplexFieldConstraint:function(a,b,c){return e([b[c.defaultParameterName],
b[c.radioButtonName],b[c.dropdownName]])},NumericCustomAmountRewardsAccountSelectionFieldConstraint:function(a,b,c,d){a=d.locale.substring(3);return f.isDefined(m(b[c.customAmountSelectionInput],a))},CustomAmountLessThanOrEqualToMaxUsableRewardsAccountSelectionFieldConstraint:function(a,b,c,d){a=b[c.customAmountSelectionInput];b=d.locale.substring(3);a=m(a,b);return f.isDefined(a)&&a<=Number(d.maxUsableAmount)},CustomAmountLargerThanOrEqualToMinUsableRewardsAccountSelectionFieldConstraint:function(a,
b,c,d){a=b[c.customAmountSelectionInput];b=d.locale.substring(3);a=m(a,b);return f.isDefined(a)&&a>=Number(d.minUsableAmount)},LengthBetweenConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return a.length>=d.min&&a.length<=d.max},LengthLessThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length<=d.maximumLength},LengthGreaterThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length>=d.minimumLength},LengthEqualToConstraint:function(a,b,c,d){a=b[c.defaultParameterName];
return a!==F&&a.length===d.expectedLength},IsNumberFieldConstraint:function(a,b,c){a=b[c.defaultParameterName];return a!==F&&null!==a&&!0!==a&&!1!==a&&!isNaN(a-0)&&""!==f.trim(a)},GreaterThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]>=d.min},LessThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]<=d.max},ExpirationDateTooFarConstraint:function(a,c,d,e){d=c[d.combinedMonthYearParameterName].split("/");if(2===d.length){a=b.trim(d[0]);d=b.trim(d[1]);
if(2!==d.length)return!0;a=parseInt(a,10);d=parseInt("20"+d,10)}else return!0;if(isNaN(a)||isNaN(d))return!1;c=(new Date(c.widgetCreationEpochMilliseconds)).getUTCFullYear();return d<=c+20},CreditCardExpirationFormatConstraint:function(a,c,d,e){a=c[d.combinedMonthYearParameterName];if(a){if(c=a.split("/"),2===c.length){var k=parseInt(b.trim(c[0]),10);var f=parseInt("20"+b.trim(c[1]),10)}}else k=parseInt(c[d.monthParameterName],10),f=parseInt(c[d.yearParameterName],10);return isNaN(k)||isNaN(f)?!1:
(1==k.toString().length||2==k.toString().length)&&4==f.toString().length},CreditCardExpirationConstraint:function(a,c,d,e){a=c[d.combinedMonthYearParameterName];if(a){if(d=a.split("/"),2===d.length){var k=parseInt(b.trim(d[0]),10);var f=parseInt("20"+b.trim(d[1]),10)}}else k=parseInt(c[d.monthParameterName],10),f=parseInt(c[d.yearParameterName],10);if(isNaN(k)||isNaN(f))return!1;d=new Date(c.widgetCreationEpochMilliseconds);c=d.getUTCFullYear();d=d.getUTCMonth();return f>c&&f<=c+20||f===c&&k>=d+1},
ValidBirthDateConstraint:function(a,b,c){if(!v(b,c)&&!b[c.defaultParameterName])return!0;a=(new Date(b.widgetCreationEpochMilliseconds)).toISOString().slice(0,10);b=b[c.defaultParameterName];return/^\d{4}-\d{2}-\d{2}$/.test(b)&&0<=a.localeCompare(b)},MCXCreditCardExpirationPastConstraint:function(a,c,d,e){d=c[d.combinedMonthYearParameterName].split("/");if(2===d.length){a=b.trim(d[0]);d=b.trim(d[1]);if(2!==d.length)return!0;a=parseInt(a,10);d=parseInt("20"+d,10)}else return!0;if(isNaN(a)||isNaN(d))return!1;
e=new Date(c.widgetCreationEpochMilliseconds);c=e.getUTCFullYear();e=e.getUTCMonth();return d>c||d===c&&a>=e+1},DateNonEmptyConstraint:function(a,b,c){a=b[c.combinedMonthYearParameterName];return!!a&&""!==f.trim(a)},ValidCVVConstraint:function(a,b,c){return y(a,b,c)},ValidCreditCardSecurityCodeConstraint:function(a,b,c){return v(b,c)?y(a,b,c):!0},ValidAmexCVVConstraint:function(a,b,c){return x(a,b,c)},ValidAmexCreditCardSecurityCodeConstraint:function(a,b,c){return v(b,c)?x(a,b,c):!0},SelectableListValidCreditCardSecurityCodeConstraint:function(a,
b,c,d){a=b[c.defaultParameterName];d=t(d.issuer);return!!a&&d.test(f.trim(a))},ValidCreditCardNumberTailConstraint:function(a,b,c){return w(a.getAdditionalData("creditCardTail"),b,c)},ValidBankAccountNumberTailConstraint:function(a,b,c){return w(a.getAdditionalData("accountNumberTail"),b,c)},ValidCreditCardNumberConstraint:function(b,c,d){var e=b.getAdditionalData("isSBIMaestroFn");e=f.isFunction(e)?e():!1;c=u(c[d.defaultParameterName]);b=b.getAdditionalData("issuerFn");b="Naranja"===(f.isFunction(b)?
b():"")?!0:!1;if(b){if(e=16===c.length)if(c&&16===c.length){e=[4,3,2,7,6,5,4,3,2,7,6,5,4,3,2];for(d=b=0;d<c.length-1;d++)b+=parseInt(c.charAt(d),10)*e[d];e=11-b%11;e=(9<e?0:e)===parseInt(c[15],10)}else e=!1;return e}return e?19===c.length&&a(c):11<=c.length&&19>=c.length&&a(c)},ValidCreditCardNumberWarningConstraint:function(a,b,c){a=z.ValidCreditCardNumberConstraint(a,b,c);b=u(b[c.defaultParameterName]);return a||16>b.length},ValidCardHolderNameConstraint:function(a,b,c){return/([A-Z][a-z][a-z]*) ([A-Z][a-z]*)*(\.)? *([A-Z][a-z][a-z][a-z]*)*/.test(b[c.defaultParameterName])},
ValidMinimalCardHolderNameConstraint:function(a,b,c){return z.NonEmptyFieldConstraint(a,b,c)},ValidEBTCardNumberConstraint:function(b,c,d){var e=u(c[d.defaultParameterName]);b=f.some(["600486","507714","507712"],function(a){return f.startsWith(e,a)})?p:a;return 16<=e.length&&19>=e.length&&b(e)},MatchValuesJSOnlyConstraint:function(a,b,c,d){a=b[c.defaultParameterName];b=b[d.targetFieldParameterName];return a!==F&&b!==F&&a===b},DirectDebitPrefixNotContainsDigitsConstraint:function(a,b,c,d){a=b[c.defaultParameterName];
d=d.lengthParameter;return a!==F&&null!==a&&null===a.substring(0,d).match(/\d+/g)},BrazilTaxIdConstraint:function(a,b,c,d){a=b[c.defaultParameterName];if(a===F||11!=a.length&&14!=a.length)return!1;if(11==a.length)return b=a.substr(0,9),b+=n(b),b+=n(b),b.substr(-2)===a.substr(-2);if(14==a.length)return b=a.substr(0,12),b+=g(b),b+=g(b),b.substr(-2)===a.substr(-2)},BusinessTaxIDConstraint:function(a,b,c,d){d=b[c.defaultParameterName];return z.NonEmptyFieldConstraint(a,b,c)&&2>=d.replace(/[^-]/g,"").length&&
9===d.replace(/[-]/g,"").length&&/^\d+$/.test(d.replace(/[-]/g,""))},InvoiceBirthdateConstraint:function(a,b,c,d){a=parseInt(b[c.monthParameterName],10)-1;d=parseInt(b[c.dayParameterName],10)-1;c=parseInt(b[c.yearParameterName],10);var e=new Date(b.widgetCreationEpochMilliseconds);b=e.getUTCFullYear()-18;var f=e.getUTCMonth();e=e.getUTCDate();return a||d||c?b>c||b===c&&f>a||b===c&&f===a&&e>=d:!0},ValidPhoneNumberConstraint:function(a,b,c,d){return l(a)?(a=b[c.defaultParameterName],d=new RegExp(d.pattern),
!!a&&d.test(f.trim(a.replace(/[\s\(\)\-]/g,"")))):!0},ValidCreditCardPostalCodeConstraint:function(a,b,c,d){if(!v(b,c))return!0;a=b[c.defaultParameterName];d=new RegExp(d.pattern);return!!a&&d.test(a)},ValidVirtualPrivateAddressConstraint:function(a,b,c){return(a=b[c.defaultParameterName])&&a.match(/^([a-zA-Z0-9\.\-]+)([@]{1})([a-zA-Z0-9\-\.]+){1,255}$/)},RequiredNonEmptyConstraint:function(a,b,c){return v(b,c)?z.NonEmptyFieldConstraint(a,b,c):!0},RequiredValidDateConstraint:function(a,b,c,d){if(!v(b,
c))return!0;a=b[c.defaultParameterName];b=d.separator;if((new RegExp(d.pattern)).test(a))if(b=a.split(b),d=parseInt(b[0],10),a=parseInt(b[1],10),b=parseInt(b[2],10),1E3>b||3E3<b||0===a||12<a)d=!1;else{c=[31,28,31,30,31,30,31,31,30,31,30,31];if(0===b%400||0!==b%100&&0===b%4)c[1]=29;d=0<d&&d<=c[a-1]}else d=!1;return d},ContainsOnlyDigitsConstraint:function(a,b,c){return p(b[c.defaultParameterName])},ValidCreditCardCurrencyCodeConstraint:function(a,b,d,e){return v(b,d)?c(new RegExp(e.pattern),[b[d.defaultParameterName],
b[d.radioButtonName],b[d.dropdownName]]):!0}};return z});w("widget-factory",["widget","lang","config","clog","testAjaxCapability"],function(f,d,b,a,c){function e(a,b,d,e,u){a=new f(a,b,d,e,u,function(a){g(a);"true"===a.options.testAjaxAuthenticationRequired&&c.makeCall(a)});n(a);return m[b.widgetInstanceId]=a}function n(b){a.logLatencyMetric({feature:"Widget",resource:"_Latency"});b.log({WidgetCreationTime:a.getCurrentTime()-a.getWidgetStartTime()})}function g(a){var c=a.publicProxy();b.getAttribute("onWidgetCreated")&&
d.forEach(b.getAttribute("onWidgetCreated"),function(a){a(c)})}var m={};return{_widgets:m,create:function(a,b,c,d,f){var g=m[b.widgetInstanceId];g&&g.continueRequestAjaxSubstitutionEnabled?g.setup(b,c,d,f):g=e(a,b,c,d,f);return g}}});w("widget","base lang when jQuery attributes server form-helper events/form-submitted-event clog public-event-registry events/spinner-events continuable AUI!P global-event-bus events security events/js-continue-failure-event clientSideEventLogger redirection-helper".split(" "),
function(f,d,b,a,c,e,n,g,m,p,l,t,v,w,D,y,x,z,h){var q=["sif_profile"];c=f.extend(t,{initialize:function(a,b,c,d,e,f){this.type=a;if(!b.widgetInstanceId)throw Error("widgetInstanceId is required.");this.widgetInstanceId=b.widgetInstanceId;this.widgetAjaxUrlPrefixPath=b.widgetAjaxUrlPrefix?b.widgetAjaxUrlPrefix:"";this.widgetRequestPrefixPath=b.widgetRequestPrefix?b.widgetRequestPrefix+"/":"";this.widgetFormData=null;this.setup(b,c,d,e,f,!0)},setup:function(a,b,c,d,e,f){this.off(null,this);this.offAui();
w.off("AuthTimeout");D.off("AuthTimeout");this.continueRequestAjaxSubstitutionEnabled=a.continueRequestAjaxSubstitutionEnabled!==F?!!a.continueRequestAjaxSubstitutionEnabled:!!this.continueRequestAjaxSubstitutionEnabled;this.components={};this.continueRequestQueue=new A;this.throttledContinueEvents={};this.widgetCreationEpochMilliseconds=d;this._localizationStringsMap=c;this.pageScrolled=!1;this.options=a;this.security=new y(this);this._registerWidgetPublicEvents();e&&e(this);this.serverToClientClockDifference=
this.widgetCreationEpochMilliseconds-Date.now();this.clientSideRequestTimeOffset=0;0<this.serverToClientClockDifference?this.clientSideRequestTimeOffset=this.serverToClientClockDifference:-12E4>this.serverToClientClockDifference&&(this.clientSideRequestTimeOffset=this.serverToClientClockDifference);0!==this.clientSideRequestTimeOffset&&f&&this.publishSuccessSushiMetrics({ActionType:"ClientSideRequestTimeOffsetEvent",ActionValueType:"ClientSideRequestTimeOffset",ActionValue:this.clientSideRequestTimeOffset});
this.on("AuthTimeout",this,function(a){u!==u.parent&&u.parent.PaymentsPortal2&&u.parent.PaymentsPortal2.modules&&(u.parent.PaymentsPortal2.modules.when(["global-event-bus"],function(b){b.trigger("AuthTimeout",a)}),u.parent.PaymentsPortal2.modules.when(["events"],function(b){b.trigger("AuthTimeout",a)}))});w.on("AuthTimeout",this,function(a){this.trigger("AuthTimeout",a)});this.on(x,this,function(){this.trigger("Done",{widgetDone:"true",WidgetResponseStatusCode:"500"})});this._initializeComponents(b)},
getLocalizedString:function(a,b){a=this._localizationStringsMap[a]||"";b&&(a=d.keywordFormat(a,b));return a},clientSideEventsHandler:function(a,b){"true"===this.options.clientLoggingWeblabEnabledValue&&z.storeEventsData({eventName:a,eventObject:b},{customerId:this.options.customerId,widgetInstanceId:this.options.widgetInstanceId,sessionId:this.options.sessionId},a)},publicProxy:function(){var a=this;return a._proxy?a._proxy:a._proxy={type:a.type,on:function(b,c){a.onPublicEvent(b,c)},update:function(b){a.trigger("UpdateWidget",
b)},complete:function(){m.logCounterMetric({feature:"InlineWidget",resource:"CompleteWidgetEvent"});m.publishMetrics();a.trigger("CompleteWidget")},isContinuable:function(){return a.getContinuable()}}},onPublicEvent:function(a,b){var c=this;c.on(a,c.publicProxy(),function(){p.has(a)||c.log({publicEventConsumedButNotRegistered:a});return b.apply(c.publicProxy(),arguments)})},submitFormAJAX:function(b,c){var e=this;if(b instanceof a){var f=n.serializeObject(b);c=c||{};c.queryParameters=this._whitelistedQueryParameters(b.get(0).action)}else f=
b;f["ppw-widgetState"]&&0!==a.trim(f["ppw-widgetState"]).length?(e.trigger("submitFormAjaxStarted"),e.continueRequest(f,d.extend({},c,{success:e.createAjaxContinueSuccessHandler(c?c.success:null),complete:function(){e._fixDropdown();e.trigger("submitFormAjaxCompleted")}}))):(this.trigger(l.hideSpinner),this.fatal({type:"error",reason:"Widget state is missing in form data",feature:"MissingWidgetState"}))},_whitelistedQueryParameters:function(a){var b={};if(!a||-1===a.indexOf("?"))return b;a=a.substring(a.indexOf("?")+
1);d.forEach(a.split("\x26"),function(a){a=a.split("\x3d");0<=d.indexOf(q,a[0])&&(b[a[0]]=a[1])});return b},createAjaxContinueSuccessHandler:function(a){var b=this;return function(c){b._onAJAXContinueSuccess(c);a&&d.isFunction(a)&&a.apply(b,arguments)}},continueRequest:function(a,b){b=b?d.extend({},b):{};b.data=d.extend({},b.data?b.data:{},{"ppw-jsEnabled":!0},a);this.continueRequestQueue.enQueue(new r(this.options.customerId,b,this));this._processContinueRequestQueue()},asyncContinueRequest:function(a,
b){b=b?d.extend({},b):{};b.data=d.extend({},b.data?b.data:{},{"ppw-jsEnabled":!0},a);b.resumeContinueQueueOnSuccess=!1;b.resumeContinueQueueOnError=!1;b.resumeContinueQueueOnFatal=!1;a=new r(this.options.customerId,b,this);return e.ajax(a.options)},fatal:function(a){a=a||{type:"error"};var b="auth"===a.type?"AuthTimeout":"Fatal",c=a.feature||"AjaxContinue";"Fatal"===b&&(this.log({ajaxFatal:a}),m.logCounterMetric({feature:c,resource:"_ErrorCount"}),m.publishMetrics());this.trigger(b,a)},_recordSuccess:function(a){a=
a||{type:"error"};m.logCounterMetric({feature:a.feature||"AjaxContinue",resource:"_ErrorCount",amount:0});m.publishMetrics()},widgetAction:function(a){this.trigger("WidgetAction",a)},width:function(){var b=this.getRootDOMElements(),c=0,e;d.forEach(b,function(b){e=a(b);(b=e.outerWidth())&&b>c&&(c=b)});return c},height:function(){var b=this.getRootDOMElements(),c=0,e;d.forEach(b,function(b){e=a(b);(b=e.outerHeight())&&(c+=b)});return c},scrollToElementOnInitialize:function(b){this.pageScrolled||(this.scrollToElement(a("#"+
b)),this.pageScrolled=!0)},scrollToElement:function(b){b&&0<b.length&&a("html, body").animate({scrollTop:b.offset().top},"fast")},scrollToElementWithCompensation:function(b){b&&0<b.length&&a("html, body").animate({scrollTop:b.offset().top-65},"fast")},focusToElement:function(b){a("#"+b).focus()},scrollToTopOfThePage:function(){this.pageScrolled||(this.forceToScrollToTopOfThePage(),this.pageScrolled=!0)},forceToScrollToTopOfThePage:function(){a("html, body").scrollTop(0)},_initializeComponents:function(a){var c=
this,e=d.map(a,function(a){return"components/"+a.type});d.forEach(e,function(d,e){var f=a[e];b([d],function(a){c.components[f.id]=new a(c,f)})});b(e,function(){var a=e.length-d.keys(c.components).length;0<a&&(m.logCounterMetric({feature:"ComponentModulesNotLoaded",resource:"_Count",amount:a}),m.publishMetrics());c._onComponentsInitialized()},!0)},_registerWidgetPublicEvents:function(){p.register("AuthTimeout","Done","Fatal",g,l.showSpinner,l.hideSpinner,"WidgetAction")},_onComponentsInitialized:function(){var b=
this;a("document").ready(function(){d.forEachKeyValue(b.components,function(a,b){b.initializeOnReady()});b._setupFormHandling();b.trigger("componentsInitialized");b.log({event:"ComponentsInitialized"})})},_setupFormHandling:function(){var a=this.getRootDOMElements();n.onSubmit(a.find("form").andSelf().filter("form"),d.bind(this._onFormSubmission,this))},_onFormSubmission:function(a,b,c){this.ajaxSubstitutionEnabled(a)?this._onAJAXFormSubmission(a,b,c):this._onStandardFormSubmission(a,b,c)},_onStandardFormSubmission:function(a,
b,c){},_onAJAXFormSubmission:function(a,b,c){this.isFormContinueEventThrottled(c,a)&&b.preventDefault();if(!b.isDefaultPrevented()){b.preventDefault();b={};if(c){var d=c.get(0).name;""!==d&&(b[d]=c.val())}this.submitFormAJAX(a,{data:b})}},ajaxSubstitutionEnabled:function(a){a=a.get(0).getAttribute("data-pmts-ajax-continuation");return this.continueRequestAjaxSubstitutionEnabled&&(null==a||"true"===a)},setAjaxSubstitutionEnabled:function(a,b){a.attr("data-pmts-ajax-continuation",b)},_onAJAXContinueSuccess:function(a){this._recordSuccess();
a.htmlContent&&this._swapHtmlAndEval(a.htmlContent)},_resumeContinueRequestQueue:function(){this.processingContinueRequest=!1;this._processContinueRequestQueue()},_processContinueRequestQueue:function(){!this.processingContinueRequest&&0<this.continueRequestQueue.length()&&this._processContinueRequest(this.continueRequestQueue.deQueue())},_processContinueRequest:function(a){this.processingContinueRequest=!0;m.publishMetrics();return e.ajax(a.options)},_handleContinueSuccess:function(a){a&&a.htmlChunks&&
a.componentDataList||this.fatal();this._recordSuccess();this._updateWidgetHtml(a.htmlChunks);this._attachNewComponents(a.componentDataList);this._resumeContinueRequestQueue()},_handleContinueError:function(a){400===a.status&&a.getResponseHeader("X-Amzn-Errortype").includes("ThrottlingException")?(this.updateThrottledContinueEvents(a.responseText),this.applyThrottledCustomerExperienceIfApplicable()):this.fatal()},_attachNewComponents:function(b){var c=[];d.forEach(b,function(b){c.push(a.parseJSON(b))});
this._initializeComponents(c)},_updateWidgetHtml:function(a){var b=this;d.forEachKeyValue(a,function(a,c){b._updateComponentDOM(a,c)})},_updateComponentDOM:function(a,b){var c=this.components[a];c&&(c=c.getRootDOMElements(),this._deleteComponentsInDOM(c),this._deleteComponent(a),c.first().before(b).end().remove())},_deleteComponentsInDOM:function(b){var c=this;b.find("[data-pmts-component-id]").each(function(b,d){b=a(d).attr("data-pmts-component-id");c._deleteComponent(b)})},_removeWidgetComponents:function(){var a=
this;a.trigger("widget:clean");d.forEachKeyValue(a.components,function(b,c){c&&(c.detach(),delete a.components[b],c.getRootDOMElements().remove())})},_removeDropdownPopovers:function(){v.when("a-popover-base").execute(function(b){a(".pmts-portal-component .a-dropdown-container").each(function(){b.remove(a(this).find("select").attr("name"))})})},_deleteComponent:function(a){var b=this.components[a];b&&(b.detach(),delete this.components[a])},getRootDOMElements:function(){return a(".pmts-portal-root-"+
this.widgetInstanceId)},_getWidgetDOMAppender:function(){var a=this.getRootDOMElements();if(0===a.length)throw Error("Could not find the root dom elements of the widget in order to append new content.");a=a.get(a.length-1);var b=a.nextSibling,c=a.parentNode,e=null;e=b?function(a){c.insertBefore(a,b)}:function(a){c.appendChild(a)};return function(a){d.forEach(a,e)}},_fixDropdown:function(){var a=this.getRootDOMElements(),b=a.find("select.a-native-dropdown").not("[data-action\x3da-dropdown-select]");
b.length&&(a.find(".a-button-dropdown").attr("aria-hidden",!0).find(".a-button-text").removeAttr("tabindex"),b.attr({tabindex:0,"data-action":"a-dropdown-select"}).addClass("a-declarative"))},_swapHtmlAndEval:function(b){var c=[],e=[];a(b).each(function(b,d){1===d.nodeType?a(d).is("style")||(a(d).is("script:not([src])")?e.push(d):c.push(d)):c.push(d)});a(".apx-secondary-view-root-"+this.widgetInstanceId).remove();b=this._getWidgetDOMAppender(this);this._removeWidgetComponents();this._removeDropdownPopovers();
this.getRootDOMElements().remove();0<c.length&&(b(c),d.forEach(e,function(b){a.globalEval(a(b).html())}))},log:function(a){"false"===this.options.clientLoggingWeblabEnabledValue&&(a=d.extend({customerId:this.options.customerId,widgetInstanceId:this.options.widgetInstanceId,sessionId:this.options.sessionId,clientId:this.options.clientId},a),m.log(a))},_generateWidgetRequestHeaders:function(){return{"APX-Widget-Info":[this.options.clientId,this.options.deviceType,this.options.widgetInstanceId].join("/")}},
_publishSushiMetrics:function(a){var b={ActionResult:a.ActionResult,PageLocale:this.options.locale,CustomerId:this.options.customerId,WidgetInstanceId:this.options.widgetInstanceId,WidgetDeviceType:this.options.deviceType,WidgetName:this.type,MarketplaceId:this.options.marketplaceId,Session:this.options.sessionId,PortalClientId:this.options.clientId,StartTime:Date.now()+this.clientSideRequestTimeOffset};b.RequestId=this.options.requestId?this.options.requestId:this.options.widgetInstanceId;var c=
{ActionType:null,ActionValueType:"Unspecified",ActionValue:null,ActionParentValueType:"Unspecified",ActionParentValue:null,ActionErrorCode:null},d;for(d in c)a[d]?b[d]=a[d]:c[d]&&(b[d]=c[d]);m.publishSushiEelMetrics(b,0)},publishFailureSushiMetrics:function(a){a.ActionResult="Failure";this._publishSushiMetrics(a)},publishSuccessSushiMetrics:function(a){a.ActionResult="Success";this._publishSushiMetrics(a)},updateThrottledContinueEvents:function(a){d.isString(a)&&(a=a.match(/WidgetContinueEvent:(.*?),/))&&
(this.throttledContinueEvents[a[1]]=!0)},isFormContinueEventThrottled:function(a,b){var c;a&&a.get(0)&&d.isString(a.get(0).name)?(a=a.get(0).name.match(/ppw-widgetEvent:([a-zA-Z]+):?/))&&(c=a[1]):b&&(a=b.find("input[name\x3dppw-widgetEvent]"))&&1===a.length&&(c=a.get(0).value);return this.throttledContinueEvents[c]},applyThrottledCustomerExperienceIfApplicable:function(){var b=a(".apx-throttle-alert");b&&(m.logCounterMetric({feature:"CustomerRateLimitingThrottleAlert",resource:"_Count"}),m.publishMetrics(),
b.removeClass("a-hidden aok-hidden"),this.disableContinueAddButton())},disableContinueAddButton:function(){var b=a(".pmts-button-input.a-button-primary");b&&(this.buttonAlreadyDisabledOnThrottledRequest&&(m.logCounterMetric({feature:"CustomerRateLimitingButtonDisabled",resource:"_Count"}),m.publishMetrics()),b.addClass("a-button-disabled"),b.prop("disabled",!0),this.buttonAlreadyDisabledOnThrottledRequest=!0)}});var r=f.extend({initialize:function(a,b,c){a=d.keywordFormat("{widgetAjaxUrlPrefixPath}/payments-portal/data/{widgetRequestPrefixPath}widgets2/v1/customer/{customerId}/continueWidget",
{customerId:a,widgetAjaxUrlPrefixPath:c.widgetAjaxUrlPrefixPath,widgetRequestPrefixPath:c.widgetRequestPrefixPath});if(b.queryParameters){var e=[];d.forEachKeyValue(b.queryParameters,function(a,b){e.push(encodeURIComponent(a)+"\x3d"+encodeURIComponent(b))});0<e.length&&(a=a+"?"+e.join("\x26"))}this.options=d.extend({},{type:"POST",url:a,success:d.bind(c._handleContinueSuccess,c),error:d.bind(c._handleContinueError,c),fatal:d.bind(c.fatal,c)},b);this.options.headers=d.extend({},this.options.headers,
c._generateWidgetRequestHeaders());d.intercept(this.options,"complete",function(a,d){var e=["timeout","parsererror"];e=0==a.status||500<=a.status||e.includes(d);m.logCounterMetric({feature:"AjaxContinue",resource:"_AvailabilityCount",amount:e?0:1});c.log({ajaxContinueStatus:a.status,ajaxContinueTextStatus:d,ajaxContinueRequestId:a.getResponseHeader("x-amz-rid"),ajaxContinueEvent:b.data?b.data["ppw-widgetEvent"]:"",isAjaxServiceUnavailable:e});b.data&&b.data["ppw-widgetEvent"]&&m.logCounterMetric({feature:b.data["ppw-widgetEvent"],
resource:"_AvailabilityCount",amount:e?0:1})},this);a=function(a,b,d){return b||d&&"undefined"===typeof b?function(b,d){try{a(b,d)}finally{c._resumeContinueRequestQueue()}}:a};this.options.success=a(function(a){return function(b,e){if(b&&b.additionalWidgetResponseData){var f=b.additionalWidgetResponseData.additionalData;if(f){if("true"===f.widgetDone){var g={};d.forEachKeyValue(f,function(a,b){try{var c=JSON.parse(b);g[a]="boolean"===typeof c?b:c}catch(U){g[a]=b}});if("true"===f.needsRedirect&&f.redirectUrl)return h.handleRedirection(f.redirectUrl,
f.httpMethod,f.httpParameters,c),c._recordSuccess(),PaymentsPortal2.events.STOP_EVENT_PROCESSING;"SetPaymentPlanSelect"===c.type?(c.log({additionalData:f,preWidgetDone:!0}),c.trigger("Done",f)):(c.log({jsonParsedAdditionalData:g,preWidgetDone:!0}),c.trigger("Done",g));c.log({widgetTriggerDone:!0})}f.widgetAction&&c.widgetAction(f)}}a(b,e)}}(this.options.success),this.options.resumeContinueQueueOnSuccess,!0);this.options.error=a(this.options.error,this.options.resumeContinueQueueOnError,!0);this.options.fatal=
a(this.options.fatal,this.options.resumeContinueQueueOnFatal,!0)}}),A=f.extend({initialize:function(){this.items=[]},enQueue:function(a){this.items.push(a)},deQueue:function(){return this.items.shift()},length:function(){return this.items.length}});return c});w("workflow-component",["component","lang","public-event-registry","events/workflow-state-event"],function(f,d,b,a){return f.extend({_workflowState:F,initialize:function(c,d){this._workflowState=d.data.workflowState;b.register(a)},bindToEvents:function(){var b=
this;b.widget.on("componentsInitialized",b,function(c){b.widget.trigger(a,b._workflowState)})}})})})()});
/* ******** */
(function(l){var u=window.AmazonUIPageJS||window.P,x=u._namespace||u.attributeErrors,r=x?x("APXWidgetsAssets@APXWidgets-TapAndPay","APXWidgetsAssets"):u;r.guardFatal?r.guardFatal(l)(r,window):r.execute(function(){l(r,window)})})(function(l,u,x){(function(){var r=PaymentsPortal2.modules.define;r("components/TapToAddCardComponent",["css-utils","jQuery","component","lang","clog"],function(f,r,J,h,n){var m=null,k=null,g=null,d=null,p=null,v=null,q=null,t=null,a=null,c=["PRESENT_CARD","PRESENT_CARD_AGAIN",
"CARD_READ_OK_PLEASE_REMOVE"],C={PRESENT_CARD:"PC",PRESENT_CARD_AGAIN:"PCA",CARD_READ_OK_PLEASE_REMOVE:"CR_OK_RM"},D="Success Pending Cancelled Failed Errored SessionActivated ERROR".split(" "),E={Success:"SCS",Pending:"PND",Cancelled:"CNCL",Failed:"FAIL",Errored:"ERRD",SessionActivated:"SSN_ACT",ERROR:"ERR"},u=["NFC_DISABLE","DEBUGGING_ENABLED","DEV_SETTING_ENABLED"],I={prepareTerminal:"PT",activateTerminalSession:"AT",readCard:"RC",activateAndReadCard:"ARC",deactivateTerminalSession:"DT"},x=["NFC_PERMISSION_DENIED"],
F="PRIMARY_SCREEN",w=!1,y=!1,H=0,G=0,z=!1,A={INVALID_ACTION_REQUESTED:"apx_tta_terminal_initialization_error",SDK_INITIALIZATION_ERROR:"apx_tta_terminal_initialization_error",NFC_DISABLED:"apx_tta_enable_nfc_in_settings",NFC_NOT_PRESENT:"apx_tta_nfc_not_detected_error",INTERNAL_ERROR:"apx_tta_terminal_initialization_error",TERMINAL_NOT_FOUND:"apx_tta_terminal_not_found_error",ATTESTATION_FAILURE:"apx_tta_device_not_supported_error",LICENSE_VALIDATION_FAILURE:"apx_tta_license_validation_failure",TERMINAL_CREATION_FAILED:"apx_tta_terminal_initialization_error",
TERMINAL_SESSION_ACTIVATION_FAILED:"apx_tta_terminal_initialization_error",TERMINAL_SESSION_NOT_FOUND:"apx_tta_terminal_session_not_found",CARD_REJECTED:"apx_tta_card_brand_not_supported_error",TIMEOUT:"apx_tta_timeout_error",INVALID_CARD_DATA:"apx_tta_error_reading_card",MASH_ATTESTATION_FAILURE:"apx_tta_device_not_supported_error",KILL_SWITCH_ENABLED:"apx_tta_kill_switch_enabled_without_update_available",KILL_SWITCH_ENABLED_WITH_UPDATE:"apx_tta_kill_switch_enabled_with_update_available",MSHOP_APP_DEBUGGABLE:"apx_tta_terminal_initialization_error",
INVALID_ANDROID_SDK_VERSION:"apx_tta_terminal_initialization_error",DEBUGGER_ATTACHED:"apx_tta_developer_settings_error",INVALID_INSTALLATION_SOURCE:"apx_tta_terminal_initialization_error",JSON_EXCEPTION:"apx_tta_terminal_initialization_error",INVALID_INPUT_NULL_OR_EMPTY_STRINGS:"apx_tta_terminal_initialization_error",ERROR_FETCHING_LICENSE:"apx_tta_license_validation_failure",ERROR_FETCHING_EMV_CONFIG:"apx_tta_license_validation_failure",NO_CARD_APPLICATION:"apx_tta_no_card_application_error",CARD_ERROR:"apx_tta_no_card_application_error",
PROCESSING_ERROR:"apx_tta_no_card_application_error",SDK_SERVICE_ERROR:"apx_tta_terminal_initialization_error",NULL_REQUEST_DATA:"apx_tta_terminal_initialization_error",INVALID_REQUEST_DATA:"apx_tta_terminal_initialization_error",NULL_RESPONSE_DATA:"apx_tta_terminal_initialization_error",REMOTE_EXCEPTION:"apx_tta_terminal_initialization_error",SDK_SERVICE_EXCEPTION:"apx_tta_terminal_initialization_error",NULL_RESPONSE_DATA_PLUGIN:"apx_tta_terminal_initialization_error",PROCESS_ISOLATION_EXCEPTION:"apx_tta_terminal_initialization_error",
BINDING_ERROR:"apx_tta_terminal_initialization_error",MOBILE_WALLETS_NOT_SUPPORTED:"apx_tta_digital_wallet_unsupported_error",DEFAULT:"apx_tta_terminal_initialization_error"},K=["valued customer","visa cardholder"],B="id"+Math.random().toString(16).slice(2);return J.extend({_getLocalizedViolationMessage:function(b,e){var a=this,c=null;try{var d=JSON.parse(b);d&&d.violations?(b=null,d.violations.forEach(function(b){u.includes(b)&&a._publishCounterMetricsForTapToAdd(e+"_Violation."+b)}),d.violations.includes("NFC_DISABLE")?
(b=A.NFC_DISABLED,w=!0):d.violations.includes("DEBUGGING_ENABLED")?b=A.DEBUGGER_ATTACHED:d.violations.includes("DEV_SETTING_ENABLED")&&(b=A.DEVELOPER_SETTING_ENABLED),b&&(c=a.widget.getLocalizedString(b))):d?a._publishCounterMetricsForTapToAdd(e+"_Violation.Null"):a._publishCounterMetricsForTapToAdd(e+"_NullResponse")}catch(M){a._publishCounterMetricsForTapToAdd(e+"_Violation.InvalidResponse")}c||(c="NULL_FIELD");return c},_getLocalizedErrorMessage:function(b,e){var a=null;try{var c=JSON.parse(b);
if(c&&c.error_code){var d=A[c.error_code];d?(a=this.widget.getLocalizedString(d),this._publishCounterMetricsForTapToAdd(I[e]+"_Error."+c.error_code),this._publishCounterMetricsForTapToAdd(e+"_Error."+c.error_code)):x.includes(c.error_code)?this._publishCounterMetricsForTapToAdd(I[e]+"_Error."+c.error_code):this._publishCounterMetricsForTapToAdd(e+"_Error.Unknown")}else c?this._publishCounterMetricsForTapToAdd(e+"_Error.NullErrorCode"):this._publishCounterMetricsForTapToAdd(e+"_Error.NullResponse")}catch(M){this._publishCounterMetricsForTapToAdd(e+
"_Error.InvalidResponse")}a||(a=this.widget.getLocalizedString(A.DEFAULT));return a},_getValidExpiryDate:function(b,e){var a=(new Date).getUTCFullYear();return b&&e?e<a?(this._publishCounterMetricsForTapToAdd("ExpiredCardTap"),{expiryMonth:1,expiryYear:a}):{expiryMonth:b,expiryYear:e}:{expiryMonth:1,expiryYear:a}},_publishCounterMetricsForTapToAdd:function(b){var e="TapToAdd_";this.data.processIsolation&&(e+="PI_");n.logCounterMetric({feature:e+b,resource:"_Count"});n.publishMetrics()},_publishLatencyMetricsForTapToAdd:function(b,
e){var a="TapToAdd_";this.data.processIsolation&&(a+="PI_");e&&(n.logLatencyMetric({feature:a+b,resource:"_Latency",startTime:e}),n.publishMetrics())},_publishMetricsForReadCard:function(b,e,a){b&&e?D.includes(b)&&c.includes(e)?this._publishCounterMetricsForTapToAdd(a+"_Status."+E[b]+"_CA."+C[e]):D.includes(b)?this._publishCounterMetricsForTapToAdd(a+"_Status."+E[b]+"_CA.Unknown"):c.includes(e)?this._publishCounterMetricsForTapToAdd(a+"_Status.Unknown_CA."+C[e]):this._publishCounterMetricsForTapToAdd(a+
"_Status.Unknown_CA.Unknown"):b&&!e&&("Pending"===b?this._publishCounterMetricsForTapToAdd(a+"_Status."+E[b]+"_CA.Null"):D.includes(b)?this._publishCounterMetricsForTapToAdd(a+"_Status."+E[b]):this._publishCounterMetricsForTapToAdd(a+"_Status.Unknown"))},_triggerTapFailureEvent:function(b,e){b={failedAction:e,failureAlertMessage:b};this._publishCounterMetricsForTapToAdd("FailureEventTriggered");this.widget.trigger("tapToAddCardFailureEvent",b)},_closeSecondaryView:function(){var b=this;l.when("a-secondary-view").execute(function(e){e&&
(e=e.get("tap-to-add-popover"))&&(f.showElement(b.getDOMElement("tap-to-add-spinner")),f.hideElement(b.getDOMElement("tap-to-add-gif")),e.hide())})},_handleCorruptResponseInReadCardSuccessCallback:function(b){this._publishCounterMetricsForTapToAdd(b);b=this.widget.getLocalizedString(A.DEFAULT);this._triggerTapFailureEvent(b,"readCard");this._closeSecondaryView()},_handleCardInfoNullFields:function(b,e,a,c){var d=0,p=0,f=0,g=0;b||(d=1);a||(p=1);e||(f=1);"NULL_FIELD"===c&&(g=1);this._publishCounterMetricsForTapToAdd("ReadCardResponse_NullFields_Number."+
d+"_Month."+p+"_Year."+f);this._publishCounterMetricsForTapToAdd("ReadCardResponse_NullFields_CardHolderName."+g)},_handleReadCardSuccess:function(b){this._publishCounterMetricsForTapToAdd("readCard_Success");try{var e=JSON.parse(b);if(!e){this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ParsedResponseNull");return}e.status||this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ResponseStatusNull");this._publishMetricsForReadCard(e.status,e.customer_action,"readCard");"Pending"===
e.status&&"PRESENT_CARD"===e.customer_action?(f.hideElement(this.getDOMElement("tap-to-add-spinner")),f.showElement(this.getDOMElement("tap-to-add-gif")),z=!1,y?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterError"),w=y=!1):w?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterViolation"),w=!1):this._publishCounterMetricsForTapToAdd("NFC_enabled")):"Pending"===e.status&&"PRESENT_CARD_AGAIN"===e.customer_action?z=!0:"Pending"===e.status&&"CARD_READ_OK_PLEASE_REMOVE"===e.customer_action?
(k=(new Date).getTime(),f.hideElement(this.getDOMElement("tap-to-add-gif")),f.showElement(this.getDOMElement("tap-to-add-spinner"))):"Cancelled"===e.status?(this._publishCounterMetricsForTapToAdd("BackButtonClicked"),this._publishLatencyMetricsForTapToAdd("BackButtonClicked_Latency",m),5E3>(new Date).getTime()-m&&this._publishCounterMetricsForTapToAdd("AccidentalClick"),m=null):"Success"===e.status&&(this._handleReadCardSuccessStatus(e),k=m=null,this._closeSecondaryView())}catch(L){this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ResponseParsingFailure")}this._publishLatencyMetricsForTapToAdd("ReadCardSuccess_Latency",
v);v=null},_handleReadCardFailure:function(b){this._publishCounterMetricsForTapToAdd("readCard_Failure");var e=this._getLocalizedErrorMessage(b,"readCard");this._triggerTapFailureEvent(e,"readCard");(b=JSON.parse(b))&&b.error_code&&"TIMEOUT"===b.error_code&&(G+=1,z&&this._publishCounterMetricsForTapToAdd("RC_timeout_cardTapAttempted"));this._closeSecondaryView();this._publishLatencyMetricsForTapToAdd("ReadCardFailure_Latency",v);v=null},_handleActivationSuccess:function(b){var e=this;e._publishCounterMetricsForTapToAdd("activateTerminalSession_Success");
l.when("TapAndPay").execute(function(b){"SECONDARY_SCREEN"===F?(v=(new Date).getTime(),b.readCard({request_id:B,processIsolation:e.data.processIsolation.toString(),mlfLoggerWeblabEnable:e.data.isMlfLoggerWeblabEnable.toString(),successCallback:h.bind(e._handleReadCardSuccess,e),failCallback:h.bind(e._handleReadCardFailure,e)})):e._invokeDeactivateTerminalSession()});e._publishLatencyMetricsForTapToAdd("ActivateTerminalSuccess_Latency",p);p=null},_handleActivationFailure:function(b){var e=this._getLocalizedErrorMessage(b,
"activateTerminalSession");this._triggerTapFailureEvent(e,"activateTerminalSession");this._closeSecondaryView();(b=JSON.parse(b))&&b.error_code&&"NFC_DISABLED"===b.error_code&&(y=!0);this._publishCounterMetricsForTapToAdd("activateTerminalSession_Failure");this._publishLatencyMetricsForTapToAdd("ActivateTerminalFailure_Latency",p);p=null},_handlePrepareTerminalSuccessOnButtonClick:function(b){var e=this;e._publishCounterMetricsForTapToAdd("prepareTerminalSuccessOnButtonClick");e._publishLatencyMetricsForTapToAdd("prepareTerminalSuccessOnButtonClick_Latency",
d);d=null;l.when("TapAndPay").execute(function(b){p=(new Date).getTime();b.activateTerminalSession({request_id:B,offline_activation:"true",digital_wallet_tap_weblab_enabled:e.data.digitalWalletTapWeblabEnabled.toString(),mlfLoggerWeblabEnable:e.data.isMlfLoggerWeblabEnable.toString(),processIsolation:e.data.processIsolation.toString(),successCallback:h.bind(e._handleActivationSuccess,e),failCallback:h.bind(e._handleActivationFailure,e)})})},_handlePrepareTerminalFailureOnButtonClick:function(b){b=
this._getLocalizedErrorMessage(b,"prepareTerminal");this._triggerTapFailureEvent(b,"prepareTerminal");this._closeSecondaryView();this._publishCounterMetricsForTapToAdd("prepareTerminalFailureOnButtonClick");this._publishLatencyMetricsForTapToAdd("prepareTerminalFailureOnButtonClick_Latency",d);d=null},_handleReadCardSuccessStatus:function(b){if(b.card_data){var e=null,a=null,c=null;b.card_data.card_number&&(e=BigInt(b.card_data.card_number));b.card_data.expiration_month&&(a=parseInt(b.card_data.expiration_month,
10));b.card_data.expiration_year&&(c=parseInt(b.card_data.expiration_year,10));var d="NULL_FIELD";b.card_data.account_holder_name?d=K.includes(b.card_data.account_holder_name.toString().toLowerCase())?"NULL_FIELD":b.card_data.account_holder_name.toString():this._publishCounterMetricsForTapToAdd("ReadCardResponse_MissingField_CardHolderName");e||a||c?(this._handleCardInfoNullFields(e,c,a,d),this.data.isFixExpiredCardDateWeblabEnabled?(b=this._getValidExpiryDate(a,c),e={creditCardNumber:e?e.toString():
"NULL_FIELD",expirationMonth:b.expiryMonth.toString(),expirationYear:b.expiryYear.toString(),cardHolderName:d}):e={creditCardNumber:e?e.toString():"NULL_FIELD",expirationMonth:a?a.toString():"1",expirationYear:c?c.toString():(new Date).getUTCFullYear().toString(),cardHolderName:d},e={successAlertMessage:this.widget.getLocalizedString("apx_tta_success_tap_to_add"),cardInfo:e,startTimeAtButtonClick:m,startTimeAfterCardTapped:k,processIsolation:this.data.processIsolation},this._publishCounterMetricsForTapToAdd("SuccessEventTriggered"),
this.widget.trigger("addCreditCardTapInfo",e)):this._handleCorruptResponseInReadCardSuccessCallback("ReadCardResponse_NullFields_Number.1_Month.1_Year.1")}else this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ResponseCardDataNull")},_handleActivateAndReadCardSuccess:function(b){this._closeSecondaryView();this._publishCounterMetricsForTapToAdd("activateAndReadCard_Success");try{var a=JSON.parse(b);if(!a){this._handleCorruptResponseInReadCardSuccessCallback("activateAndReadCard_ParsedResponseNull");
return}a.status||this._handleCorruptResponseInReadCardSuccessCallback("activateAndReadCard_ResponseStatusNull");this._publishMetricsForReadCard(a.status,a.customer_action,"activateAndReadCard");"Pending"===a.status&&"PRESENT_CARD"===a.customer_action?(z=!1,y?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterError"),w=y=!1):w?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterViolation"),w=!1):this._publishCounterMetricsForTapToAdd("NFC_enabled"),this._publishLatencyMetricsForTapToAdd("Gif_Render_Latency",
m)):"Pending"===a.status&&"PRESENT_CARD_AGAIN"===a.customer_action?z=!0:"Pending"===a.status&&"CARD_READ_OK_PLEASE_REMOVE"===a.customer_action?k=(new Date).getTime():"Cancelled"===a.status?(this._publishCounterMetricsForTapToAdd("BackButtonClicked"),this._publishLatencyMetricsForTapToAdd("BackButtonClicked_Latency",m),5E3>(new Date).getTime()-m&&this._publishCounterMetricsForTapToAdd("AccidentalClick"),m=null,this._invokeDeactivateTerminalSession()):"Success"===a.status&&(this._handleReadCardSuccessStatus(a),
k=m=null)}catch(L){this._handleCorruptResponseInReadCardSuccessCallback("activateAndReadCard_ResponseParsingFailure")}this._publishLatencyMetricsForTapToAdd("activateAndReadCard_SuccessLatency",q);q=null},_handleActivateAndReadCardFailure:function(b){this._closeSecondaryView();this._invokeDeactivateTerminalSession();var a=this._getLocalizedErrorMessage(b,"activateAndReadCard");b=JSON.parse(b);"NFC_PERMISSION_DENIED"!=b.error_code&&this._triggerTapFailureEvent(a,"activateAndReadCard");b&&b.error_code&&
"NFC_DISABLED"===b.error_code&&(y=!0);b&&b.error_code&&"TIMEOUT"===b.error_code&&(G+=1,z&&this._publishCounterMetricsForTapToAdd("ARC_timeout_cardTapAttempted"));this._publishCounterMetricsForTapToAdd("activateAndReadCard_Failure");this._publishLatencyMetricsForTapToAdd("activateAndReadCard_FailureLatency",q);q=null},_handleTapToAddButtonClick:function(){m=(new Date).getTime();var b=this;F="SECONDARY_SCREEN";f.hideElement(b.getDOMElement("tap-to-add-gif"));f.showElement(b.getDOMElement("tap-to-add-spinner"));
b._hideTapToAddAlert("#tap-to-add-subtitle-alert-element");b._hideTapToAddAlert("#tap-to-add-alert-id");b.data.processIsolation?l.when("TapAndPay").execute(function(a){q=(new Date).getTime();a.activateAndReadCard({request_id:B,digital_wallet_tap_weblab_enabled:b.data.digitalWalletTapWeblabEnabled.toString(),processIsolation:b.data.processIsolation.toString(),nfcAlertBoxWeblabEnable:b.data.nfcAlertBoxWeblabEnable.toString(),mlfLoggerWeblabEnable:b.data.isMlfLoggerWeblabEnable.toString(),titleString:b.widget.getLocalizedString("apx_tta_button_tap_to_add"),
contentString:b.widget.getLocalizedString("apx_tta_tap_to_add_instruction"),cardReadProcessingDurationString:b.widget.getLocalizedString("apx_tta_card_read_processing_duration"),nfcAlertBoxTitleString:b.widget.getLocalizedString("apx_tta_nfc_alert_box_title"),nfcAlertBoxMessageString:b.widget.getLocalizedString("apx_tta_nfc_alert_box_message"),nfcAlertBoxNavigateToSettingString:b.widget.getLocalizedString("apx_tta_nfc_alert_box_navigate_to_setting_button"),nfcAlertBoxCancelString:b.widget.getLocalizedString("apx_tta_cancel_button"),
successCallback:h.bind(b._handleActivateAndReadCardSuccess,b),failCallback:h.bind(b._handleActivateAndReadCardFailure,b)})}):l.when("TapAndPay").execute(function(a){d=(new Date).getTime();a.prepareTerminal({request_id:B,enable_attestation:"false",processIsolation:b.data.processIsolation.toString(),mlfLoggerWeblabEnable:b.data.isMlfLoggerWeblabEnable.toString(),successCallback:h.bind(b._handlePrepareTerminalSuccessOnButtonClick,b),failCallback:h.bind(b._handlePrepareTerminalFailureOnButtonClick,b)})});
b._publishCounterMetricsForTapToAdd("ButtonClicked");H+=1;4>=H?b._publishCounterMetricsForTapToAdd("buttonClicksInSession."+H):b._publishCounterMetricsForTapToAdd("buttonClicksInSession.n");4>=G?b._publishCounterMetricsForTapToAdd("buttonClickedAfterTimeout_timeoutCount."+G):b._publishCounterMetricsForTapToAdd("buttonClickedAfterTimeout_timeoutCount.n")},_disableTapToAddButton:function(){this.getDOMElement("tap-to-add-button").addClass("apx-tap-to-add-disabled-button");this.getDOMElement("tap-to-add-button").addClass("a-button-disabled");
this.getDOMElement("tap-to-add-secondary-view-declarative").removeClass("a-declarative");this.getDOMElement("tap-to-add-button").attr("disabled","disabled")},_displayTapToAddSection:function(){f.showElement(this.getDOMElement("tap-to-add-section"));this._disableTapToAddButton();this._publishCounterMetricsForTapToAdd("SectionVisible")},_enableTapToAddButton:function(){this.getDOMElement("tap-to-add-button").removeClass("apx-tap-to-add-disabled-button");this.getDOMElement("tap-to-add-button").removeClass("a-button-disabled");
this.data.processIsolation||this.getDOMElement("tap-to-add-secondary-view-declarative").addClass("a-declarative");this.getDOMElement("tap-to-add-button").removeAttr("disabled");f.hideElement(this.getDOMElement("tap-to-add-disabled-subtitle"));this._publishLatencyMetricsForTapToAdd("ButtonEnabled_Latency",t);t=null},_handlePrepareTerminalSuccessOnPageLoad:function(a){var b=this;b._enableTapToAddButton();var c=JSON.parse(a);if(c&&c.violations&&0<c.violations.length){var d=b._getLocalizedViolationMessage(a,
"prepareTerminal");"NULL_FIELD"!==d?l.when("a-alert").execute(function(a){a=a("#tap-to-add-subtitle-alert-element");b.data.nfcAlertBoxWeblabEnable&&w||a.text(d).show();b._publishCounterMetricsForTapToAdd("ButtonEnabledWithViolation")}):(b._hideTapToAddAlert("#tap-to-add-subtitle-alert-element"),b._publishCounterMetricsForTapToAdd("Violation.Unknown"))}else b._hideTapToAddAlert("#tap-to-add-subtitle-alert-element");b._publishCounterMetricsForTapToAdd("ButtonEnabled");b._publishCounterMetricsForTapToAdd("PrepareTerminalSuccessOnPageLoad");
b._publishLatencyMetricsForTapToAdd("PrepareTerminalSuccessOnPageLoad_Latency",g);g=null},_hideTapToAddAlert:function(a){l.when("a-alert").execute(function(b){b(a).hide()})},_handlePrepareTerminalFailureOnPageLoad:function(a){var b=this._getLocalizedErrorMessage(a,"prepareTerminal");l.when("a-alert").execute(function(a){a("#tap-to-add-subtitle-alert-element").text(b).show()});this._publishCounterMetricsForTapToAdd("ButtonDisabled");this._publishCounterMetricsForTapToAdd("PrepareTerminalFailureOnPageLoad");
this._publishLatencyMetricsForTapToAdd("PrepareTerminalFailureOnPageLoad_Latency",g);g=null},_handleDeactivateTerminalSessionSuccess:function(b){self=this;this._publishCounterMetricsForTapToAdd("DeactivateTerminalSession_Success");this._publishLatencyMetricsForTapToAdd("DeactivateTerminalSessionSuccess_Latency",a);a=null},_handleDeactivateTerminalSessionFailure:function(b){self=this;this._publishCounterMetricsForTapToAdd("DeactivateTerminalSession_Failure");this._publishLatencyMetricsForTapToAdd("DeactivateTerminalSessionFailure_Latency",
a);a=null},_invokeDeactivateTerminalSession:function(b){var c=this;this._publishCounterMetricsForTapToAdd("DeactivateTerminalSession_Invoked");l.when("TapAndPay").execute(function(b){a=(new Date).getTime();b.deactivateTerminalSession({request_id:B,processIsolation:c.data.processIsolation.toString(),mlfLoggerWeblabEnable:c.data.isMlfLoggerWeblabEnable.toString(),successCallback:h.bind(c._handleDeactivateTerminalSessionSuccess,c),failCallback:h.bind(c._handleDeactivateTerminalSessionFailure,c)})})},
_shouldInvokeTapToAddJS:function(){return 0===this.getDOMElement("tap-to-add-section").length?!1:!0},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){t=(new Date).getTime();a._publishCounterMetricsForTapToAdd("AddCCPageLoad");a.data.isRequestFromAndroidOS?a._publishCounterMetricsForTapToAdd("OS.Android"):a.data.isRequestFromIOS&&a._publishCounterMetricsForTapToAdd("OS.IOS");a._shouldInvokeTapToAddJS()?l.when("TapAndPay").execute(function(b){F="PRIMARY_SCREEN";a._displayTapToAddSection();
g=(new Date).getTime();b.prepareTerminal({request_id:B,enable_attestation:"false",processIsolation:a.data.processIsolation.toString(),mlfLoggerWeblabEnable:a.data.isMlfLoggerWeblabEnable.toString(),successCallback:h.bind(a._handlePrepareTerminalSuccessOnPageLoad,a),failCallback:h.bind(a._handlePrepareTerminalFailureOnPageLoad,a)})}):a._publishCounterMetricsForTapToAdd("SectionNotVisible")});l.when("A","a-modal").execute(function(b,c){b.on("a:popover:afterHide:tap-to-add-popover",function(b){F="PRIMARY_SCREEN";
a.data.processIsolation||a._invokeDeactivateTerminalSession()})})},bindToElements:function(){this.getDOMElement("tap-to-add-button").click(h.bind(this._handleTapToAddButtonClick,this))}})});r("ErrorCodes",["css-utils","jQuery","lang","clog"],function(f,l,r,h){return{errorCodes:{DEFAULT:"DEFAULT",CARD_NOT_SUPPORTED:"CARD_NOT_SUPPORTED",MOBILE_WALLETS_NOT_SUPPORTED:"MOBILE_WALLETS_NOT_SUPPORTED",CARD_TAP_FAILED_FIVE_TIMES:"CARD_TAP_FAILED_FIVE_TIMES",CARD_TAP_FAILED:"CARD_TAP_FAILED",SOFTPOS_INVOCATION_FAILS_RECOVERABLE:"SOFTPOS_INVOCATION_FAILS_RECOVERABLE",
SOFTPOS_INVOCATION_FAILS_UNRECOVERABLE:"SOFTPOS_INVOCATION_FAILS_UNRECOVERABLE",TAP_FAILS_OR_TIMES_OUT:"TAP_FAILS_OR_TIMES_OUT",addCreditCardNumber:"CARD_NUMBER_ERROR",expirationDate:"EXPIRATION_DATE_ERROR",accountHolderName:"ACCOUNT_HOLDER_NAME_ERROR",SDK_NULL_VALUES:"SDK_NULL_VALUES",DEPENDENCY_FAILURE:"DEPENDENCY_FAILURE",NFC_PERMISSION_DENIED:"NFC_PERMISSION_DENIED",NFC_DISABLED:"NFC_DISABLED",ATTESTATION_FAILURE:"MASH_AND_SDK_UNRECOVERABLE_ERROR",BINDING_ERROR:"MASH_AND_SDK_UNRECOVERABLE_ERROR",
PROCESS_ISOLATION_EXCEPTION:"MASH_AND_SDK_UNRECOVERABLE_ERROR",NULL_RESPONSE_DATA_PLUGIN:"MASH_AND_SDK_UNRECOVERABLE_ERROR",SDK_SERVICE_EXCEPTION:"MASH_AND_SDK_UNRECOVERABLE_ERROR",REMOTE_EXCEPTION:"MASH_AND_SDK_UNRECOVERABLE_ERROR",NULL_RESPONSE_DATA:"MASH_AND_SDK_UNRECOVERABLE_ERROR",INVALID_REQUEST_DATA:"MASH_AND_SDK_UNRECOVERABLE_ERROR",NULL_REQUEST_DATA:"MASH_AND_SDK_UNRECOVERABLE_ERROR",INVALID_INPUT_NULL_OR_EMPTY_STRINGS:"MASH_AND_SDK_UNRECOVERABLE_ERROR",JSON_EXCEPTION:"MASH_AND_SDK_UNRECOVERABLE_ERROR",
TERMINAL_SESSION_ACTIVATION_FAILED:"MASH_AND_SDK_UNRECOVERABLE_ERROR",TERMINAL_CREATION_FAILED:"MASH_AND_SDK_UNRECOVERABLE_ERROR",ERROR_FETCHING_LICENSE:"RECOVERABLE_ERROR_WITH_ACTIVATE_AND_READ_CARD_API_CALL",ERROR_FETCHING_EMV_CONFIG:"RECOVERABLE_ERROR_WITH_ACTIVATE_AND_READ_CARD_API_CALL",TERMINAL_SESSION_NOT_FOUND:"RECOVERABLE_ERROR_WITH_ACTIVATE_AND_READ_CARD_API_CALL",CARD_REJECTED:"MASH_AND_SDK_CARD_READ_RELATED_RECOVERABLE_ERROR",NO_CARD_APPLICATION:"MASH_AND_SDK_CARD_READ_RELATED_RECOVERABLE_ERROR",
CARD_ERROR:"MASH_AND_SDK_CARD_READ_RELATED_RECOVERABLE_ERROR",PROCESSING_ERROR:"MASH_AND_SDK_CARD_READ_RELATED_RECOVERABLE_ERROR",INVALID_CARD_DATA:"MASH_AND_SDK_CARD_READ_RELATED_RECOVERABLE_ERROR",TIMEOUT:"TAP_FAILS_OR_TIMES_OUT",INTERNAL_ERROR:"SOFTPOS_INVOCATION_FAILS_RECOVERABLE",TERMINAL_NOT_FOUND:"RECOVERABLE_ERROR_WITH_ACTIVATE_PREPARE_TERMINAL_API_CALL",SDK_INITIALIZATION_ERROR:"RECOVERABLE_ERROR_WITH_ACTIVATE_PREPARE_TERMINAL_API_CALL",LICENSE_VALIDATION_FAILURE:"RECOVERABLE_ERROR_WITH_ACTIVATE_PREPARE_TERMINAL_API_CALL"},
errorCodeProperties:{CARD_NOT_SUPPORTED:{primaryString:"apx_ttp_error_card_canot_be_read",secondaryString:"apx_ttp_error_try_different_payment_method",retryButtonText:"apx_ttp_error_try_another_card",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},MOBILE_WALLETS_NOT_SUPPORTED:{primaryString:"apx_ttp_error_digital_wallet_unsupported",secondaryString:"apx_ttp_error_try_physical_card",retryButtonText:"apx_ttp_error_try_again_button",
shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},CARD_TAP_FAILED_FIVE_TIMES:{primaryString:"apx_ttp_error_card_read_failed",secondaryString:"apx_ttp_error_try_different_payment_method",retryButtonText:"",shouldShowRetryButton:!1,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!1,shouldShowStandAloneCancelButton:!1},CARD_TAP_FAILED:{primaryString:"apx_ttp_error_card_read_failed",secondaryString:"apx_ttp_error_use_different_card",
retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},SOFTPOS_INVOCATION_FAILS_RECOVERABLE:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_activation_failure",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!0,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},SOFTPOS_INVOCATION_FAILS_UNRECOVERABLE:{primaryString:"apx_ttp_error_something_went_wrong",
secondaryString:"apx_ttp_error_restart_app",retryButtonText:"",shouldShowRetryButton:!1,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!1,shouldShowStandAloneCancelButton:!1},TAP_FAILS_OR_TIMES_OUT:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_time_out",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},CARD_NUMBER_ERROR:{primaryString:"apx_ttp_card_number_is_not_correct",
secondaryString:"apx_ttp_error_use_different_card",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},EXPIRATION_DATE_ERROR:{primaryString:"apx_ttp_card_expired",secondaryString:"apx_ttp_please_use_different_card",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},
ACCOUNT_HOLDER_NAME_ERROR:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_please_try_again",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},SDK_NULL_VALUES:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_use_different_card",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,
shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},DEPENDENCY_FAILURE:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_please_try_again",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},MASH_AND_SDK_UNRECOVERABLE_ERROR:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_try_different_payment_method",retryButtonText:"apx_ttp_error_try_again_button",
shouldShowRetryButton:!1,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!1,shouldShowStandAloneCancelButton:!0},RECOVERABLE_ERROR_WITH_ACTIVATE_AND_READ_CARD_API_CALL:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_please_try_again",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},MASH_AND_SDK_CARD_READ_RELATED_RECOVERABLE_ERROR:{primaryString:"apx_ttp_error_something_went_wrong",
secondaryString:"apx_ttp_error_use_different_card",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},DEFAULT:{primaryString:"apx_ttp_error_something_went_wrong",secondaryString:"apx_ttp_error_please_try_again",retryButtonText:"apx_ttp_error_try_again_button",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!1,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1},RECOVERABLE_ERROR_WITH_ACTIVATE_PREPARE_TERMINAL_API_CALL:{primaryString:"apx_ttp_error_something_went_wrong",
secondaryString:"apx_ttp_error_please_try_again",retryButtonText:"Try again",shouldShowRetryButton:!0,callPrepareTerminalApiOnRetry:!0,shouldShowCancelButton:!0,shouldShowStandAloneCancelButton:!1}}}});r("components/TapToPayComponent","css-utils jQuery component form-component lang clog TapToPayErrorScreenJs ErrorCodes mash-helper".split(" "),function(f,r,u,h,n,m,k,g,d){var p=["valued customer","visa cardholder"],v="id"+Math.random().toString(16).slice(2),q=null,t=null;return h.extend(k,g,{_maybeCardHolderName:"",
_obfuscatedCardNumber:"",_maybeBillingAddressId:"",_missingBillingAddressIdFlag:!1,_currencyDisplayString:"",_cssAndSpinnerFixInSecureRegistrationEnabled:"",_returnToPSPOnNavBackButtonPressEnabled:"",_isToggleSwitchDisplayable:!1,_isNfcAlertBoxWeblabEnabled:!0,_isDigitalWalletTapWeblabEnabled:!0,_isMlfLoggerWeblabEnable:!0,_expiryDateIssueWeblabEnabled:!1,_isConsentUpdateWeblabEnabled:!1,_existingPaymentInstrumentDetails:[],initialize:function(a,c){this._maybeCardHolderName=c.data.maybeCardHolderName;
this._maybeBillingAddressId=c.data.maybeBillingAddressId;this._missingBillingAddressIdFlag=c.data.missingBillingAddressIdFlag;this._currencyDisplayString=c.data.currencyDisplayString;this._cssAndSpinnerFixInSecureRegistrationEnabled=c.data.cssAndSpinnerFixInSecureRegistrationEnabled;this._returnToPSPOnNavBackButtonPressEnabled=c.data.returnToPSPOnNavBackButtonPressEnabled;this._isToggleSwitchDisplayable=c.data.isToggleSwitchDisplayable;this._isNfcAlertBoxWeblabEnabled=c.data.isNfcAlertBoxWeblabEnabled;
this._isDigitalWalletTapWeblabEnabled=c.data.isDigitalWalletTapWeblabEnabled;this._expiryDateIssueWeblabEnabled=c.data.expiryDateIssueWeblabEnabled;this._isMlfLoggerWeblabEnable=c.data.isMlfLoggerWeblabEnable;this._isConsentUpdateWeblabEnabled=c.data.isConsentUpdateWeblabEnabled;this._existingPaymentInstrumentDetails=c.data.existingPaymentInstrumentDetails;this._returnToPSPOnNavBackButtonPressEnabled&&d.dispatchEvent("DisableCheckoutRefreshEvent",{})},bindToEvents:function(){this.widget.on("componentsInitialized",
this,function(){this._initiateTapToPayCardReadProcessing()});this.widget.on("formSubmission",this,function(a){var c=this;this._disableContinueButton();this._hideToggleButtonAndSuccessImage();this._cssAndSpinnerFixInSecureRegistrationEnabled?f.showElement(this.getDOMElement("tap-to-pay-spinner")):c.widget.trigger("submitFormAjaxStarted");var d={addCreditCardNumber:a.submissionParameters[0].value,"ppw-widgetState":c.widget.options.serializedState,"ppw-useBillingAddress":!this._missingBillingAddressIdFlag,
"ppw-widgetEvent":"AddTapAndPayCreditCardEvent"};d=c._appendExpiryDateAndToggleConsentFields(d,a);c.widget.continueRequest(d,{query:{sif_profile:"APX-Encrypt-All-EU"},success:function(a){(a&&a.additionalWidgetResponseData&&a.additionalWidgetResponseData.additionalData?a.additionalWidgetResponseData.additionalData.paymentInstrumentId:x)?(c._publishCountMetrics("CardFormSubmittedResponse.Success"),c._publishLatencyMetrics("CardFormSubmittedResponse.Success",t)):(c._publishCountMetrics("CardFormSubmittedResponse.Failure"),
k._invokeErrorScreen.apply(c,[g.errorCodes.DEPENDENCY_FAILURE]),c._publishLatencyMetrics("CardFormSubmittedResponse.Failure",t));t=null},error:function(a){c._publishCountMetrics("CardFormSubmittedResponse.Error");c._cssAndSpinnerFixInSecureRegistrationEnabled||c.widget.trigger("submitFormAjaxCompleted");k._invokeErrorScreen.apply(c,[g.errorCodes.DEPENDENCY_FAILURE]);c._publishLatencyMetrics("CardFormSubmittedResponse.Error",t);t=null},complete:function(){}})})},bindToElements:function(){this.getDOMElement("tap-to-pay-submit-button").click(n.bind(this._handleFormSubmission,
this));k.bindToElements.apply(this)},_getObfuscatedCardNumber:function(a,c){a=a.slice(-4);return c.repeat(4)+a},_disableContinueButton:function(){this.getDOMElement("tap-to-pay-submit-button").addClass("apx-tap-to-add-disabled-button");this.getDOMElement("tap-to-pay-submit-button").addClass("a-button-disabled");this.getDOMElement("tap-to-pay-submit-button").removeClass("a-declarative");this.getDOMElement("tap-to-pay-submit-button").attr("disabled","disabled")},_enableContinueButton:function(){this.getDOMElement("tap-to-pay-submit-button").removeClass("apx-tap-to-add-disabled-button");
this.getDOMElement("tap-to-pay-submit-button").removeClass("a-button-disabled");this.getDOMElement("tap-to-pay-submit-button").addClass("a-declarative");this.getDOMElement("tap-to-pay-submit-button").removeAttr("disabled","disabled")},_hideToggleButtonAndSuccessImage:function(){f.hideElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch"));f.hideElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch-label"));f.hideElement(this.getDOMElement("tap-to-pay-success-form-logo"))},
_updateFormWithCardInformation:function(a){var c=null,d=null,f=null;a.card_data.card_number&&(c=BigInt(a.card_data.card_number));a.card_data.expiration_month&&(d=parseInt(a.card_data.expiration_month,10));a.card_data.expiration_year&&(f=parseInt(a.card_data.expiration_year,10));a=a.card_data.account_holder_name?a.card_data.account_holder_name.toString():"NULL_FIELD";a="NULL_FIELD"===a||p.includes(a.toLowerCase())?this._maybeCardHolderName:a.toString();var h=this._handleNULLValues(c,d,f,a);c=c?c.toString():
"NULL_FIELD";d=d?d.toString():"1";f=f?f.toString():(new Date).getUTCFullYear().toString();this._obfuscatedCardNumber=this._getObfuscatedCardNumber(c,"").toString();this.getDOMElement("tap-to-pay-card-number").html(this._obfuscatedCardNumber);h?k._invokeErrorScreen.apply(this,[g.errorCodes.SDK_NULL_VALUES]):(this._publishCountMetrics("SuccessScreenRendered"),this._showSuccessScreen());this.getDOMElement("tap-to-pay-credit-card-number-hidden-input").val(c);this._expiryDateIssueWeblabEnabled?(this.getDOMElement("tap-to-pay-expiry-date-year-hidden-input").val(f),
this.getDOMElement("tap-to-pay-expiry-date-month-hidden-input").val(d)):this.getDOMElement("tap-to-pay-expiry-date-hidden-input").val(d+" / "+f%100);this.getDOMElement("tap-to-account-holder-name-hidden-input").val(a);this.getDOMElement("tap-to-pay-billing-address-hidden-input").val(this._maybeBillingAddressId)},_showSuccessScreen:function(){f.showElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch"));f.showElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch-label"));f.showElement(this.getDOMElement("tap-to-pay-success-screen"));
f.showElement(this.getDOMElement("tap-to-pay-success-form-logo"))},_appendExpiryDateAndToggleConsentFields:function(a,c){this._expiryDateIssueWeblabEnabled?(a["ppw-expirationDate_month"]=c.submissionParameters[1].value,a["ppw-expirationDate_year"]=c.submissionParameters[2].value,a["ppw-accountHolderName"]=c.submissionParameters[3].value):(a["ppw-expirationDate_combinedMonthYear"]=c.submissionParameters[1].value,a["ppw-accountHolderName"]=c.submissionParameters[2].value);this._expiryDateIssueWeblabEnabled&&
this._isToggleSwitchDisplayable?a["ppw-storageConsent"]=c.submissionParameters[5].value:!this._expiryDateIssueWeblabEnabled&&this._isToggleSwitchDisplayable&&(a["ppw-storageConsent"]=c.submissionParameters[4].value);this._isConsentUpdateWeblabEnabled&&this._updateStorageConsentFromWalletForExistingInstrument(c.submissionParameters[0].value,c.submissionParameters[1].value,c.submissionParameters[2].value,a);return a},_updateStorageConsentFromWalletForExistingInstrument:function(a,c,d,p){a=null!=a?a.slice(-4):
"";for(var f=0;f<this._existingPaymentInstrumentDetails.length;f++)if(this._isMatchingInstrument(a,c,d,this._existingPaymentInstrumentDetails[f])){"OptedIn"==p["ppw-storageConsent"]?this._publishCountMetrics("ExistingInstrument.Existing.Consent_OptedIn"):this._publishCountMetrics("ExistingInstrument.Updated.Consent_OptedIn");p["ppw-storageConsent"]="OptedIn";break}},_isMatchingInstrument:function(a,c,d,f){return null!=c&&null!=d&&a==f.tail&&Number(c)==f.expiryMonth&&Number(d)==f.expiryYear},_getErrorCode:function(a){try{var c=
JSON.parse(a);return c&&c.error_code?c.error_code:g.errorCodes.DEFAULT}catch(C){return g.errorCodes.DEFAULT}},_getErrorCodeAndInvokeErrorScreen:function(a){a=this._getErrorCode(a);k._invokeErrorScreen.apply(this,[a])},_handleDeactivateTerminalSessionSuccess:function(a){this._publishCountMetrics("DeactivateTerminal.Response.Success")},_handleDeactivateTerminalSessionFailure:function(a){self=this;self._publishCountMetrics("DeactivateTerminal.Response.Error");self._getErrorCodeAndInvokeErrorScreen(a)},
_handleNULLValues:function(a,c,d,f){var p=!1;if(null==d||null==c||null==a||"NULL_FIELD"===f)p=!0;var g=0,h=0,k=0,l=0;a||(g=1);c||(h=1);d||(k=1);"NULL_FIELD"===f&&(l=1);this._publishCountMetrics("ReadCardResponse_NullFields_Number."+g+"_Month."+h+"_Year."+k);this._publishCountMetrics("ReadCardResponse_NullFields_CardHolderName."+l);return p},_invokeDeactivateTerminalSession:function(a){var c=this;c._publishCountMetrics("DeactivateTerminal.Invoked");l.when("TapAndPay").execute(function(a){a.deactivateTerminalSession({request_id:v,
processIsolation:"true",mlfLoggerWeblabEnable:c._isMlfLoggerWeblabEnable.toString(),successCallback:n.bind(c._handleDeactivateTerminalSessionSuccess,c),failCallback:n.bind(c._handleDeactivateTerminalSessionFailure,c)})})},_handleCorruptResponseInReadCardSuccessCallback:function(){k._invokeErrorScreen.apply(this,[g.errorCodes.DEFAULT])},_handleActivateAndReadCardSuccess:function(a){try{var c=JSON.parse(a);if(!c||!c.status)this._publishCountMetrics("ReadCard.Response.Corrupted"),this._handleCorruptResponseInReadCardSuccessCallback(),
this._publishLatencyMetrics("ReadCard.Response.Corrupted",q),q=null;else if("Cancelled"===c.status)this._publishCountMetrics("ReadCard.Response.Cancelled"),this._publishLatencyMetrics("ReadCard.Response.Cancelled",q),q=null,this._invokeDeactivateTerminalSession(),this._returnToPSPOnNavBackButtonPressEnabled&&k._handleCancelButtonClick.apply(this);else if("Success"===c.status)this._publishCountMetrics("ReadCard.Response.Success"),this._updateFormWithCardInformation(c),this._publishLatencyMetrics("ReadCard.Response.Success",
q),q=null;else if("Pending"===c.status){var d="ReadCard.Response.Pending."+c.customer_action;this._publishCountMetrics(d);this._publishLatencyMetrics(d,q)}}catch(D){this._handleCorruptResponseInReadCardSuccessCallback()}},_handleActivateAndReadCardFailure:function(a){this._publishCountMetrics("ReadCard.Response.Error");var c=this._getErrorCode(a);this._publishCountMetrics("ReadCard.Error_"+c);c!==g.errorCodes.NFC_PERMISSION_DENIED&&c!==g.errorCodes.NFC_DISABLED||!this._returnToPSPOnNavBackButtonPressEnabled?
(this._invokeDeactivateTerminalSession(),this._getErrorCodeAndInvokeErrorScreen(a),this._publishLatencyMetrics(readCardErrorResponseMetric,q),q=null):k._handleCancelButtonClick.apply(this)},_getLocalString:function(a){return this.widget.getLocalizedString(a)},_initiateTapToPayCardReadProcessing:function(){var a=this;q=(new Date).getTime();a._publishCountMetrics("ReadCard.Invoked");l.when("TapAndPay").execute(function(c){c.activateAndReadCard({request_id:v,digital_wallet_tap_weblab_enabled:a._isDigitalWalletTapWeblabEnabled.toString(),
processIsolation:"true",nfcAlertBoxWeblabEnable:a._isNfcAlertBoxWeblabEnabled.toString(),mlfLoggerWeblabEnable:a._isMlfLoggerWeblabEnable.toString(),offline_Activation:"true",registrationType:"TapToPay",amountString:a._getLocalString("apx_ttp_estimated_total")+" "+a._currencyDisplayString,continueString:a._getLocalString("apx_ttp_button_continue"),titleString:a._getLocalString("apx_ttp_mash_activity_header"),presentCardMessageString:a._getLocalString("apx_ttp_present_card_message"),nfcAlertBoxTitleString:a._getLocalString("apx_ttp_nfc_alert_box_title"),
nfcAlertBoxMessageString:a._getLocalString("apx_ttp_nfc_alert_box_message"),nfcAlertBoxNavigateToSettingString:a._getLocalString("apx_ttp_nfc_alert_box_navigate_to_setting_button"),nfcAlertBoxCancelString:a._getLocalString("apx_ttp_cancel_button"),successCallback:n.bind(a._handleActivateAndReadCardSuccess,a),failCallback:n.bind(a._handleActivateAndReadCardFailure,a)})})},_handlePrepareTerminalFailureOnPageLoad:function(a){this._getErrorCodeAndInvokeErrorScreen(a)},_handlePrepareTerminalSuccessOnPageLoad:function(a){try{var c=
JSON.parse(a);c&&c.violations&&0<c.violations.length?this._getErrorCodeAndInvokeErrorScreen(a):this._initiateTapToPayCardReadProcessing()}catch(C){k._invokeErrorScreen.apply(this,[g.errorCodes.DEFAULT])}},_invokePrepareTerminalAPI:function(){var a=this;l.when("TapAndPay").execute(function(c){c.prepareTerminal({request_id:v,enable_attestation:"false",processIsolation:"true",mlfLoggerWeblabEnable:a._isMlfLoggerWeblabEnable.toString(),successCallback:n.bind(a._handlePrepareTerminalSuccessOnPageLoad,
a),failCallback:n.bind(a._handlePrepareTerminalFailureOnPageLoad,a)})})},_getStorageConsentValue:function(){return this.getDOMElement("tap-to-pay-success-form-toggle-switch").find("input").prop("checked")?"OptedIn":"OptedOut"},_handleFormSubmission:function(a){t=(new Date).getTime();this._publishCountMetrics("CardForm.SubmitBtnClicked");this._isToggleSwitchDisplayable?(this.getDOMElement("tap-to-pay-success-form-storage-consent-field").val(this._getStorageConsentValue()),this._publishCountMetrics("CardForm.SubmitBtnClicked.Consent_"+
this._getStorageConsentValue())):this._publishCountMetrics("CardForm.SubmitBtnClicked.Consent_NotRequired");var c=this.form.validateForm(),d=this.getFormSubmissionParameters("tap-to-pay-form");0===c.length?this.widget.trigger("formSubmission",{event:a,submissionParameters:d,action:this._action}):(a.preventDefault(),this._publishCountMetrics("CardForm.ValidationFailureOnSubmit"),k._invokeErrorScreen.apply(this,[c[0].field?c[0].field:g.errorCodes.DEFAULT]))},_publishCountMetrics:function(a){m.logCounterMetric({feature:"TTP."+
a,resource:"_Count"});m.publishMetrics()},_publishLatencyMetrics:function(a,c){c&&(m.logLatencyMetric({feature:"TTP."+a,resource:"_Latency",startTime:c}),m.publishMetrics())}})});r("TapToPayErrorScreenJs","css-utils jQuery lang clog component events/close-secure-container-event mash-helper ErrorCodes".split(" "),function(f,l,r,h,n,m,k,g){return g,{bindToElements:function(){this.getDOMElement("tap-to-pay-error-screen-retry-button").click(function(){this._publishCountMetricsForErrorPage("RetryBtnClicked.RefreshTerminalSession");
this._resetScreens();this._initiateTapToPayCardReadProcessing(this)}.bind(this));this.getDOMElement("tap-to-pay-error-screen-prepare-terminal-API-retry-button").click(function(){this._publishCountMetricsForErrorPage("RetryBtnClicked.RefreshTerminal");this._resetScreens();this._invokePrepareTerminalAPI(this)}.bind(this));this.getDOMElement("tap-to-pay-error-screen-cancel-button").click(function(){this._publishCountMetricsForErrorPage("CancelBtnClicked.UserRequest_RecoverableError");this._handleCancelButtonClick()}.bind(this));
this.getDOMElement("tap-to-pay-stand-alone-error-screen-cancel-button").click(function(){this._publishCountMetricsForErrorPage("CancelBtnClicked.UserRequest_UnRecoverableError");this._handleCancelButtonClick()}.bind(this))},_handleCancelButtonClick:function(){this.widget.trigger(m,{force:!0});k.backToBookmark("spps-widget")},_resetScreens:function(){f.hideElement(this.getDOMElement("tap-to-pay-error-screen-section"));this._enableContinueButton(this)},_invokeErrorScreen:function(d){this._publishCountMetricsForErrorPage("Reason_"+
d);d=d&&g.errorCodes[d]?g.errorCodes[d]:g.errorCodes.DEFAULT;this._showErrorScreenMessages(g.errorCodeProperties[d].primaryString,g.errorCodeProperties[d].secondaryString);this._showErrorScreenButtons(g.errorCodeProperties[d].shouldShowRetryButton,g.errorCodeProperties[d].callPrepareTerminalApiOnRetry,g.errorCodeProperties[d].retryButtonText,g.errorCodeProperties[d].shouldShowCancelButton,g.errorCodeProperties[d].shouldShowStandAloneCancelButton);f.hideElement(this.getDOMElement("tap-to-pay-success-screen"));
this._cssAndSpinnerFixInSecureRegistrationEnabled&&f.hideElement(this.getDOMElement("tap-to-pay-spinner"));f.showElement(this.getDOMElement("tap-to-pay-error-screen-section"))},_getLocalString:function(d){return this.widget.getLocalizedString(d)},_showErrorScreenMessages:function(d,f){this.getDOMElement("tap-to-pay-error-screen-primary-string").html(this._getLocalString(d));this.getDOMElement("tap-to-pay-error-screen-secondary-string").html(this._getLocalString(f))},_showErrorScreenButtons:function(d,
p,g,h,k){d&&(p?f.showElement(this.getDOMElement("tap-to-pay-error-screen-prepare-terminal-API-retry-button")):(this.getDOMElement("tap-to-pay-error-screen-retry-button-text").html(this._getLocalString(g)),f.showElement(this.getDOMElement("tap-to-pay-error-screen-retry-button"))));h&&f.showElement(this.getDOMElement("tap-to-pay-error-screen-cancel-button"));k&&f.showElement(this.getDOMElement("tap-to-pay-stand-alone-error-screen-cancel-section"))},_publishCountMetricsForErrorPage:function(d){h.logCounterMetric({feature:"TTP.ErrorPage."+
d,resource:"_Count"});h.publishMetrics()},_publishLatencyMetrics:function(d,f){f&&(h.logLatencyMetric({feature:"TTP.ErrorPage."+d,resource:"_Latency",startTime:f}),h.publishMetrics())}}});r("components/TapToPayTriggerComponent","css-utils jQuery component lang clog events/postToSecureIframeEvent".split(" "),function(f,r,u,h,n,m){var k=null,g="id"+Math.random().toString(16).slice(2);return u.extend({_creatablePaymentMethods:[],_registrationType:"TapToPay",_billingAddressId:[],_isRequiredMShopVersionForTapToPay:!0,
_isMlfLoggerWeblabEnable:!0,_shouldRenderTriggerButtonAsEnabled:!0,initialize:function(d,f){this._creatablePaymentMethods=f.data.creatablePaymentMethods;this._registrationType=f.data.registrationType;this._billingAddressId=f.data.billingAddressId;this._isRequiredMShopVersionForTapToPay=f.data.isRequiredMShopVersionForTapToPay;this._shouldRenderTriggerButtonAsEnabled=f.data.shouldRenderTriggerButtonAsEnabled;this._isMlfLoggerWeblabEnable=f.data.isMlfLoggerWeblabEnable},_disableTapToPayTriggerButton:function(){this.getDOMElement("tap-to-pay-trigger-button").addClass("apx-tap-to-pay-disabled-button");
this.getDOMElement("tap-to-pay-trigger-button").addClass("a-button-disabled");this.getDOMElement("tap-to-pay-trigger-button").attr("disabled","disabled");if(!this._isRequiredMShopVersionForTapToPay){this._publishCountMetrics("InvalidMShopVersion");var d=this._getLocalString("apx_ttp_error_invalid_mshop_version");f.showElement(this.getDOMElement("tap-to-pay-inline-PSP-alert-row"));l.when("a-alert").execute(function(f){f("#tap-to-pay-inline-PSP-alert-id").text(d).show()})}},_enableTapToPayTriggerButton:function(){this._isRequiredMShopVersionForTapToPay&&
(this.getDOMElement("tap-to-pay-trigger-button").removeClass("apx-tap-to-pay-disabled-button"),this.getDOMElement("tap-to-pay-trigger-button").removeClass("a-button-disabled"),this.getDOMElement("tap-to-pay-trigger-button").removeAttr("disabled"))},_isTapToPayTriggerButtonDisabled:function(){return this.getDOMElement("tap-to-pay-trigger-button").hasClass("apx-tap-to-pay-disabled-button")||this.getDOMElement("tap-to-pay-trigger-button").hasClass("a-button-disabled")},_shouldInvokeTapToPayTriggerJS:function(){return 0<
this.getDOMElement("tap-to-pay-trigger-button").length},_handlePrepareTerminalFailureOnPageLoad:function(d){this._disableTapToPayTriggerButton();this._getErrorCodeAndShowAlert(d);var f=f+".Error";this._publishCountMetrics(f);this._publishLatencyMetrics(f,k);k=null},_getErrorCodeAndShowAlert:function(d){try{var g=JSON.parse(d),h=g?g.error_code:"FailureReasonMissing";this._publishCountMetrics("BtnDisabled.Error_"+h);"NFC_DISABLED"!==h&&"KILL_SWITCH_ENABLED_WITH_UPDATE"!==h&&f.showElement(this.getDOMElement("tap-to-pay-inline-PSP-alert-row"))}catch(q){this._publishCountMetrics("BtnDisabled.Error_UnknownException"),
f.showElement(this.getDOMElement("tap-to-pay-inline-PSP-alert-row"))}},_handlePrepareTerminalSuccessOnPageLoad:function(d){var f=this;f._enableTapToPayTriggerButton();d=JSON.parse(d);f._publishCountMetrics("BtnEnabled");d&&d.violations&&0<d.violations.length?(f._publishCountMetrics("BtnEnabled.Violation_Exist"),d.violations.forEach(function(d){f._publishCountMetrics("BtnEnabled.Violation_"+d)})):f._publishCountMetrics("BtnEnabled.Violation_None");f._publishLatencyMetrics("BtnEnabled",k);k=null},_publishCountMetrics:function(d){n.logCounterMetric({feature:"TTP."+
d,resource:"_Count"});n.publishMetrics()},_publishLatencyMetrics:function(d,f){f&&(n.logLatencyMetric({feature:"TTP."+d,resource:"_Latency",startTime:f}),n.publishMetrics())},_bindTapToPayTriggerButtonClick:function(d){this._publishCountMetrics("ButtonClicked");d.preventDefault();this._isTapToPayTriggerButtonDisabled()?this._publishCountMetrics("ButtonClickEventDropped"):this.widget.trigger(m,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:this._creatablePaymentMethods,registrationType:this._registrationType,
billingAddressId:this._billingAddressId}})},_getLocalString:function(d){return this.widget.getLocalizedString(d)},bindToEvents:function(){var d=this;d.widget.on("componentsInitialized",d,function(){d._shouldInvokeTapToPayTriggerJS()&&(d._shouldRenderTriggerButtonAsEnabled&&d._isRequiredMShopVersionForTapToPay?d._enableTapToPayTriggerButton():d._disableTapToPayTriggerButton(),d._publishCountMetrics("PageLoad"),l.when("TapAndPay").execute(function(f){k=(new Date).getTime();f.prepareTerminal({request_id:g,
enable_attestation:"false",processIsolation:"true",mlfLoggerWeblabEnable:d._isMlfLoggerWeblabEnable.toString(),successCallback:h.bind(d._handlePrepareTerminalSuccessOnPageLoad,d),failCallback:h.bind(d._handlePrepareTerminalFailureOnPageLoad,d)})}))})},bindToElements:function(){this.getDOMElement("tap-to-pay-trigger-button").click(h.bind(this._bindTapToPayTriggerButtonClick,this))}})})})()});
/* ******** */
(function(e){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,c=f?f("APXWidgetsAssets@APXWidgets-InstallmentOffers","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(e)(c,window):c.execute(function(){e(c,window)})})(function(e,d,f){(function(){var c=PaymentsPortal2.modules.define;c("components/InstallmentOffersComponent","css-utils component lang clog jQuery AUI!P".split(" "),function(c,d,e,m,h,k){var l,g;return d.extend({initialize:function(a,b){this.instrumentId=b.data.instrumentId;
this.isMobile="mobile"===a.options.deviceType;this.financialOfferDisplayStringsMap=b.data.financialOfferDisplayStringsMap;l=b.data.financialOfferBOs;g=b.data.preselectedOffer},bindToEvents:function(){this.widget.on("toggleFinancialOffer",this,function(a){this.instrumentId===a.instrumentId&&this._toggleFinancialOffers(a.isSelected,a.isAddressChallenged)})},bindToElements:function(){var a=this;a.getDOMElement("financialOfferPopoverContinueButtonMobile").click(e.bind(a._financialOfferContinueButtonClicked,
this));a.getDOMElementsByPrefix("financialOfferButtonMobile-").click(function(b){b=h(b.currentTarget)[0].firstElementChild.firstElementChild.attributes["data-financial-offer-id"].value;a._updateFinancialOfferSelection(b)});a.getDOMElement("financialOffersMobileTouchLink-"+a.instrumentId).click(function(b){b=a.getDOMElement("financialOffersMobileTouchLink-"+a.instrumentId).find("input").attr("value");if(b===f||""===b)b=g;a._refreshFinancialOffersPopover(b)});k.when("A").execute(function(b){b.on("a:popover:hide:termsAndConditionPopover_"+
a.instrumentId,function(){var b=a.getDOMElement("financialOffersMobilePopoverMobile-"+a.instrumentId).find("input").attr("value");if(b===f||""===b)b=g;a._refreshFinancialOffersPopover(b)})})},_updateFinancialOfferSelection:function(a){this.getDOMElement("financialOfferHiddenInputMobile_"+this.instrumentId)[0].value=a;this._refreshFinancialOffersPopover(a)},_refreshFinancialOffersPopover:function(a){var b=this;l.map(function(c){c.financialOfferId===a?b._updateFinancialOfferButtonStyle(a,!0):b._updateFinancialOfferButtonStyle(c.financialOfferId,
!1)})},_updateFinancialOfferButtonStyle:function(a,b){a=this.getDOMElement("financialOfferButtonMobile-"+a);b?a.addClass("a-button-focus"):a.removeClass("a-button-focus")},_financialOfferContinueButtonClicked:function(){this._updateFinancialOfferMobileButtonContent(this.instrumentId);this._closeFinancialOfferSecondaryPopover(this.instrumentId)},_updateFinancialOfferMobileButtonContent:function(a){var b=this.getDOMElement("financialOffersMobileTouchLink-"+a);b.find("input").remove();var c=this._getSelectedFinancialOfferId();
c&&(this._appendHiddenInput(c,b),this._updateButtonDisplayText(c,b),this.getDOMElement("financialOfferDisplayString-"+a).html(this.financialOfferDisplayStringsMap[c]))},_updateButtonDisplayText:function(a,b){b.find("span").find("span").html(this.financialOfferDisplayStringsMap[a])},_appendHiddenInput:function(a,b){h('\x3cinput type\x3d"hidden"\x3e').attr({name:"ppw-"+this.instrumentId+"_financialOfferId",value:a}).appendTo(b)},_getSelectedFinancialOfferId:function(){return this.getDOMElement("financialOfferHiddenInputMobile_"+
this.instrumentId)[0].value},_closeFinancialOfferSecondaryPopover:function(a){k.when("a-secondary-view").execute(function(b){b&&(b=b.get("financialOffersSecondaryPopoverMobile-"+a))&&b.hide()})},_toggleFinancialOffers:function(a,b){var d=this.getDOMElement("financialOfferDisplayStringContainer"),e=this.getDOMElement("financialOffersMobileTouchLinkContainer-"+this.instrumentId);c.toggleElement(d,!(a&&(this.isMobile||b)));c.toggleElement(e,a&&!b)}})});c("components/DefaultInstallmentOffersComponent",
["component"],function(c){return c.extend({initialize:function(){d.alert("DefaultInstallmentOffersComponent initialize!")}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BankRefund","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BankRefundComponent",["component","jQuery","lang","AUI!P"],function(a,c,b,f){return a.extend({initialize:function(a,b){this._bankRefundListSize=b.data.bankRefundListSize;var c=this;f.when("A",
"jp-bank-list","ready").execute(function(a,b){for(a=0;a<c._bankRefundListSize;a++){var e=b.getBankNameByCode(c.getDOMElement("bank-refund-bank-name-field-"+a).attr("data-bankNumber"));e!==d&&(c.getDOMElement("bank-refund-bank-name-field-"+a)[0].innerHTML=e)}})},bindToElements:function(){this.getDOMElementsByPrefix("remove-bank-account-").click(b.bind(this._removeBankLinkTriggered,this));this.getDOMElement("add-new-bank-account-button").click(b.bind(this._addBankButtonTriggered,this));this.getDOMElement("add-new-bank-account-link").click(b.bind(this._addBankButtonTriggered,
this))},_removeBankLinkTriggered:function(a){this.widget.scrollToTopOfThePage();a=c(a.target).attr("data-instrumentId");this.widget.submitFormAJAX({"ppw-widgetEvent":"RemoveBankAccountEvent","ppw-instrumentId":a,"ppw-widgetState":this.widget.options.serializedState})},_addBankButtonTriggered:function(){this.widget.scrollToTopOfThePage();this.widget.submitFormAJAX({"ppw-widgetEvent":"AddNewBankAccountEvent","ppw-widgetState":this.widget.options.serializedState})}})});a("components/BankRefundWorkflowComponent",
["component"],function(a){return a})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Bancontact","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/BancontactDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/BancontactEditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/BancontactSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,
b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,f=c._namespace||c.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-Transactions","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,f){(function(){var a=PaymentsPortal2.modules.define;a("components/TransactionsSummaryComponent",["component","jQuery"],function(a,d){return a.extend({initialize:function(a,b){this._noTransactionsFoundByUPDOrSignature=b.data.noTransactionsFoundByUPDOrSignature;
this._baseUrl=b.data.baseUrl},_reloadPageOnUpdOrSignatureError:function(){var a=d("\x3cform\x3e").attr({method:"GET",action:this._baseUrl});a.append(this.buildHiddenInput("noTransactionsFoundByUPDOrSignature",!0));this.widget.getRootDOMElements().last().append(a);a.submit()},buildHiddenInput:function(a,b){return d("\x3cinput\x3e").attr({type:"hidden",name:a,value:b})},bindToElements:function(){this._noTransactionsFoundByUPDOrSignature&&this._reloadPageOnUpdOrSignatureError()}})});a("components/TransactionLineItemComponent",
["component","lang","metrics-helper","clog"],function(a,d,c,b){return a.extend({initialize:function(a,b){this._orderIds=b.data.orderIds},_publishOrderIdOnClickMetrics:function(){var a=this;d.forEach(a._orderIds,function(b){c.publishOnClickSuccessSushiMetrics(a,[{JsBindElementId:"OrderIdLink-"+b,MetricsObject:{ActionType:"TransactionsOrderIdLink"}}])})},_publishWalletViewTransactionOrderDetailsMetrics:function(){var a=this;d.forEach(a._orderIds,function(c){a.getDOMElement("walletViewTransactionOrderDetails-"+
c).bind("click",function(){b.logCounterMetric({feature:"WalletViewTransactionOrderDetails",resource:"_Count"});b.publishMetrics()})})},bindToElements:function(){this._publishOrderIdOnClickMetrics();this._publishWalletViewTransactionOrderDetailsMetrics()}})})})()});
/* ******** */
(function(k){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors,b=l?l("APXWidgetsAssets@APXWidgets-Wallet","APXWidgetsAssets"):g;b.guardFatal?b.guardFatal(k)(b,window):b.execute(function(){k(b,window)})})(function(k,g,l){(function(){var b=PaymentsPortal2.modules.define;b("AddBalanceMethodHelper",["events/spinner-events"],function(f){return{_startAddBalanceEvent:function(a){a.widget.trigger(f.showSpinner);a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,
"ppw-widgetEvent":"StartAddBalanceEvent"},{success:a.widget.createAjaxContinueSuccessHandler(),complete:function(){a.widget.trigger(f.hideSpinner)}})}}});b("AddPaymentMethodHelper",["events/spinner-events"],function(f){return{_startAddPMEvent:function(a){a.widget.trigger(f.showSpinner);a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"StartAddInstrumentEvent"},{success:a.widget.createAjaxContinueSuccessHandler(),complete:function(){a.widget.trigger(f.hideSpinner)}})}}});
b("components/WalletComponent","component jQuery events/spinner-events AddPaymentMethodHelper mash-helper AddBalanceMethodHelper".split(" "),function(f,a,e,b,h,m){return f.extend({_triggerFallbackToMPO:!1,_shouldOpenAddPaymentInstrumentView:!1,_manageHicIngressEnabled:!1,initialize:function(a,c){this._triggerFallbackToMPO=c.data.triggerFallbackToMPO;this._isRequestForMobileApp=c.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=c.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=
c.data.dynamicContinueEnabled;this._shouldOpenAddPaymentInstrumentView=c.data.shouldOpenAddPaymentInstrumentView;this._manageHicIngressEnabled=c.data.manageHicIngressEnabled;var d=this;d._isRequestForMobileApp&&(h.addEventListener(d._securePaymentMethodAddedEvent,function(a){d._addEventListenerWalletHandler(a)}),h.setBookmark("wallet-widget"))},_addEventListenerWalletHandler:function(a){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(a.detail.paymentInstrumentId,a.detail.widgetAction):
this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a.detail.paymentInstrumentId,"ppw-widgetAction":a.detail.widgetAction});h.backToBookmark("wallet-widget")},bindToElements:function(){var d=this;"mobile"!==d.widget.options.deviceType&&(a(".pmts-loading-async-widget-spinner-overlay").css("background-color","rgba( 234, 237, 237, .5 )"),d.getDOMElement("JsBindSleeveAddPMButton").click(function(){b._startAddPMEvent(d)}));
this._manageHicIngressEnabled&&this.getDOMElement("walletManageHealthInsuranceCardsButton").click(function(){g.location.pathname=g.location.pathname.replace("/wallet","/healthwallet")})},bindToEvents:function(){var d=this;if("mobile"===d.widget.options.deviceType){var c=a(".apx-wallet-mobile-selectable-card-list .apx-wallet-mobile-sleeve-item-shadow-two").first(),e=a(".apx-wallet-mobile-selectable-cash-list .apx-wallet-mobile-sleeve-item-shadow-two").first();d._updateFirstItemStyle(c);d._updateFirstItemStyle(e)}d.widget.on("componentsInitialized",
d,function(){d._triggerFallbackToMPO&&d.widget.trigger("triggerFallbackToMPO");if(d._shouldOpenAddPaymentInstrumentView){var a=(new URLSearchParams(g.location.search)).get("successCodes");null!==a&&"SUCCESS_CHANGE_MOBILE_PHONE"===a&&b._startAddPMEvent(d)}})},_updateFirstItemStyle:function(a){a.removeClass("apx-wallet-mobile-sleeve-item-shadow-two")}})});b("PaymentMethodDetailsSlotComponentSupport",["lang"],function(b){return{_bindEditPMLink:function(){this.getDOMElement("editPMLink").click(b.bind(this._editPMLinkClicked,
this))},_editPMLinkClicked:function(){var a={"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"StartEditEvent","ppw-iid":this._paymentMethodId,"ppw-paymentMethodType":this._paymentMethodType,"ppw-isDefaultPaymentMethod":this._isDefault};"undefined"!==typeof this._paymentMethodSubCategory&&(a["ppw-paymentMethodSubCategory"]=this._paymentMethodSubCategory);this.widget.submitFormAJAX(a)}}});b("EditComponentSupport",["modal-popover"],function(b){return{_initializePopover:function(a,
e,f){e.data.shouldRenderInPopover&&(f.popover=new b(a,e,f))},_bindPopoverCloseButtonClickedEvent:function(a){a.widget.on("apx-wallet-edit-popover-closed",a,function(){a.getDOMElement("apx-wallet-js-edit-popover-cancel-form").submit()})}}});b("components/PaymentMethodSleeveComponent","component jQuery events/spinner-events AddPaymentMethodHelper clog events/InstrumentRowSelectedEvent AddBalanceMethodHelper".split(" "),function(b,a,e,g,h,m,d){return b.extend({initialize:function(c,b){var e=this;e.widget.on("componentsInitialized",
e,function(){var c=b.data.selectedInstrumentId;c&&e.widget.trigger(m,{instrumentId:c});b.data.shouldFocusSelectedInstrument&&a(".apx-wallet-payment-method-tab-selected").find("a").focus()})},bindToElements:function(){var c=this,e=c.getDOMElement("JsBindSleeveAddPMButton"),b=c.getDOMElement("walletSelectableAddTab"),f=c.getDOMElement("walletAddBalanceTab");e.click(function(){g._startAddPMEvent(c)});b.click(function(){"mobile"!==c.widget.options.deviceType&&(a(".apx-wallet-payment-method-tab-selected").removeClass("apx-wallet-payment-method-tab-selected"),
c.getDOMElement("walletSelectableAddTab").addClass("apx-wallet-payment-method-tab-selected"));g._startAddPMEvent(c)});null!=f&&f.click(function(){"mobile"!==c.widget.options.deviceType&&(a(".apx-wallet-payment-method-tab-selected").removeClass("apx-wallet-payment-method-tab-selected"),c.getDOMElement("walletAddBalanceTab").addClass("apx-wallet-payment-method-tab-selected"));d._startAddBalanceEvent(c)});c.getDOMElement("walletSeeAllPaymentMethods").bind("click",function(){h.logCounterMetric({feature:"WalletSeeAllPaymentMethods",
resource:"_Count"});h.publishMetrics();c._triggerFallbackToMPO()})},bindToEvents:function(){var a=this;a.widget.on("triggerFallbackToMPO",a,function(){a._triggerFallbackToMPO()})},_triggerFallbackToMPO:function(){h.logCounterMetric({feature:"WalletFallbackToMPO",resource:"_Count"});h.publishMetrics();this.widget.trigger(e.showSpinner);this.widget.widgetAction({widgetActionType:"wallet",widgetAction:"fallback-to-mpo-widget"})}})});b("PaymentMethodSleeveItemSlotComponentSupport",["jQuery","events/spinner-events"],
function(b,a){return{bindToElements:function(){var a=this;a.getDOMElement("walletSelectablePMTab").click(function(){b(".apx-wallet-payment-method-tab-selected").removeClass("apx-wallet-payment-method-tab-selected");a.getDOMElement("walletSelectablePMTab").addClass("apx-wallet-payment-method-tab-selected");a._triggerViewDetailsEvent();return!1});a.getDOMElement("walletSelectablePMButton").click(function(){a._triggerViewDetailsEvent()})},_triggerViewDetailsEvent:function(){var b=this;b.widget.trigger(a.showSpinner);
b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"ViewPaymentMethodDetailsEvent","ppw-instrumentId":b._instrumentId},{success:b.widget.createAjaxContinueSuccessHandler(),complete:function(){b.widget.trigger(a.hideSpinner)}})}}});b("components/PaymentMethodSleevePaginationComponent",["component","jQuery","lang"],function(b,a,e){return b.extend({_sleeveId:!1,initialize:function(a,b){this._sleeveId=b.data.sleeveId},bindToElements:function(){var a=this,b=
a.getDOMElements("walletSleevePageButton"+a._sleeveId);e.forEach(b,function(b){b=b.querySelector("button");var d=b.value;d&&(b.onclick=e.bind(function(a){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"PaymentMethodSleevePaginationNavigateEvent","ppw-sleeveId":this._sleeveId,"ppw-newPageIndex":a});return!1},a,d))})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Balances","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ManageBalancesComponent",["component","metrics-helper"],function(a,b){return a.extend({bindToElements:function(){b.publishOnClickSuccessSushiMetrics(this,[{JsBindElementId:"EnrollRewardsAccountDesktopLink",
MetricsObject:{ActionType:"EnrollRewardsAccountDesktopLink"}},{JsBindElementId:"EnrollRewardsAccountMobileLink",MetricsObject:{ActionType:"EnrollRewardsAccountMobileLink"}}])}})});a("components/RewardsAccountListComponent",["component"],function(a){return a.extend({})});a("components/RewardsAccountListItemComponent",["component"],function(a){return a.extend({})})})()});
/* ******** */
(function(t){var u=window.AmazonUIPageJS||window.P,v=u._namespace||u.attributeErrors,g=v?v("APXWidgetsAssets@APXWidgets-CreditCardBillPayment","APXWidgetsAssets"):u;g.guardFatal?g.guardFatal(t)(g,window):g.execute(function(){t(g,window)})})(function(t,u,v){(function(){var g=PaymentsPortal2.modules.define;g("components/AddCreditCardBillPaymentsComponent","form-component css-utils cc-spacing lang events/form-submitted-event jQuery form-helper mock-helper AUI!P validation-functions clog".split(" "),
function(g,d,t,h,v,k,U,V,z,n){var l,w,e,y,S=/^[0-9]+$/,A="",B="",E,F,C,G,H,I,J,L,M,N,q,p,D,O,m,r="false",P,Q,R=!1,x=!1;return g.extend({initialize:function(a,b){this._addButtonJSBinding=b.data.addButtonJSBinding||"newCreditCardSubmitButton";this._addFormContainerJSBinding=b.data.addFormContainerJSBinding||"addCreditCardContainer";this._accountHolderNameBinding=b.data.addAccountHolderNameBinding||"accountHolderName";this._addCardNumberBinding=b.data.addCardNumberBinding||"addCreditCardNumber";this._placementType=
b.data.placementType;this._alertJSBinding=b.data.alertFailureContainerJSBinding||"pmts-alert-failure-container";this._lengthRequiredToFetchIssuer=b.data.minLengthRequiredToFetchIssuer||6;this._expiryMonthBinding=b.data.addExpiryMonthBinding||"expirationDate";this._expiryYearBinding=b.data.addExpiryYearBinding||"expirationDate";this._secureCardHiddenBinding=b.data.addSecureCardBinding||"secureCardHidden";J=b.data.prefillBankCode;L=b.data.prefillNetworkImage;M=b.data.prefillTail;N=b.data.prefillBankDisplayName;
q=b.data.shouldPrefillSemiSavedCardDetails;p=b.data.isInlineTokenisationEnabled;D=b.data.isBillDeskIntegrationEnabled;O=b.data.isMandatoryTokenisationEnabled;P=b.data.payAndSecureCTALabel;Q=b.data.proceedCTALabel;p&&(m=!1,this.getDOMElement(this._secureCardHiddenBinding).val(!1),E=this.getDOMElement("expiry_selector"),F=this.getDOMElement("name_on_card_section"),C=this.getDOMElement("mandatoryTokenisationError"),G=this.getDOMElement("cardNotSupportedError"),x=b.data.isRedirectedFromSecureNow,this.createConditionalValidationFunctions(),
H=this.getDOMElement("nonTokenisableCardError"),z.when("a-button").execute(function(b){w=b("#proceedButton")}))},bindToElements:function(){this.getDOMElement(this._addButtonJSBinding).click(h.bind(this.handleAddCardLikeDOMEvent,this));this.getDOMElement(this._accountHolderNameBinding);var a=this.getDOMElement(this._addCardNumberBinding),b=this.getDOMElement(this._expiryMonthBinding),T=this.getDOMElement(this._expiryYearBinding);y=this.getDOMElement(this._alertJSBinding);d.setElementBackgroundImage(a,
this._blankIssuerImageURL,"no-repeat 96% center");setTimeout(function(){q&&d.setElementBackgroundImage(a,L)},500);z.when("jQuery","ready").execute("autofocus-addCreditCardNumber",function(b){q||b('input[name\x3d"addCreditCardNumber"]').focus()});var c=this,K,f;a.keydown(function(b){K=this.value;f=this.selectionStart});b.click(function(b){c._clearValidationErrors()});T.click(function(b){c._clearValidationErrors()});a.bind("paste",function(b){k(b.target).keyup()});a.keyup(function(b){this.value=this.value.replace(/^0|[^0-9\s]+/g,
"");"number"!==this.type&&this.value!==K&&(b=this.selectionStart,this.value=t.fixSpacing(this.value),b=t.fixCaret(b,this.value,K,f),this.setSelectionRange(b,b))});var e=null;a.keyup(function(b){u.clearTimeout(e);e=u.setTimeout(function(){B=A="";q||(c._resetIssuingBankAndHideTokenisationFields(),p&&(x?(c.enableDisableProceedButton(!0),r=""):c.enableDisableSecureCardCheckbox(!1)));var b=a.val().replace(/\s/g,"");S.test(b)&&b.length>=c._lengthRequiredToFetchIssuer?c.widget.trigger("creditCardNumberChanged",
{creditCardNumber:b,placementType:c._placementType}):(c._clearValidationErrors(),d.setElementBackgroundImage(a,this._blankIssuerImageURL))},500)});a.focus(function(b){q&&!R&&(a.val(M),setTimeout(function(){a[0].setSelectionRange(0,0)},0),R=!0)})},handleAddCardLikeDOMEvent:function(a){if(w.isEnabled()){if(p&&x&&"false"===r)return!1;var b=this.form.validateForm();0===b.length&&(this.form.renderErrorMessages(b),this._formSubmissionEventObj={submissionParameters:this.getFormSubmissionParameters(this._addFormContainerJSBinding),
action:this._action,event:a},h.isDefined(this._formSubmissionEventObj.submissionParameters)&&h.isDefined(this._formSubmissionEventObj.submissionParameters[2])&&(this._formSubmissionEventObj.submissionParameters[2].value=this._formSubmissionEventObj.submissionParameters[2].value.replace(/\s/g,"")),this.widget.trigger(v,this._formSubmissionEventObj));return!1}},bindToEvents:function(){function a(b){e&&e.getSelect("issuingBankSelectDropDown")&&e.getSelect("issuingBankSelectDropDown").setValue(b);k("#issuingBankCodeTextInput").val(b);
k("#fetchedBankCodeTextInput").val(b)}var b=this;this.getDOMElement("secureCardCheckbox").change(function(a){b.hideShowTokenisationFields(k(this).is(":checked"))});this.widget.on(v,this,function(a){d.hideElement(y);b.widget.trigger("submitFormAjaxStarted");p?(x&&(m=!1),a={addCreditCardNumber:a.submissionParameters[2].value,"ppw-accountHolderName":a.submissionParameters[5].value,"ppw-selectIssuingBankCode":a.submissionParameters[3].value,"ppw-fetchedBankCode":a.submissionParameters[4].value,"ppw-cardType":A.split('"')[1],
"ppw-countryCode":B,"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"AddCreditCardEvent","ppw-expirationDate_month":a.submissionParameters[6].value,"ppw-expirationDate_year":a.submissionParameters[7].value,"ppw-secureCardHidden":m}):a={addCreditCardNumber:a.submissionParameters[2].value,"ppw-selectIssuingBankCode":a.submissionParameters[3].value,"ppw-fetchedBankCode":a.submissionParameters[4].value,"ppw-cardType":A.split('"')[1],"ppw-countryCode":B,"ppw-widgetState":b.widget.options.serializedState,
"ppw-widgetEvent":"AddCreditCardEvent"};b.widget.continueRequest(a,{query:{sif_profile:"CCBP_SIF_Profile"},success:function(a){var c=a.additionalWidgetResponseData.additionalData.addCreditCardEventResponseMessage;"failed"===a.additionalWidgetResponseData.additionalData.addCreditCardEventResponseStatus&&b._displayErrorMessage(c)},complete:function(){b.widget.trigger("submitFormAjaxCompleted")}})});this.widget.on("creditCardIssuerDetermined",this,function(a){b.widget.trigger("submitFormAjaxCompleted");
a.countryCode&&(B=a.countryCode);a.cardType&&(A=a.cardType);a.issuer||(clog.logCounterMetric({feature:"BinProperties_IssuerNotPresent",resource:"_Count"}),clog.publishMetrics());a.issuingBankName?this.widget.continueRequest({"ppw-issuingBankName":a.issuingBankName,"ppw-network":a.issuer,"ppw-widgetEvent":"IdentifyIssuingBankEvent","ppw-widgetState":this.widget.options.serializedState},{success:h.bind(function(a){a=a.additionalWidgetResponseData.additionalData;a.issuingBankCode&&a.issuingBankDisplayName?
(l&&l.text(a.issuingBankDisplayName),e&&e.getSelect("issuingBankSelectDropDown")&&e.getSelect("issuingBankSelectDropDown").setValue(a.issuingBankCode),k("#issuingBankCodeTextInput").val(a.issuingBankCode),k("#fetchedBankCodeTextInput").val(a.issuingBankCode),p&&(r=a.isTokenisable,x?("true"===r?this.enableDisableProceedButton(!0):this.enableDisableProceedButton(!1),this.enableDisableSecureCardCheckbox(!0),this.getDOMElement("secureCardCheckbox").attr("checked",!1),m=!0):"true"===r?(this.showInlineTokenisationFields(),
this.getDOMElement("secureCardCheckbox").attr("checked",!0),this.getDOMElement(this._secureCardHiddenBinding).val(!1),m=!1):(this.enableDisableSecureCardCheckbox(!0),this.getDOMElement("secureCardCheckbox").attr("checked",!1),this.getDOMElement(this._secureCardHiddenBinding).val(!0),m=!0,d.showElement(H))),D&&this.handleCardEligibility(a),a="#"+this.form.component._elementReferences.selectIssuingBankCode,this.form._getFormFieldAlertContainers().selectIssuingBankCode.find(".pmts-error-message-inline").remove(),
k(a).removeClass("a-form-error a-button-error")):(this.disableSecureNowCheckboxIfIssuingBankIsNotDetected(),b._resetIssuingBankAndHideTokenisationFields())},this),error:h.bind(function(a){this.disableSecureNowCheckboxIfIssuingBankIsNotDetected()},this)}):(this.disableSecureNowCheckboxIfIssuingBankIsNotDetected(),b._resetIssuingBankAndHideTokenisationFields(),clog.logCounterMetric({feature:"BinProperties_IssuingBankNameNotPresent",resource:"_Count"}),clog.publishMetrics());if(a.issuerImage){var c=
this.getDOMElement(this._addCardNumberBinding);d.setElementBackgroundImage(c,a.issuerImage)}});z.when("A","a-sheet","a-button","ready").execute("issuingBankBottomsheet",function(b,c,d){var f,e=b.$;l=d("#issuingBankSelectBtn");b.on("a:sheet:afterShow:issuing_bank_bottom_sheet",function(a){f=a.sheet});b.declarative("issuing-bank-item-click","click",function(a){a=a.data;f&&f.hide();l&&(l.text(a.issuingBankDisplayName),e("#issuingBankCodeTextInput").val(a.issuingBankCode))});q&&(l&&l.text(N),a(J))});
z.when("A","a-dropdown","ready").execute("issuingBankDropDown",function(b,c){e=c;q&&a(J)})},hideShowTokenisationFields:function(a){if("true"===r){var b=this.getDOMElement(this._secureCardHiddenBinding);O&&D&&"true"===I&&this.toggleMandatoryTokenisationError(a);a?(b.val(""),this.showInlineTokenisationFields(),this.getDOMElement(this._secureCardHiddenBinding).val(!1),m=!1):(b.val("checked"),this.hideInlineTokenisationFields(),this.getDOMElement(this._secureCardHiddenBinding).val(!0),m=!0)}},toggleMandatoryTokenisationError:function(a){a?
(this.enableDisableProceedButton(!0),d.hideElement(C)):(this.enableDisableProceedButton(!1),d.showElement(C))},enableDisableSecureCardCheckbox:function(a){this.getDOMElement("secureCardCheckbox").attr("disabled",a)},hideInlineTokenisationFields:function(){d.hideElement(E);d.hideElement(F);w.text(Q)},showInlineTokenisationFields:function(){d.showElement(E);d.showElement(F);w.text(P)},handleCardEligibility:function(a){I=a.shouldEnforceTokenisation;"true"===I&&"false"===r&&(this.enableDisableProceedButton(!1),
d.showElement(G))},createConditionalValidationFunctions:function(){n.NonEmptyWhenConditionFieldCompliesToValidationTypeConstraint=function(a,b,d,c){var e="false"==b[c.conditionFieldName],f=!1;switch(c.validationType.value){case "NonEmptyWhenConditionFieldFalse":f=e}return f?n.NonEmptyFieldConstraint(a,b,d):!0};n.MatchesPatternWhenConditionFieldCompliesToValidationTypeConstraint=function(a,b,d,c){var e="false"==b[c.conditionFieldName],f=!1;switch(c.validationType.value){case "MatchesPatternWhenConditionFieldFalse":f=
e}return f?n.RegexMatchFieldConstraint(a,b,d,c):!0};n.LengthGreaterThanOrEqualWhenConditionFieldPassesValidationConstraint=function(a,b,d,c){var e="false"==b[c.conditionFieldName],f=!1;switch(c.validationType.value){case "LengthGreaterThanOrEqualWhenConditionFieldFalse":f=e}return f?n.LengthGreaterThanEqualConstraint(a,b,d,c):!0};n.VerifyExpirationDateWhenConditionFieldCompliesToValidationTypeConstraint=function(a,b,d,c){var e="false"==b[c.conditionFieldName],f=!1;switch(c.validationType.value){case "VerifyExpirationDateWhenConditionFieldFalse":f=
e}return f?n.CreditCardExpirationConstraint(a,b,d,c):!0}},_displayErrorMessage:function(a){y.find(".a-alert-content").html(a);d.showElement(y)},enableDisableProceedButton:function(a){a?w.enable():w.disable()},disableSecureNowCheckboxIfIssuingBankIsNotDetected:function(){this.enableDisableSecureCardCheckbox(!0);this.getDOMElement("secureCardCheckbox").attr("checked",!1);this.getDOMElement(this._secureCardHiddenBinding).val(!0);m=!0},_resetIssuingBankAndHideTokenisationFields:function(){l&&l.text("Select bank");
e&&e.getSelect("issuingBankSelectDropDown")&&e.getSelect("issuingBankSelectDropDown").setValue("");k("#issuingBankCodeTextInput").val("");k("#fetchedBankCodeTextInput").val("");p&&!x?(this.hideInlineTokenisationFields(),d.hideElement(H)):p&&this.showInlineTokenisationFields();D&&(d.hideElement(G),d.hideElement(C),this.enableDisableProceedButton(!0))},_clearValidationErrors:function(){d.hideElement(y);this.form.clearValidationErrors();if(h)try{var a=this.form._getFormFieldAlertContainers();a&&h.keys(a)&&
h.forEach(h.keys(a),function(b){a[b].find(".pmts-error-message-inline").remove()})}catch(b){console.log("Error while removing inlineFormFieldAlertContainers")}}})})})()});
/* ******** */
(function(f){var c=window.AmazonUIPageJS||window.P,g=c._namespace||c.attributeErrors,b=g?g("APXWidgetsAssets@APXWidgets-Venmo","APXWidgetsAssets"):c;b.guardFatal?b.guardFatal(f)(b,window):b.execute(function(){f(b,window)})})(function(f,c,g){(function(){var b=PaymentsPortal2.modules.define;b("components/AddVenmoComponent","events/form-submitted-event jQuery form-component mini-browser-helper lang clog".split(" "),function(b,m,k,l,e,g){var h={width:600,height:800};return k.extend({_hasErrors:!1,initialize:function(a,
d){this._hasErrors=d.data.hasErrors;this._interstitialPageUrl=d.data.interstitialPageUrl;this._isMiniBrowserEnabled=d.data.isMiniBrowserEnabled;this._instrumentId=d.data.instrumentId;this._widgetAction=d.data.action;this._intermediateScreenTreatment=d.data.intermediateScreenTreatment;this._desktopDescriptionTreatment=d.data.desktopDescriptionTreatment;this._device=a.options.deviceType;this._isRequestForMobileApp=d.data.isRequestForMobileApp},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",
a,function(){a._interstitialPageUrl&&(a._isMiniBrowserEnabled?a._showPopoverModal():c.location.href=this._interstitialPageUrl)});a.widget.on("AddVenmoIntermediateStepEvent",a,function(a){this._isIntermediateScreenEnabled()?this.getDOMElement("apx-add-venmo-mobile-link").trigger("click"):this._handleAddVenmoClickWithoutIntermediateScreen(a)})},_handleCompactAddVenmoClicked:function(a){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._desktopDescriptionTreatment+".addVenmoBtnClicked");this._handleAddVenmoFormSubmission(a)},
_handleDesktopAddVenmoClicked:function(a){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._desktopDescriptionTreatment+".addVenmoBtnClicked")},bindToElements:function(){var a=this;f.when("A","a-modal","ready").execute(function(d,b){a.getDOMElement("apx-add-venmo-modal-go-button").click(function(){a._logClogCounterMetric("DigitalWallet.Venmo.Reg."+a._desktopDescriptionTreatment+".goToVenmoBtnClicked");a._openVenmoMiniBrowserWindow(a._interstitialPageUrl)})});f.when("A","a-modal").execute(function(d){d.off("a:popover:afterHide:apx-add-venmo-modal");
d.on("a:popover:afterHide:apx-add-venmo-modal",function(d){a._logClogCounterMetric("DigitalWallet.Venmo.addVenmoPopoverHidden")})});a.getDOMElement("apx-add-venmo-link-button").click(e.bind(this._handleDesktopAddVenmoClicked,this));a.getDOMElement("apx-add-venmo-compact-link").click(e.bind(this._handleCompactAddVenmoClicked,this));a.getDOMElement("apx-continue-to-venmo-button-id").click(e.bind(this._handleContinueToVenmoButton,this));this._isIntermediateScreenEnabled()?(a.getDOMElement("apx-venmo-intermediate-screen-learn-more-link-mobile").click(e.bind(this._handleIntermediateScreenLearnMoreLink,
this)),a.getDOMElement("apx-add-venmo-mobile-link").click(e.bind(this._handleAddVenmoClickWhichOpensIntermediateScreen,this))):a.getDOMElement("apx-add-venmo-mobile-link").click(e.bind(this._handleAddVenmoClickWithoutIntermediateScreen,this));this._isDesktopDescriptionEnabled()&&a.getDOMElement("apx-add-venmo-learn-more-link").click(e.bind(this._handleDesktopDescriptionLearnMoreLink,this))},_isIntermediateScreenEnabled:function(){return this._intermediateScreenTreatment&&"C"!==this._intermediateScreenTreatment.toUpperCase()},
_isDesktopDescriptionEnabled:function(){return this._desktopDescriptionTreatment&&"C"!==this._desktopDescriptionTreatment.toUpperCase()},_showPopoverModal:function(){this.getDOMElement("apx-add-venmo-modal-trigger").trigger("click")},_hidePopoverModal:function(){var a=this;f.when("a-modal").execute(function(d){d&&(d=d.get("apx-add-venmo-modal"))&&(d.hide(),a._logClogCounterMetric("DigitalWallet.Venmo.addVenmoPopoverHiddenAfterInterstitialClosed"))})},_getDeviceType:function(){return this._isRequestForMobileApp?
"mobileapp":this._device},_handleContinueToVenmoButton:function(a){this._handleAddVenmoReturnUrl(a);this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._intermediateScreenTreatment+"."+this._getDeviceType()+".continueToVenmoBtnClicked");this.widget.publishSuccessSushiMetrics({ActionType:"ContinueToVenmo",ActionValueType:"Click",ActionValue:"ContinueToVenmoButtonClicked"})},_handleAddVenmoClickWithoutIntermediateScreen:function(a){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._getDeviceType()+
".addVenmoBtnClicked");this._handleAddVenmoFormSubmission(a)},_handleAddVenmoClickWhichOpensIntermediateScreen:function(){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._intermediateScreenTreatment+"."+this._getDeviceType()+".addVenmoBtnClicked");this.widget.publishSuccessSushiMetrics({ActionType:"AddVenmoAccount",ActionValueType:"Click",ActionValue:"AddVenmoButtonClicked"})},_handleIntermediateScreenLearnMoreLink:function(){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._intermediateScreenTreatment+
".IntermediateScreen.learnMoreClicked")},_handleDesktopDescriptionLearnMoreLink:function(){this._logClogCounterMetric("DigitalWallet.Venmo.Reg.DesktopDescription.learnMoreClicked")},_logClogCounterMetric:function(a){g.logCounterMetric({feature:a,resource:"_Count"});g.publishMetrics()},_openVenmoMiniBrowserWindow:function(a){this._venmo_window=l.openInMiniBrowser(a,"apx-add-venmo-mini-window",h);this._venmo_window.focus();this._monitorVenmoMinibrowserWindow()},_handleAddVenmoReturnUrl:function(a){a=
c.location.pathname+c.location.search;this.getDOMElement("apx-add-venmo-client-page-url").val(a)},_handleAddVenmoFormSubmission:function(a){this.widget.publishSuccessSushiMetrics({ActionType:"AddVenmoAccount",ActionValueType:"Click",ActionValue:"AddVenmoButtonClicked"});a=this.getDOMElement("apx-add-venmo-form");this._handleAddVenmoReturnUrl();a.submit()},_monitorVenmoMinibrowserWindow:function(){c.clearTimeout(this._venmo_window_timer);!this._venmo_window||this._venmo_window.closed?(this._hidePopoverModal(),
this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})):this._venmo_window_timer=setTimeout(this._monitorVenmoMinibrowserWindow.bind(this),100)}})});b("components/VenmoDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(b,c){return b.extend(c,{initialize:function(b,c){this._paymentMethodId=c.data.paymentMethodId;
this._paymentMethodType=c.data.paymentMethodType;this._paymentMethodSubCategory=c.data.paymentMethodSubCategory},bindToElements:function(){this._bindEditPMLink()}})});b("components/VenmoEditComponent",["component","EditComponentSupport"],function(b,c){return b.extend(c,{initialize:function(b,h){c._initializePopover(b,h,this)},bindToEvents:function(){c._bindPopoverCloseButtonClickedEvent(this)}})});b("components/SelectableVenmoListComponent",["form-component"],function(b){return b});b("components/SelectableVenmoListItemComponent",
["components/SelectableDPMInstrumentListItemComponent"],function(b){return b});b("components/VenmoSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(b,c){return b.extend(c,{initialize:function(b,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(k){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors,d=l?l("APXWidgetsAssets@APXWidgets-CVS","APXWidgetsAssets"):g;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,g,l){(function(){var d=PaymentsPortal2.modules.define;d("components/CVSPayByBarcodeComponent","component css-utils jQuery lang AUI!P clog".split(" "),function(d,e,f,c,h,m){return d.extend({countdownTimerIntervalId:"",MAX_FETCH_BARCODE_RETRY:3,RETRY_DELAY:2E3,AUTO_REFRESH_BARCODE_CUTOFF_TIME:30,
shouldContinueFetchData:!0,initialize:function(a,b){this.MAX_FETCH_BARCODE_RETRY=b.data.maxRetry;this.RETRY_DELAY=b.data.retryDelay;this.AUTO_REFRESH_BARCODE_CUTOFF_TIME=b.data.autoRefreshBarcodeCutoffTime;this.displayBarcode=b.data.displayBarcode;this.isMobile="mobile"===a.options.deviceType;this._redirectUrl=b.data.redirectUrl},bindToElements:function(){this.getDOMElement("pmts-cvs-display-barcode-button").click(c.bind(this._displayBarcodeButtonTriggered,this));this.getDOMElement("pmts-cvs-barcode-refresh-button").click(c.bind(this._refreshBarcodeButtonTriggered,
this));this.getDOMElement("pay-by-barcode-store-location-link").click(c.bind(this._triggerConfirmRedirectionPopup,this));this._bindCloseBottomSheetTrigger();!0===this.displayBarcode&&this.isMobile&&this.getDOMElement("pmts-cvs-display-barcode-button").click()},_triggerConfirmRedirectionPopup:function(){this.widget.trigger("OpenRedirectionPopupEvent",{redirectUrl:this._redirectUrl})},_bindCloseBottomSheetTrigger:function(){var a=this;h.when("A","a-sheet").execute("barcode_bottomSheet",function(b,c){b.on("a:sheet:beforeShow:barcode_bottomSheet",
function(b){a.shouldContinueFetchData=!0});b.on("a:sheet:afterHide:barcode_bottomSheet",function(b){clearInterval(a.countdownTimerIntervalId);a.shouldContinueFetchData=!1})})},_renderSpinnerAndFetchBarcodeAsync:function(a){a._renderFetchBarcodePendingView(a);a._continueRequestWithEvent(a,"GenerateBarcodeEvent",0,!1)},_continueRequestWithEvent:function(a,b,c,d){a.widget.continueRequest({"ppw-widgetEvent":b,"ppw-widgetState":a.widget.options.serializedState},{success:function(b){a._handleFetchBarcodeSuccess(a,
b,c,d)},error:function(){a._renderFetchBarcodeFailureView(a)}})},_refreshBarcodeButtonTriggered:function(){this._renderSpinnerAndFetchBarcodeAsync(this)},_displayBarcodeButtonTriggered:function(){this._renderSpinnerAndFetchBarcodeAsync(this)},_fetchBarcodeWithRetry:function(a,b){b++;a.shouldContinueFetchData?a._continueRequestWithEvent(a,"GetBarcodeEvent",b,!0):a._renderFetchBarcodeFailureView(a)},_handleFetchBarcodeSuccess:function(a,b,c,d){var e=b.additionalWidgetResponseData.additionalData;b=e.getBarcodeStatus;
var f=e.barcodeBase64Image;e=e.barcodeExpiresAtEpochSeconds;d||"PENDING"!==b?c<a.MAX_FETCH_BARCODE_RETRY?"SUCCESS"===b?a._renderFetchBarcodeSuccessView(a,f,e):"FAILURE"===b?a._renderFetchBarcodeFailureView(a):g.setTimeout(function(){a._fetchBarcodeWithRetry(a,c)},a.RETRY_DELAY):("SUCCESS"===b?a._renderFetchBarcodeSuccessView(a,f,e):a._renderFetchBarcodeFailureView(a),m.logCounterMetric({feature:"FetchBarcodeRetryExceeded",resource:"_Count"}),m.publishMetrics()):a._fetchBarcodeWithRetry(a,c)},_renderFetchBarcodePendingView:function(a){a._hideBarcodeImageSection(a);
a._hideReloadBarcodeButtonSection(a);e.showElement(a.getDOMElement("pmts-cvs-get-barcode-pending-section"))},_renderFetchBarcodeSuccessView:function(a,b,c){a._hideReloadBarcodeButtonSection(a);a._hideSpinnerSection(a);a._showBarcodeImageSection(a,b,c)},_renderFetchBarcodeFailureView:function(a){a._hideBarcodeImageSection(a);a._hideSpinnerSection(a);a._showReloadBarcodeButtonSection(a)},_hideBarcodeImageSection:function(a){e.hideElement(a.getDOMElement("pmts-cvs-barcode-image-section-id"))},_hideSpinnerSection:function(a){e.hideElement(a.getDOMElement("pmts-cvs-get-barcode-pending-section"))},
_hideReloadBarcodeButtonSection:function(a){e.hideElement(a.getDOMElement("refresh-barcode-button-section-id"))},_showBarcodeImageSection:function(a,b,c){f(a.getDOMElement("pmts-cvs-barcode-image")).attr("src","data:image/png;base64,"+b);a._displayBarcodeExpiresInTimer(a,c);e.showElement(a.getDOMElement("pmts-cvs-barcode-image-section-id"))},_showReloadBarcodeButtonSection:function(a){e.showElement(a.getDOMElement("refresh-barcode-button-section-id"));a.getDOMElement("pmts-cvs-barcode-refresh-button").click(c.bind(this._refreshBarcodeButtonTriggered,
this))},_displayBarcodeExpiresInTimer:function(a,b){var c=!1;a.countdownTimerIntervalId=setInterval(function(){var e=Math.round(Date.now()/1E3);e=b-e;var d=Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0");e<a.AUTO_REFRESH_BARCODE_CUTOFF_TIME&&!c&&(a.widget.submitFormAJAX({"ppw-widgetEvent":"GenerateBarcodeEvent","ppw-widgetState":a.widget.options.serializedState}),c=!0);0>e?(clearInterval(a.countdownTimerIntervalId),a._renderFetchBarcodePendingView(a),a._fetchBarcodeWithRetry(a,0)):
a.getDOMElement("pmts-cvs-barcode-expires-in-timer").html(d)},1E3)}})});d("components/cvs",["component"],function(d){return d.extend({initialize:function(){console.log("Cvs initialized!")}})});d("components/CVSPaymentNotesComponent",["component"],function(d){return d.extend({})});d("components/CVSPayByPayIdComponent",["component","jQuery","lang"],function(d,e,f){return d.extend({initialize:function(c,d){this.storeLocationIds=d.data.storeLocationIds},bindToElements:function(){var c=this;f.forEach(c.storeLocationIds,
function(d){c.getDOMElement("store-location-link-id-"+d).click(f.bind(c._openConfirmRedirectionPopup,c))})},_openConfirmRedirectionPopup:function(c){c=e(c.target).attr("data-storeLink");this.widget.trigger("OpenRedirectionPopupEvent",{redirectUrl:c})}})});d("components/CVSPaymentLocationsComponent",["component","css-utils","lang","jQuery","clog"],function(d,e,f,c,h){return d.extend({bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(a){e.hideElement(c.getDOMElement("pmts-cvs-barcode-pending-payment-location-view"));
e.showElement(c.getDOMElement("pmts-cvs-barcode-payment-location-view"))})},bindToElements:function(){this.getDOMElement("JSPaidyBannerClick").click(f.bind(this._triggerBanner,this,"PaidyLpBannerClick","https://www.amazon.co.jp/-/en/dp/B08B5TDT9J"));this.getDOMElement("JSPaidyWalletBannerClick").click(f.bind(this._triggerBanner,this,"PaidyWalletBannerClick","https://www.amazon.co.jp/cpe/yourpayments/wallet"));this.getDOMElement("JSPayPayBannerClick").click(f.bind(this._triggerBanner,this,"PayPayLpBannerClick",
"https://www.amazon.co.jp/l/10435052051"));this.getDOMElement("JSPayPayWalletBannerClick").click(f.bind(this._triggerBanner,this,"PayPayWalletBannerClick","https://www.amazon.co.jp/cpe/yourpayments/wallet"))},_triggerBanner:function(c,a){this.publishCountMetrics(c);g.location.href=a},publishCountMetrics:function(c){h.logCounterMetric({feature:c,resource:"_Count"});h.publishMetrics()}})});d("components/ConfirmRedirectionPopupComponent","component jQuery lang AUI!P modal-popover mash-helper".split(" "),
function(d,e,f,c,h,k){return d.extend({initialize:function(a,b){this._redirectUrl=b.data.redirectUrl;this._jsComponentData=b;this._shouldRedirect=!1},bindToElements:function(){this.getDOMElement("confirm-redirection-popup-continue-button").click(f.bind(this._handleContinueAction,this));this.getDOMElement("confirm-redirection-popup-cancel-button").click(f.bind(this._handleCancelAction,this))},bindToEvents:function(){var a=this;a.widget.on("OpenRedirectionPopupEvent",a,function(b){a._redirectUrl=b.redirectUrl;
"mobile"===a.widget.options.deviceType?a._openSecondaryView():a._openModal()});var b="mobile"===a.widget.options.deviceType?"afterSlideOut":"afterHide";c.when("A").execute(function(c){c.on("a:popover:"+b+":"+a._jsComponentData.data.popoverName,function(b){a._shouldRedirect&&(g.location.href=a._redirectUrl,a._shouldRedirect=!1)})})},_handleContinueAction:function(){this._shouldRedirect=!0;this._handleCancelAction()},_openModal:function(){this.popover=new h(this.widget,this._jsComponentData,this);this.bindToElements()},
_openSecondaryView:function(){var a=this;c.when("A","a-secondary-view").execute(function(b,c){b=b.$("#"+a._jsComponentData.data.declarativeAction);a.popover=c.get(b);a.popover.show()})},_closeSecondaryView:function(){var a=this;c.when("a-secondary-view").execute(function(b){b&&(b=b.get(a._jsComponentData.data.popoverName))&&b.hide()})},_closeModal:function(){this.widget.trigger("confirm-redirection-popup-cancel-event")},_handleCancelAction:function(){"mobile"===this.widget.options.deviceType?this._closeSecondaryView():
this._closeModal()}})})})()});
/* ******** */
(function(f){var e=window.AmazonUIPageJS||window.P,g=e._namespace||e.attributeErrors,a=g?g("APXWidgetsAssets@APXWidgets-DigitalWallet","APXWidgetsAssets"):e;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,e,g){(function(){var a=PaymentsPortal2.modules.define;a("components/AddDigitalWalletComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,c,e,f,g){g.when("A","jQuery","a-dropdown").execute(function(a,c,b){a.declarative("a-popover-a11y",
"focusin",function(a){if(a=document.getElementById("pmts-add-digital-wallet-dropdown-with-grey-out-selected-wallet-native-id_0")){a=a.parentElement.parentElement.childElementCount;for(var c=0;c<a;c++){var d=document.getElementById("pmts-add-digital-wallet-dropdown-with-grey-out-selected-wallet-native-id_"+c);if(null!=d&&d.parentElement.classList.contains("deviceDisabled")&&"A"==d.tagName.toUpperCase()){for(var b=document.createElement("div"),h=0;h<d.attributes.length;h++)b.setAttribute(d.attributes[h].name,
d.attributes[h].value);b.textContent=d.textContent;d.parentElement.replaceChild(b,d)}}}})});return e.extend({_hasErrors:!1,initialize:function(a,c){this._action="add-digital-wallet";this._hasErrors=c.data.hasErrors},bindToElements:function(){this.getDOMElement("addDigitalWalletSubmitButton").click(f.bind(this._handleFormSubmission,this))},bindToEvents:function(){var b=this;b.widget.on(a,b,function(a){a.action===b._action&&c(b.getDOMElement("addDigitalWalletForm")).submit()})},_handleFormSubmission:function(b){var c=
this.form.validateForm(),e=this.getFormSubmissionParameters("addDigitalWalletFormContainer");0===c.length?this.widget.trigger(a,{event:b,submissionParameters:e,action:this._action}):b.preventDefault()}})});a("components/DigitalWalletDetailsSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/SelectableDigitalWalletListComponent",["form-component"],function(a){return a});a("components/SelectableDigitalWalletListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],
function(a){return a});a("components/DigitalWalletSleeveItemSlotComponent",["component"],function(a){return a.extend({_triggerFallbackToMPO:!1,initialize:function(a,b){this._triggerFallbackToMPO=b.data.triggerFallbackToMPO},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO")})}})})})()});
/* ******** */
(function(g){var f=window.AmazonUIPageJS||window.P,h=f._namespace||f.attributeErrors,c=h?h("APXWidgetsAssets@APXWidgets-ImportantMessageBox","APXWidgetsAssets"):f;c.guardFatal?c.guardFatal(g)(c,window):c.execute(function(){g(c,window)})})(function(g,f,h){(function(){var c=PaymentsPortal2.modules.define;c("components/ImportantMessageBoxComponent","component jQuery css-utils events/InstrumentRowSelectedEvent events/CreditCardIssuerDeterminedEvent events/CreditCardNumberResetEvent".split(" "),function(c,
d,e,f,g,h){return c.extend({initialize:function(a,b){this.messageDisplayConditionMap=b.data.messageDisplayConditionMap;this.messageGroupClass=b.data.messageGroupClass;this.messageGroupItemClass=b.data.messageGroupItemClass;this.shouldDisplayForMultitenderKey=b.data.shouldDisplayForMultitenderKey;this.displayForSpecificInstrumentIdsKey=b.data.displayForSpecificInstrumentIdsKey;this.displayForSpecificBrandsKey=b.data.displayForSpecificBrandsKey;this.isMultitenderSelected=!1;this.creditCardIssuerDetermined=
this.selectedInstrumentId="";this.refreshIMBDisplay()},bindToEvents:function(){this.widget.on(f,this,function(a){this.updateStateInstrumentChanged(a.instrumentId);this.refreshIMBDisplay()});this.widget.on("optionalInstrumentSelected",this,function(a){this.updateStateOptionalInstrumentChanged(!0,a.paymentMethod);this.refreshIMBDisplay()});this.widget.on("optionalInstrumentDeselected",this,function(a){this.updateStateOptionalInstrumentChanged(!1,a.paymentMethod);this.refreshIMBDisplay()});this.widget.on(g,
this,function(a){this.updateStateBrandChanged(a.issuer,a.cardType);this.refreshIMBDisplay()});this.widget.on(h,this,function(){this.updateStateBrandChanged("","");this.refreshIMBDisplay()})},updateStateInstrumentChanged:function(a){this.selectedInstrumentId="string"===typeof a&&a?a:""},updateStateOptionalInstrumentChanged:function(a,b){"string"===typeof b&&"GC"===b.toUpperCase()&&(this.isMultitenderSelected=a)},updateStateBrandChanged:function(a,b){this.creditCardIssuerDetermined="string"===typeof a&&
a&&'"CREDIT"'===b?a:""},refreshIMBDisplay:function(){var a=this,b=this.getDOMElements(),c=b.filter("."+this.messageGroupClass);b=b.filter("."+this.messageGroupItemClass);this.messageDisplayConditionMap&&b.each(function(b,k){if(b=a.messageDisplayConditionMap[d(k).attr("id")]){var c=!0;try{if(a.shouldHideMessageItemForInstrumentId(b,a.selectedInstrumentId)||a.shouldHideMessageItemForMultitender(b,a.isMultitenderSelected)||a.shouldHideMessageItemForBrand(b,a.creditCardIssuerDetermined))c=!1}catch(l){c=
!0}c?e.showElement(d(k)):e.hideElement(d(k))}});c.filter(function(a,b){return!e.hasAUIHiddenClass(d(b))}).filter(function(b,c){return 0===a.findVisibleMessageGroupItems(d(c)).length}).each(function(a,b){e.hideElement(d(b))});c.filter(function(a,b){return e.hasAUIHiddenClass(d(b))}).filter(function(b,c){return 0<a.findVisibleMessageGroupItems(d(c)).length}).each(function(a,b){e.showElement(d(b))})},shouldHideMessageItemForInstrumentId:function(a,b){return(a=a[this.displayForSpecificInstrumentIdsKey])&&
b&&!a.includes(b)},shouldHideMessageItemForMultitender:function(a,b){return!1===a[this.shouldDisplayForMultitenderKey]&&!0===b},shouldHideMessageItemForBrand:function(a,b){return(a=a[this.displayForSpecificBrandsKey])&&!a.includes(b)},findVisibleMessageGroupItems:function(a){return a.find("."+this.messageGroupItemClass).filter(function(a,c){return!1===e.hasAUIHiddenClass(d(c))})}})})})()});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,b=d._namespace||d.attributeErrors,a=b?b("APXWidgetsAssets@APXWidgets-ReplenishmentPayments","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,b){(function(){var a=PaymentsPortal2.modules.define;a("components/ReplenishmentPaymentsComponent",["css-utils","lang","component","clog"],function(a,d,c,b){return c.extend({initialize:function(a,b){this.instrumentId=b.data.instrumentId;this.isDisplayable=
b.data.isDisplayable;this.recurringPaymentEligibilityJsBinding=b.data.recurringPaymentEligibilityJsBinding},bindToEvents:function(){this.widget.on("toggleRecurringPaymentEligibilityMessage",this,function(a){this.data.isDisplayable&&this.instrumentId===a.instrumentId&&(b.logCounterMetric({feature:"SPCRecurringIneligibleInstrumentSelect",resource:"_Count"}),b.publishMetrics())})}})})})()});
/* ******** */
(function(p){var d=window.AmazonUIPageJS||window.P,q=d._namespace||d.attributeErrors,c=q?q("APXWidgetsAssets@APXWidgets-GlobalInstallmentLending","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(p)(c,window):c.execute(function(){p(c,window)})})(function(p,d,q){(function(){var c=PaymentsPortal2.modules.define;c("components/SelectableGILListItemComponent","events/InstrumentRowSelectedEvent components/SelectablePaymentMethodListItemComponent components/POAInstrumentListItemComponent lang css-utils AUI!P jQuery".split(" "),
function(c,f,n,k,m,r,g){var l;return f.extend({initialize:function(a,b){l=b.data.hasInelgibleLineItemsInCart;this.financialOfferCalculationStringsMap=new Map;this.financialOfferDisplayLibraryMap=b.data.financialOfferDisplayLibraryMap;this.multiTenderDiscountAmountMap=b.data.multiTenderDiscountAmountMap;this.gcAmount=b.data.gcAmount.value;this.isCreditLine=b.data.isCreditLine;this.isMobile=b.data.isMobile;this._instrumentId=b.data.instrumentId;this.offerToAmountAllowedOnOtherPaymentMethodsMap=b.data.offerToAmountAllowedOnOtherPaymentMethodsMap;
this.promoAmount=b.data.promoAmount.value;this.showGCWarning=b.data.showGCWarning;this.showGCAndPromoWarning=b.data.showGCAndPromoWarning;this.showGCAndPromoWarningforCL=b.data.showGCAndPromoWarningforCL;this.stringIdMap=b.data.stringIdMap;this.isUpdateFinancialOfferCalculationsEnabled=b.data.isUpdateFinancialOfferCalculationsEnabled;this.showMultiTenderWarning=this.showGCWarning||this.showGCAndPromoWarning;this.currentSelectedFinancialOffer=this._getInitialSelectedFinancialOffer();this._setCurrencyUnit();
this._setFinancialOfferCalculationStringsMap()},_getInitialSelectedFinancialOffer:function(){var a=d.document.getElementById("selectedFinancialOfferHiddenInput");return a?a.value:""},_setCurrencyUnit:function(){this.currencyUnit="";this.offerToAmountAllowedOnOtherPaymentMethodsMap&&(this.currencyUnit=this.offerToAmountAllowedOnOtherPaymentMethodsMap[Object.keys(this.offerToAmountAllowedOnOtherPaymentMethodsMap)[0]].unit)},_chooseGILInstallmentOfferButtonClick:function(a){var b=g(a.currentTarget).find("input"),
e=this.getDOMElement("hiddenGILFinancialOfferIdInput");this.currentSelectedFinancialOffer=b.data("financialofferid");e.val(this.currentSelectedFinancialOffer);b=this.getDOMElement("selectGILOfferAccordionButton");a=g(a.currentTarget).find(".a-section").html();b.html(a);this.closeGilOffersAccordionPopover();this._setMultiTenderWarningMessages(this.currentSelectedFinancialOffer)},closeGilOffersAccordionPopover:function(){r.when("a-secondary-view").execute(function(a){a&&(a=a.get("gilOffersAccordionPopover"))&&
a.hide()})},_hideContainer:function(a){m.hideElement(this.getDOMElement(a))},_showContainer:function(a){m.showElement(this.getDOMElement(a))},_toggleContainers:function(a,b){m.toggleElement(this.getDOMElement(a),b)},_poaInstrumentSelected:function(){k.bind(f.prototype._poaInstrumentSelected,this).apply();this._toggleContainers("selectedFinancialOfferFormContainer",!0);this._toggleContainers("gilMultiTenderWarningsContainer",!0)},_poaInstrumentUnselected:function(){k.bind(f.prototype._poaInstrumentUnselected,
this).apply();this._toggleContainers("selectedFinancialOfferFormContainer",!1);this._toggleContainers("gilMultiTenderWarningsContainer",!1)},_instrumentRowSelected:function(a){k.bind(f.prototype._instrumentRowSelected,this).apply();a===this._instrumentId?(this._poaInstrumentSelected(),this.widget.publishSuccessSushiMetrics({ActionType:"GILPaymentMethodSelected",ActionValueType:"PaymentMethodSelector",ActionValue:"amzn1.ps.pms.gil"})):this._poaInstrumentUnselected()},_getWarningMessageElement:function(a){return d.document.getElementById(this._instrumentId+
"-"+a)},_hasWarningMessageText:function(a){return a&&a.hasChildNodes()&&""!==a.childNodes[0].data.trim()},_formatCurrencyInDisplayLibraryMap:function(a){var b=a.currencyCode||this.currencyUnit;a.totalPaymentAmount&&!a.totalPaymentAmount.includes(b)&&(a.totalPaymentAmount=this._formatCurrency(a.totalPaymentAmount,b));a.interestAmount&&!a.interestAmount.includes(b)&&(a.interestAmount=this._formatCurrency(a.interestAmount,b));a.averageMonthlyAmount&&!a.averageMonthlyAmount.includes(b)&&(a.averageMonthlyAmount=
this._formatCurrency(a.averageMonthlyAmount,b));a.firstMonthAmount&&!a.firstMonthAmount.includes(b)&&(a.firstMonthAmount=this._formatCurrency(a.firstMonthAmount,b));return a},_getFinancialOfferCalculationStringId:function(a){a=0===parseInt(a.apr,10)?"offer_calculation_zero_interest":"offer_calculation";this.isMobile&&(a="mobile_"+a);return this.stringIdMap[a]},_setFinancialOfferCalculationStringsMap:function(){for(var a in this.financialOfferDisplayLibraryMap){var b=new Map,e;for(e in this.financialOfferDisplayLibraryMap[a]){var h=
this.financialOfferDisplayLibraryMap[a][e];h=this._formatCurrencyInDisplayLibraryMap(h);b.set(e,this._getTranslatedString(this._getFinancialOfferCalculationStringId(h),h))}this.financialOfferCalculationStringsMap.set(a,b)}},_updateFinancialOfferCalculationStringsDesktop:function(a){var b=this;r.when("a-dropdown").execute(function(e){try{var h=e.getSelect("gilFinancialOffersDropdown"),f=h.getOptions().info();for(e=0;e<f.length;e++){var c=f[e].value,d=b.financialOfferCalculationStringsMap.get(a).get(c);
h.getOption(e).update({text:d})}}catch(t){d=b.financialOfferDisplayLibraryMap[a];for(c in d){d=b.financialOfferCalculationStringsMap.get(a).get(c);h=g('a[data-value\x3d"'+c+'"]');if("a-active"===h.attr("class")){var l=g('a[data-value\x3d"'+c+'"]').text();var k=d}f=g('option[value\x3d"'+c+'"]');if(f[0].hasAttribute("selected")){var n=g('option[value\x3d"'+c+'"]').text();var m=d}h.text(d);f.text(d)}c=k?k:m;g('.a-dropdown-prompt:contains("'+(l?l:n)+'")').text(c)}})},_updateElementText:function(a,b){a=
d.document.getElementById(a);a.removeChild(a.childNodes[0]);a.appendChild(d.document.createTextNode(b))},_updateFinancialOfferCalculationStringsMobile:function(a){var b=this.financialOfferDisplayLibraryMap[a],e;for(e in b){var c=this._formatCurrencyInDisplayLibraryMap(b[e]),f=this.financialOfferCalculationStringsMap.get(a).get(e);this._updateElementText("accordionFinancialOfferCalculationText-"+e,f);this._updateElementText("accordionInterestText-"+e,this._getTranslatedString(this.stringIdMap.interest,
c));this._updateElementText("accordionTotalInterestAmountText-"+e,this._getTranslatedString(this.stringIdMap.total_interest_amount,c));e===this.currentSelectedFinancialOffer&&this._updateElementText("selectGILOfferAccordionButtonText",f)}},_updateFinancialOfferCalculationStrings:function(a){this.isMobile?this._updateFinancialOfferCalculationStringsMobile(a):this._updateFinancialOfferCalculationStringsDesktop(a)},_gcEventHandler:function(a){var b=this._getWarningMessageElement("gilMTWarningMessageGCTextId");
this.gcWarningRendered?(this._hasWarningMessageText(b)?this._showContainer("gilGCWarning"):this._hideContainer("gilGCWarning"),this.isCreditLine&&a&&this._updateFinancialOfferCalculationStrings("GiftCard")):this._hideContainer("gilGCWarning")},_promoEventHandler:function(a){var b=this._getWarningMessageElement("gilMTWarningMessagePromoTextId");this.promoWarningRendered?(this._hasWarningMessageText(b)?this._showContainer("gilPromoWarning"):this._hideContainer("gilPromoWarning"),this.isCreditLine&&
a&&this._updateFinancialOfferCalculationStrings("Promo")):this._hideContainer("gilPromoWarning")},_gcAndPromoEventHandler:function(a){var b=this._getWarningMessageElement("gilMTWarningMessageGCAndPromoContainerGCTextId"),e=this._getWarningMessageElement("gilMTWarningMessageGCAndPromoContainerPromoTextId");this.gcAndPromoWarningRendered?(this._hasWarningMessageText(b)&&this._hasWarningMessageText(e)?this._showContainer("gilGCAndPromoWarning"):this._hideContainer("gilGCAndPromoWarning"),this.isCreditLine&&
a&&this._updateFinancialOfferCalculationStrings("GiftCardAndPromo")):this._hideContainer("gilGCAndPromoWarning")},_defaultMTEventHandler:function(a){!this.isCreditLine||this.gcWarningRendered||this.promoWarningRendered||this.gcAndPromoWarningRendered||!a||this._updateFinancialOfferCalculationStrings("Default")},_setMultiTenderWarningStates:function(a){"GC"===a.paymentMethod?a.isSelected?this.promoWarningRendered?(this.promoWarningRendered=this.gcWarningRendered=0,this.gcAndPromoWarningRendered=1):
this.gcWarningRendered=1:(this.gcWarningRendered=0,this.gcAndPromoWarningRendered&&(this.gcAndPromoWarningRendered=0,this.promoWarningRendered=1)):"PROMO"===a.paymentMethod&&(a.isSelected?this.gcWarningRendered?(this.promoWarningRendered=this.gcWarningRendered=0,this.gcAndPromoWarningRendered=1):this.promoWarningRendered=1:(this.promoWarningRendered=0,this.gcAndPromoWarningRendered&&(this.gcAndPromoWarningRendered=0,this.gcWarningRendered=1)))},_hasDiscountDetailsMessageText:function(a){return a&&
""!==a.textContent},_getFormattedDiscountAmount:function(){return this.gcAndPromoWarningRendered?this.multiTenderDiscountAmountMap.GiftCardAndPromo:this.gcWarningRendered?this.multiTenderDiscountAmountMap.GiftCard:this.promoWarningRendered?this.multiTenderDiscountAmountMap.Promo:this.multiTenderDiscountAmountMap.Default},_getDiscountTranslatedString:function(a){return this.isMobile?this._getTranslatedString(this.stringIdMap.discount_offer_message_mobile,a):this._getTranslatedString(this.stringIdMap.discount_offer_message_desktop,
a)},_discountOfferMessageHandler:function(){var a=d.document.getElementById(this._instrumentId+"-gilDiscountOfferTextId");if(this._hasDiscountDetailsMessageText(a)){var b=this._getFormattedDiscountAmount();b&&(a.textContent=this._getDiscountTranslatedString({discountAmount:b}))}},_balanceSelectionEventHandler:function(a){this.showMultiTenderWarning&&(this._setMultiTenderWarningStates(a),this.showGCWarning&&this._gcEventHandler(this.isUpdateFinancialOfferCalculationsEnabled),this.showGCAndPromoWarning&&
(this._promoEventHandler(this.isUpdateFinancialOfferCalculationsEnabled),this._gcAndPromoEventHandler(this.isUpdateFinancialOfferCalculationsEnabled)),this._defaultMTEventHandler(this.isUpdateFinancialOfferCalculationsEnabled));this._discountOfferMessageHandler()},_formatCurrency:function(a,b){var e=b||this.currencyUnit;switch(e){case "EUR":b=",";var c=".";break;default:b=".",c=","}a=e+" "+a.toString();return a=a.replace(".",b).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+c)},_getTranslatedString:function(a,
b){return this.widget.getLocalizedString(a,b)},_updateWarningText:function(a,b){(a=this._getWarningMessageElement(a))&&a.childNodes&&a.childNodes.length&&(a.removeChild(a.childNodes[0]),a.appendChild(d.document.createTextNode(b)))},_setGCWarningMessage:function(){var a=" ";this.amountOnOtherPaymentMethods<=this.gcAmount&&(a=this._getTranslatedString(this.stringIdMap.gift_card_info,{giftCardAmount:this._formatCurrency(this.amountOnOtherPaymentMethods)}));this._updateWarningText("gilMTWarningMessageGCTextId",
a);this._gcEventHandler(!1)},_setPromoWarningMessage:function(){var a=" ";this.amountOnOtherPaymentMethods<=this.promoAmount&&(a=this._getTranslatedString(this.stringIdMap.promo_info,{promoAmount:this._formatCurrency(this.amountOnOtherPaymentMethods)}));this._updateWarningText("gilMTWarningMessagePromoTextId",a);this._promoEventHandler(!1)},_setGCAndPromoWarningMessage:function(){var a=" ",b=" ";this.amountOnOtherPaymentMethods<=this.gcAmount+this.promoAmount&&(a=Math.round(100*(this.amountOnOtherPaymentMethods-
this.promoAmount))/100,b=0<a?this._getTranslatedString(this.stringIdMap.gift_card_info,{giftCardAmount:this._formatCurrency(a<=this.gcAmount?a:this.gcAmount)}):this._getTranslatedString(this.stringIdMap.gift_card_unavailable),a=this._getTranslatedString(this.stringIdMap.promo_info,{promoAmount:this._formatCurrency(this.amountOnOtherPaymentMethods<=this.promoAmount?this.amountOnOtherPaymentMethods:this.promoAmount)}));this._updateWarningText("gilMTWarningMessageGCAndPromoContainerPromoTextId",a);this._updateWarningText("gilMTWarningMessageGCAndPromoContainerGCTextId",
b);this._gcAndPromoEventHandler(!1)},_setMultiTenderWarningMessages:function(a){a=this.offerToAmountAllowedOnOtherPaymentMethodsMap[a];!this.isCreditLine||"undefined"!==typeof this.amountOnOtherPaymentMethods&&this.amountOnOtherPaymentMethods===a||(this.amountOnOtherPaymentMethods="undefined"===typeof a?Number.MAX_SAFE_INTEGER:a.value,this._setGCWarningMessage(),this._setPromoWarningMessage(),this._setGCAndPromoWarningMessage())},_gilOffersDropdownEventChangeHandler:function(a){this._setMultiTenderWarningMessages(a.value)},
bindToEvents:function(){k.bind(f.prototype.bindToEvents,this).apply();var a=this;this.widget.on("gilCheckIneligibleItemsInCartEvent",this,function(){l&&this.widget.trigger("gilIneligibleItemsInCartEvent",this.widget.getLocalizedString("apx_gil_cc_disabled_continue_button_hover_message"))});a.widget.on(c,a,function(b){a._instrumentRowSelected(b.instrumentId)});a.widget.on("balanceSelectionChanged",a,function(b){a._balanceSelectionEventHandler(b)});a.widget.on("gilOffersDropDownChangeEvent",a,function(b){a._gilOffersDropdownEventChangeHandler(b)});
r.when("A").execute(function(b){b.declarative("chooseGILInstallemntOfferButton","click",function(b){a._chooseGILInstallmentOfferButtonClick(b.$event)});if(a.showGCAndPromoWarningforCL)b.on("a:dropdown:selected:ppw-selectedFinancialOfferId",function(b){a.widget.trigger("gilOffersDropDownChangeEvent",b)})})}})});c("components/SelectableGILBAComponent",["form-component","jQuery","lang"],function(c,f,d){return c.extend({displayIneligibleItemsInMobile:function(c){this.widget.trigger("GILIneligibleSubPageEvent",
{subtype:"StandaloneInstallment",error:function(c,d,g){f("#gil-ineligible-subpage-StandaloneInstallment-error").show()}})},bindToElements:function(){f("#gil-ineligible-subpage-StandaloneInstallment").click(d.bind(this.displayIneligibleItemsInMobile,this))}})});c("components/SelectableGILCCComponent",["form-component","jQuery","lang"],function(c,f,d){return c.extend({displayIneligibleItemsInMobile:function(c){this.widget.trigger("GILIneligibleSubPageEvent",{subtype:"StandaloneCreditCardInstallment",
error:function(c,d,g){f("#gil-ineligible-subpage-StandaloneCreditCardInstallment-error").show()}})},bindToElements:function(){f("#gil-ineligible-subpage-StandaloneCreditCardInstallment").click(d.bind(this.displayIneligibleItemsInMobile,this))}})});c("components/SelectableGILCLComponent",["form-component","jQuery","lang"],function(c,d,n){return c.extend({displayIneligibleItemsInMobile:function(c){this.widget.trigger("GILIneligibleSubPageEvent",{subtype:"StandaloneReusableCreditLineInstallment",error:function(c,
f,g){d("#gil-ineligible-subpage-StandaloneReusableCreditLine-error").show()}})},bindToElements:function(){d("#gil-ineligible-subpage-StandaloneReusableCreditLine").click(n.bind(this.displayIneligibleItemsInMobile,this))}})})})()});
/* ******** */
(function(l){var h=window.AmazonUIPageJS||window.P,m=h._namespace||h.attributeErrors,d=m?m("APXWidgetsAssets@APXWidgets-FoodVoucherCard","APXWidgetsAssets"):h;d.guardFatal?d.guardFatal(l)(d,window):d.execute(function(){l(d,window)})})(function(l,h,m){(function(){var d=PaymentsPortal2.modules.define;d("components/AddFoodVoucherCardComponent","events/form-submitted-event form-component lang AUI!P jQuery cc-spacing".split(" "),function(d,f,g,a,b,c){var e=/^[0-9]+$/;return f.extend({initialize:function(a,
b){this.addCardNumberId=b.data.addCardNumber;this.addSubmitButtonId=b.data.addSubmitButton;this.placementType=b.data.placementType;this.$addCardNumberInput=this.getDOMElement(this.addCardNumberId);this.hasErrors=b.data.hasErrors;this.addModalId=b.data.addModalId;this.addModalName=b.data.addModalName;this.queryParams=b.data.queryParams;this.addFormContainer=b.data.addFormContainer;this.addFormId=b.data.addFormId;this.widgetAction=b.data.widgetAction;this.addEvent=b.data.addEvent;this.isDesktop="desktop"===
a.options.deviceType},initPopoverState:function(){!0===this.hasErrors&&(this.isDesktop?this.getDOMElement(this.addModalId).trigger("click"):this.widget.trigger("showAddPaymentInstrumentPage"))},handleAddCardLikeDOMEvent:function(a){if(0===this.form.validateForm().length){this.closeAddPopover();var b=this.getFormSubmissionParameters(this.addFormContainer);this.widget.trigger(d,{queryParameters:this.queryParams,submissionParameters:b,event:a,action:this.widgetAction});return!0}a.preventDefault();return!1},
closeAddPopover:function(){var b=this;a.when("a-modal").execute(function(a){a&&(a=a.get(b.addModalName))&&a.hide()})},creditCardNumberChanged:function(a){var b=a.replace(/\s/g,"");if(e.test(b)&&(8===b.length||16===b.length)){a=a.replace(/\s/g,"").substring(0,8);b=16-(a.length+1);for(var c=0;c<b;c++)a=a.concat(Math.floor(10*Math.random()));b=0;for(var k=a.length-1;0<=k;k--)c=parseInt(a.charAt(k),10),0===k%2&&(c*=2,c=9<c?c-9:c),b+=c;a=a.concat(10-b%10);this.widget.trigger("creditCardNumberChanged",
{creditCardNumber:a,placementType:this.placementType})}},bindToElements:function(){this.getDOMElement(this.addSubmitButtonId).click(g.bind(this.handleAddCardLikeDOMEvent,this))},bindToEvents:function(){var a=this,e,f;this.$addCardNumberInput.keydown(function(a){e=this.value;f=this.selectionStart});this.$addCardNumberInput.change(function(a){this.value=c.fixSpacing(this.value)});this.$addCardNumberInput.keyup(function(b){"number"!==this.type&&this.value!==e&&(b=this.selectionStart,this.value=c.fixSpacing(this.value),
b=c.fixCaret(b,this.value,e,f),this.setSelectionRange(b,b),a.creditCardNumberChanged(this.value))});a.widget.on("componentsInitialized",a,function(a){this.initPopoverState()});a.widget.on(d,this,function(c){if(c.action===a.data.widgetAction){c=a.getDOMElement(a.addFormId);var e=b("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:"+a.addEvent,value:"submit"});c.append(e);c.submit()}})}})});d("components/FoodVoucherCardInputAmountComponent",["css-utils","form-component","lang"],function(d,
f,g){return f.extend({initialize:function(a,b){this.instrumentId=b.data.instrumentId;this.inputAmountId=b.data.inputAmount;this.minSelectableAmount=b.data.minSelectableAmount;this.maxSelectableAmount=b.data.maxSelectableAmount;this.initialAmount=b.data.initialAmount;this.totalAmount=b.data.totalAmount;this.paymentMethodCode=b.data.paymentMethodCode;this.ineligibleAmount=this.remainingGcBalance=this.promoCodeAmount=this.giftCardAmount=0;this.isBacking=this.isCCSelected=this.isSelected=!1;this.currentMaxSelectableAmount=
this.maxSelectableAmount;this.inputAmount=this.getDOMElement(this.inputAmountId)},validationToErrorMap:{IsNumberFieldConstraint:"FailureInvalidInput",LessThanEqualFieldConstraint:"FailureGreaterThanMaxSelectable",GreaterThanEqualFieldConstraint:"FailureLessThanMinSelectable",CoverageCalculationFailedConstraint:"FailureBackingInstrumentIsRequired"},getErrorMessageContainer:function(){return this.getDOMElement("errorMessages")},resetFormErrorMessages:function(){var a=this;d.hideElement(a.getErrorMessageContainer());
g.forEachKeyValue(a.validationToErrorMap,function(b,c){a.form.resetErrorMessage(a.field,a.getDOMElement(c))},a)},displayFormErrorMessages:function(a){0!==a.length&&(a=a[0],a.field===this.inputAmountId&&(a=this.getDOMElement(this.validationToErrorMap[a.validation]),this.form.displayErrorMessage(this.inputAmountId,a)),d.showElement(this.getErrorMessageContainer()))},validateInputAmount:function(){if(this.getSelectedAmount()>this.currentMaxSelectableAmount){var a=this.widget.getLocalizedString("apx_food_voucher_error_gt_max_eligible",
{});return[{validation:"LessThanEqualFieldConstraint",field:this.inputAmountId,localizedMessageString:a,messageStringId:"apx_food_voucher_error_gt_max_eligible"}]}return this.getSelectedAmount()<this.currentMaxSelectableAmount&&!this.isCCSelected?(a=this.widget.getLocalizedString("apx_food_voucher_error_backing_instrument_is_required",{}),[{validation:"CoverageCalculationFailedConstraint",field:this.inputAmountId,localizedMessageString:a,messageStringId:"apx_food_voucher_error_backing_instrument_is_required"}]):
[]},performCoverageCalculation:function(){this.currentMaxSelectableAmount=this.promoCodeAmount+this.giftCardAmount>=this.maxSelectableAmount?0:this.maxSelectableAmount-this.promoCodeAmount-this.giftCardAmount;this.widget.trigger("FoodVoucherCardMaxSelectableChangedEvent",{instrumentId:this.instrumentId,currentMaxSelectableAmount:this.currentMaxSelectableAmount})},checkForErrors:function(){this.resetFormErrorMessages();var a=this.form.validateForm().concat(this.validateInputAmount());0<a.length&&this.displayFormErrorMessages(a);
return this.isSelected?a.map(function(a){return a.localizedMessageString}):[]},backingInstrumentSelected:function(a){this.isBacking=!0;this.widget.trigger("backingInstrumentSelected",{instrumentId:this.instrumentId,errors:a,paymentMethod:this.paymentMethodCode})},backingInstrumentDeselected:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:null,errors:a,paymentMethod:null})},optionalInstrumentSelected:function(a){this.isBacking=!1;a={instrumentId:this.instrumentId,errors:a,
paymentMethod:this.paymentMethodCode,balance:this.getSelectedAmount(),isBackingInstrument:this.isBacking};this.widget.trigger("optionalInstrumentSelected",a)},optionalInstrumentDeselected:function(a){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.instrumentId})},fvcRowSelected:function(a){this.giftCardAmount>=this.totalAmount&&(this.giftCardAmount=0,this.widget.trigger("deselectGiftCardCheckbox",{paymentMethod:this.paymentMethodCode}));this.promoCodeAmount>=this.totalAmount&&
(this.promoCodeAmount=0,this.widget.trigger("deselectPromoBalanceInstrument",{paymentMethod:this.paymentMethodCode}));this.performCoverageCalculation();this.inputAmount.val(this.currentMaxSelectableAmount.toFixed(2));a=this.checkForErrors();this.getSelectedAmount()+this.giftCardAmount+this.promoCodeAmount>=this.totalAmount&&this.isCCSelected?(this.widget.trigger("resetSelectedPaymentMethod",{}),this.isCCSelected=!1,this.backingInstrumentSelected(a)):this.isCCSelected?this.optionalInstrumentSelected(a):
this.backingInstrumentSelected(a)},fvcRowDeselected:function(a){!0===this.isBacking?this.backingInstrumentDeselected(null):this.optionalInstrumentDeselected(null);this.isBacking=!1},inputAmountChanged:function(a){this.isSelected&&(this.performCoverageCalculation(),this.updateFoodVoucherCardSelection(),a=this.checkForErrors(),!0===this.isBacking?this.backingInstrumentSelected(a):this.optionalInstrumentSelected(a))},ccRowClicked:function(a){this.performCoverageCalculation();a=this.checkForErrors();
this.isSelected&&this.optionalInstrumentSelected(a)},amazonBalanceRowClicked:function(a){this.performAmazonBalanceAndPromoCalculation(a);this.inputAmountChanged(a)},performAmazonBalanceAndPromoCalculation:function(a){var b=a.isSelected?parseFloat(a.balance):0;"GC"===a.paymentMethod&&(this.giftCardAmount=b);"PROMO"===a.paymentMethod&&(this.promoCodeAmount=b)},updateFoodVoucherCardSelection:function(){this.giftCardAmount>=this.maxSelectableAmount||this.promoCodeAmount>=this.maxSelectableAmount?(this.isSelected=
!1,this.widget.trigger("FoodVoucherCardDeselectedByBalanceEvent",{instrumentId:this.instrumentId,currentMaxSelectableAmount:0})):(this.isSelected=!0,this.widget.trigger("FoodVoucherCardEnabledByBalanceEvent",{instrumentId:this.instrumentId,currentMaxSelectableAmount:this.currentMaxSelectableAmount}))},getSelectedAmount:function(){var a=Number(this.inputAmount.val());return isNaN(a)?0:a},bindToElements:function(){this.inputAmount.bind("keyup change",g.bind(this.inputAmountChanged,this))},bindToEvents:function(){var a=
this;a.widget.on("FoodVoucherCardRowClickedEvent",a,function(b){a.instrumentId===b.instrumentId&&(a.isSelected=b.isSelected,!0===a.isSelected?a.fvcRowSelected(b):a.fvcRowDeselected(b))});a.widget.on("balanceSelectionChanged",a,function(b){a.amazonBalanceRowClicked(b)});a.widget.on("backingInstrumentSelected",a,function(a){"CC"===a.paymentMethod?(this.isCCSelected=!0,this.ccRowClicked(a)):this.isBacking||(this.isCCSelected=!1)})}})});d("components/SelectableFoodVoucherCardListComponent",["events/InstrumentRowSelectedEvent",
"form-component","lang","css-utils"],function(d,f,g,a){return f.extend({initialize:function(a,c){this.initialError=c.data.initialError;this.warningMessagesContainer=this.getDOMElement(c.data.warningMessagesContainer);this.warningMessagesAlert=this.getDOMElement(c.data.warningMessagesAlert);this.errorMessagesContainer=this.getDOMElement(c.data.errorMessagesContainer);this.errorMessagesAlert=this.getDOMElement(c.data.errorMessagesAlert);this.renderInitialErrorMessage()},hideContainers:function(){a.hideElement(this.warningMessagesContainer);
a.hideElement(this.errorMessagesContainer)},showWarningMessage:function(b){this.warningMessagesContainer[0].getElementsByClassName("a-alert-content")[0].textContent=b;a.showElement(this.warningMessagesContainer)},showErrorMessage:function(b){this.errorMessagesContainer[0].getElementsByClassName("a-alert-content")[0].textContent=b;a.showElement(this.errorMessagesContainer)},bindToElements:function(){},renderInitialErrorMessage:function(){if(this.initialError){var a=this.widget.getLocalizedString(this.initialError,
{});this.showErrorMessage(a)}},bindToEvents:function(){var a=this;this.widget.on(d,this,function(b){a.hideContainers();"PayAgent"!==b.paymentMethodCategory||this.initialError?a.renderInitialErrorMessage():(a.widget.trigger("FoodVoucherCardDeselectedByPayCodeEvent",{}),b=a.widget.getLocalizedString("apx_food_voucher_warning_disabled_by_paycode",{}),a.showWarningMessage(b))});this.widget.on("installmentOptionChanged",this,function(b){a.hideContainers();this.initialError?a.renderInitialErrorMessage():
(a.widget.trigger("FoodVoucherCardChangedByInstallmentsEvent",{isEnabled:!b.isInstallmentOfferSelected}),b.isInstallmentOfferSelected&&(b=a.widget.getLocalizedString("apx_food_voucher_warning_disabled_by_installments",{}),a.showWarningMessage(b)))})}})});d("components/SelectableFoodVoucherCardListItemComponent",["form-component","lang","jQuery","css-utils","clog"],function(d,f,g,a,b){return d.extend({initialize:function(b,e){this.instrumentId=e.data.instrumentId;this.currency=e.data.currency;this.isUsable=
e.data.isUsable;this.containerId=e.data.container;this.detailsContainerId=e.data.detailsContainer;this.firstRowContainerId=e.data.firstRowContainer;this.eligibleAmountMessageId=e.data.eligibleAmountMessage;this.checkBoxId=e.data.checkBox;this.container=this.getDOMElement(this.containerId);this.detailsContainer=this.getDOMElement(this.detailsContainerId);this.firstRowContainer=this.getDOMElement(this.firstRowContainerId);this.eligibleAmountMessage=this.getDOMElement(this.eligibleAmountMessageId);this.checkBox=
this.getDOMElement(this.checkBoxId);this.isSelected=this.isDisabled=!1;a.toggleElement(this.detailsContainer,!1);this.checkBox.prop("checked",!1)},doNothing:function(a){a.preventDefault();a.stopPropagation()},firstRowContainerClicked:function(a){!this.isDisabled&&this.isUsable&&(this.selectRowContainer(!this.isSelected),this.widget.trigger("FoodVoucherCardRowClickedEvent",{instrumentId:this.instrumentId,isSelected:this.isSelected}),this.widget.trigger("poaInstrumentRowSelected",{instrumentId:null}),
b.logCounterMetric({feature:"FoodVoucherCardRowClickedEvent",resource:"_Count"}))},selectRowContainer:function(a){this.isSelected=a;this.toggleElement()},toggleElement:function(){this.checkBox.prop("checked",this.isSelected);a.toggleElement(this.detailsContainer,this.isSelected);this.isSelected?this.container.addClass("pmts-selected"):this.container.removeClass("pmts-selected")},renderEligibleAmountMessage:function(a){a=this.currency+" "+a.toFixed(2);a=this.widget.getLocalizedString("apx_food_voucher_eligible_amount",
{eligible_amount:a});this.eligibleAmountMessage.text(a)},enableRowContainer:function(a){this.isUsable&&(this.isDisabled=!a,a?(this.container.removeClass("pmts-disabled-section"),this.checkBox.prop("disabled",!1)):(this.container.addClass("pmts-disabled-section"),this.checkBox.prop("disabled",!0)))},bindToElements:function(){this.firstRowContainer.click(f.bind(this.firstRowContainerClicked,this));this.checkBox.click(f.bind(this.firstRowContainerClicked,this));this.detailsContainer.click(f.bind(this.doNothing,
this))},bindToEvents:function(){var a=this;this.widget.on("FoodVoucherCardRowClickedEvent",this,function(b){b.instrumentId!==this.instrumentId&&!0===this.isSelected&&a.selectRowContainer(!1)});this.widget.on("FoodVoucherCardDeselectedByBalanceEvent",this,function(a){this.selectRowContainer(!1)});this.widget.on("FoodVoucherCardDeselectedByPayCodeEvent",this,function(a){this.selectRowContainer(!1)});this.widget.on("FoodVoucherCardEnabledByBalanceEvent",this,function(a){this.renderEligibleAmountMessage(a.currentMaxSelectableAmount)});
this.widget.on("FoodVoucherCardMaxSelectableChangedEvent",this,function(a){this.renderEligibleAmountMessage(a.currentMaxSelectableAmount)});this.widget.on("FoodVoucherCardChangedByInstallmentsEvent",this,function(a){this.enableRowContainer(a.isEnabled);a.isEnabled||this.selectRowContainer(!1)})}})})})()});
/* ******** */
(function(h){var g=window.AmazonUIPageJS||window.P,m=g._namespace||g.attributeErrors,c=m?m("APXWidgetsAssets@APXWidgets-BLIKDirect","APXWidgetsAssets"):g;c.guardFatal?c.guardFatal(h)(c,window):c.execute(function(){h(c,window)})})(function(h,g,m){(function(){var c=PaymentsPortal2.modules.define;c("components/BlikAuthenticateComponent","css-utils jQuery form-component lang AUI!P clog ExecutionsWidgetUtils AjaxUtil".split(" "),function(b,c,n,f,p,d,q,l){var k,g,h;return n.extend({initialize:function(a,
e){a=e.data.isBlikOneClick;this.dynamicContinueFormDescription=e.data.dynamicContinueFormDescription;this.isBlikOneClick=a;this.pollFundingSourceCounter=this.retries=0;a?(k=new Date((new Date).getTime()+9E4),this._pollForCollectApiStatus()):(b.hideElement(this.getDOMElement("BlikAuthenticateSpinner")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPExpired")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPInvalid")),b.hideElement(this.getDOMElement("add-blik-modal-trigger")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPValidationErrorMessage")),
b.hideElement(this.getDOMElement("CompleteTransactionInBlikAppMessage")),this._disableSubmitButton())},_handleFormSubmission:function(){if(this.getDOMElement("ConfirmBlikButton").hasClass("a-button-disabled"))event.preventDefault();else return this._publishMetric("BlikAuthenticateConfirmButtonClickedCount"),console.log("inside _handleFormSubmission. logging retires"+this.retries),0===this.form.validateForm().length&&(this._publishMetric("BlikAuthenticateFormSubmittedCount"),this.widget.trigger("blikAuthenticateFormSubmitted")),
!1},_showBlikPopoverModal:function(){var a=this;p.when("A","a-modal","ready").execute(function(e,d){a.getDOMElement("add-blik-modal-trigger").click()});this._disableSubmitButton();this.getDOMElement("BlikAuthenticateOTPInputBox").attr("disabled","disabled");b.showElement(this.getDOMElement("CompleteTransactionInBlikAppMessage"));g=(new Date).getTime()},_validateAllCharactersAreDigit:function(a){return/^\d+$/.test(a)},_disableSubmitButton:function(){this.getDOMElement("ConfirmBlikButton").attr("disabled",
"disabled");this.getDOMElement("ConfirmBlikButton").addClass("a-button-disabled")},_enableSubmitButton:function(){this.getDOMElement("ConfirmBlikButton").removeAttr("disabled");this.getDOMElement("ConfirmBlikButton").removeClass("a-button-disabled")},_handleInputEvent:function(a){var e=this.form.getFormValues().__sif_encrypted_stripe_blik_otp;6===e.length&&this._validateAllCharactersAreDigit(e)?(this._enableSubmitButton(),13===a.which&&this.getDOMElement("ConfirmBlikButton").click()):this._disableSubmitButton();
0===e.length||this._validateAllCharactersAreDigit(e)?(b.hideElement(this.getDOMElement("BlikAuthenticateOTPExpired")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPInvalid")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPValidationErrorMessage"))):b.showElement(this.getDOMElement("BlikAuthenticateOTPValidationErrorMessage"))},_pollForValidateOTPStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikValidateOtpEvent","ppw-__sif_encrypted_stripe_blik_otp":a.form.getFormValues().__sif_encrypted_stripe_blik_otp,
"ppw-widgetState":a.widget.options.serializedState},queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dStripe_Blik_SIF_Profile"),retryDelayFn:function(){return 9E3},isResponseExpectedFn:function(a){return a.fsStatus&&a.fsDetailedStatus},onSuccessFn:function(e){a._publishSuccessMetric("BlikAuthenticatePollForValidateOtpSuccessCount");a._handleValidateOTPFundingSourceStatus(e)},onErrorFn:function(){a._publishErrorMetric("BlikAuthenticatePollForValidateOtpErrorCount")},retryFailedFn:function(){a._publishMetric("BlikAuthenticatePollForValidateOtpRetriesExhaustedCount");
a.fireBlikAuthenticateCompleteEvent("BlikValidateOtpApiFailureEvent")},retryLimit:2})},_handleValidateOTPFundingSourceStatus:function(a){var e=a.fsStatus.toUpperCase();"PENDING"!==e&&b.hideElement(this.getDOMElement("BlikAuthenticateSpinner"));switch(e){case "APPROVED":this._publishMetric("BlikAuthenticateFundingSourceStatusApprovedCount");this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateApproveEvent");break;case "PENDING":this._handleValidateOTPFundingSourceDetailedStatus(a.fsDetailedStatus);
break;case "DECLINED":this._publishMetric("BlikAuthenticateFundingSourceStatusDeclinedCount");this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent");break;case "CANCELLED":this._publishMetric("BlikAuthenticateFundingSourceStatusCancelledCount");this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent");break;default:this._publishMetric("BlikAuthenticateFundingSourceStatus"+e),this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent")}},_handleValidateOTPFundingSourceDetailedStatus:function(a){"Accepted"!==
a&&b.hideElement(this.getDOMElement("BlikAuthenticateSpinner"));switch(a){case "Accepted":this._publishMetric("BlikAuthenticateAcceptedBlikOtpCount");h=(new Date).getTime();this._pollBlikValidateOTPFundingSourceDetailedStatus();break;case "ApprovedPendingVerification":this._publishMetric("BlikAuthenticateApprovedBlikOtpCount");this._showBlikPopoverModal();k=new Date((new Date).getTime()+9E4);console.log("Auth Expiry time: "+k);this._pollBlikFundingSourceStatus();break;case "OneTimePasswordInvalid":this._publishMetric("BlikAuthenticateInvalidBlikOtpCount");
b.showElement(this.getDOMElement("BlikAuthenticateOTPInvalid"));this.isEnterBlikOtpAttemptsExhausted();break;case "OneTimePasswordExpired":this._publishMetric("BlikAuthenticateExpiredBlikOtpCount");b.showElement(this.getDOMElement("BlikAuthenticateOTPExpired"));this.isEnterBlikOtpAttemptsExhausted();break;default:this._publishMetric("BlikAuthenticateUndefinedFsDetailedStatusCount"),this.isEnterBlikOtpAttemptsExhausted(),this.fireBlikAuthenticateCompleteEvent("BlikUndefinedFsDetailedStatusEvent")}},
_pollBlikValidateOTPFundingSourceDetailedStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikPollFundingSourceStatusEvent","ppw-widgetState":a.widget.options.serializedState},retryDelayFn:function(){return 1E3},isResponseExpectedFn:function(a){return a.fsStatus&&a.fsDetailedStatus&&"Accepted"!==a.fsDetailedStatus},onSuccessFn:function(e){a._publishSuccessMetric("BlikAuthenticatePollForFundingSourceDetailedStatusSuccessCount");a._publishLatencyMetric("BlikAuthenticatePollTimeForFundingSourceDetailedStatus"+
e.fsDetailedStatus,h);a._handleValidateOTPFundingSourceStatus(e)},onErrorFn:function(){a._publishErrorMetric("BlikAuthenticatePollForFundingSourceDetailedStatusErrorCount")},retryFailedFn:function(){a._publishMetric("BlikAuthenticatePollForFundingSourceDetailedStatusRetriesExhaustedCount");a.fireBlikAuthenticateCompleteEvent("BlikValidateOtpApiFailureEvent")},retryLimit:10})},_pollBlikFundingSourceStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikPollFundingSourceStatusEvent",
"ppw-widgetState":a.widget.options.serializedState},retryDelayFn:function(){return 1E3},isResponseExpectedFn:function(e){a.pollFundingSourceCounter++;console.log("pollFundingSourceCounter: "+a.pollFundingSourceCounter);return e.fsStatus&&"true"===e.fundingSourceInTerminalState},onSuccessFn:function(e){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForFundingSourceStatusSuccessCount","BlikOneClickAuthenticatePollForFundingSourceStatusSuccessCount",a._publishSuccessMetric);a._publishLatencyMetric("BlikWaitingForAuthenticationPopOverModalVisibleTime",
g);"APPROVED"===e.fsStatus.toUpperCase()?a.fireBlikAuthenticateCompleteEvent("BlikAuthenticateApproveEvent"):a.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent")},onErrorFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForFundingSourceStatusErrorCount","BlikOneClickAuthenticatePollForFundingSourceStatusErrorCount",a._publishErrorMetric)},retryFailedFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForFundingSourceRetriesExhaustedCount","BlikOneClickAuthenticatePollForFundingSourceRetriesExhaustedCount",
a._publishMetric);a._pollForCollectApiStatus()},retryLimit:10})},_pollForCollectApiStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikCollectEvent","ppw-widgetState":a.widget.options.serializedState,"ppw-timeForCustomerActionIsExpired":(new Date).getTime()>k.getTime()?"true":"false"},retryDelayFn:function(){return 1E3},isResponseExpectedFn:function(a){return a.collectApiSucceeded&&"true"===a.collectApiSucceeded},onSuccessFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForCollectApiSuccessCount",
"BlikOneClickAuthenticatePollForCollectApiSuccessCount",a._publishSuccessMetric);a._checkTransactionAuthorizationTLE()?a.fireBlikAuthenticateCompleteEvent("BlikTransactionAuthorizationTleEvent"):a._pollBlikFundingSourceStatus()},onErrorFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForCollectApiErrorCount","BlikOneClickAuthenticatePollForCollectApiErrorCount",a._publishErrorMetric)},retryFailedFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForCollectApiRetriesExhaustedCount",
"BlikOneClickAuthenticatePollForCollectApiRetriesExhaustedCount",a._publishMetric);a._checkTransactionAuthorizationTLE()?a.fireBlikAuthenticateCompleteEvent("BlikTransactionAuthorizationTleEvent"):a._pollBlikFundingSourceStatus()},retryLimit:1})},_checkTransactionAuthorizationTLE:function(){var a=(new Date(k.getTime()+6E4)).getTime();if(45<this.pollFundingSourceCounter)return this._publishMetric("BlikAuthenticatePollForFsCountLimitReachedCount"),console.log("poll fs count limit reached"),!0;if((new Date).getTime()>
a)return this._publishMetric("BlikAuthenticatePollForFsTimeLimitReachedCount"),console.log("poll fs time limit reached"),!0;console.log("continue polling");return!1},fireBlikAuthenticateCompleteEvent:function(a){q.dynamicContinueWithEvent(a,this.widget.options.serializedState,[],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},bindToElements:function(){var a=this;this.getDOMElement("ConfirmBlikButton").click(f.bind(this._handleFormSubmission,this));c(this.getDOMElement("BlikAuthenticateOTPInputBox")).bind("input keypress",
function(d){a._handleInputEvent(d)})},isEnterBlikOtpAttemptsExhausted:function(){3<=this.retries&&(this._publishMetric("BlikAuthenticateEnterBlikOtpAttemptsExhaustedCount"),this.fireBlikAuthenticateCompleteEvent("BlikValidateOtpMaxAttemptsExhaustedEvent"))},bindToEvents:function(){var a=this;a.widget.on("blikAuthenticateFormSubmitted",a,function(){a.retries++;a._publishMetric("BlikAuthenticateOTPAttemptCount."+a.retries);b.showElement(this.getDOMElement("BlikAuthenticateSpinner"));a._disableSubmitButton();
a._pollForValidateOTPStatus()})},_publishMetricForBlikPaymentMethod:function(a,d,b){b(this.isBlikOneClick?d:a)},_publishMetric:function(a){d.logCounterMetric({feature:a,resource:"_Count"});d.publishMetrics()},_publishSuccessMetric:function(a){d.logCounterMetric({feature:a,resource:"_SuccessCount"});d.publishMetrics()},_publishErrorMetric:function(a){d.logCounterMetric({feature:a,resource:"_ErrorCount"});d.publishMetrics()},_publishLatencyMetric:function(a,b){d.logLatencyMetric({feature:a,resource:"_Latency",
startTime:b});d.publishMetrics()}})});c("AjaxUtil",["jQuery","lang"],function(b,c){return{continueRequestWithPolling:function(b){this.widget=b.widget;this.inputData=b.inputData;this.onErrorFn=b.onErrorFn||c.NOOP;this.onSuccessFn=b.onSuccessFn||c.NOOP;this.isResponseExpectedFn=b.isResponseExpectedFn||function(){return!0};this.retryFailedFn=b.retryFailedFn||b.onErrorFn;this.retryLimit=isNaN(b.retryLimit)?15:b.retryLimit;this.retryDelayFn=b.retryDelayFn||function(){return 1E3};this.queryParameters=b.queryParameters;
this.continueRequest(0)},continueRequest:function(b){var f=this;f.widget.continueRequest(f.inputData,{headers:{"executions-widget-ajax-continue-attempt-count":b},retryDelayFn:f.retryDelayFn,queryParameters:f.queryParameters,success:function(c){var d=c.additionalWidgetResponseData.additionalData;if(f.isResponseExpectedFn(d))f.onSuccessFn(d);else b<f.retryLimit?g.setTimeout(function(){var d=c.additionalWidgetResponseData.additionalData.widgetState;d&&(f.inputData["ppw-widgetState"]=d);f.continueRequest(++b)},
f.retryDelayFn(b)):f.retryFailedFn(c)},error:f.onErrorFn})}}});c("components/AddBlikDirectComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(b,c,g,f,h){return g.extend({_hasErrors:!1,initialize:function(b,c){this._action=c.data.action;this._hasErrors=c.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("addBlikDirectPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBlikDirectSubmitButton").click(f.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var d=this;d.widget.on("componentsInitialized",d,function(b){this._initPopoverState()});d.widget.on(b,d,function(b){b.action===d._action&&c(d.getDOMElement("addBlikDirectForm")).submit()})},_handleFormSubmission:function(d){var c=this.form.validateForm(),f=this.getFormSubmissionParameters("addBlikDirectFormContainer");0===c.length?(this.widget.trigger(b,{event:d,submissionParameters:f,action:this._action}),this.closeAddBlikPopover()):d.preventDefault()},closeAddBlikPopover:function(){h.when("a-modal").execute(function(b){b&&
(b=b.get("addBlikDirectPopover"))&&b.hide()})}})});c("components/SelectableBlikDirectListComponent",["form-component"],function(b){return b});c("components/SelectableBlikDirectListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","jQuery"],function(b,c){return b.extend({bindToEvents:function(){var b=this;b.widget.on(c,b,function(c){b._instrumentRowSelected(c.instrumentId)})}})})})()});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-BusinessInvoicing","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,f){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableBusinessInvoicingListComponent",["form-component"],function(a){return a});a("components/SelectableBusinessInvoicingListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],
function(a){return a});a("components/BusinessInvoicingActivationWorkflowComponent",["modal-popover","component"],function(a,d){return d.extend({initialize:function(d,c){this.popover=new a(d,c,this)}})});a("components/SelectableBusinessInstantInvoicingListComponent",["form-component"],function(a){return a});a("components/SelectableBusinessInstantInvoicingListItemComponent","events/form-submitted-event css-utils jQuery form-component lang AUI!P clog modal-popover components/SelectableDPMInstrumentListItemComponent events/close-secure-container-event events/InstrumentRowSelectedEvent mixins/b2b-cross-wallet-mixin events/spinner-events".split(" "),
function(a,d,c,f,k,l,r,t,m,n,g,p,h){var q=["GC","JPPoints","ProductVoucher","PROMO"];return m.extend(p,{initialize:function(b,e){this._isPaymentMethodActivationConsentRequiredViolationAvailable=e.data.isPaymentMethodActivationConsentRequiredViolationAvailable},bindToEvents:function(){var b=this;if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(g,{instrumentId:this._instrumentId})});this.widget.on("poaInstrumentRowSelected",this,function(b){this._instrumentRowSelected(b.instrumentId)});
this.widget.on(g,this,function(b){this._instrumentRowSelected(b.instrumentId)});this.widget.on("submitFormAjaxCompleted",this,function(a){b._isPaymentMethodActivationConsentRequiredViolationAvailable&&(b.widget.trigger(h.showSpinner),b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState},{success:b.widget.createAjaxContinueSuccessHandler(),complete:function(){b.widget.trigger(h.hideSpinner)}}))});b.widget.on("balanceSelectionChanged",this,function(a){var e=!1!==a.isInstrumentOwned,
c=!1!==this._getIsOwned();!0===b._isB2BCrossWalletMultitenderEnforcementEnabled?!0===b.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",a)&&b._updateBackingInstrumentState():this._isABCrossCustomerMultiTenderSuppressionEnabled&&0<=k.indexOf(q,a.paymentMethod)&&c!==e&&!a.isBackingInstrument&&a.isSelected&&this._updateBackingInstrumentState()})},bindToElements:function(){var b=this,a=b.getDOMElement("addInstantInvoicingButton");1===a.length&&a.click(function(a){if(0===b.form.validateForm().length){var d=
b.getFormSubmissionParameters("addInstantInvoicingFormContainer"),e=c("\x3cform\x3e").attr({action:"?sif_profile\x3dThebesAccountService"});c.each(d,function(a,b){a="phone_number"===b.name?"+1"+b.value.replace(/(\+1)?[^\d\\+]/g,""):b.value;e.append(c("\x3cinput\x3e").attr({name:b.name,value:a}))});a.preventDefault();b.widget.submitFormAJAX(e);b.closeAddInstantInvoicingPopOverPopover()}else a.preventDefault()});b.getDOMElementsByPrefix("POAInstrumentContainer").click(function(a){c(a.currentTarget).data("disabled")||
b.poaInstrumentClicked(b._instrumentId)});b.widget.on("initializeRecommendedInstrument",b,function(a){a.instrumentId===b._instrumentId&&(b.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||b._poaInstrumentSelected())});a=this.getDOMElement("cancelAddInstantInvoicingButton");1===a.length&&a.click(function(){b.closeAddInstantInvoicingPopOverPopover({force:!0});b.widget.publishSuccessSushiMetrics({ActionType:"CancelAddInstantInvoicePopup",ActionValueType:"Click",ActionValue:"CancelButtonClicked",
ActionParentValueType:"PurchaseDocument",ActionParentValue:b._purchaseId})})},closeAddInstantInvoicingPopOverPopover:function(a){this.widget.trigger(n,a);this.form.resetErrors();l.when("a-modal").execute(function(a){a&&(a=a.get("pbi2"))&&a.hide()})}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-ShowAllPaymentOptions","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ShowAllPaymentOptionsComponent",["component","public-event-registry","clog"],function(a,c,b){return a.extend({initialize:function(){c.register("ShowAllPaymentOptionsEvent")},_getContainerElement:function(){return this.getDOMElement("ShowAllPaymentOptionsComponent")},
bindToElements:function(){var a=this;a._getContainerElement().click(function(){b.logCounterMetric({feature:"ShowAllPaymentOptionsClicked",resource:"_Count"});b.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"ShowAllPaymentOptionsClicked",ActionValueType:"PaymentOptions",ActionValue:"ShowAllPaymentOptionsClickedEvent"});a.widget.trigger("ShowAllPaymentOptionsEvent")})}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Ideal","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/IdealDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=
b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/IdealEditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/IdealSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PaymentArt","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PaymentArtComponent",["component","jQuery","AUI!P"],function(a,c,b){return a.extend({initialize:function(a,b){this.shouldDownloadImageAfterPageLoad=b.data.shouldDownloadImageAfterPageLoad;this.paymentArtImageElement=
this.getDOMElement("paymentArtImageReference")},bindToEvents:function(){this.shouldDownloadImageAfterPageLoad&&this.downloadImageAfterPageLoad()},downloadImageAfterPageLoad:function(){var a=this;b.when("A","jQuery","load").execute("manual-load-image",function(b){b.loadHiResImage(a.paymentArtImageElement)})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BusinessPaymentProducts","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/AddBusinessCardAdvertisementComponent",["component","lang"],function(a,b){return a.extend({})})})()});
/* ******** */
(function(h){var g=window.AmazonUIPageJS||window.P,f=g._namespace||g.attributeErrors,e=f?f("APXWidgetsAssets@APXWidgets-AmazonPayEMI","APXWidgetsAssets"):g;e.guardFatal?e.guardFatal(h)(e,window):e.execute(function(){h(e,window)})})(function(h,g,f){(function(){var e=PaymentsPortal2.modules.define;e("components/AmazonPayEMIComponent","component jQuery lang css-utils events/InstrumentRowSelectedEvent public-event-registry continuable AUI!P".split(" "),function(e,g,h,d,k,m,n,l){return e.extend(n,{isAPBWithEMIEnabled:!1,
installmentOfferBOsWithoutAPB:[],installmentOfferBOsWithAPB:[],isPaylastEligible:!1,isAmazonPayEMIDisabled:!1,isPayLaterAvailable:!1,showFloatingContinueBarOnNonPaylastPSP:!1,isPayLaterDisabledForSIRedirection:!1,isNCEPromtionForAPLOneMonthTenureWeblabEnabled:!1,isAPLPreselectedInTurbo:!1,strategyBasedRecommendationWeblabTreatment:"C",initialize:function(a,b){this.currentInstrumentId=b.data.instrumentId;this.isNomenclatureWave2Enabled=b.data.isNomenclatureWave2Enabled;this.aplPaymentMethodCategory=
b.data.aplPaymentMethodCategory;this.availableAPLBalance=b.data.availableBalance;this.isAmazonPayEMIDisplayable=b.data.isDisplayable;this.isAmazonPayEMIDisabled=b.data.isDisabled;this.strategyBasedRecommendationWeblabTreatment=b.data.strategyBasedRecommendationWeblabTreatment;this.isAmazonPayEMIDisabled&&this._disableAmazonPayEMIOption();this.isPayLaterDisabledForSIRedirection=b.data.isPayLaterDisabledForSIRedirection;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;(this.isPayLaterAvailable=b.data.isPayLaterAvailable)&&
m.register(k);this.installmentOfferBOsWithoutAPB=b.data.installmentOfferBOsWithoutAPB;this.installmentOfferBOsWithAPB=b.data.installmentOfferBOsWithAPB;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this._hideAmazonPayEMINoCostEMIAvailableWrapper();this.isBuyNowPayLaterSlotEnabledForDesktop=b.data.isBuyNowPayLaterSlotEnabledForDesktop;this.isNCEPromtionForAPLOneMonthTenureWeblabEnabled=b.data.isNCEPromtionForAPLOneMonthTenureWeblabEnabled;
this.isAPLPreselectedInTurbo=b.data.isAPLPreselectedInTurbo;this.isInlineEMIPlanChangeMessageExperienceEnabled=b.data.isInlineEMIPlanChangeMessageExperienceEnabled;"T1"!==this.strategyBasedRecommendationWeblabTreatment&&"T2"!==this.strategyBasedRecommendationWeblabTreatment&&"T3"!==this.strategyBasedRecommendationWeblabTreatment||this._onInstrumentDeselected()},_isAmazonPayBalanceSelected:function(){return this.widget.get("apbCheckboxSelected")},_isAmazonPayEmiAvailable:function(){return this._isAmazonPayBalanceSelected()&&
this.isAPBWithEMIEnabled&&0!==this.installmentOfferBOsWithAPB.length?!0:this._isAmazonPayBalanceSelected()||0===this.installmentOfferBOsWithoutAPB.length?!1:!0},_getAmazonPayEMIContainer:function(){return this.getDOMElementsByPrefix("amazonPayEMIContainer")},_getInstrumentSelectionInputElement:function(){return this.getDOMElement("instrumentRowSelection-"+this.currentInstrumentId)},_showEMIMessageForTurbo:function(){var a=this.getDOMElement("emiHelpStringRowTurbo");a!==f&&d.showElement(a)},_hideEMIMessageForTurbo:function(){var a=
this.getDOMElement("emiHelpStringRowTurbo");a!==f&&d.hideElement(a)},_getAmazonPayEMITitleSlotJSBinding:function(){return this.getDOMElement("aplTitleSlot")},_getAmazonPayEMIIconSlotJSBinding:function(){return this.getDOMElement("aplIconSlot")},_getAmazonPayRadioButtonJSBinding:function(){return this.getDOMElement("aplRadioButton")},_onInstrumentSelected:function(){this._getAmazonPayEMIContainer().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this.isNomenclatureWave2Enabled&&
this._getAmazonPayEMITitleSlotJSBinding().addClass("pmts-payment-method-title-slot");(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();this._showEMIMessageForTurbo()},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_onInstrumentDeselected:function(){this.isNomenclatureWave2Enabled&&this._getAmazonPayEMITitleSlotJSBinding().removeClass("pmts-payment-method-title-slot");
this._getAmazonPayEMIContainer().removeClass("pmts-selected");this._hideEMIMessageForTurbo();this.hideEMIMessage();this._hideAmazonPayEMILimitUpdateConsentMessage()},_amazonPayEMIOptionClicked:function(a){this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled||this.widget.trigger(k,{instrumentId:this.currentInstrumentId})},_showAmazonPayEMIDisabledWrapper:function(){d.showElement(this.getDOMElement("amazonCreditUnavailableMessage"))},_showAmazonPayEMIDropdownWrapper:function(a){d.showElement(this.getDOMElement("amazonPayEMIDropdown"))},
_hideAmazonPayEMIDisabledWrapper:function(){d.hideElement(this.getDOMElement("amazonCreditUnavailableMessage"))},_hideAmazonPayEMIDropdownWrapper:function(a){d.hideElement(this.getDOMElement("amazonPayEMIDropdown"))},_showAmazonPayEMINoCostEMIAvailableWrapper:function(){d.showElement(this.getDOMElement("noCostEMIStringRow"))},_hideAmazonPayEMINoCostEMIAvailableWrapper:function(){d.hideElement(this.getDOMElement("noCostEMIStringRow"))},_showAmazonPayEMILimitUpdateConsentMessage:function(){d.showElement(this.getDOMElement("amazonpayEMILimitUpdateConsentMessage"))},
_hideAmazonPayEMILimitUpdateConsentMessage:function(){d.hideElement(this.getDOMElement("amazonpayEMILimitUpdateConsentMessage"))},_getAmazonPayEMIInstallmentHiddenInput:function(a){return this.getDOMElement("amazonPayEMISelectionHiddenInput-"+a).add(this.getDOMElement("amazonPayEMISelectionHiddenInput-"))},_getPrimaryViewButtonDisplay:function(a){return this.getDOMElement("amazonPayEMIOfferButtonText-"+a).add(this.getDOMElement("amazonPayEMIOfferButtonText-"))},_getAmazonPayEMIInstallmentTouchLink:function(a){return this.getDOMElement("amazonPayEMIMobileTouchLink-"+
a).add(this.getDOMElement("amazonPayEMIMobileTouchLink-"))},_triggerBackingInstrumentSelectedEvent:function(a,b){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,paystationPaymentMethodCategory:this.aplPaymentMethodCategory,availableAPLBalance:this.availableAPLBalance,installmentOfferBOsWithoutAPB:this.installmentOfferBOsWithoutAPB,errors:b})},closeAmazonPayEMIInstallmentsSecondaryPopover:function(a){l.when("a-secondary-view").execute(function(b){b&&(b=b.get("amazonPayEMISecondaryPopover-"+
a))&&b.hide()});this._triggerBackingInstrumentSelectedEvent(this.currentInstrumentId,null)},_updateInstallmentOptionsAccordionStateToLastSelectedInstallment:function(a){a=this.currentInstrumentId;var b=this._getAmazonPayEMIInstallmentHiddenInput(a)[0].value;g("[data-a-accordion-name\x3d'installmentOptionsAccordion-"+a+"'] [data-a-accordion-row-name\x3d'"+("installmentOptionAccordionRow-"+a+b)+"'] a").click()},_chooseInstallmentButtonClick:function(a,b,c){b=this.currentInstrumentId;c=g(a.currentTarget);
a=c.find("input");c=c.find(".a-section").html();var d=a.data("instrumentid").toString();b===d&&(this._displaySelectedInstallmentPlan(a,c),this.displayEMIMessage())},getSelectedInstallmentOfferBO:function(a,b){var c=null;a&&(c=a.filter(function(a){return a.financialOfferId===b})[0]);return c},getEligibleInstallmentOfferBOs:function(){return this._isAmazonPayBalanceSelected()?this.installmentOfferBOsWithAPB:this.installmentOfferBOsWithoutAPB},_displaySelectedInstallmentPlan:function(a,b){var c=this.currentInstrumentId,
d=a.data("instrumentid").toString();if(c===d){this._getAmazonPayEMIInstallmentHiddenInput(c).val(a.data("financialofferid"));this._getPrimaryViewButtonDisplay(c).html(b);if(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)""!==a.data("financialofferid")?this.triggerEventToUpdateOrderTotalForNCEDiscount(a.data().financialofferid):this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0,instrumentId:this.currentInstrumentId});this.isBuyNowPayLaterSlotEnabledForDesktop&&
this.widget.trigger("installmentPlanSelectedForDesktop",{instrumentId:c,displayHtml:b});this.isAPBWithEMIEnabled&&this.widget.trigger("installmentPlanChanged",{instrumentId:c,displayHtml:b,installmentPlanId:a.data("financialofferid")});a=c.split(".").join("-");this.installmentSelected=!0;this._hideAmazonPayEMINoCostEMIAvailableWrapper();this.closeAmazonPayEMIInstallmentsSecondaryPopover(a)}},_getAmazonPayEMIAvailableLimit:function(){return this.getDOMElement("amazonpayEMIAvailableLimit")},_isInstrumentSelected:function(){return this._getAmazonPayEMIContainer().hasClass("pmts-selected")},
_getAmazonPayEMIHeading:function(){return this.getDOMElement("amazonPayEMIHeading")},_toggleAmazonPayEMIOption:function(a){this.isAPBWithEMIEnabled||0!==this.installmentOfferBOsWithoutAPB.length&&!this._isAmazonPayBalanceSelected()||this._disableAmazonPayEMIOption();if(!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled)this._hideAmazonPayEMIDisabledWrapper(),this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this._getAmazonPayEMIHeading().removeClass("pmts-disabled-section"),this._getAmazonPayEMIAvailableLimit().removeClass("pmts-disabled-section"),
this.isNomenclatureWave2Enabled&&(this._getAmazonPayEMIIconSlotJSBinding().removeClass("pmts-disabled-section"),this._getAmazonPayEMITitleSlotJSBinding().removeClass("pmts-disabled-section"),this._getAmazonPayRadioButtonJSBinding().removeClass("pmts-disabled-section")),this._getInstrumentSelectionInputElement().prop("disabled",!1);this._isInstrumentSelected()&&!this._isAmazonPayEmiAvailable()&&(this._onInstrumentDeselected(),this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(k,
{}),this.setContinuable(!1),this.widget.trigger("PaymentPlanSelected",{isValid:!1}));this.isAPBWithEMIEnabled&&this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithAPB.length?this._disableAmazonPayEMIOption():this._isAmazonPayBalanceSelected()||0!==this.installmentOfferBOsWithoutAPB.length||this._disableAmazonPayEMIOption();this.isPayLaterDisabledForSIRedirection&&this._disableAmazonPayEMIOption()},_disableAmazonPayEMIOption:function(){this.isPayLaterDisabledForSIRedirection?this._hideAmazonPayEMIDisabledWrapper():
this._showAmazonPayEMIDisabledWrapper();this._hideAmazonPayEMIDropdownWrapper();this._hideAmazonPayEMINoCostEMIAvailableWrapper();this._getAmazonPayEMIHeading().addClass("pmts-disabled-section");this._getAmazonPayEMIAvailableLimit().addClass("pmts-disabled-section");this.isNomenclatureWave2Enabled&&(this._getAmazonPayEMIIconSlotJSBinding().addClass("pmts-disabled-section"),this._getAmazonPayRadioButtonJSBinding().addClass("pmts-disabled-section"),this._getAmazonPayEMITitleSlotJSBinding().addClass("pmts-disabled-section"));
this._getInstrumentSelectionInputElement().prop("disabled",!0);this.hideEMIMessage();this._hideAmazonPayEMILimitUpdateConsentMessage()},_enableAmazonPayEMIOption:function(){this._onInstrumentSelected();this.isOnlyOneMonthTenurePresent()?this._hideAmazonPayEMIDropdownWrapper():this._showAmazonPayEMIDropdownWrapper();this._hideAmazonPayEMINoCostEMIAvailableWrapper();this.displayEMIMessage();this.installmentSelected=!0;this._hideAmazonPayEMIDisabledWrapper();this.installmentSelected&&(this._triggerBackingInstrumentSelectedEvent(this.currentInstrumentId,
null),this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this.triggerEventToUpdateKFSInfo());this._showAmazonPayEMILimitUpdateConsentMessage()},isOnlyOneMonthTenurePresent:function(){return this._isAmazonPayBalanceSelected()&&1===this.installmentOfferBOsWithAPB.length&&1===this.installmentOfferBOsWithAPB[0].numberOfInstallments||!this._isAmazonPayBalanceSelected()&&1===this.installmentOfferBOsWithoutAPB.length&&1===this.installmentOfferBOsWithoutAPB[0].numberOfInstallments},hasNoCostEMIInstallmentsExcludingOneMonthPlan:function(a){return a.filter(function(a){return 1!==
a.numberOfInstallments&&a.maybeOfferDiscountAmount&&0<a.maybeOfferDiscountAmount.value})[0]},isNCEPlan:function(a){return 1===a.numberOfInstallments&&a.maybeOfferDiscountAmount&&0<a.maybeOfferDiscountAmount.value},getInstallmentStartMonth:function(a){return("undefined"!==typeof a.maybeInstallmentStartTime.year&&null!==a.maybeInstallmentStartTime.year?new Date(a.maybeInstallmentStartTime.year,a.maybeInstallmentStartTime.monthValue-1,a.maybeInstallmentStartTime.dayOfMonth):new Date(1E3*a.maybeInstallmentStartTime)).toLocaleString("default",
{month:"short"})},getOneMonthDisplayString:function(a){var b="";null!==a.maybeInstallmentStartTime&&(b={month:this.getInstallmentStartMonth(a)},b=this.isNCEPromtionForAPLOneMonthTenureWeblabEnabled&&this.isNCEPlan(a)?this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected_nocost",b):this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected",b));return b},displayEMIMessage:function(){var a=this._getAmazonPayEMIInstallmentHiddenInput(this.currentInstrumentId);
if(a[0]!==f){var b=a[0].value;a="";var c=this.getEligibleInstallmentOfferBOs();if(b=this.getSelectedInstallmentOfferBO(c,b))1===b.numberOfInstallments?a=1<c.length&&this.hasNoCostEMIInstallmentsExcludingOneMonthPlan(c)!==f?this.widget.getLocalizedString("apx_amazon_pay_emi_nocostemi_available"):1<c.length?this.widget.getLocalizedString("apx_amazon_pay_later_emi_available"):1===c.length?this.getOneMonthDisplayString(b):"":null!==b.maybeInstallmentStartTime?(a={month:this.getInstallmentStartMonth(b)},
a=this.widget.getLocalizedString("apx_amazon_pay_later_emi_starts_from",a)):a="";""!==a&&this.showEMIMessage(a)}},showEMIMessage:function(a){var b=this.getDOMElement("emiHelpStringRow");this.getDOMElement("emiHelpMessage").html(a);d.showElement(b)},hideEMIMessage:function(){d.hideElement(this.getDOMElement("emiHelpStringRow"))},triggerEventToUpdateOrderTotalForNCEDiscount:function(a){var b=this.getEligibleInstallmentOfferBOs();if(a=this.getSelectedInstallmentOfferBO(b,a))(a=a.maybeOfferDiscountAmount)&&
0<a.value?this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:Math.round(a.value)}):this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},triggerEventToUpdateKFSInfo:function(){var a=this._getAmazonPayEMIInstallmentHiddenInput(this.currentInstrumentId);a[0]!==f&&this.widget.trigger("updateKfsInfo",{instrumentId:this.currentInstrumentId,installmentPlanId:a[0].value})},bindToEvents:function(){var a=this;this.getDOMElementsByPrefix("amazonPayEMIContainer").click(h.bind(this._amazonPayEMIOptionClicked,
this));a.widget.on(k,this,function(a){if(a.instrumentId!==this.currentInstrumentId||this.isAmazonPayEMIDisabled||this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled){if(this._onInstrumentDeselected(),this._hideAmazonPayEMIDropdownWrapper(),!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled)this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this.isAPBWithEMIEnabled&&this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithAPB.length?this._hideAmazonPayEMINoCostEMIAvailableWrapper():
this.isAPBWithEMIEnabled&&!this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithoutAPB.length&&this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this.isAmazonPayEMIDisabled&&this._disableAmazonPayEMIOption()}else this.isAPBWithEMIEnabled?(this._isAmazonPayBalanceSelected()&&0<this.installmentOfferBOsWithAPB.length&&this._enableAmazonPayEMIOption(),!this._isAmazonPayBalanceSelected()&&0<this.installmentOfferBOsWithoutAPB.length&&this._enableAmazonPayEMIOption()):this._enableAmazonPayEMIOption()});
if(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)a.widget.on("GetNoCostEMISelectionDiscountValue",a,function(b){b.instrumentId===a.currentInstrumentId&&(b=this._getCreditCardInstallmentMobileHiddenInput(b.instrumentId))&&0<b.length&&this.triggerEventToUpdateOrderTotalForNCEDiscount(b[0].value)});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.currentInstrumentId&&(b=this._getAmazonPayEMIContainer(),0<b.length&&b.click())});a.widget.on("apbSelectionChanged",
a,function(b){this.hideEMIMessage();this.isAmazonPayEMIDisplayable&&(this.isAPBWithEMIEnabled&&this._isInstrumentSelected()?(this._onInstrumentDeselected(),this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(k,{}),this.setContinuable(!1),a.isInlineEMIPlanChangeMessageExperienceEnabled||this.widget.trigger("PaymentPlanSelected",{isValid:!1}),this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithAPB.length?b=a.widget.getLocalizedString("apx_amazon_pay_later_deselect_apb_to_use_pay_later_message"):
this._isAmazonPayBalanceSelected()||0!==this.installmentOfferBOsWithoutAPB.length?(b=a.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"),this.triggerEventToUpdateKFSInfo()):b=a.widget.getLocalizedString("apx_amazon_pay_later_select_apb_to_use_pay_later_message"),this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:b}),a.isInlineEMIPlanChangeMessageExperienceEnabled&&this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:a.widget.getLocalizedString("apx_select_payment_method_to_continue")})):
this._toggleAmazonPayEMIOption(b))});a.widget.on("updatePrimaryButtonDisplayString",this,function(a){if(this.currentInstrumentId===a.instrumentId){var b=this._getPrimaryViewButtonDisplay(this.currentInstrumentId),d=this._getAmazonPayEMIInstallmentHiddenInput(a.instrumentId);""===a.displayString&&(a.displayString=this.widget.getLocalizedString("apx_amazon_pay_emi_sec_view_default_text"));b.html(a.displayString);d.val(a.installmentPlanId)}});l.when("A","a-modal").execute(function(b,c){b.on("a:popover:afterHide:amazonPayEMISecondaryPopover-"+
this.currentInstrumentId,function(a){this._updateInstallmentOptionsAccordionStateToLastSelectedInstallment(a)});b.declarative("chooseInstallmentButton","click",function(d){a._chooseInstallmentButtonClick(d.$event,b,c)})})}})})})()});
/* ******** */
(function(k){var f=window.AmazonUIPageJS||window.P,l=f._namespace||f.attributeErrors,d=l?l("APXWidgetsAssets@APXWidgets-PayWithCash","APXWidgetsAssets"):f;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,f,l){(function(){var d=PaymentsPortal2.modules.define;d("components/SelectablePayWithCashListComponent","events/InstrumentRowSelectedEvent css-utils component AUI!P jQuery clog".split(" "),function(n,d,f,h,e,g){return f.extend({initialize:function(a,b){this.isNTAExperience=
b.data.isNTAExperience;this.currentInstrumentId=b.data.currentInstrumentId;this.selectedInstrumentId=b.data.selectedInstrumentId;this.optionExperimentTreatment=b.data.optionExperimentTreatment||"C";this._isMobile="mobile"===a.options.deviceType;this.paywithcashPopoverId="select-pay-with-cash-options-popover-"+b.data.popOverId;this.isPayOnPickupEnabled=b.data.isPayOnPickupEnabled},bindToElements:function(){var a=this;h.when("A","a-modal","ready").execute(function(b){b.on("a:popover:beforeShow:"+a.paywithcashPopoverId,
function(c){c.popover&&(a.paywithcashPopover=c.popover.$popover,a._isMobile&&a.paywithcashPopover.addClass("pay-with-cash-option-pop-over"));a.getDOMElement("select-pay-with-cash-option-continue-button").click(function(c){a.handleOptionSelectionContinueButtonEvent(c)});a.getDOMElementsByPrefix("pay-with-cash-option").change(function(c){a.disableEnableOptionsContinueButton(!1)})});b.on("a:popover:beforeHide:"+a.paywithcashPopoverId,function(c){c.popover&&(a.paywithcashPopover=c.popover.$popover,a._isMobile&&
a.paywithcashPopover.removeClass("pay-with-cash-option-pop-over"));a.paywithcashPopover=null})})},handleOptionSelectionContinueButtonEvent:function(a){var b=this;a.preventDefault();a.stopImmediatePropagation();b.getDOMElement("select-pay-with-cash-option-continue-button").hasClass("a-button-disabled")||(h.when("a-modal").execute(function(a){b.paywithcashPopover&&((a=e(b.paywithcashPopover.find("[data-action]\x3da-popover-close")[0]))&&a.trigger("click"),b.paywithcashPopover=null)}),this.getDOMElementsByPrefix("pay-with-cash-option").find("input").each(function(a,
m){m.checked&&(b.currentInstrumentId=m.value,b.selectedInstrumentId=m.value,b.isNTAExperience?(b.isNTAExperience=!1,b.widget.trigger("PayWithCashSetReturnCustomer",b.currentInstrumentId)):b.triggerSelectedOptionEvent(!1))}))},triggerSelectedOptionEvent:function(a){!this.isNTAExperience&&this.currentInstrumentId&&(this.widget.trigger("payWithCashOptionSelected",this.currentInstrumentId,a),d.showElement(this.getDOMElement("psp-pay-with-cash-list-container")));this.isNTAExperience?d.showElement(this.getDOMElement("psp-pay-with-cash-nta-experience")):
d.hideElement(this.getDOMElement("psp-pay-with-cash-nta-experience"))},disableEnableOptionsContinueButton:function(a){this.getDOMElementsByPrefix("select-pay-with-cash-option-continue-button").toggleClass("a-button-disabled",!!a)},bindToEvents:function(){var a=this;this.widget.on("payWithCashShowOptions",this,function(b){a.disableEnableOptionsContinueButton(!0);a.getDOMElementsByPrefix("pay-with-cash-option").find("input").each(function(c,b){b.value!==a.selectedInstrumentId||b.hasAttribute("disabled")||
(b.checked=!0,a.disableEnableOptionsContinueButton(!1))});a.optionViewInstance?a.optionViewInstance.show():a.getDOMElement("select-pay-with-option-trigger").click();g.logCounterMetric({feature:"PayWithCashOptionsClicked",resource:"_Count"});this.widget.publishSuccessSushiMetrics({ActionType:"PayWithCashOptionsClicked",ActionValueType:"isPayOnPickupEnabled",ActionValue:(a.isPayOnPickupEnabled||!1).toString(),ActionParentValueType:"PurchaseDocument",ActionParentValue:b});this.widget.publishSuccessSushiMetrics({ActionType:"PayWithCashOptionsClicked",
ActionValueType:"optionExperimentTreatment",ActionValue:a.optionExperimentTreatment,ActionParentValueType:"PurchaseDocument",ActionParentValue:b});g.publishMetrics()});this.widget.on("PayWithCashSetReturnCustomerUpdated",this,function(b){this.currentInstrumentId=b;a.triggerSelectedOptionEvent(!1)});this.widget.on("componentsInitialized",this,function(){a.triggerSelectedOptionEvent(!0)})}})});d("components/SelectablePayWithCashListItemComponent","components/SelectableDPMInstrumentListItemComponent events/InstrumentRowSelectedEvent modal-popover css-utils clog lang".split(" "),
function(d,f,k,h,e,g){return d.extend({initialize:function(a,b){this.isCashOptionSelected=b.data.isCashOptionSelected;this.paymentMethod=b.data.paymentMethod;this._purchaseId=b.data.purchaseId;this.isOptionWindowEnabled=b.data.isOptionWindowEnabled},bindToElements:function(){var a=this;a.getDOMElement("pay-with-cash-option-selection-link").click(function(b){b.preventDefault();b.stopImmediatePropagation();a.openOptionsWindow()});d.prototype.bindToElements.apply(this)},bindToEvents:function(){var a=
this;this.widget.on("payWithCashOptionSelected",this,function(b,c){a.showHideCurrentInstrument(a._instrumentId===b);if((!c||a.isCashOptionSelected)&&a._instrumentId===b){try{a.isCashOptionSelected||(e.logCounterMetric({feature:"PayWithCashOptionSelected."+a.paymentMethod,resource:"_Count"}),e.publishMetrics())}catch(m){}a.poaInstrumentClicked(b,!a.isCashOptionSelected,c||a.isCashOptionSelected);a.isCashOptionSelected=!1}});d.prototype.bindToEvents.apply(this)},openOptionsWindow:function(){this.widget.trigger("payWithCashShowOptions",
this._purchaseId)},publishSushiMetrics:function(a,b,c){c=g.isDefined(c)&&"boolean"===typeof c?c.toString():c;this.widget.publishSuccessSushiMetrics({ActionType:a,ActionValueType:b,ActionValue:c,ActionParentValueType:"PurchaseDocument",ActionParentValue:this._purchaseId})},showHideCurrentInstrument:function(a){a?h.showElement(this.getDOMElementsByPrefix("POAInstrumentContainer-")):h.hideElement(this.getDOMElementsByPrefix("POAInstrumentContainer-"))}})});d("components/SelectablePayWithCashPayCodeListItemComponent",
["components/SelectablePayWithCashListItemComponent","events/InstrumentRowSelectedEvent","css-utils","lang","clog"],function(d,f,k,h,e){return d.extend({initialize:function(d,a){this.isPayCodeMultiTenderEnabled=a.data.isPayCodeMultiTenderEnabled;this.paymentMethod=a.data.paymentMethod},bindToElements:function(){var g=this;this.getDOMElement("pmts-paywithcash-paycode-partner-store-link").click(function(a){a.stopImmediatePropagation();a.preventDefault();g.getDOMElement("pmts-paywithcash-paycode-partner-store-popover-trigger").trigger("click")});
d.prototype.bindToElements.apply(g)},poaInstrumentClicked:function(d,a,b){a=h.isDefined(a)?a:!1;if(!a&&!b&&this.isOptionWindowEnabled)return this.openOptionsWindow();this.widget.trigger(f,{instrumentId:d,isPayCodeMultiTenderEnabled:this.isPayCodeMultiTenderEnabled,paymentMethod:this.paymentMethod});e.logCounterMetric({feature:"AmazonPayCodeMultiTender"+(this.isPayCodeMultiTenderEnabled?".Enabled":".Disabled"),resource:"_Count"});this.publishSushiMetrics("PayWithCashOptionSelected."+this.paymentMethod,
"isSelectedFromOption",a);e.publishMetrics()}})});d("components/SelectablePayWithCashPayOnPickupListItemComponent","components/SelectablePayWithCashListItemComponent events/InstrumentRowSelectedEvent continuable css-utils lang AUI!P jQuery clog".split(" "),function(d,k,l,h,e,g,a,b){return d.extend(l,{initialize:function(a,b){this.isLocationInformationAvailable=b.data.isLocationInformationAvailable;this.locationSelectorURL=b.data.locationSelectorURL;this.paymentMethod=b.data.paymentMethod;this.isPayOnPickupMultiTenderEnabled=
b.data.isPayOnPickupMultiTenderEnabled;this.isPayOnPickupPreSelected=b.data.isPayOnPickupPreSelected;this._isMobile="mobile"===a.options.deviceType},bindToElements:function(){var a=this;g.when("A","a-modal","ready").execute(function(c){c.on("a:popover:beforeShow:copu-select-pickup-location-popover",function(c){document.getElementById("pay-on-pickup-location-selector-iframe").src=a.locationSelectorURL;c.popover&&(a.locationSelectorPopover=c.popover.$popover);try{b.logCounterMetric({feature:"PayOnPickupLocationSelectorOpen",
resource:"_Count"}),a.publishSushiMetrics("PayOnPickupLocationSelectorOpen","payOnPickupLocationInfoAvailable",a.isLocationInformationAvailable),b.publishMetrics(),c.preventDefault(),c.stopImmediatePropagation()}catch(p){}})});a.getDOMElement("copu-pickup-location-selector-link").click(function(b){b.stopImmediatePropagation();b.preventDefault();a.getDOMElement("copu-pickup-location-selector-trigger").trigger("click")});a.widget.on("initializeRecommendedInstrument",a,function(b){if(b.instrumentId===
a._instrumentId)if(a.isPayOnPickupPreSelected)a.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||a._poaInstrumentSelected();else return APX.events.STOP_EVENT_PROCESSING});d.prototype.bindToElements.apply(a)},bindToEvents:function(){var a=this;a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a._getInstrumentId()&&a.isPayOnPickupPreSelected?a._onInstrumentSelected():a._onInstrumentDeselected()});this.widget.on("PayWithCashSetReturnCustomer",this,function(b){a.triggerCustomerEvent("PayWithCashSetReturnCustomerEvent",
b)});var b=e.bind(this._processLocationSelectorMessage,this);e.addEventListener(f,"message",b);d.prototype.bindToEvents.apply(this)},_processLocationSelectorMessage:function(a){if(a.origin===document.location.origin)try{"CONFIRM_PICKUP_LOCATION"===JSON.parse(a.data).name&&this.locationIsSelected()}catch(m){}},locationIsSelected:function(){var b=this;g.when("a-modal").execute(function(c){if(b.locationSelectorPopover){if(c=a(b.locationSelectorPopover.find("[data-action]\x3da-popover-close")[0]))c.trigger("click"),
b.triggerCustomerEvent("PayOnPickupLocationSelectedEvent",b._instrumentId);b.locationSelectorPopover=null}})},poaInstrumentClicked:function(a,b,d){var c=this;b=e.isDefined(b)?b:!1;if(!b&&!d&&c.isOptionWindowEnabled)return this.openOptionsWindow();this.widget.trigger(k,{instrumentId:a,isPayOnPickupMultiTenderEnabled:this.isPayOnPickupMultiTenderEnabled,paymentMethod:this.paymentMethod});b&&!c.isLocationInformationAvailable&&(c._isMobile?setTimeout(function(){c.getDOMElement("copu-pickup-location-selector-trigger").trigger("click")},
100):c.getDOMElement("copu-pickup-location-selector-trigger").trigger("click"));this.publishSushiMetrics("PayWithCashOptionSelected."+c.paymentMethod,"payOnPickupLocationInfoAvailable",c.isLocationInformationAvailable)},triggerCustomerEvent:function(a,b){var c=this;c.widget.submitFormAJAX({"ppw-widgetEvent":a,"ppw-instrumentId":c._instrumentId,"ppw-widgetState":c.widget.options.serializedState},{success:function(){c.widget.trigger("PayWithCashSetReturnCustomerUpdated",b)},error:function(){console.log("Update failed")},
resumeContinueQueueOnError:!0})},_triggerBackingInstrumentSelectedEvent:function(){if(this.isLocationInformationAvailable&&"false"!==this.isLocationInformationAvailable)d.prototype._triggerBackingInstrumentSelectedEvent.apply(this);else{var a=[this.widget.getLocalizedString("pay_on_pickup_psp_select_location_error_message")];this.widget.trigger("backingInstrumentSelected",{instrumentId:self._instrumentId,errors:a,paymentMethod:self._paymentMethodCode})}}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,e=b._namespace||b.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Swish","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,e){(function(){var a=PaymentsPortal2.modules.define;a("components/SwishComponent",["component"],function(a){return a.extend({initialize:function(){}})});a("components/SelectableSwishListComponent",["form-component"],function(a){return a});a("components/SelectableSwishListItemComponent",
["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","jQuery"],function(a,c,b){return a.extend({initialize:function(a,b){this.isSwishPaymentMethodUnavailable=b.data.isSwishPaymentMethodUnavailable},_getContainerElement:function(){return this.getDOMElement("POAInstrumentContainer-"+this._getInstrumentId())},_instrumentSwishEnableGreyOut:function(){this._getContainerElement().addClass("pmts-disabled-section")},_instrumentSwishUnclickable:function(){this._getContainerElement().addClass("pmts-pm-disabled")},
_instrumentSwishRadioButtonUncheckAndDisable:function(){this._getContainerElement().find("input[type\x3dradio]").each(function(a,c){b(c).prop("checked",!1);b(c).prop("disabled",!0)})},bindToEvents:function(){if(this.isSwishPaymentMethodUnavailable)this._instrumentSwishRadioButtonUncheckAndDisable(),this._instrumentSwishEnableGreyOut(),this._instrumentSwishUnclickable();else if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(c,{instrumentId:this._instrumentId})});
this.widget.on(c,this,function(a){this._instrumentRowSelected(a.instrumentId)})}})});a("components/SwishDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType}})});a("components/SwishSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=
b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-CardClaimOwnership","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ClaimOwnershipChallengeCardComponent",["component"],function(a){return a.extend({initialize:function(){}})});a("components/CardClaimOwnershipComponent",["component","jQuery","lang","AUI!P"],
function(a,b,e,c){return a.extend({initialize:function(){},bindToElements:function(){var a=this;b("#claim-continue-checkbox-clicked").bind("change",function(c){b(this).is(":checked")?a.getDOMElement("continue-button-clicked").removeClass("apx-wallet-card-claim-ownership-continue-button-disable"):a.getDOMElement("continue-button-clicked").addClass("apx-wallet-card-claim-ownership-continue-button-disable")});a.getDOMElement("continue-button-clicked").click(e.bind(this._continueBankButtonTriggered,this))},
_continueBankButtonTriggered:function(){this.widget.submitFormAJAX({"ppw-widgetEvent":"StartChallengeComponentEvent","ppw-widgetState":this.widget.options.serializedState})}})});a("components/CardClaimOwnershipWorkflowComponent",["modal-popover","component"],function(a,b){return b.extend({initialize:function(b,c){this.popover=new a(b,c,this)},bindToEvents:function(){this.widget.on("claim-ownership-cancelClicked",this,function(a){this.getDOMElement("claim-ownership-popover-cancel-form").submit()})}})})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,f=c._namespace||c.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-APayDeviceValidation","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,f){(function(){var a=PaymentsPortal2.modules.define;a("components/DeviceValidationComponent",["component","clog","upiEvents"],function(a,d,c){return a.extend({initialize:function(b,a){d.logCounterMetric({feature:"DeviceValidation2FA_JSInitialised",
resource:"_Count"});this.dfValidationResultTracker=[];this.paymentMethodId=a.data.paymentMethodId;this.processedDF2FA=!1;this.DeviceFingerprint2FACompletedEventName="DeviceFingerprint2FACompleted"},bindToEvents:function(){var b=this;b.widget.on(c.DeviceFingerprintValidationPerformedEventName,this,function(a){b.processedDF2FA||(d.logCounterMetric({feature:"DeviceValidation2FA_DeviceFingerprintValidationPerformedEvent",resource:"_Count"}),b.dfValidationResultTracker.push(a.outcome),"SUCCESS"!==a.outcome&&
b.dfValidationResultTracker.length!==a.totalHandleIndexes)||(b.widget.trigger(b.DeviceFingerprint2FACompletedEventName,b.dfValidationResultTracker),b.processedDF2FA=!0)});b.widget.on(b.DeviceFingerprint2FACompletedEventName,this,function(a){d.logCounterMetric({feature:"DeviceValidation2FA_DeviceFingerprint2FACompletedEvent",resource:"_Count"});b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"CreateDeviceDataSourceEvent","ppw-aggValidationResults":a.join(","),
"ppw-paymentMethodId":b.paymentMethodId},{success:function(a){d.logCounterMetric({feature:"DeviceValidation2FA_CreateDeviceDataSourceEventSuccess",resource:"_Count"})},error:function(a){d.logCounterMetric({feature:"DeviceValidation2FA_CreateDeviceDataSourceEventFailure",resource:"_Count"})}})})}})})})()});
/* ******** */
(function(e){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-PaymentAuthenticationApprovers","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,d,f){(function(){var a=PaymentsPortal2.modules.define;a("components/AddPaymentAuthenticationApproverComponent",["jQuery","form-component","lang","AUI!P","css-utils"],function(a,d,e,f,g){return d.extend({initialize:function(b,c){this.form.formModel.registerAdditionalData("paymentMethodId",
c.data.paymentMethodId);this.form.formModel.registerAdditionalData("sourceComponent",c.data.sourceComponent)},bindToElements:function(){var b=this.data.paymentMethodId+this.data.sourceComponent,c=this.getDOMElement("pmts-paa-email-input-section"+b),a=this.getDOMElement("pmts-paa-bypass-approval-preference"+b).find("input[type\x3dradio]"),h=this.getDOMElement("pmts-paa-delegate-authentication-preference"+b).find("input[type\x3dradio]");this._shouldShowEmailInputSection(h,c);var d=this.getDOMElement("pmts-paa-add-save-button"+
b);b=this.getDOMElement("pmts-paa-add-cancel-button"+b);this._handleBypassApprovalPreferenceSelectedEvent(a,c);this._handleDelegateAuthenticationPreferenceSelectedEvent(h,c);this._handleSaveButtonEvent(d);this._handleCancelButtonEvent(b)},_handleSaveButtonEvent:function(b){var c=this;b.click(function(b){b.preventDefault();c._saveButtonAction()})},_handleCancelButtonEvent:function(b){var c=this;b.click(function(b){b.preventDefault();c._cancelButtonAction()})},_shouldShowEmailInputSection:function(b,
c){b.is(":checked")?g.showElement(c):g.hideElement(c)},_handleDelegateAuthenticationPreferenceSelectedEvent:function(b,c){b.change(function(a){b.is(":checked")&&g.showElement(c)})},_handleBypassApprovalPreferenceSelectedEvent:function(b,c){b.change(function(a){b.is(":checked")&&g.hideElement(c)})},_saveButtonAction:function(){if(0===this.form.validateForm().length){var b=this.form.getFormValues();this.widget.submitFormAJAX({"ppw-widgetEvent":"AddPaymentAuthenticationApproverSaveButtonClickedEvent",
"ppw-paymentMethodId":this.data.paymentMethodId,"ppw-sourceComponent":this.data.sourceComponent,"ppw-maybePAAEmailId":b.payment_authentication_approver_email_id,"ppw-maybeBypassApproval":b.bypass_approval,"ppw-widgetState":this.widget.options.serializedState})}},_cancelButtonAction:function(){this.form.getFormValues();this.widget.submitFormAJAX({"ppw-widgetEvent":"AddPaymentAuthenticationApproverCancelButtonClickedEvent","ppw-sourceComponent":this.data.sourceComponent,"ppw-paymentMethodId":this.data.paymentMethodId,
"ppw-widgetState":this.widget.options.serializedState})}})});a("components/EditPaymentAuthenticationApproverComponent",["component"],function(a){return a.extend({})});a("components/EditPaymentAuthenticationApproverWorkflowComponent",["component"],function(a){return a.extend({})});a("components/PaymentAuthenticationApproversListItemComponent",["component"],function(a){return a.extend({})});a("components/PaymentAuthenticationApproversListItemAlertComponent",["component"],function(a){return a.extend({})});
a("components/AddPaymentAuthenticationApproversWorkflowComponent",["component"],function(a){return a.extend({})})})()});
/* ******** */
(function(g){var h=window.AmazonUIPageJS||window.P,l=h._namespace||h.attributeErrors,d=l?l("APXWidgetsAssets@APXWidgets-HealthInsurance","APXWidgetsAssets"):h;d.guardFatal?d.guardFatal(g)(d,window):d.execute(function(){g(d,window)})})(function(g,h,l){(function(){var d=PaymentsPortal2.modules.define;d("token-mapper",[],function(){return{replaceTokens:function(a,b){b=Object.entries(b);for(var f=0;f<b.length;f++){var c=b[f][0],e=b[f][1];c.startsWith("TokenField-")&&(c=a.getDOMElement(c.replace("TokenField-",
"")),c.is("input")?c.val(e):c.html(e))}}}});d("components/DeleteMe",["component"],function(a){return a.extend({})});d("components/HealthInsuranceEligibilityLoaderComponent",["component","jQuery"],function(a,b){var f,c;return a.extend({initialize:function(e,a){this.insuranceId=a.data.insuranceId;this.eligibilityRequestId=a.data.eligibilityRequestId;this.insuranceEligibilityStatus=a.data.eligibilityStatus;f=a.data.maxRetries||10;c=a.data.retryDelayMs||1E3},bindToEvents:function(){var a=this;setTimeout(function(){a._pollForEligibilityStatus(0)},
c)},_pollForEligibilityStatus:function(a){var e=this,b={"ppw-widgetEvent":"HealthInsurancePollEligibilityStatusEvent","ppw-insuranceId":this.insuranceId,"ppw-eligibilityRequestId":this.eligibilityRequestId,"ppw-retryCount":a,"ppw-widgetState":this.widget.options.serializedState},d={success:e.widget.createAjaxContinueSuccessHandler(function(b){e.insuranceEligibilityStatus=b&&b.additionalWidgetResponseData&&b.additionalWidgetResponseData.additionalData&&b.additionalWidgetResponseData.additionalData.eligibilityStatus||
"InProgress";e._isInProgress()&&a<f&&h.setTimeout(function(){e._pollForEligibilityStatus(++a)},c)}),error:function(a){}};this.widget.continueRequest(b,d)},_isInProgress:function(){return"inprogress"===this.insuranceEligibilityStatus.toLowerCase()}})});d("date-utils",[],function(){return{formatDateToYYYYMMDD:function(a){return/^\d{4}-\d{2}-\d{2}$/.test(a)?a.split("-").join(""):a},formatDateToYYYY_MM_DD:function(a){return/^\d{8}$/.test(a)?a.slice(0,4)+"-"+a.slice(4,6)+"-"+a.slice(6):a}}});d("components/InsuranceFormComponent",
"component jQuery form-component css-utils lang AUI!P aui-helper validation-functions token-mapper date-utils".split(" "),function(a,b,f,c,e,d,h,g,m,k){return f.extend({initialize:function(a,c){this.hideShowPrimaryHolderDetailsSection(this.getDOMElement("is_primary_holder").is(":checked"));a=this.getDOMElement("date_of_birth").val();this.getDOMElement("calendar_date_of_birth").val(k.formatDateToYYYY_MM_DD(a));(a=this.getDOMElement("primary_holder_date_of_birth").val())&&this.getDOMElement("calendar_primary_holder_date_of_birth").val(k.formatDateToYYYY_MM_DD(a));
this.createConditionalValidationFunction();m.replaceTokens(this,c.data)},bindToElements:function(){var a=this;this.getDOMElement("hi-form-save-hic-button").click(function(c){return a.onSaveInsuranceSubmitButton(c)})},bindToEvents:function(){var a=this;this.getDOMElement("is_primary_holder").change(function(c){a.hideShowPrimaryHolderDetailsSection(b(this).is(":checked"))})},onSaveInsuranceSubmitButton:function(a){(a=this.getDOMElement("member_id").val())&&this.getDOMElement("policy_number_tail").val(a.slice(-4));
a=this.getDOMElement("calendar_date_of_birth").val();this.getDOMElement("date_of_birth").val(k.formatDateToYYYYMMDD(a));(a=this.getDOMElement("calendar_primary_holder_date_of_birth").val())&&this.getDOMElement("primary_holder_date_of_birth").val(k.formatDateToYYYYMMDD(a));return 0===this.form.validateForm().length},hideShowPrimaryHolderDetailsSection:function(a){var e=this.getDOMElement("is_primary_holder_hidden"),b=this.getDOMElement("primary_holder_details");a?(e.val("checked"),c.hideElement(b)):
(e.val(""),c.showElement(b))},createConditionalValidationFunction:function(){g.NonEmptyWhenConditionFieldCompliesToValidationTypeConstraint=function(a,c,e,b){var f=g.NonEmptyFieldConstraint(a,c,a.fields[b.conditionFieldName],b),d=!1;switch(b.validationType.value){case "NonEmptyWhenConditionFieldNonEmpty":d=!f;break;case "NonEmptyWhenConditionFieldEmpty":d=f}return d?g.NonEmptyFieldConstraint(a,c,e,b):!0}}})});d("components/ValidateInsuranceComponent",["component","jQuery"],function(a,b){var f,c;return a.extend({initialize:function(a,
b){this.psInstrumentId=b.data.psInstrumentId;this.verificationId=b.data.verificationId;this.hiCardVerificationStatus=b.data.verificationStatus;f=b.data.maxRetries||10;c=b.data.retryDelayMs||1E3},bindToEvents:function(){var a=this;setTimeout(function(){a._pollForVerificationStatus(0)},c)},_pollForVerificationStatus:function(a){var b=this,e={"ppw-widgetEvent":"PollHiCardVerificationStatusEvent","ppw-insuranceId":this.psInstrumentId,"ppw-verificationId":this.verificationId,"ppw-retryCount":a,"ppw-widgetState":this.widget.options.serializedState},
d={success:b.widget.createAjaxContinueSuccessHandler(function(e){this.hiCardVerificationStatus=e&&e.additionalWidgetResponseData&&e.additionalWidgetResponseData.additionalData&&e.additionalWidgetResponseData.additionalData.verificationStatus||"VerificationPending";"verificationpending"===this.hiCardVerificationStatus.toLowerCase()&&a<f&&h.setTimeout(function(){b._pollForVerificationStatus(++a)},c)}),error:function(a){}};this.widget.continueRequest(e,d)}})});d("components/ViewInsuranceComponent",["component",
"jQuery","token-mapper"],function(a,b,d){return a.extend({initialize:function(a,b){this.insuranceId=b.data.insuranceId;d.replaceTokens(this,b.data)},bindToEvents:function(){var a=this;this.getDOMElement("remove_health_insurance_button").click(function(b){a._removeInsurance()})},_removeInsurance:function(){var a={"ppw-widgetEvent":"RemoveInsuranceEvent","ppw-insuranceId":this.insuranceId,"ppw-widgetState":this.widget.options.serializedState},b={success:this.widget.createAjaxContinueSuccessHandler(),
error:function(a){}};this.widget.continueRequest(a,b)}})});d("components/HICardAddWorkflowComponent",["component","modal-popover"],function(a,b){return a.extend({initialize:function(a,b){this._handlePopoverVisibility(b.data)},_handlePopoverVisibility:function(a){var b=this;a.addHiWorkflowCompleted||g.when("A").execute(function(a){a.on("a:declarative:a-popover-close:click",function(){b.getDOMElement("HiAddPopoverCancelForm").submit()})});g.when("a-modal").execute(function(c){c&&(c=c.get("AddHicPopover"),
a.isAddInProgress?c?c.refresh():b.getDOMElement("AddHicTriggerButton").trigger("click"):c&&c.hide())})}})});d("components/HICardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","lang","token-mapper"],function(a,b,d,c){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType;c.replaceTokens(this,b.data)},bindToElements:function(){this._bindEditPMLink();this.getDOMElement("verifyHiPmLink").click(d.bind(this._verifyHiPMLinkClicked,
this))},_verifyHiPMLinkClicked:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"StartHiCardVerifyEvent","ppw-iid":this._paymentMethodId,"ppw-paymentMethodType":this._paymentMethodType,"ppw-isDefaultPaymentMethod":this._isDefault})}})});d("components/HICardEditWorkflowComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});
d("components/HICardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-B2BPaymentsAcceptance","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PaymentMethodOwnerResolverComponent",["jQuery","form-component","lang","AUI!P","css-utils"],function(a,b,c,d,e){return b.extend({initialize:function(f,a){this.form.formModel.registerAdditionalData("sourceComponent",
a.data.sourceComponent);this.form.formModel.registerAdditionalData("sourceComponentSubCategory",a.data.sourceComponentSubCategory)},bindToElements:function(){var a=this.data.sourceComponent+this.data.sourceComponentSubCategory;this.getDOMElement("pmts-pmo-individual-preference"+a).find("input[type\x3dradio]");this.getDOMElement("pmts-pmo-shared-preference"+a).find("input[type\x3dradio]");a=this.getDOMElement("pmts-pmo-resolver-next-button"+a);this._handleNextButtonEvent(a)},_handleNextButtonEvent:function(a){var b=
this;a.click(function(a){a.preventDefault();b._nextButtonAction()})},_nextButtonAction:function(){if(0===this.form.validateForm().length){var a=this.form.getFormValues();this.widget.submitFormAJAX({"ppw-widgetEvent":"PaymentMethodOwnerResolverButtonClickedEvent","ppw-sourceComponent":this.data.sourceComponent,"ppw-sourceComponentSubCategory":this.data.sourceComponentSubCategory,"ppw-maybePaymentMethodOwner":a.payment_method_owner,"ppw-widgetState":this.widget.options.serializedState})}}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-JPPoints","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/JPPointsDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(a,b,c){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType;this._isDefault=b.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});a("components/JPPointsMetadataSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/JPPointsSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BottomSheet","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BottomSheetComponent",["component","AUI!P","clog"],function(a,b,c){return a.extend({initialize:function(e,a){this._bottomSheetCloseButtonSelector=(e=a.data.bottomSheetCloseButtonClass)?"."+e:
""},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(c){a._startWidget(a)})},_startWidget:function(a){b.when("A","a-sheet").execute("APX-Startwidget",function(b,f){f.create({name:"code_generated_sheet",preloadDomId:"bottomSheetComponent",height:800});var d=f.get("code_generated_sheet"),e=null;b.on("a:sheet:beforeShow:code_generated_sheet",function(){e=c.getCurrentTime()});f.showSheet(d);var g=d.$container[0];g&&g.classList.add("mcx-bottom-sheet-container");b.on("a:sheet:afterShow:code_generated_sheet",
function(){c.logLatencyMetric({feature:"ShowBottomSheetWidget",resource:"_Latency",startTime:e});c.publishMetrics()});a._bottomSheetCloseButtonSelector&&$(a._bottomSheetCloseButtonSelector).click(function(){f.hideSheet(d)})})}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-P24","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/P24DetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=
b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/P24EditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/P24SleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-SPEI","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/SpeiComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===
a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("speiContainer")}})})})()});
/* ******** */
(function(d){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,b=f?f("APXWidgetsAssets@APXWidgets-Registration","APXWidgetsAssets"):e;b.guardFatal?b.guardFatal(d)(b,window):b.execute(function(){d(b,window)})})(function(d,e,f){(function(){var b=PaymentsPortal2.modules.define;b("components/RegistrationLinkComponent","component lang jQuery events/postToSecureIframeEvent events/secureIframeLoadedEvent AUI!P clog css-utils events/AddPaymentInstrumentLinkSelectedEvent TransitionMetricsConstants".split(" "),
function(b,e,d,f,k,l,g,n,m,h){return b.extend({initialize:function(a,c){this._paymentIdentifier=c.data.paymentIdentifier;this._touchLink=this.getDOMElement(c.data.touchLinkReference);this._secureIframeName=c.data.secureIframeName;this._isEligible=c.data.isEligible;this._bindManualAddCCTrigger()},bindToElements:function(){var a=this;a._touchLink.click(function(){a._registrationLinkTriggered()})},bindToEvents:function(){var a=this;a.widget.on("RecordMaybeIneligiblePaymentMethodDisplayedMetricEvent",
a,function(){this._isEligible||(g.logCounterMetric({feature:"MCXRegistration.PaymentMethodIneligible."+this._paymentIdentifier,resource:"_Count"}),g.publishMetrics(),a.widget.publishSuccessSushiMetrics({ActionType:"PaymentMethodIneligible",ActionValueType:"AddMethod",ActionValue:this._paymentIdentifier}))});if("CC"===this._paymentIdentifier)a.widget.on("DisableCreditCardRegistrationLinkEvent",a,function(c){var b=d(".pmts-mcx-registration-touchlink-CC");1===b.length&&(a._disableRegistrationLink(b),
a._displayVerificationLimitExceedErrorMessage(b,c.rateLimitDurationInSeconds))});a.widget.on(k,this,function(a){a.data&&"CC"===a.data.paymentMethod&&a.clickData&&a.clickData.startTimestamp&&a.clickData.startTimestampSource&&g.logLatencyMetric({feature:a.clickData.startTimestampSource+h.SEPARATOR+h.CARD_REGISTRATION_FORM_VIEW,resource:"_Latency",startTime:a.clickData.startTimestamp})})},_disableRegistrationLink:function(a){a.addClass("isDisabled")},_displayVerificationLimitExceedErrorMessage:function(a,
b){a=900<=b?a.find(".pmts-registration-link-verification-limit-exceed-24hrs-error"):a.find(".pmts-registration-link-verification-limit-exceed-15mins-error");1===a.length&&a.removeClass("a-hidden aok-hidden")},_showAddPMPage:function(){this.widget.trigger(m,{paymentMethodIdentifier:this._paymentIdentifier})},_redirectVenmoPMToInterstitialPage:function(){this.widget.trigger("AddVenmoIntermediateStepEvent")},_registrationLinkTriggered:function(){switch(this._paymentIdentifier){case "CC":var a={ActionType:"StartAddCreditCard",
ActionValueType:"Click",ActionValue:"SecureAddCreditCardLinkClicked"};this._triggerSecureRegistration(a);break;case "BA":a={ActionType:"StartAddBankAccount",ActionValueType:"Click",ActionValue:"SecureAddBankAccountLinkClicked"};this._triggerSecureRegistration(a);break;case "CBA":a={ActionType:"StartAddCorporateBankAccount",ActionValueType:"Click",ActionValue:"SecureAddBankAccountLinkClicked"};this._triggerSecureRegistration(a);break;case "HBA":this._showAddPMPage();break;case "APC":this._showAddPMPage();
break;case "EBT":this._showAddPMPage();break;case "VM":this._redirectVenmoPMToInterstitialPage();break;case "HIC":this._showAddPMPage()}},_bindManualAddCCTrigger:function(){var a=this;"CC"===this._paymentIdentifier&&l.when("A").execute(function(b){b.declarative("add-credit-card-mcx-action-name","click",function(){a._triggerSecureRegistration()})})},_triggerSecureRegistration:function(a){(new Date).getTime();g.logCounterMetric({feature:"SecureRegistrationLinkClicked",resource:"_Count"});this.widget.publishSuccessSushiMetrics(a);
this.widget.trigger(f,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:[this._paymentIdentifier],iFrameName:this._secureIframeName}})}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,e=b._namespace||b.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Bellamy","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,e){(function(){var a=PaymentsPortal2.modules.define;a("components/AddBankRedirectComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,b,f,d,e){return f.extend({_hasErrors:!1,initialize:function(c,a){this._action=a.data.action;
this._hasErrors=a.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("BankRedirectPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBankRedirectSubmitButton").click(d.bind(this._handleFormSubmission,this))},bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(a){this._initPopoverState()});c.widget.on(a,c,function(a){a.action===c._action&&b(c.getDOMElement("addBankRedirectForm")).submit()})},_handleFormSubmission:function(c){var f=
this.form.validateForm(),b=this.getFormSubmissionParameters("addBankRedirectFormContainer");0===f.length?(this.widget.trigger(a,{event:c,submissionParameters:b,action:this._action}),this.closeAddBankRedirectPopover()):c.preventDefault()},closeAddBankRedirectPopover:function(){e.when("a-modal").execute(function(a){a&&(a=a.get("pmtsAddBankRedirectPopover"))&&a.hide()})}})});a("components/SelectableBankRedirectListComponent",["form-component"],function(a){return a});a("components/SelectableBankRedirectListItemComponent",
["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(a,b){return a.extend({bindToEvents:function(){var a=this;if(a._isPreselected)a.widget.on("componentsInitialized",a,function(){a.widget.trigger(b,{instrumentId:a._instrumentId})});a.widget.on(b,a,function(b){a._instrumentRowSelected(b.instrumentId)})}})})})()});
/* ******** */
(function(F){var m=window.AmazonUIPageJS||window.P,x=m._namespace||m.attributeErrors,r=x?x("APXWidgetsAssets@APXWidgets-AIPS","APXWidgetsAssets"):m;r.guardFatal?r.guardFatal(F)(r,window):r.execute(function(){F(r,window)})})(function(F,m,x){(function(){var r=PaymentsPortal2.modules.define;r("components/DefaultComponent",["component"],function(c){return c.extend({initialize:function(){m.alert("DefaultComponent initialize!")}})});r("components/UpiOtherPMListItemComponent","component continuable events/InstrumentRowSelectedEvent public-event-registry css-utils components/SimplePaymentOptionListItemComponent lang upi-redirection-util clog events/spinner-events".split(" "),
function(c,k,n,q,g,h,l,t,e,v){return h.extend(k,{isUPIValidated:!1,isUpiContinuable:!1,isUpiRegistrationSelected:!1,upiContainer:"",upiDisabledMessageContainer:"",upiValidationInputContainer:"",upiInputContainer:"",isUpiUsable:!0,isUpiRegistrationUsable:!0,UpiRegistrationSuppressedViolationHead:"",instrumentId:"",instrumentType:"",isAPBSelected:!1,isUpiAPBMultiTenderEnabled:!1,selectedBankValue:"",redirectUrl:"",returnUrl:"",clientId:"",upiAPBUncheckedMessageContainer:"",upiRegistrationSubsectionInfoContainer:"",
isAPBDeselectTriggered:!1,isAutomaticAPBDeselectForUpiEnabled:!1,httpMethod:"",isUpiRecurringEligible:!1,orderId:"",enableGetReturnHttpMethod:!1,enableOrderIdInClientContext:!1,enableCallbackRedirectionBehavior:!1,enableMultiTenderContextInUPIRedirectionClientContext:!1,upiGifJsBinding:"",upiRegistrationAndValidationLogo:"",genericUpiLogoJsBinding:"",isNomenclatureWave2Enabled:!1,returnUrlPostParams:"",initialize:function(b,a){this.isUpiUsable=a.data.isUpiUsable;this.isUpiRegistrationUsable=a.data.isUpiRegistrationUsable;
this.UpiRegistrationSuppressedViolationHead=a.data.UpiRegistrationSuppressedViolationHead;this.instrumentId=a.data.instrumentId;this.instrumentType=a.data.instrumentType;this.orderId=a.data.orderId;this.enableGetReturnHttpMethod=a.data.enableGetReturnHttpMethod;this.enableOrderIdInClientContext=a.data.enableOrderIdInClientContext;this.enableCallbackRedirectionBehavior=a.data.enableCallbackRedirectionBehavior;this.upiGifJsBinding=a.data.upiGifJsBinding;this.upiRegistrationAndValidationLogo=a.data.upiRegistrationAndValidationLogo;
this.genericUpiLogoJsBinding=a.data.genericUpiLogoJsBinding;this.isNomenclatureWave2Enabled=a.data.isNomenclatureWave2Enabled;this.isUpiUsable&&(q.register(n),q.register("UpiRedirectionContinueEvent"));this.upiContainer=a.data.upiContainer;this.upiDisabledMessageContainer=a.data.upiDisabledMessageContainer;this.upiValidationInputContainer=a.data.upiValidationInputContainer;this.upiInputContainer=a.data.upiInputContainer;this.upiAPBUncheckedMessageContainer=a.data.upiAPBUncheckedMessageContainer;this.isAutomaticAPBDeselectForUpiEnabled=
a.data.isAutomaticAPBDeselectForUpiEnabled;this.upiRegistrationSubsectionInfoContainer=a.data.upiRegistrationSubsectionInfoContainer;this._toggleUPIInputContainer(!1);this.isUpiAPBMultiTenderEnabled=a.data.isUpiAPBMultiTenderEnabled;this._toggleUncheckAPBtoEnableUPIMessage(!1);g.showElement(this.getDOMElement(this.upiContainer));this.enableMultiTenderContextInUPIRedirectionClientContext=a.data.enableMultiTenderContextInUPIRedirectionClientContext;this.returnUrlPostParams=a.data.returnUrlPostParams},
_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._toggleUPIInputContainer(!0);this._toggleUPIAPBUncheckedMessage();this._triggerBackingInstrumentSelectedEvent();this.isUPIValidated&&this._toggleUpiLogosForNomenclature(!0)},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._toggleUPIInputContainer(!1);this._getInstrumentSelectionInputElement().prop("checked",
!1);this._toggleUpiLogosForNomenclature(!1)},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},_getContainerElement:function(){return this.getDOMElement(this.upiContainer)},_toggleUPIValidationContainer:function(b){0<this.getDOMElement(this.upiValidationInputContainer).length&&g.toggleElement(this.getDOMElement(this.upiValidationInputContainer),b)},_toggleUPIInputContainer:function(b){0<this.getDOMElement(this.upiInputContainer).length&&g.toggleElement(this.getDOMElement(this.upiInputContainer),
b)},_toggleUncheckAPBtoEnableUPIMessage:function(b){0<this.getDOMElement(this.upiDisabledMessageContainer).length&&g.toggleElement(this.getDOMElement(this.upiDisabledMessageContainer),b)},_toggleUPIAPBUncheckedMessage:function(){this.isAutomaticAPBDeselectForUpiEnabled&&this.isAPBSelected&&this.isUpiRegistrationSelected&&!this.isUpiContinuable?(this.isAPBDeselectTriggered=this.isUpiContinuable=!0,this._toggleUPIAPBUncheckedMessageContainer(!0),this._toggleUPIRegistrationSubsectionInfoContainer(!1)):
this.isUpiRegistrationSelected&&!this.isAPBDeselectTriggered&&this._toggleUPIRegistrationSubsectionInfoContainer(!0)},_toggleUPIAPBUncheckedMessageContainer:function(b){var a=this.getDOMElement(this.upiAPBUncheckedMessageContainer);0<a.length&&g.toggleElement(a,b)},_toggleUpiLogosForNomenclature:function(b){this.isNomenclatureWave2Enabled&&(this._toggleUPIGenericLogo(b),this._toggleUPIGif(!b),this._toggleUpiRegistrationAndValidationLogo(!b))},_toggleUPIGenericLogo:function(b){var a=this.getDOMElement(this.genericUpiLogoJsBinding);
0<a.length&&g.toggleElement(a,b)},_toggleUPIGif:function(b){var a=this.getDOMElement(this.upiGifJsBinding);0<a.length&&g.toggleElement(a,b)},_toggleUpiRegistrationAndValidationLogo:function(b){var a=this.getDOMElement(this.upiRegistrationAndValidationLogo);0<a.length&&g.toggleElement(a,b)},_toggleUPIRegistrationSubsectionInfoContainer:function(b){var a=this.getDOMElement(this.upiRegistrationSubsectionInfoContainer);0<a.length&&g.toggleElement(a,b)},_getIsRecurringChargePaymentMethod:function(){return this.isUpiRecurringEligible},
_triggerInstrumentRowSelectedEvent:function(b){this.widget.trigger(n,{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),isInstrumentOwned:this._getIsOwned(),isRecurringChargePaymentMethod:this._getIsRecurringChargePaymentMethod(),paymentMethod:this._getPaymentMethodCode()})},_triggerBackingInstrumentSelectedEvent:function(){var b="";this.isUpiRegistrationUsable?b="apx_upi_registration_disabled_message_apb_selected":"PurchaseAmountExceeded"===this.UpiRegistrationSuppressedViolationHead&&
(b="apx_upi_registration_disabled_message_for_fl");b=this.isUpiContinuable?[]:[this.widget.getLocalizedString(this.isUpiRegistrationSelected?b:"apx_upi_not_verified")];var a=this.isUpiRegistrationSelected&&this.isUpiContinuable;this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:b,paymentMethod:this.data.paymentMethod,isUpiRedirectionRequired:a})},bindToEvents:function(){var b=this;l.bind(h.prototype.bindToEvents,this).apply();
b.widget.on(n,this,function(a){a.instrumentId===this._getInstrumentId()?this._onInstrumentSelected():this._onInstrumentDeselected()});b.widget.on("apbSelectionChanged",b,function(a){b.widget.get("apbCheckboxSelected")!==x&&b.isUpiUsable&&(b.isAPBSelected=a.isSelected,b.giftCardId=a.giftCardId,b.storedValueId=a.storedValueId,b.isAutomaticAPBDeselectForUpiEnabled&&a.isSelected&&(this._toggleUPIAPBUncheckedMessageContainer(!1),this.isAPBDeselectTriggered=!1),b.isUpiAPBMultiTenderEnabled||(this._isInstrumentSelected()&&
a.isSelected&&(this.setContinuable(!1),b.widget.trigger("PaymentPlanSelected",{isValid:!1})),a.isSelected&&this._toggleUpiLogosForNomenclature(!1),this.setDisabled(a.isSelected),this._toggleUncheckAPBtoEnableUPIMessage(a.isSelected)))});b.widget.on("ValidateUpiIdResultEvent",b,function(a){this.isUpiContinuable=this.isUPIValidated=a.isContinuable;this.isUpiRecurringEligible=a.isUpiRecurringEligible;this.isUPIValidated?this._toggleUpiLogosForNomenclature(!0):this._toggleUpiLogosForNomenclature(!1);
this.isUpiRecurringEligible&&b._triggerInstrumentRowSelectedEvent()});b.widget.on("UpiActionChangeEvent",b,function(a){b._toggleUPIValidationContainer(a.isUpiValidationContainerSelected);b.isUpiRegistrationSelected=!a.isUpiValidationContainerSelected;b.isUpiContinuable=a.isUpiValidationContainerSelected?b.isUPIValidated:b.getContinuable();a.isUpiValidationContainerSelected?(b._toggleUPIAPBUncheckedMessageContainer(!1),b._toggleUPIRegistrationSubsectionInfoContainer(!1),this.isAPBDeselectTriggered=
!1):(b.selectedBankValue=a.selectedBank,b.redirectUrl=a.redirectUrl,b.returnUrl=a.returnUrl,b.failureReturnUrl=a.failureReturnUrl,b.purchaseId=a.purchaseId,b.isPurchaseIdRequired=a.isPurchaseIdRequired,b.areReturnUrlsSentByClient=a.areReturnUrlsSentByClient,b.clientId=a.clientId,b.httpMethod=a.httpMethod);b._isInstrumentSelected()&&b._triggerInstrumentRowSelectedEvent()});b.widget.on("UpiBankSelectionChangeEvent",b,function(a){b.isUpiContinuable=!0;b.isUpiRegistrationSelected=!0;b.selectedBankValue=
a.selectedBank;b.redirectUrl=a.redirectUrl;b.returnUrl=a.returnUrl;b.failureReturnUrl=a.failureReturnUrl;b.purchaseId=a.purchaseId;b.isPurchaseIdRequired=a.isPurchaseIdRequired;b.areReturnUrlsSentByClient=a.areReturnUrlsSentByClient;b.clientId=a.clientId;b.httpMethod=a.httpMethod;b._isInstrumentSelected()&&b._triggerInstrumentRowSelectedEvent()});b.widget.on("UpiRedirectionContinueEvent",b,function(){var a=e.getCurrentTime();b._isInstrumentSelected()&&(b.widget.trigger(v.showSpinner),e.logCounterMetric({feature:"UpiRegistrationRedirection",
resource:"_Count"}),t.upiRegistration(b.selectedBankValue,{redirectUrl:b.redirectUrl,returnUrl:b.returnUrl,failureReturnUrl:b.failureReturnUrl},b.purchaseId,b.clientId,b.httpMethod,{areReturnUrlsSentByClient:b.areReturnUrlsSentByClient,isPurchaseIdRequired:b.isPurchaseIdRequired,isAPBSelected:b.isAPBSelected,giftCardId:b.giftCardId,storedValueId:b.storedValueId,enableGetReturnHttpMethod:b.enableGetReturnHttpMethod,enableOrderIdInClientContext:b.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:b.enableMultiTenderContextInUPIRedirectionClientContext,
orderId:b.orderId,enableCallbackRedirectionBehavior:b.enableCallbackRedirectionBehavior,returnUrlPostParams:b.returnUrlPostParams})?(e.logCounterMetric({feature:"UpiRegistrationRedirection",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(b._getInstrumentId())})):(e.logCounterMetric({feature:"UpiRegistrationRedirection",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"UpiRegistrationRedirection",
ActionValueType:"PaymentInstrument",ActionValue:String(b._getInstrumentId())})),e.logLatencyMetric({feature:"UpiRegistrationRedirection",resource:"_Latency",startTime:a}),e.publishMetrics());return!1})},bindToElements:function(){var b=this;b.isUpiUsable&&b._getContainerElement().click(function(){b._isInstrumentSelected()||!b.isUpiUsable||b.isAPBSelected&&!b.isUpiAPBMultiTenderEnabled||b._triggerInstrumentRowSelectedEvent()})}})});r("components/UpiRegistrationComponent","component commonUtil css-utils continuable lang public-event-registry clog events/spinner-events upi-redirection-util jQuery events/InstrumentRowSelectedEvent".split(" "),
function(c,k,n,q,g,h,l,t,e,v,b){return c.extend(q,{isUpiValidated:!1,isUpiRegistrationSelected:!1,upiActionDropdown:"",upiRegistrationDropdownContainer:"",isUpiRegistrationUsable:!1,upiBankSelectDropdown:"",redirectUrl:"",returnUrl:"",failureReturnUrl:"",purchaseId:"",areReturnUrlsSentByClient:!1,isPurchaseIdRequired:!1,upiRegistrationDisabledApbMessageContainer:"",isUpiAPBMultiTenderEnabled:!1,isAPBSelected:!1,clientId:"",isApxReloadEnabled:!1,httpMethod:"",enableGetReturnHttpMethod:!1,isOnlyRegistrationDisplayable:!1,
enableOrderIdInClientContext:!1,enableMultiTenderContextInUPIRedirectionClientContext:!1,isUPIInBoxWeblabEnabled:!1,$getStartedLabel:"",orderId:"",isPspBspConvergenceWeblabEnabled:!1,pspBspConvergenceWeblabTreatment:"",isCreditCardOnUPIRegistrationEnabledForNewToAmazonPayUPICustomersTreatment:"",shouldDisplayCreditCardBanks:!1,enableCallbackRedirectionBehavior:!1,returnUrlPostParams:"",initialize:function(a,b){h.register("UpiActionChangeEvent");h.register("UpiBankSelectionChangeEvent");h.register("UpiRedirectionRequiredEvent");
this.upiBankSelectDropdown=b.data.upiBankSelectDropdown;this.upiActionDropdown=b.data.upiActionDropdown;this.upiRegistrationDropdownContainer=b.data.upiRegistrationDropdownContainer;this.isUpiRegistrationUsable=b.data.isUpiRegistrationUsable;this.redirectUrl=b.data.redirectUrl;this.returnUrl=b.data.returnUrl;this.failureReturnUrl=b.data.failureReturnUrl;this.purchaseId=b.data.purchaseId;this.isPurchaseIdRequired=b.data.isPurchaseIdRequired;this.areReturnUrlsSentByClient=b.data.areReturnUrlsSentByClient;
this.upiRegistrationDisabledApbMessageContainer=b.data.upiRegistrationDisabledApbMessageContainer;this.isUpiAPBMultiTenderEnabled=b.data.isUpiAPBMultiTenderEnabled;this.clientId=b.data.clientId;this.isApxReloadEnabled=b.data.isApxReloadEnabled;this.httpMethod=b.data.httpMethod;this.isOnlyRegistrationDisplayable=b.data.isOnlyRegistrationDisplayable;this.enableGetReturnHttpMethod=b.data.enableGetReturnHttpMethod;this.enableOrderIdInClientContext=b.data.enableOrderIdInClientContext;this.orderId=b.data.orderId;
this.isUPIInBoxWeblabEnabled=b.data.isUPIInBoxWeblabEnabled;this.enableMultiTenderContextInUPIRedirectionClientContext=b.data.enableMultiTenderContextInUPIRedirectionClientContext;this.isPspBspConvergenceWeblabEnabled=b.data.isPspBspConvergenceWeblabEnabled;this.pspBspConvergenceWeblabTreatment=b.data.pspBspConvergenceWeblabTreatment;this.isCreditCardOnUPIRegistrationEnabledForNewToAmazonPayUPICustomersTreatment=b.data.isCreditCardOnUPIRegistrationEnabledForNewToAmazonPayUPICustomersTreatment;this.shouldDisplayCreditCardBanks=
b.data.shouldDisplayCreditCardBanks;this.enableCallbackRedirectionBehavior=b.data.enableCallbackRedirectionBehavior;this.returnUrlPostParams=b.data.returnUrlPostParams},_toggleUPIRegistrationContainer:function(a){0<this.getDOMElement(this.upiRegistrationDropdownContainer).length&&n.toggleElement(this.getDOMElement(this.upiRegistrationDropdownContainer),a)},_toggleUncheckAPBtoEnableUPIMessage:function(a){var b=this.getDOMElement(this.upiRegistrationDisabledApbMessageContainer);0<b.length&&n.toggleElement(b,
a)},_getUpiRegistrationSelectedBank:function(){var a=this.getDOMElement(this.upiBankSelectDropdown);return 0<a.length?a[0].value:""},_invalidatePaymentPlan:function(){this.setContinuable(!1);this.widget.trigger("PaymentPlanSelected",{isValid:!1})},_triggerUpiRegistrationSelection:function(){if(this.isUpiRegistrationSelected){this.isUpiRegistrationUsable?(this._toggleUncheckAPBtoEnableUPIMessage(this.isAPBSelected),this._toggleUPIRegistrationContainer(!this.isAPBSelected),this.setContinuable(!this.isAPBSelected)):
this._invalidatePaymentPlan();var a=this.isAPBSelected?"":this._getUpiRegistrationSelectedBank();this.widget.trigger("UpiActionChangeEvent",{isUpiValidationContainerSelected:!1,selectedBank:a,redirectUrl:this.redirectUrl,returnUrl:this.returnUrl,failureReturnUrl:this.failureReturnUrl,purchaseId:this.purchaseId,isPurchaseIdRequired:this.isPurchaseIdRequired,areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,clientId:this.clientId,httpMethod:this.httpMethod})}},_isBankSelected:function(){return""!==
this._getUpiRegistrationSelectedBank()},_handleUPIRedirectionForUpiRegistration:function(a){var b=l.getCurrentTime();this.widget.trigger(t.showSpinner);l.logCounterMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",resource:"_Count"});e.upiRegistration(a,{redirectUrl:this.redirectUrl,returnUrl:this.returnUrl,failureReturnUrl:this.failureReturnUrl},this.purchaseId,this.clientId,this.httpMethod,{areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,isPurchaseIdRequired:this.isPurchaseIdRequired,
isAPBSelected:this.isAPBSelected,giftCardId:this.giftCardId,storedValueId:this.storedValueId,enableGetReturnHttpMethod:this.enableGetReturnHttpMethod,enableOrderIdInClientContext:this.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:this.enableMultiTenderContextInUPIRedirectionClientContext,orderId:this.orderId,enableCallbackRedirectionBehavior:this.enableCallbackRedirectionBehavior,returnUrlPostParams:this.returnUrlPostParams})?l.logCounterMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",
resource:"_SuccessCount"}):l.logCounterMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",resource:"_ErrorCount"});l.logLatencyMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",resource:"_Latency",startTime:b});l.publishMetrics()},_moveToDefaultViewOfBottomSheet:function(){var a=this.getDOMElement("upi-bank-selection-bottom-sheet-top-marker");a&&a[0]&&a[0].scrollIntoView({behavior:"auto"})},bindToEvents:function(){var a=this;g.bind(c.prototype.bindToEvents,this).apply();
a.widget.on("ValidateUpiIdResultEvent",this,function(a){this.isUpiValidated=a.isContinuable});a.widget.on("componentsInitialized",a,function(){var b=a.getDOMElement(a.upiActionDropdown);0<b.length&&b.trigger("change");b=a.getDOMElement(a.upiBankSelectDropdown);a.isOnlyRegistrationDisplayable&&0<b.length&&a.isUpiRegistrationUsable&&b.trigger("change");a.isUpiValidated=!1});a.widget.on("apbSelectionChanged",a,function(b){a.widget.get("apbCheckboxSelected")!==x&&(a.isUPIInBoxWeblabEnabled||a.isApxReloadEnabled||
!a.isUpiAPBMultiTenderEnabled?a.isUPIInBoxWeblabEnabled&&(a.isAPBSelected=b.isSelected,a.giftCardId=b.giftCardId,a.storedValueId=b.storedValueId):(a.isAPBSelected=b.isSelected,a._triggerUpiRegistrationSelection()))})},bindToElements:function(){var a=this;g.bind(c.prototype.bindToElements,this).apply();a.$topBanksList=this.getDOMElementsByPrefix("upiTopBanks-list-item-");a.$allBanksList=this.getDOMElementsByPrefix("upiAllBanks-list-item-");a.$ccBanksList=this.getDOMElementsByPrefix("upiCCBanks-list-item-");
a.$topBanksHeader=this.getDOMElement("upiTopBanks-title");a.$allBanksHeader=this.getDOMElement("upiAllBanks-title");a.$ccBanksHeader=this.getDOMElement("upiCCBanks-title");a.$noBankFoundText=this.getDOMElement("no-bank-found");var f=!1,e=a.getDOMElement(a.upiBankSelectDropdown);0<e.length&&e.bind("change",function(){a.isUpiRegistrationSelected=!0;a.setContinuable(!0);a.widget.trigger("UpiBankSelectionChangeEvent",{selectedBank:a._getUpiRegistrationSelectedBank(),redirectUrl:a.redirectUrl,returnUrl:a.returnUrl,
failureReturnUrl:a.failureReturnUrl,purchaseId:a.purchaseId,isPurchaseIdRequired:a.isPurchaseIdRequired,areReturnUrlsSentByClient:a.areReturnUrlsSentByClient,clientId:a.clientId,httpMethod:a.httpMethod})});e=a.getDOMElement(a.upiActionDropdown);0<e.length&&e.bind("change",function(){var b=this.value;"upi-registration"===b?(a.isUpiRegistrationSelected=!0,a._triggerUpiRegistrationSelection()):"upi-acceptance"===b&&(a.isUpiRegistrationSelected=!1,a.setContinuable(a.isUpiValidated),a._toggleUncheckAPBtoEnableUPIMessage(!1),
a.widget.trigger("UpiActionChangeEvent",{isUpiValidationContainerSelected:!0}),a._toggleUPIRegistrationContainer(!1))});a.getDOMElementsByPrefix("apx-bottom-sheet-scroll-to-top-button").click(function(b){a._moveToDefaultViewOfBottomSheet()});F.when("A","a-sheet","ready").execute("bottom-sheet-events",function(c,e){a.getDOMElement("js-binding-upi-registration-box").click(function(c){g.forEach(v("input[type\x3dradio][name\x3dppw-instrumentRowSelection]"),function(a){a.checked=!1});a.widget.trigger(b,
{instrumentId:"UPIRegistration"});if(!a.isPspBspConvergenceWeblabEnabled){c={name:"upi-registration-bank-selection-bottom-sheet",height:400,preloadDomId:"upi-registration-bank-selection-bottom-sheet-id",closeType:"icon",sheetLabel:"Registration Bank Selection Bottom sheet header",sheetDescription:"Registration Bank Selection Bottom sheet content"};var f=e.get("upi-registration-bank-selection-bottom-sheet");f?f.show():(e.create(c),e.get("upi-registration-bank-selection-bottom-sheet").show());l.logCounterMetric({feature:"isCreditCardForNewToAmazonPayRegistrationEnabledForRetail_"+
a.isCreditCardOnUPIRegistrationEnabledForNewToAmazonPayUPICustomersTreatment,resource:"_Count"});l.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"UpiGetStartedLink",ActionValueType:"isCreditCardForNewToAmazonPayRegistrationEnabledForRetail",ActionParentValueType:"WeblabTreatment",ActionParentValue:"isCreditCardForNewToAmazonPayRegistrationEnabledForRetail_"+a.isCreditCardOnUPIRegistrationEnabledForNewToAmazonPayUPICustomersTreatment});a.shouldDisplayCreditCardBanks&&k.recordWeblabTrigger("IN_APX_PSP_UPI_ENABLE_CREDIT_CARD_REGISTRATION_FOR_NEW_TO_UPI_CUSTOMERS_802317",
a.isCreditCardOnUPIRegistrationEnabledForNewToAmazonPayUPICustomersTreatment)}l.logCounterMetric({feature:"PspBspConvergence_"+a.pspBspConvergenceWeblabTreatment,resource:"_Count"});l.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"UpiGetStartedLink",ActionValueType:"PspBspConvergence",ActionParentValueType:"WeblabTreatment",ActionParentValue:"PspBspConvergence_"+a.pspBspConvergenceWeblabTreatment});k.recordWeblabTrigger("IN_APX_PSP_BSP_AIPS_CONVERGENCE_747406",a.pspBspConvergenceWeblabTreatment);
a.isPspBspConvergenceWeblabEnabled&&a._handleUPIRedirectionForUpiRegistration()});c.on("a:sheet:beforeShow:upi-registration-bank-selection-bottom-sheet",function(b){n.showElement(a.getDOMElement("upi-registration-bank-selection-bottom-sheet-content"));n.enableTextInput(a.getDOMElement("search-bank-text-box-input"));a.bottomSheetOpenTime=l.getCurrentTime();a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankStart",ActionValueType:"UpiSearchBank",ActionParentValueType:"OtherUpiPaymentMethod",
ActionParentValue:"UpiInBoxPspRegistration"})});c.declarative("bankSearchDeclarativeActionRegistration","keyup",function(){f=!0;a.$topBankAvailable=0;a.$allBankAvailable=0;var b,e="";a.getDOMElement("search-bank-text-box-input").val()&&(e=a.getDOMElement("search-bank-text-box-input").val().toUpperCase());g.forEach(a.$topBanksList,function(f){b=f.getElementsByClassName("upi-bank-selection-bank-name-element-section")[0].innerText.toUpperCase();f.classList.add("aok-offscreen");c.contains(b,e)&&(f.classList.remove("aok-offscreen"),
a.$topBankAvailable++)});g.forEach(a.$allBanksList,function(f){b=f.getElementsByClassName("upi-bank-selection-bank-name-element-section")[0].innerText.toUpperCase();f.classList.add("aok-offscreen");c.contains(b,e)&&(f.classList.remove("aok-offscreen"),a.$allBankAvailable++)});g.forEach(a.$ccBanksList,function(f){b=f.getElementsByClassName("upi-bank-selection-bank-name-element-section")[0].innerText.toUpperCase();f.classList.add("aok-offscreen");c.contains(b,e)&&(f.classList.remove("aok-offscreen"),
a.$ccBankAvailable++)});0===a.$topBankAvailable?a.$topBanksHeader.addClass("aok-offscreen"):a.$topBanksHeader.removeClass("aok-offscreen");0===a.$allBankAvailable?a.$allBanksHeader.addClass("aok-offscreen"):a.$allBanksHeader.removeClass("aok-offscreen");0===a.$ccBankAvailable?a.$ccBanksHeader.addClass("aok-offscreen"):a.$ccBanksHeader.removeClass("aok-offscreen");0===a.$topBankAvailable&&0===a.$allBankAvailable?(n.showElement(a.$noBankFoundText),l.logCounterMetric({feature:"UPI_PSP_REG_NoBankFoundWhenSearchBoxUsed",
resource:"_ErrorCount"}),l.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"UpiSearchBankInProgress",ActionValueType:"UpiSearchBank",ActionValue:"BankNotFoundInList",ActionErrorCode:"NO_BANK_FOUND",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"UpiInBoxPspRegistration"})):n.hideElement(a.$noBankFoundText)})});g.forEach(["upiTopBanks-list-item-","upiAllBanks-list-item-","upiCCBanks-list-item-"],function(b){a.getDOMElementsByPrefix(b).click(function(b){l.logLatencyMetric({feature:"UpiInBoxPspRegistrationBottomSheet",
resource:"_Latency",startTime:this.bottomSheetOpenTime});f?l.logCounterMetric({feature:"UPI_PSP_REG_BankSelectCompletedUsingSearchBox",resource:"_SuccessCount"}):l.logCounterMetric({feature:"UPI_PSP_REG_BankSelectCompletedWithoutUsingSearchBox",resource:"_SuccessCount"});l.publishMetrics();v(".a-sheet-close").click();var c=v(b.currentTarget);b=c&&c.data("bank-code")?c.data("bank-code"):"";c=c&&c[0].innerText?c[0].innerText:"";if(a.getDOMElement("search-bank-text-box-input").val())var e=a.getDOMElement("search-bank-text-box-input").val().length;
f?a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionUsingSearchBox",ActionErrorCode:c+" inputSize "+e,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"UpiInBoxPspRegistrationBottomSheet"}):a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionWithoutUsingSearchBox",ActionErrorCode:c,ActionParentValueType:"OtherUpiPaymentMethod",
ActionParentValue:"UpiInBoxPspRegistrationBottomSheet"});f=!1;a._handleUPIRedirectionForUpiRegistration(b)})})}})});r("components/ValidateUpiComponent",["form-component","css-utils","continuable","lang"],function(c,k,n,q){var g,h,l,t,e,v,b,a,f,w,u,p,C,B,A,z,D,d,y,E,I,J,m,K=!1,r=!1,L="false",G="",x="",H,M;return c.extend(n,{initialize:function(d,y){g=y.data.JsBindingEncryptedVpaInput;h=y.data.JsBindingValidateVpaButton;l=y.data.JsBindingAlertSuccess;t=y.data.JsBindingAlertFailure;e=y.data.JsBindingVerifiedVpaWarningMessage;
v=y.data.JsBindingVerifiedVpaErrorMessage;b=y.data.JsBindingSectionSuccess;a=y.data.JsBindingInputHelpTextSection;K=y.data.isPayWithBankAccountWithBottomSheetEnabled;f=y.data.JsBindingVpaToken;w=y.data.JsBindingPaymentMethodId;u=y.data.JsBindingValidateSuccessHelpTextSection;p=y.data.JsBindingRecurringInlineTextSection;r=y.data.isRecurringInlineMessageDisplayable;H=null;M=!1},bindToElements:function(){var c=this;C=this.getDOMElement(g);B=this.getDOMElement(h);A=this.getDOMElement(l);z=this.getDOMElement(t);
D=this.getDOMElement(e);d=this.getDOMElement(v);y=this.getDOMElement(b);E=this.getDOMElement(a);I=this.getDOMElement(f);$paymentMethodId=this.getDOMElement(w);J=this.getDOMElement(u);m=this.getDOMElement(p);this.watchContinuable(this,function(d){c.widget.trigger("ValidateUpiIdResultEvent",{isContinuable:d,isUpiRecurringEligible:M});c._doesInputContainValidVpa()&&c._displaySuccessMessage("",G,x);c.widget.log({event:"PaymentPlanSelected",details:{isValid:d,paymentMethod:"ValidateUPI"}});c.widget.trigger("PaymentPlanSelected",
{isValid:d})});C.live("input propertychange",function(){c._setInputHelpTextVisible(!0);c.setContinuable(c._doesInputContainValidVpa()&&"false"===L);c._doesInputContainValidVpa()&&c._displaySuccessMessage("",G,x)});c.setContinuable(c._doesInputContainValidVpa()&&"false"===L);C.focusout(this._canonicalizeInputTextField);B.click(function(){C.focusout();var d=c.form.validateForm();if(0<d.length)c._displayFormErrorMessages(d),c.widget.trigger("ValidateUpiIdResultEvent",{isContinuable:!1,isUpiRecurringEligible:!1});
else{var a=C.val();c.widget.trigger("submitFormAjaxStarted");c.widget.continueRequest({"ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"ValidateUpiIdEvent",__sif_encryptedVPA_collect:a},{success:function(d){var b=d.additionalWidgetResponseData.additionalData.valid,y=d.additionalWidgetResponseData.additionalData.message,f=d.additionalWidgetResponseData.additionalData.vpaToken;M="true"===d.additionalWidgetResponseData.additionalData.isUpiRecurringEligible;var e=d.additionalWidgetResponseData.additionalData.paymentMethodId;
L=d.additionalWidgetResponseData.additionalData.shouldSuppressValidatedVpa;G=d.additionalWidgetResponseData.additionalData.verifiedVpaWarningMessage;x=d.additionalWidgetResponseData.additionalData.verifiedVpaErrorMessage;"true"===b?(H=a,c._setVpaTokenField(f),c._setPaymentMethodId(e),c.setContinuable("false"===L),c._displaySuccessMessage(y,G,x),K&&"false"===L&&c.widget.trigger("UpiIdValidateSuccess",{validatedUpiId:H,vpaToken:f,paymentMethodId:e,isUpiRecurringEligible:M,shouldAutoCloseBottomSheet:!(G||
x)})):"false"===b?(H=null,c.setContinuable(!1),c._displayErrorMessage(y)):y&&(H=null,c.setContinuable(!0),c._displayErrorMessage(y))},complete:function(){c.widget.trigger("submitFormAjaxCompleted")}})}return!1})},_doesInputContainValidVpa:function(){return H&&H===C.val()},_displayFormErrorMessages:function(a){0!==a.length&&(a=a[0],z.find(".a-alert-content").html(a.localizedMessageString),this.form.displayErrorMessage(a.field,z),k.hideElement(y),k.hideElement(E),k.hideElement(D),k.hideElement(d))},
_displayVerifiedVpaMessage:function(d,a){d?(a.find(".a-alert-content").html(d),k.showElement(a)):k.hideElement(a)},_displayErrorMessage:function(d){z.find(".a-alert-content").html(d);k.showElement(z);k.hideElement(y);k.hideElement(E)},_displaySuccessMessage:function(a,b,c){a&&A.find(".a-alert-content").html(a);(!K||b||c)&&k.showElement(y);M&&r?(k.showElement(m),k.hideElement(J)):(k.hideElement(m),k.showElement(J));this._displayVerifiedVpaMessage(b,D);this._displayVerifiedVpaMessage(c,d);b||c?k.hideElement(J):
k.showElement(J);k.hideElement(z);k.hideElement(E)},_setInputHelpTextVisible:function(a){a?(k.showElement(E),k.hideElement(y),k.hideElement(z),k.hideElement(D),k.hideElement(d)):k.hideElement(E)},_canonicalizeInputTextField:function(){var d=q.trim(C.val());C.val(d)},_setVpaTokenField:function(d){I.val(d)},_setPaymentMethodId:function(d){$paymentMethodId.val(d)}})});r("components/SelectableUpiListComponent","AUI!P component lang clog upiEvents sdkUtil deviceSignatureUtil".split(" "),function(c,k,n,
q,g,h,l){return k.extend({isDeviceSignatureAlreadyChecked:!1,isSavedHandleComponentUsable:!1,useAmazonJsForDeviceSignatureCheck:!1,numberOfSavedHandles:0,savedHandleIndexes:[],isServerSideDeviceSignatureCheckEnabled:!1,isProd:!0,apxSandbox:"",initialize:function(c,e){this.isSavedHandleComponentUsable=e.data.isSavedHandleComponentUsable;this.useAmazonJsForDeviceSignatureCheck=e.data.useAmazonJsForDeviceSignatureCheck;this.numberOfSavedHandles=e.data.numberOfSavedHandles;this.isServerSideDeviceSignatureCheckEnabled=
e.data.isServerSideDeviceSignatureCheckEnabled;this.isProd=e.data.isProd;this.apxSandbox=e.data.apxSandbox},bindToEvents:function(){var c=this;n.bind(k.prototype.bindToEvents,this).apply();c.widget.on(g.JuspayCheckDeviceSignatureEventName,c,function(e,l){c.savedHandleIndexes.includes(e)||c.savedHandleIndexes.push(e);c.isDeviceSignatureAlreadyChecked||(c.isDeviceSignatureAlreadyChecked=!0,h.getIsJuspaySdkCallEligible()?h.getIsDeviceSignatureCheckEligible()?h.checkDeviceSignature(c,e,l,h.juspayHandleDeviceSignatureMatchesHandler,
h.juspayHandleDeviceSignatureDoesNotMatchHandler,h.juspayErrorHandler):c.widget.trigger(g.NoDevicePermissionsEventName):c.widget.trigger(g.ErrorEventName))});c.widget.on(g.CheckDeviceSignatureEventName,c,function(e,h,b){var a=function(a,b){return"undefined"!==typeof a?a:b},f=function(b,c,f){c=a(c,!0);f=a(f,"_Count");c&&(q.logCounterMetric({feature:b,resource:f}),q.publishMetrics())},w=function(b,c,f){if(f=a(f,!0))q.logCounterMetric({feature:b,resource:"_Latency",startTime:c}),q.publishMetrics()};
f("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",b);this.deviceSignatureCheckStartTime=q.getCurrentTime();var t=function(){f("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",b,"_SuccessCount");w("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",c.deviceSignatureCheckStartTime,b)},p=function(a){c.widget.trigger(g.DeviceFingerprintValidationPerformedEventName,{outcome:"SUCCESS"===a.status?a.status:a.responseCode,performedOn:c.deviceSignatureCheckStartTime,currentHandleIndex:e,totalHandleIndexes:c.numberOfSavedHandles});
f("SelectableUpiJsCalls_DFValidationPerformedEvent",b);c.isSavedHandleComponentUsable&&("SUCCESS"===a.status?(c.widget.trigger(g.DeviceSignatureMatchesEventName,e,a.deviceSignature),t(),f("SelectableUpiAmazonJsCalls_DeviceSignatureCheck_SignatureMatch",b)):"DEVICE_SIGNATURE_MISMATCH"===a.responseCode?(c.widget.trigger(g.DeviceSignatureDoesNotMatchEventName,e),t(),f("SelectableUpiAmazonJsCalls_DeviceSignatureCheck_SigMismatch",b)):"PERMISSION_NOT_GRANTED"===a.responseCode?(c.widget.trigger(g.NoDevicePermissionsEventName,
e),t(),f("SelectableUpiAmazonJsCalls_DeviceSignatureCheck_NoPermissions",b)):this.isSavedHandleComponentUsable&&(c.widget.trigger(g.ErrorEventName),f("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",b,"_ErrorCount"),w("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",c.deviceSignatureCheckStartTime,b)))};c.isServerSideDeviceSignatureCheckEnabled?p({status:"SUCCESS",deviceSignature:h}):l.checkDeviceSignature(h,p)});c.widget.on("componentsInitialized",c,function(){this.useAmazonJsForDeviceSignatureCheck?
(!c.isProd&&m.location.toString().includes(c.apxSandbox)&&c.widget.trigger(g.DeviceSignatureCheckMockEventNameForApxSandbox),h.checkUPIIssuanceSupportedForJsLibApps(this)):(q.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_Count"}),q.publishMetrics(),this.sdkCallStartTime=q.getCurrentTime(),h.initializeDeviceSignatureCheck(this,h.juspayHasPermissionsHandler,h.juspayHasNoPermissionsHandler,h.juspayErrorHandler),h.checkUPIIssuanceSupported(this));this.isSavedHandleComponentUsable&&c.widget.trigger(g.GetPaymentMethodDetailsByIdEventName)})}})});
r("components/SelectableUpiListItemComponent","component continuable events/InstrumentRowSelectedEvent events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/InstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent public-event-registry css-utils components/SimplePaymentOptionListItemComponent lang upi-redirection-util clog events/spinner-events AwaitingEventStatusConstants upiEnums paymentMethodUtil checkBalanceUtil commonUtil eagerInitUtil jQuery".split(" "),
function(c,k,n,q,g,h,l,t,e,v,b,a,f,w,u,p,C,B,A,z,D){return v.extend(k,{selectableUpiContainer:"",upiDisabledApbMessageContainer:"",upiHeadingDiv:"",upiBankDetailsHeadingDiv:"",isNomenclatureWave1Enabled:!1,upiAutoDeselectApbMessageContainer:"",upiInfoContainer:"",isUpiUsable:!0,instrumentId:"",instrumentType:"",isAPBSelected:!1,savedHandleIndex:"0",isPinChosen:!1,mPinLength:"",issuingPsp:"",responseClientContext:"",paymentMethodIdVersion:"",merchantCustomerId:"",deviceSignature:"",isDeviceSignatureValid:null,
isPermanentDisabled:!0,isAIPSRedirectRequired:null,redirectUrl:"",returnUrl:"",failureReturnUrl:"",purchaseId:"",isUpiIssuanceAPBMultiTenderEnabled:"",isUpiSavedHandleAPBMultiTenderEligible:!1,clientId:"",marketPlaceId:"",isApxReloadEnabled:!1,areReturnUrlsSentByClient:!1,isPurchaseIdRequired:!1,isUpiRegistrationEnabled:!1,isUpiAIPSRedirectionWithMTEnabled:!1,upiPermanentDisabledMessageContainer:"",incorrectUpiPinErrorMessageContainer:"",incorrectUpiPinLimitBreachedContainer:"",userAbortsUpfrontErrorContainer:"",
insufficientBalanceUpfrontErrorContainer:"",httpMethod:"",isMergedInlineView:!1,isTurboView:!1,sdkCallStatus:null,instrumentPreparationStatus:null,isAwaitingInstrumentPrepare:!1,continueClickTime:null,hasContinueTimedOut:!1,failureReason:null,errorMessage:null,isFirstTimeInstrumentSelection:!0,isApbAutoDeselectedOnce:!1,isAutoDeselectApbForUpiIssuanceEnabled:!1,isRecurringChargePaymentMethod:!1,orderId:"",enableGetReturnHttpMethod:!1,enableOrderIdInClientContext:!1,enableMultiTenderContextInUPIRedirectionClientContext:!1,
enableCallbackRedirectionBehavior:!1,aipsOnboardingEndpointUrl:"",upiCheckBalanceTurboInlineErrorMessage:"",upiCheckBalanceEnabledContainer:"",upiCheckBalanceEnabledTextId:"",incorrectUpiPinCta:"",incorrectUpiPinLimitBreachedCta:"",userAbortsMpinCta:"",insufficientBalanceCta:"",upiCheckingBalanceEnabledContainer:"",upiAccountBalanceEnabledContainer:"",upiAccountBalanceDisplayEnabledContainer:"",upiCheckBalanceEnabled:!1,npciKey:"",customerVpa:"",bankAccountUniqueId:"",getPMS2SCallStatus:"",customerMobileNumber:"",
bankName:"",bankTail:"",$checkBalanceLabel:"",$checkingBalanceLabel:"",$accountBalanceLabel:"",$accountBalanceDisplayLabel:"",$checkBalanceTextId:"",$incorrectUpiPinCta:"",$incorrectUpiPinLimitBreachedCta:"",$userAbortsMpinCta:"",$insufficientBalanceCta:"",$checkBalanceErrorBottomSheet:"",upiCheckBalanceErrorBottomSheetPreloadDomId:"",upiCheckBalanceWrongMpinContainer:"",upiCheckBalanceMaxRetriesExceededContainer:"",upiCheckBalanceScreenRecordingOnContainer:"",upiCheckBalanceTimeoutErrorContainer:"",
upiCheckBalanceGenericErrorContainer:"",upiAmazonPayBalance:0,upiMaybeAdjustedPurchaseTotal:0,isApbAndUpiBalanceMoreThanPurchaseTotal:!1,upiCheckBalanceUpfrontInsufficientBalanceMessageContainer:"",upiCheckBalanceUpfrontRetriesExceededMessageContainer:"",upiCheckBalanceUpfrontRetriesExceededResetHere:"",upiCheckBalanceWrongMpinInlineTryAgain:"",upiCheckBalanceScreenRecordingOnInlineTryAgain:"",upiCheckBalanceNoResponseBankInlineTryAgain:"",upiCheckBalanceGenericErrorInlineTryAgain:"",revisePaymentFailureReason:"",
revisePaymentInstrumentId:"",hasPinBeenReset:!1,isUpiDisabledDueToUpfrontErrorMessage:!1,isUpiPreselectedInTurbo:!1,$topBankAvailable:0,$allBankAvailable:0,$ccBankAvailable:0,$topBanksList:"",$allBanksList:"",$ccBanksList:"",$topBanksHeader:"",$allBanksHeader:"",$ccBanksHeader:"",$noBankFoundText:"",bottomSheetOpenTime:null,incorrectUpiPinEntered:!1,incorrectUpiPinMaxRetriesExceeded:!1,userAborted:!1,isInsufficientBalanceRevisePaymentsView:!1,delegateUpiProcessing:!1,$incorrectUpiPinErrorMessageContainerWrapper:"",
$incorrectUpiPinLimitBreachedContainerWrapper:"",$insufficientBalanceUpfrontErrorContainerWrapper:"",$userAbortsUpfrontErrorContainerWrapper:"",eagerInitNpciClWeblabTreatment:"",revisePaymentsGenericErrorMsgWeblabTreatment:"",revisePaymentsUserAbortsErrorMsgWeblabTreatment:"",upiPaymentMethodCategory:x,isPrimarySavedHandle:!1,pspMaBspConvergenceWeblabTreatment:"",isCreditCardOnUPIRegistrationEnabledForRetailTreatment:"",isPspMaBspConvergenceWeblabEnabled:!1,isPspBspConvergenceWeblabEnabled:!1,isUPIInBoxWeblabEnabled:!1,
enableUpi1pforApxSandbox:!1,isDfpMismatchErrorMessageAvailableForCheckBalance:!1,isDfpMismatchViolationPresent:!1,upiCheckBalanceUpfrontDfpMismatchContainer:"",upiCheckBalanceUpfrontDfpMismatchCtaContainer:"",shouldDisplayCreditCardBanks:!1,returnUrlPostParams:"",initialize:function(d,a){this.isUpiUsable=a.data.isUpiUsable;this.instrumentId=a.data.instrumentId;this.instrumentType=a.data.instrumentType;this.selectableUpiContainer=a.data.selectableUpiContainer;this.upiDisabledApbMessageContainer=a.data.upiDisabledApbMessageContainer;
this.upiHeadingDiv=a.data.upiHeadingDiv;this.upiBankDetailsHeadingDiv=a.data.upiBankDetailsHeadingDiv;this.isNomenclatureWave1Enabled=a.data.isNomenclatureWave1Enabled;this.upiAutoDeselectApbMessageContainer=a.data.upiAutoDeselectApbMessageContainer;this.upiInfoContainer=a.data.upiInfoContainer;this.savedHandleIndex=a.data.savedHandleIndex;this.isPinChosen=a.data.isPinChosen;this.mPinLength=a.data.mPinLength;this.issuingPsp=a.data.issuingPsp;this.bankName=a.data.bankName;this.bankTail=a.data.bankTail;
this.marketPlaceId=a.data.marketPlaceId;this.merchantCustomerId=a.data.merchantCustomerId;this.deviceSignature=a.data.deviceSignature;this._toggleUncheckAPBtoEnableUPIMessage(!1);this._toggleUPIInfoContainer(!1);this.redirectUrl=a.data.redirectUrl;this.returnUrl=a.data.returnUrl;this.failureReturnUrl=a.data.failureReturnUrl;this.purchaseId=a.data.purchaseId;this.orderId=a.data.orderId;this.isPurchaseIdRequired=a.data.isPurchaseIdRequired;this.areReturnUrlsSentByClient=a.data.areReturnUrlsSentByClient;
this.isUpiIssuanceAPBMultiTenderEnabled=a.data.isUpiIssuanceAPBMultiTenderEnabled;this.clientId=a.data.clientId;this.isApxReloadEnabled=a.data.isApxReloadEnabled;this.isUpiRegistrationEnabled=a.data.isUpiRegistrationEnabled;this.upiPermanentDisabledMessageContainer=a.data.upiPermanentDisabledMessageContainer;this.incorrectUpiPinErrorMessageContainer=a.data.incorrectUpiPinErrorMessageContainer;this.incorrectUpiPinLimitBreachedContainer=a.data.incorrectUpiPinLimitBreachedContainer;this.userAbortsUpfrontErrorContainer=
a.data.userAbortsUpfrontErrorContainer;this.insufficientBalanceUpfrontErrorContainer=a.data.insufficientBalanceUpfrontErrorContainer;this.upiSdkCallFailedMessageContainer=a.data.upiSdkCallFailedMessageContainer;this.isPaylastEligible=a.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=a.data.showFloatingContinueBarOnNonPaylastPSP;this.isAmazonApp=a.data.isAmazonApp;this.httpMethod=a.data.httpMethod;this.isMergedInlineView=a.data.isMergedInlineView;this.isTurboView=a.data.isTurboView;
this.isAutoDeselectApbForUpiIssuanceEnabled=a.data.isAutoDeselectApbForUpiIssuanceEnabled;this.isSavedHandleOriginallySelectable=a.data.isSavedHandleOriginallySelectable;this.handleSavedHandleContinueError=a.data.handleSavedHandleContinueError;this.sdkCallStatus=p.SdkCallStatusEnum.Pending;this.instrumentPreparationStatus=u.Pending;this.errorMessage=[this._buildErrorMessage()];this.isRecurringChargePaymentMethod=a.data.isRecurringChargePaymentMethod;this.enableGetReturnHttpMethod=a.data.enableGetReturnHttpMethod;
this.enableOrderIdInClientContext=a.data.enableOrderIdInClientContext;this.enableMultiTenderContextInUPIRedirectionClientContext=a.data.enableMultiTenderContextInUPIRedirectionClientContext;this.enableCallbackRedirectionBehavior=a.data.enableCallbackRedirectionBehavior;this.aipsOnboardingEndpointUrl=a.data.aipsOnboardingEndpointUrl;this.upiCheckBalanceEnabledContainer=a.data.upiCheckBalanceEnabledContainer;this.upiCheckBalanceEnabledTextId=a.data.upiCheckBalanceEnabledTextId;this.incorrectUpiPinCta=
a.data.incorrectUpiPinCta;this.incorrectUpiPinLimitBreachedCta=a.data.incorrectUpiPinLimitBreachedCta;this.userAbortsMpinCta=a.data.userAbortsMpinCta;this.insufficientBalanceCta=a.data.insufficientBalanceCta;this.upiCheckingBalanceEnabledContainer=a.data.upiCheckingBalanceEnabledContainer;this.upiAccountBalanceEnabledContainer=a.data.upiAccountBalanceEnabledContainer;this.upiAccountBalanceDisplayEnabledContainer=a.data.upiAccountBalanceDisplayEnabledContainer;this.upiCheckBalanceEnabled=a.data.upiCheckBalanceEnabled;
this.getPMS2SCallStatus=p.GetPMCallStatusEnum.Pending;this.upiCheckBalanceErrorBottomSheetPreloadDomId=a.data.upiCheckBalanceErrorBottomSheetPreloadDomId;this.upiCheckBalanceWrongMpinContainer=a.data.upiCheckBalanceWrongMpinContainer;this.upiCheckBalanceMaxRetriesExceededContainer=a.data.upiCheckBalanceMaxRetriesExceededContainer;this.upiCheckBalanceScreenRecordingOnContainer=a.data.upiCheckBalanceScreenRecordingOnContainer;this.upiCheckBalanceTimeoutErrorContainer=a.data.upiCheckBalanceTimeoutErrorContainer;
this.upiCheckBalanceGenericErrorContainer=a.data.upiCheckBalanceGenericErrorContainer;this.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer=a.data.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer;this.upiCheckBalanceUpfrontRetriesExceededMessageContainer=a.data.upiCheckBalanceUpfrontRetriesExceededMessageContainer;this.upiCheckBalanceUpfrontRetriesExceededResetHere=a.data.upiCheckBalanceUpfrontRetriesExceededResetHere;this.upiCheckBalanceWrongMpinInlineTryAgain=a.data.upiCheckBalanceWrongMpinTryAgain;
this.upiCheckBalanceScreenRecordingOnInlineTryAgain=a.data.upiCheckBalanceScreenRecordingOnTryAgain;this.upiCheckBalanceNoResponseBankInlineTryAgain=a.data.upiCheckBalanceNoResponseFromBankTryAgain;this.upiCheckBalanceGenericErrorInlineTryAgain=a.data.upiCheckBalanceGenericErrorTryAgain;this.upiCheckBalanceTurboInlineErrorMessage=a.data.upiCheckBalanceTurboInlineErrorMessage;this.upiAmazonPayBalance=a.data.upiAmazonPayBalance;this.upiMaybeAdjustedPurchaseTotal=a.data.upiMaybeAdjustedPurchaseTotal;
this.revisePaymentFailureReason=a.data.revisePaymentFailureReason;this.revisePaymentInstrumentId=a.data.revisePaymentInstrumentId;this.isUpiPreselectedInTurbo=a.data.isUpiPreselectedInTurbo;this.hasPinBeenReset=(new URL(m.location.href)).searchParams.get("pinResetSuccessful")||!1;this.eagerInitNpciClWeblabTreatment=a.data.eagerInitNpciClWeblabTreatment;this.revisePaymentsGenericErrorMsgWeblabTreatment=a.data.revisePaymentsGenericErrorMsgWeblabTreatment;this.revisePaymentsUserAbortsErrorMsgWeblabTreatment=
a.data.revisePaymentsUserAbortsErrorMsgWeblabTreatment;this.delegateUpiProcessing=a.data.delegateUpiProcessing;this.upiPaymentMethodCategory=a.data.upiPaymentMethodCategory;this.isPrimarySavedHandle=a.data.isPrimarySavedHandle;this.pspMaBspConvergenceWeblabTreatment=a.data.pspMaBspConvergenceWeblabTreatment;this.isCreditCardOnUPIRegistrationEnabledForRetailTreatment=a.data.isCreditCardOnUPIRegistrationEnabledForRetailTreatment;this.isPspMaBspConvergenceWeblabEnabled=a.data.isPspMaBspConvergenceWeblabEnabled;
this.isUPIInBoxWeblabEnabled=a.data.isUPIInBoxWeblabEnabled;this.enableUpi1pforApxSandbox=a.data.enableUpi1pforApxSandbox;this.isUpiAIPSRedirectionWithMTEnabled=a.data.isUpiAIPSRedirectionWithMTEnabled;this.isDfpMismatchErrorMessageAvailableForCheckBalance=a.data.isDfpMismatchErrorMessageAvailableForCheckBalance;this.isDfpMismatchViolationPresent=a.data.isDfpMismatchViolationPresent;this.upiCheckBalanceUpfrontDfpMismatchContainer=a.data.upiCheckBalanceUpfrontDfpMismatchContainer;this.upiCheckBalanceUpfrontDfpMismatchCtaContainer=
a.data.upiCheckBalanceUpfrontDfpMismatchCtaContainer;this.shouldDisplayCreditCardBanks=a.data.shouldDisplayCreditCardBanks;this.returnUrlPostParams=a.data.returnUrlPostParams;this.isAmazonApp&&this.isSavedHandleOriginallySelectable&&this.isUpiUsable?(this.isPermanentDisabled=!1,this.isUpiSavedHandleAPBMultiTenderEligible=this.isUpiIssuanceAPBMultiTenderEnabled):this.isAmazonApp?this.setDisabled(!0):this.isAIPSRedirectRequired=this.isPermanentDisabled=!1;this.isUpiUsable&&(this.isUpiSavedHandleAPBMultiTenderEligible=
this.isUpiIssuanceAPBMultiTenderEnabled,t.register(n));this.isUpiPreselectedInTurbo&&this._onInstrumentSelected();this.$incorrectUpiPinErrorMessageContainerWrapper=this.getDOMElement(this.incorrectUpiPinErrorMessageContainer);this.$incorrectUpiPinLimitBreachedContainerWrapper=this.getDOMElement(this.incorrectUpiPinLimitBreachedContainer);this.$insufficientBalanceUpfrontErrorContainerWrapper=this.getDOMElement(this.insufficientBalanceUpfrontErrorContainer);this.$userAbortsUpfrontErrorContainerWrapper=
this.getDOMElement(this.userAbortsUpfrontErrorContainer);this.upiCheckBalanceEnabled&&(this.$checkBalanceLabel=this.getDOMElement(this.upiCheckBalanceEnabledContainer),this.$checkingBalanceLabel=this.getDOMElement(this.upiCheckingBalanceEnabledContainer),this.$accountBalanceLabel=this.getDOMElement(this.upiAccountBalanceEnabledContainer),this.$accountBalanceDisplayLabel=this.getDOMElement(this.upiAccountBalanceDisplayEnabledContainer),this.isDfpMismatchErrorMessageAvailableForCheckBalance&&this.isDfpMismatchViolationPresent&&
(this._toggleCheckBalanceContainer(!1),this._toggleUpiCheckBalanceDfpMismatchMessage(!0)))},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._toggleUPIInfoContainer(!0);!this.isUpiSavedHandleAPBMultiTenderEligible&&this.isAPBSelected&&this.isAutoDeselectApbForUpiIssuanceEnabled&&this._setFlagAndToggleMsgForAutoDeselectApb();this._triggerBackingInstrumentSelectedEvent();(this.isPaylastEligible||
this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();this.getDOMElement("UpiRecurringInlineMessage")[0]&&this.showPaymentMethodInlineMessage();this.isTurboView&&this.upiCheckBalanceEnabled&&this.isAIPSRedirectRequired&&this._toggleCheckBalanceContainer(!1);z.performNpciClEagerInit(this.eagerInitNpciClWeblabTreatment,this._isInstrumentSelected(),this.sdkCallStatus,this._isUpiRedirectionRequired(),!1,this._getMetadata())},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!1);this._toggleUPIInfoContainer(!1);this._toggleUpiAutoDeselectAPBMessage(!1);this.getDOMElement("UpiRecurringInlineMessage")[0]&&this.hidePaymentMethodInlineMessage()},_isInstrumentSelected:function(){return this.isMergedInlineView?!0:this._getContainerElement().hasClass("pmts-selected")},showPaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!0)},hidePaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!1)},
_togglePaymentMethodInlineMessage:function(d){e.toggleElement(this.getDOMElement("UpiRecurringInlineMessage"),d)},_getContainerElement:function(){return this.getDOMElement(this.selectableUpiContainer)},_isUpiBalanceShown:function(){var d=this.getDOMElement(this.upiAccountBalanceEnabledContainer);return d!==x&&0<d.length&&!e.hasAUIHiddenClass(d)},_isCheckBalanceUpFrontErrorMessageShown:function(){var d=!1,a=this.getDOMElement(this.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer),b=this.getDOMElement(this.upiCheckBalanceUpfrontRetriesExceededMessageContainer);
a!==x&&0<a.length&&!e.hasAUIHiddenClass(a)?d=!0:b!==x&&0<b.length&&!e.hasAUIHiddenClass(b)&&(d=!0);return d},_toggleUPIContainer:function(d){var a=this._getContainerElement();0<a.length&&e.toggleElement(a,d)},_toggleCheckBalanceContainer:function(d){var a=this.getDOMElement(this.upiCheckBalanceEnabledContainer);a!==x&&0<a.length&&e.toggleElement(a,d)},_toggleCheckingBalanceContainer:function(d){var a=this.getDOMElement(this.upiCheckingBalanceEnabledContainer);a!==x&&0<a.length&&e.toggleElement(a,
d)},_toggleUncheckAPBtoEnableUPIMessage:function(d){var a=this.getDOMElement(this.upiDisabledApbMessageContainer);0<a.length&&e.toggleElement(a,d)},_toggleUpiInsufficientBalance:function(d){var a=this.getDOMElement(this.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer);a!==x&&0<a.length&&e.toggleElement(a,d)},_toggleUpiUpfrontRetriesExceededErrorMessage:function(d){var a=this.getDOMElement(this.upiCheckBalanceUpfrontRetriesExceededMessageContainer);a!==x&&0<a.length&&e.toggleElement(a,d)},
_toggleUpiCheckBalanceTurboInlineErrorMessage:function(d){var a=this.getDOMElement(this.upiCheckBalanceTurboInlineErrorMessage);a!==x&&0<a.length&&e.toggleElement(a,d)},_toggleRevisePaymentUpfrontErrorMessageContainer:function(d,a){d!==x&&0<d.length&&e.toggleElement(d,a)},_toggleUPIInfoContainer:function(d){var a=this.getDOMElement(this.upiInfoContainer);0<a.length&&e.toggleElement(a,d)},_toggleUPIPermanentDisabledMessage:function(d){var a=this.getDOMElement(this.upiPermanentDisabledMessageContainer);
0<a.length&&e.toggleElement(a,d)},_toggleUPISdkCallFailedMessage:function(d){var a=this.getDOMElement(this.upiSdkCallFailedMessageContainer);0<a.length&&e.toggleElement(a,d)},_toggleUpiAutoDeselectAPBMessage:function(d){var a=this.getDOMElement(this.upiAutoDeselectApbMessageContainer);0<a.length&&e.toggleElement(a,d)},_toggleUpiCheckBalanceDfpMismatchMessage:function(d){var a=this.getDOMElement(this.upiCheckBalanceUpfrontDfpMismatchContainer);0<a.length&&e.toggleElement(a,d)},_triggerUpiRedirectionRequiredEvent:function(){this.widget.trigger("UpiRedirectionRequiredEvent")},
_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:[],paymentMethod:this.data.paymentMethod,isUpiRedirectionRequired:this._isUpiRedirectionRequired(),paystationPaymentMethodCategory:this.upiPaymentMethodCategory});this._publishMetricsOnInstrumentSelection()},_isUpiRedirectionRequired:function(){return!1!==this.isAIPSRedirectRequired},_publishMetricsOnInstrumentSelection:function(){this.isSavedHandleOriginallySelectable&&
this.isFirstTimeInstrumentSelection&&(this.sdkCallStatus===p.SdkCallStatusEnum.Pending?f.logCounterMetric({feature:"SavedHandleSdkCallPendingOnSelection",resource:"_Count"}):f.logCounterMetric({feature:"SavedHandleSdkCallCompletedOnSelection",resource:"_Count"}),f.publishMetrics(),this.isFirstTimeInstrumentSelection=!1)},_invalidatePaymentPlan:function(){this.setContinuable(!1);this.widget.trigger("PaymentPlanSelected",{isValid:!1})},_setAPBSelectionChanged:function(d){if(!this.isAutoDeselectApbForUpiIssuanceEnabled||
this.isApbAutoDeselectedOnce)!this.isUpiUsable||this.isPermanentDisabled||this.isUpiSavedHandleAPBMultiTenderEligible?this.isUpiUsable&&!this.isPermanentDisabled&&this.isUpiSavedHandleAPBMultiTenderEligible&&this.isApbAndUpiBalanceMoreThanPurchaseTotal&&this._isUpiBalanceShown()&&(this._toggleUpiInsufficientBalance(!d),this.isUpiDisabledDueToUpfrontErrorMessage=!d,this.setDisabled(!d)):(this._isInstrumentSelected()&&d&&(this._invalidatePaymentPlan(),this._toggleUpiAutoDeselectAPBMessage(!1)),this._isUpiBalanceShown()||
this.isDfpMismatchErrorMessageAvailableForCheckBalance&&this.isDfpMismatchViolationPresent||this._toggleCheckBalanceContainer(!d),this.isDfpMismatchErrorMessageAvailableForCheckBalance&&this.isDfpMismatchViolationPresent&&this._toggleUpiCheckBalanceDfpMismatchMessage(!d),this.isTurboView&&this.upiCheckBalanceEnabled&&this.isAIPSRedirectRequired&&this._hideAllCheckBalanceRelatedLabel(),this._isCheckBalanceUpFrontErrorMessageShown()||(this.setDisabled(d),this.isNomenclatureWave1Enabled&&(d?(this.getDOMElement(this.upiHeadingDiv).addClass("apx-disabled-opacity"),
this.getDOMElement(this.upiBankDetailsHeadingDiv).addClass("apx-disabled-opacity")):(this.getDOMElement(this.upiHeadingDiv).removeClass("apx-disabled-opacity"),this.getDOMElement(this.upiBankDetailsHeadingDiv).removeClass("apx-disabled-opacity"))),this._toggleUncheckAPBtoEnableUPIMessage(d),this.incorrectUpiPinEntered?this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$incorrectUpiPinErrorMessageContainerWrapper,!d):this.incorrectUpiPinMaxRetriesExceeded?this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$incorrectUpiPinLimitBreachedContainerWrapper,
!d):this.userAborted&&this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$userAbortsUpfrontErrorContainerWrapper,!d))),this._setInstrumentPreparationStatus()},_updateFlagsAndWidgetStateOnTerminalSdkResponse:function(){this.isUpiSavedHandleAPBMultiTenderEligible=this.isAIPSRedirectRequired?this.isUpiIssuanceAPBMultiTenderEnabled&&this.isUpiRegistrationEnabled&&(this.isApxReloadEnabled||this.isUpiAIPSRedirectionWithMTEnabled):this.isUpiIssuanceAPBMultiTenderEnabled;this.delegateUpiProcessing&&
this.widget.trigger("updateDeviceSignatureCheckStatus",{deviceSignatureCheckStatus:this.sdkCallStatus});this._setInstrumentPreparationStatus();this._publishMetricsOnSdkCallCompletion();this._autoDeselectApbIfMultitenderNotSupported();z.performNpciClEagerInit(this.eagerInitNpciClWeblabTreatment,this._isInstrumentSelected(),this.sdkCallStatus,this._isUpiRedirectionRequired(),this.isAwaitingInstrumentPrepare,this._getMetadata());this._triggerInstrumentPreparedEvent();this.sdkCallStatus===p.SdkCallStatusEnum.Error||
this.isAIPSRedirectRequired&&!this.isUpiRegistrationEnabled?this._setDisabled(!0):(this._setEnabled(),this.isTurboView&&this.upiCheckBalanceEnabled&&this.isAIPSRedirectRequired&&this._hideAllCheckBalanceRelatedLabel(),this.revisePaymentInstrumentId===this._getInstrumentId()&&this._handleRevisePaymentsErrorCX());this._setAPBSelectionChanged(this.isAPBSelected)},_handleRevisePaymentsErrorCX:function(){"InsufficientFunds"===this.revisePaymentFailureReason&&A.recordWeblabTriggerAndReturn(this.revisePaymentGenericErrorMsgWeblab,
this.revisePaymentsGenericErrorMsgWeblabTreatment)&&this.revisePaymentsGenericErrorMsgWeblabTreatment!=p.WeblabTreatment.C&&(this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$insufficientBalanceUpfrontErrorContainerWrapper,!0),this._shouldHideCheckBalanceContainer(this.revisePaymentsGenericErrorMsgWeblabTreatment),this.isInsufficientBalanceRevisePaymentsView=!0);this.hasPinBeenReset||("AuthenticationDenied"===this.revisePaymentFailureReason?(A.recordWeblabTrigger(this.revisePaymentGenericErrorMsgWeblab,
this.revisePaymentsGenericErrorMsgWeblabTreatment),this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$incorrectUpiPinErrorMessageContainerWrapper,!0),this._shouldHideCheckBalanceContainer(this.revisePaymentsGenericErrorMsgWeblabTreatment),this.incorrectUpiPinEntered=!0):"MaxRetriesExceeded"===this.revisePaymentFailureReason?(A.recordWeblabTrigger(this.revisePaymentGenericErrorMsgWeblab,this.revisePaymentsGenericErrorMsgWeblabTreatment),this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$incorrectUpiPinLimitBreachedContainerWrapper,
!0),this._shouldHideCheckBalanceContainer(this.revisePaymentsGenericErrorMsgWeblabTreatment),this.incorrectUpiPinMaxRetriesExceeded=!0):"AuthenticationAborted"===this.revisePaymentFailureReason&&A.recordWeblabTriggerAndReturn(this.revisePaymentUserAbortsErrorMsgWeblab,this.revisePaymentsUserAbortsErrorMsgWeblabTreatment)&&this.revisePaymentsUserAbortsErrorMsgWeblabTreatment!=p.WeblabTreatment.C&&(this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$userAbortsUpfrontErrorContainerWrapper,!0),
this._shouldHideCheckBalanceContainer(this.revisePaymentsUserAbortsErrorMsgWeblabTreatment),this.userAborted=!0))},_shouldHideCheckBalanceContainer:function(d){d===p.WeblabTreatment.T1&&this._toggleCheckBalanceContainer(!1)},_setInstrumentPreparationStatus:function(){this.sdkCallStatus===p.SdkCallStatusEnum.Error?(this.instrumentPreparationStatus=u.Failure,this.failureReason=p.FailureReasonEnum.SdkError):this.isAIPSRedirectRequired&&!this.isUpiRegistrationEnabled?(this.instrumentPreparationStatus=
u.Failure,this.failureReason=p.FailureReasonEnum.AIPSRedirectionNotEnabled):this._isInstrumentSelected()&&this.isAPBSelected&&!this.isUpiSavedHandleAPBMultiTenderEligible?(this.instrumentPreparationStatus=u.Failure,this.failureReason=p.FailureReasonEnum.MultitenderNotSupported):(this.instrumentPreparationStatus=this.sdkCallStatus===p.SdkCallStatusEnum.Pending?u.Pending:this.delegateUpiProcessing&&this.getPMS2SCallStatus===p.GetPMCallStatusEnum.Pending?u.Pending:u.Success,this.failureReason=null);
this.errorMessage=[this._buildErrorMessage()]},_buildErrorMessage:function(){return this.handleSavedHandleContinueError&&this.instrumentPreparationStatus!==u.Success?this.failureReason===p.FailureReasonEnum.SdkError?this.widget.getLocalizedString("apx_upi_savedHandle_continue_sdk_error"):this.failureReason===p.FailureReasonEnum.AIPSRedirectionNotEnabled?this.widget.getLocalizedString("apx_upi_savedHandle_continue_redirection_error"):this.failureReason===p.FailureReasonEnum.MultitenderNotSupported?
this.widget.getLocalizedString("apx_upi_savedHandle_continue_multi_tender_error"):this.widget.getLocalizedString("apx_upi_savedHandle_continue_error"):null},_triggerInstrumentPreparedEvent:function(){this.isSavedHandleOriginallySelectable&&this._isInstrumentSelected()&&this.isAwaitingInstrumentPrepare&&(!this.delegateUpiProcessing||this.getPMS2SCallStatus!==p.GetPMCallStatusEnum.Pending)&&this.widget.trigger(h,{instrumentId:this._getInstrumentId(),instrumentPreparationStatus:this.instrumentPreparationStatus,
isUpiRedirectionRequired:this._isUpiRedirectionRequired(),failureReason:this.failureReason,errorMessage:this.errorMessage})},_publishMetricsOnSdkCallCompletion:function(){if(this.isSavedHandleOriginallySelectable){var d=this.continueClickTime?"AfterContinue":"BeforeContinue";this.hasContinueTimedOut&&(d="AfterContinueTimedout");this.sdkCallStatus!==p.SdkCallStatusEnum.Completed||this.isAIPSRedirectRequired||f.logCounterMetric({feature:"SavedHandleHappyCase_"+d,resource:"_Count"});this.sdkCallStatus===
p.SdkCallStatusEnum.Completed&&this.isAIPSRedirectRequired&&f.logCounterMetric({feature:"SavedHandleUnhappyCase_"+d,resource:"_Count"});this.sdkCallStatus===p.SdkCallStatusEnum.Error&&f.logCounterMetric({feature:"SavedHandleSdkError_"+d,resource:"_Count"});this.continueClickTime&&(this.sdkCallStatus===p.SdkCallStatusEnum.Error?f.logLatencyMetric({feature:"SavedHandleSdkCallError_"+d,resource:"_Latency",startTime:this.continueClickTime}):f.logLatencyMetric({feature:"SavedHandleSdkCallSuccess_"+d,resource:"_Latency",
startTime:this.continueClickTime}),f.logLatencyMetric({feature:"SavedHandleSdkCallCompletion_AfterContinue_Overall",resource:"_Latency",startTime:this.continueClickTime}));f.publishMetrics()}},_autoDeselectApbIfMultitenderNotSupported:function(){this.isAutoDeselectApbForUpiIssuanceEnabled&&this._isInstrumentSelected()&&this.isAPBSelected&&!this.isUpiSavedHandleAPBMultiTenderEligible&&!this.isAwaitingInstrumentPrepare&&(this._setFlagAndToggleMsgForAutoDeselectApb(),this._triggerUpiRedirectionRequiredEvent())},
_setDisabled:function(d){if(!this.isSavedHandleOriginallySelectable||this.handleSavedHandleContinueError)this._isInstrumentSelected()&&this._invalidatePaymentPlan(),this.isPermanentDisabled=!0,this.setDisabled(!0),this._toggleCheckBalanceContainer(!1),d&&(this.failureReason===p.FailureReasonEnum.SdkError?this._toggleUPISdkCallFailedMessage(!0):this._toggleUPIPermanentDisabledMessage(!0))},_setEnabled:function(){this.isSavedHandleOriginallySelectable||(this.isPermanentDisabled=!1,this.setDisabled(!1))},
_handlePreparedInstrumentContinueError:function(d){d===u.TimedOut&&(this.hasContinueTimedOut=!0,f.logCounterMetric({feature:"SavedHandleSdkCallTimedOut",resource:"_Count"}),f.publishMetrics());this.isAwaitingInstrumentPrepare=!1;this.failureReason===p.FailureReasonEnum.MultitenderNotSupported?this._handleMultitenderContinueErrorCase():this.failureReason===p.FailureReasonEnum.SdkError?this._setDisabled(!0):this._setDisabled(!1)},_handleMultitenderContinueErrorCase:function(){this.isAutoDeselectApbForUpiIssuanceEnabled?
(this._setFlagAndToggleMsgForAutoDeselectApb(),this._triggerUpiRedirectionRequiredEvent()):this._setAPBSelectionChanged(this.isAPBSelected)},_setFlagAndToggleMsgForAutoDeselectApb:function(){this.isApbAutoDeselectedOnce=!0;this._toggleUpiAutoDeselectAPBMessage(this.isAPBSelected)},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_storeGetPMDetailsResponse:function(){this.getPMS2SCallStatus===
p.GetPMCallStatusEnum.Completed?this.widget.trigger("storePaymentMethodDetailsResponse",{getPMS2SCallStatus:this.getPMS2SCallStatus,issuingPsp:this.issuingPsp,responseClientContext:this.responseClientContext,bankTail:this.bankTail,mPinLength:this.mPinLength,paymentMethodIdVersion:this.paymentMethodIdVersion,deviceSignature:this.deviceSignature,npciKey:this.npciKey,customerVpa:this.customerVpa,bankAccountUniqueId:this.bankAccountUniqueId,customerMobileNumber:this.customerMobileNumber,bankName:this.bankName,
instrumentId:this.instrumentId}):this.widget.trigger("storePaymentMethodDetailsResponse",{getPMS2SCallStatus:this.getPMS2SCallStatus})},_removeGetPMDetailsResponse:function(){this.widget.trigger("removePaymentMethodDetailsResponse",{instrumentId:this.instrumentId})},_getMetadata:function(){return{clientName:"APX",clientId:this.clientId,merchantCustomerId:this.merchantCustomerId}},_moveToDefaultViewOfBottomSheet:function(){var d=this.getDOMElement("upi-bank-selection-bottom-sheet-top-marker");d&&d[0]&&
d[0].scrollIntoView({behavior:"auto"})},bindToEvents:function(){var d=this;b.bind(v.prototype.bindToEvents,this).apply();b.forEach(["initializeRecommendedInstrument",n],function(a){d.widget.on(a,d,function(a){a.instrumentId!==d._getInstrumentId()||!d.isUpiUsable||d.isAPBSelected&&!d.isUpiSavedHandleAPBMultiTenderEligible?(d._onInstrumentDeselected(),d.delegateUpiProcessing&&d._removeGetPMDetailsResponse()):(d._onInstrumentSelected(),d.delegateUpiProcessing&&d._storeGetPMDetailsResponse())})});d.widget.on("apbSelectionChanged",
d,function(a){d.widget.get("apbCheckboxSelected")!==x&&(d.isAPBSelected=a.isSelected,d._setAPBSelectionChanged(d.isAPBSelected),d.giftCardId=a.giftCardId,d.storedValueId=a.storedValueId)});d.widget.on("DeviceSignatureMatchesEvent",d,function(a,b){d.isUpiUsable&&d.savedHandleIndex===a&&(d.sdkCallStatus=p.SdkCallStatusEnum.Completed,this.isDeviceSignatureValid=d.deviceSignature===b,this.isAIPSRedirectRequired=!(this.isDeviceSignatureValid&&this.isPinChosen),this.isPrimarySavedHandle&&this.upiCheckBalanceEnabled&&
this.isDfpMismatchErrorMessageAvailableForCheckBalance&&(this.isDfpMismatchViolationPresent?f.logCounterMetric({feature:"DfpMismatchViolationPresent_And_DfpMatched",resource:"_Count"}):f.logCounterMetric({feature:"DfpMismatchViolationNotPresent_And_DfpMatched",resource:"_Count"})),d._updateFlagsAndWidgetStateOnTerminalSdkResponse())});d.widget.on("DeviceSignatureDoesNotMatchEvent",d,function(a){d.isUpiUsable&&d.savedHandleIndex===a&&(d.sdkCallStatus=p.SdkCallStatusEnum.Completed,d.isDeviceSignatureValid=
!1,d.isAIPSRedirectRequired=!0,this.isPrimarySavedHandle&&this.upiCheckBalanceEnabled&&this.isDfpMismatchErrorMessageAvailableForCheckBalance&&(this.isDfpMismatchViolationPresent?f.logCounterMetric({feature:"DfpMismatchViolationPresent_And_DfpMismatched",resource:"_Count"}):f.logCounterMetric({feature:"DfpMismatchViolationNotPresent_And_DfpMismatched",resource:"_Count"})),d._updateFlagsAndWidgetStateOnTerminalSdkResponse())});d.widget.on("JuspayHasPermissionsEvent",d,function(){d.widget.trigger("JuspayCheckDeviceSignatureEvent",
this.savedHandleIndex,this.deviceSignature)});d.widget.on("NoDevicePermissionsEvent",d,function(){d.isUpiUsable&&(d.sdkCallStatus=p.SdkCallStatusEnum.Completed,d.isAIPSRedirectRequired=!0,d._updateFlagsAndWidgetStateOnTerminalSdkResponse())});d.widget.on("ErrorEvent",d,function(){d.sdkCallStatus=p.SdkCallStatusEnum.Error;d.isAIPSRedirectRequired=!1;d._updateFlagsAndWidgetStateOnTerminalSdkResponse()});d.widget.on("InitializeDeviceSignatureCheckEvent",d,function(){null!=this.isPrimarySavedHandle&&
d.widget.trigger("CheckDeviceSignatureEvent",this.savedHandleIndex,this.deviceSignature,this.isPrimarySavedHandle)});d.widget.on("DeviceSignatureCheckMockEventNameForApxSandbox",d,function(){this.enableUpi1pforApxSandbox&&(this.isAIPSRedirectRequired=!1,d.widget.trigger("DeviceSignatureMatchesEvent",this.savedHandleIndex,this.deviceSignature))});d.widget.on("GetPaymentMethodDetailsByIdEvent",d,function(){if(this.delegateUpiProcessing){var a=f.getCurrentTime();f.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",
resource:"_Count"});f.publishMetrics();C.getPaymentMethodDetailsById({payerPaymentMethodId:d.instrumentId,obfuscatedMarketplaceId:d.marketPlaceId,url:d.aipsOnboardingEndpointUrl},function(b){"SUCCESS"===b.status?(d.getPMS2SCallStatus=p.GetPMCallStatusEnum.Completed,d.issuingPsp=b.issuingPsp,d.responseClientContext=b.clientContext,d.bankTail=b.payerBankTail,d.mPinLength=b.payerMpinLength,d.paymentMethodIdVersion=b.version,d.npciKey=b.npciKey,d.customerVpa=b.payerVpa,d.bankAccountUniqueId=b.payerBankAccountUniqueId,
d.customerMobileNumber=b.payerMobileNumber,d.bankName=b.payerBankName,f.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",resource:"_SuccessCount"})):(d.getPMS2SCallStatus=p.GetPMCallStatusEnum.Error,f.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch_"+b.responseCode,resource:"_ErrorCount"}),f.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",resource:"_ErrorCount"}));f.logLatencyMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",
resource:"_Latency",startTime:a});f.publishMetrics();d._isInstrumentSelected()&&d._storeGetPMDetailsResponse();d.sdkCallStatus===p.SdkCallStatusEnum.Error?(d.instrumentPreparationStatus=u.Failure,d._triggerInstrumentPreparedEvent()):d.sdkCallStatus===p.SdkCallStatusEnum.Completed&&(d.instrumentPreparationStatus=u.Success,d._triggerInstrumentPreparedEvent())})}else return!1});d.widget.on(q,d,function(a){d.isSavedHandleOriginallySelectable&&d._isInstrumentSelected()&&(this.instrumentPreparationStatus===
u.Pending?(d.widget.trigger(g,{errorMessage:d.errorMessage}),this.isAwaitingInstrumentPrepare=!0):(this.isAwaitingInstrumentPrepare=!0,d._triggerInstrumentPreparedEvent(),this.isAwaitingInstrumentPrepare=!1))});d.widget.on(l,d,function(a){d.handleSavedHandleContinueError&&d._isInstrumentSelected()&&d._handlePreparedInstrumentContinueError(a.reason?a.reason:u.UnknownFailure)});b.forEach(["ContinueButtonClicked","SecondaryContinueButtonClicked","CompleteWidget"],function(a){d.widget.on(a,d,function(a){d.isSavedHandleOriginallySelectable&&
d._isInstrumentSelected()&&(d.continueClickTime=f.getCurrentTime(),f.logCounterMetric({feature:"SavedHandleSelectedAtContinueClick",resource:"_Count"}),f.logCounterMetric({feature:"SavedHandleSelectedAtContinueClick_Index"+d.savedHandleIndex,resource:"_Count"}),d.sdkCallStatus===p.SdkCallStatusEnum.Pending&&f.logCounterMetric({feature:"SavedHandleSdkCallPendingAtContinueClick",resource:"_Count"}),f.publishMetrics());z.performNpciClEagerInit(d.eagerInitNpciClWeblabTreatment,d._isInstrumentSelected(),
d.sdkCallStatus,d._isUpiRedirectionRequired(),!0,d._getMetadata())})});d.widget.on("UpiRedirectionContinueEvent",d,function(){d._isInstrumentSelected()&&d._callUpiRedirectionEvent(d);return!1});d.widget.on("UPIIssuanceNotSupportedEvent",d,function(){d._toggleUPIContainer(!1)});d.widget.on("UPIIssuanceSupportedEvent",d,function(){d._toggleUPIContainer(!0)})},_callUpiRedirectionEvent:function(d){f.getCurrentTime();d.widget.trigger(w.showSpinner);f.logCounterMetric({feature:"SelectableUpiAipsRedirection",
resource:"_Count"});f.logCounterMetric({feature:"SelectableUpiAipsRedirection_Index"+d.savedHandleIndex,resource:"_Count"});this.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiAipsRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(d._getInstrumentId())});d.isDeviceSignatureValid?d.isPinChosen||d._redirectToSetPin("SelectableUpiAipsRedirectionPinNotSet",""):d._redirectToDeviceVerification(!1);f.publishMetrics()},_isSavedHandleInstrumentSelectionEligible:function(d){var a=
!d.isAPBSelected||d.isUpiSavedHandleAPBMultiTenderEligible?!0:d.isAutoDeselectApbForUpiIssuanceEnabled&&!d.isApbAutoDeselectedOnce;return d._isInstrumentSelected()||!d.isUpiUsable||d.isPermanentDisabled||!a||d.isUpiDisabledDueToUpfrontErrorMessage?!1:!0},bindToElements:function(){var a=this;a.isUpiUsable&&a._getContainerElement().click(function(){a._isSavedHandleInstrumentSelectionEligible(a)&&a._triggerInstrumentRowSelectedEvent()});a.$checkBalanceLabel=this.getDOMElement(this.upiCheckBalanceEnabledContainer);
a.$checkingBalanceLabel=this.getDOMElement(this.upiCheckingBalanceEnabledContainer);a.$accountBalanceLabel=this.getDOMElement(this.upiAccountBalanceEnabledContainer);a.$accountBalanceDisplayLabel=this.getDOMElement(this.upiAccountBalanceDisplayEnabledContainer);a.$checkBalanceTextId=this.getDOMElement(this.upiCheckBalanceEnabledTextId);a.$incorrectUpiPinCta=this.getDOMElement(this.incorrectUpiPinCta);a.$incorrectUpiPinLimitBreachedCta=this.getDOMElement(this.incorrectUpiPinLimitBreachedCta);a.$userAbortsMpinCta=
this.getDOMElement(this.userAbortsMpinCta);a.$insufficientBalanceCta=this.getDOMElement(this.insufficientBalanceCta);a.$topBanksList=this.getDOMElementsByPrefix("upiTopBanks-list-item-");a.$allBanksList=this.getDOMElementsByPrefix("upiAllBanks-list-item-");a.$ccBanksList=this.getDOMElementsByPrefix("upiCCBanks-list-item-");a.$topBanksHeader=this.getDOMElement("upiTopBanks-title");a.$allBanksHeader=this.getDOMElement("upiAllBanks-title");a.$ccBanksHeader=this.getDOMElement("upiCCBanks-title");a.$noBankFoundText=
this.getDOMElement("no-bank-found");var c=!1;a.$checkBalanceTextId.click(function(){a._showCheckingBalanceLabel();a._callCheckBalance(a);a._tempEmitCheckBalanceClickMetricWeblabComparison()});a.getDOMElement(this.upiCheckBalanceWrongMpinInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});a.getDOMElement(this.upiCheckBalanceScreenRecordingOnInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();
a._callCheckBalance(a)});a.getDOMElement(this.upiCheckBalanceNoResponseBankInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});a.getDOMElement(this.upiCheckBalanceGenericErrorInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});a.getDOMElement("apx-link-another-bank-account-section-js-label").click(function(){f.logCounterMetric({feature:"PspMaBspConvergence_"+a.pspMaBspConvergenceWeblabTreatment,
resource:"_Count"});f.logCounterMetric({feature:"isCreditCardOnUPIRegistrationEnabledForRetail_"+a.isCreditCardOnUPIRegistrationEnabledForRetailTreatment,resource:"_Count"});f.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"UpiLinkBankAccount",ActionValueType:"PspMaBspConvergence",ActionParentValueType:"WeblabTreatment",ActionParentValue:"PspMaBspConvergence_"+a.pspMaBspConvergenceWeblabTreatment});a.widget.publishSuccessSushiMetrics({ActionType:"UpiLinkBankAccount",ActionValueType:"isCreditCardOnUPIRegistrationEnabledForRetail",
ActionParentValueType:"WeblabTreatment",ActionParentValue:"isCreditCardOnUPIRegistrationEnabledForRetail_"+a.isCreditCardOnUPIRegistrationEnabledForRetailTreatment});a.shouldDisplayCreditCardBanks&&A.recordWeblabTrigger("IN_APX_PSP_UPI_ENABLE_CREDIT_CARD_REGISTRATION_788410",a.isCreditCardOnUPIRegistrationEnabledForRetailTreatment);a.isUPIInBoxWeblabEnabled?A.recordWeblabTrigger("IN_APX_PSP_BSP_AIPS_CONVERGENCE_747406",a.pspMaBspConvergenceWeblabTreatment):A.recordWeblabTrigger("IN_APX_PSP_MA_BSP_AIPS_CONVERGENCE_753596",
a.pspMaBspConvergenceWeblabTreatment);a.isPspMaBspConvergenceWeblabEnabled&&a._handleUPIRedirectionForLinkAnotherBankAccount()});a.getDOMElement(this.upiCheckBalanceUpfrontRetriesExceededResetHere).click(function(){a._redirectToSetPin("SelectableUpiUpfrontRedirectResetPin","")});a.$incorrectUpiPinCta.click(function(){a._redirectToSetPin("SelectableUpiAipsRedirectionResetPin",a.revisePaymentsGenericErrorMsgWeblabTreatment)});a.$incorrectUpiPinLimitBreachedCta.click(function(){a._redirectToSetPin("SelectableUpiAipsRedirectionResetPin",
a.revisePaymentsGenericErrorMsgWeblabTreatment)});a.$userAbortsMpinCta.click(function(){a._redirectToSetPin("SelectableUpiAipsRedirectionResetPin",a.revisePaymentsUserAbortsErrorMsgWeblabTreatment)});a.$insufficientBalanceCta.click(function(){e.toggleElement(a.$insufficientBalanceUpfrontErrorContainerWrapper,!1);a._showCheckingBalanceLabel();a._callCheckBalance(a);a._tempEmitCheckBalanceClickMetricWeblabComparison()});a.getDOMElement(this.upiCheckBalanceUpfrontDfpMismatchCtaContainer).click(function(){a._redirectToDeviceVerification(!0)});
a.getDOMElementsByPrefix("apx-bottom-sheet-scroll-to-top-button").click(function(d){a._moveToDefaultViewOfBottomSheet()});F.when("A","a-sheet","ready").execute("bottom-sheet-events",function(d,g){d.on("a:sheet:beforeShow:apx-link-another-bank-account-bottom-sheet",function(d){e.showElement(a.getDOMElement("apx-link-another-bank-account-bottom-sheet-content"));e.enableTextInput(a.getDOMElement("search-bank-text-box-input"));a.bottomSheetOpenTime=f.getCurrentTime();a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankStart",
ActionValueType:"UpiSearchBank",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"LinkAnotherBankAccount"})});d.declarative("bankSearchDeclarativeActionLBA","keyup",function(){c=!0;a.$topBankAvailable=0;a.$allBankAvailable=0;var g,l="";a.getDOMElement("search-bank-text-box-input").val()&&(l=a.getDOMElement("search-bank-text-box-input").val().toUpperCase());b.forEach(a.$topBanksList,function(b){g=b.getElementsByClassName("upi-bank-selection-bank-name-element-section")[0].innerText.toUpperCase();
b.classList.add("aok-offscreen");d.contains(g,l)&&(b.classList.remove("aok-offscreen"),a.$topBankAvailable++)});b.forEach(a.$allBanksList,function(b){g=b.getElementsByClassName("upi-bank-selection-bank-name-element-section")[0].innerText.toUpperCase();b.classList.add("aok-offscreen");d.contains(g,l)&&(b.classList.remove("aok-offscreen"),a.$allBankAvailable++)});b.forEach(a.$ccBanksList,function(b){g=b.getElementsByClassName("upi-bank-selection-bank-name-element-section")[0].innerText.toUpperCase();
b.classList.add("aok-offscreen");d.contains(g,l)&&(b.classList.remove("aok-offscreen"),a.$ccBankAvailable++)});0===a.$topBankAvailable?a.$topBanksHeader.addClass("aok-offscreen"):a.$topBanksHeader.removeClass("aok-offscreen");0===a.$allBankAvailable?a.$allBanksHeader.addClass("aok-offscreen"):a.$allBanksHeader.removeClass("aok-offscreen");0===a.$ccBankAvailable?a.$ccBanksHeader.addClass("aok-offscreen"):a.$ccBanksHeader.removeClass("aok-offscreen");0===a.$topBankAvailable&&0===a.$allBankAvailable?
(e.showElement(a.$noBankFoundText),f.logCounterMetric({feature:"LABA_NoBankFoundWhenSearchBoxUsed",resource:"_ErrorCount"}),f.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"UpiSearchBankInProgress",ActionValueType:"UpiSearchBank",ActionValue:"BankNotFoundInList",ActionErrorCode:"NO_BANK_FOUND",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"LinkAnotherBankAccount"})):e.hideElement(a.$noBankFoundText)})});b.forEach(["upiTopBanks-list-item-","upiAllBanks-list-item-",
"upiCCBanks-list-item-"],function(d){a.getDOMElementsByPrefix(d).click(function(d){f.logLatencyMetric({feature:"LinkAnotherBankAccountBottomSheet",resource:"_Latency",startTime:this.bottomSheetOpenTime});c?f.logCounterMetric({feature:"LABA_BankSelectCompletedUsingSearchBox",resource:"_SuccessCount"}):f.logCounterMetric({feature:"LABA_BankSelectCompletedWithoutUsingSearchBox",resource:"_SuccessCount"});f.publishMetrics();D(".a-sheet-close").click();var b=D(d.currentTarget);d=b&&b.data("bank-code")?
b.data("bank-code"):"";b=b&&b[0].innerText?b[0].innerText:"";if(a.getDOMElement("search-bank-text-box-input").val())var e=a.getDOMElement("search-bank-text-box-input").val().length;c?a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionUsingSearchBox",ActionErrorCode:b+" inputSize "+e,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"LinkAnotherBankAccount"}):a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",
ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionWithoutUsingSearchBox",ActionErrorCode:b,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"LinkAnotherBankAccount"});c=!1;a._handleUPIRedirectionForLinkAnotherBankAccount(d)})})},_tempEmitCheckBalanceClickMetricWeblabComparison:function(){this.revisePaymentInstrumentId===this._getInstrumentId()&&"InsufficientFunds"===this.revisePaymentFailureReason&&(f.logCounterMetric({feature:"SelectableUpi_InsufficientFunds_CheckBalance_"+
this.revisePaymentsGenericErrorMsgWeblabTreatment,resource:"_Count"}),f.publishMetrics())},_redirectToSetPin:function(d,b){var c=f.getCurrentTime(),e=this._getUPIRedirectionData(d);f.logCounterMetric({feature:d+b,resource:"_Count"});a.upiPinNotSet(this._getInstrumentId(),e.requiredUrls,this.purchaseId,this.clientId,this.httpMethod,e.conditionalArguments)?(f.logCounterMetric({feature:d,resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:d,ActionValueType:"PaymentInstrument",
ActionValue:String(this._getInstrumentId())})):(f.logCounterMetric({feature:d,resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:d,ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())}));f.logLatencyMetric({feature:d,resource:"_Latency",startTime:c});f.publishMetrics()},_redirectToDeviceVerification:function(d){var b=f.getCurrentTime(),c=this._getUPIRedirectionData("SelectableUpiAipsRedirection");d&&(c.conditionalArguments.skipRegistrationContext=
!0);f.logCounterMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Count"});a.upiDeviceFingerprintDoesNotMatch(this._getInstrumentId(),c.requiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.conditionalArguments)?(f.logCounterMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",ActionValueType:"PaymentInstrument",
ActionValue:String(this._getInstrumentId())})):(f.logCounterMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())}));f.logLatencyMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Latency",startTime:b})},_getUPIRedirectionData:function(a){var d=
this.returnUrl,b=this.failureReturnUrl;"SelectableUpiAipsRedirectionResetPin"===a&&(d=new URL(d),d.searchParams.append("pinResetSuccessful","true"),d=d.toString(),b&&""!=b&&(b=new URL(b),b.searchParams.append("pinResetSuccessful","true"),b=b.toString()));return{requiredUrls:{redirectUrl:this.redirectUrl,returnUrl:d,failureReturnUrl:b},conditionalArguments:{areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,isPurchaseIdRequired:this.isPurchaseIdRequired,isAPBSelected:this.isAPBSelected,giftCardId:this.giftCardId,
storedValueId:this.storedValueId,enableGetReturnHttpMethod:this.enableGetReturnHttpMethod,enableOrderIdInClientContext:this.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:this.enableMultiTenderContextInUPIRedirectionClientContext,orderId:this.orderId,issuingPsp:this.issuingPsp,skipRegistrationContext:!1,enableCallbackRedirectionBehavior:this.enableCallbackRedirectionBehavior,returnUrlPostParams:this.returnUrlPostParams}}},_handleUPIRedirectionForLinkAnotherBankAccount:function(d){var b=
f.getCurrentTime();this.widget.trigger(w.showSpinner);f.logCounterMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_Count"});var c=this._getUPIRedirectionData("LinkAnotherBankAccountAction");a.upiLinkAnotherBankAccount(d,c.requiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.conditionalArguments)?f.logCounterMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_SuccessCount"}):f.logCounterMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_ErrorCount"});
f.logLatencyMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_Latency",startTime:b});f.publishMetrics()},_callCheckBalance:function(a){a.checkBalanceStartTime=f.getCurrentTime();f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_Count"});f.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiCheckBalanceStart",ActionValueType:"CheckBalance",ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)});
if(a.sdkCallStatus===p.SdkCallStatusEnum.Pending||a.sdkCallStatus===p.SdkCallStatusEnum.Error)a._handleCheckBalanceFailureResponseCode(a),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_UpiSdkCall"+a.sdkCallStatus+"_FetchOnClick",resource:"_Count"}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:"DeviceSignaturePendingOrFailed",
ActionErrorCode:a.sdkCallStatus,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)});else if(a._isUpiRedirectionRequired()){f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"});f.logCounterMetric({feature:"SelectableUpi_CheckBalance_UpiRedReq_FetchOnClick",resource:"_Count"});var b="Unspecified";a.isDeviceSignatureValid?a.isPinChosen||(b="PIN_NOT_SET",a._callUpiRedirectionEvent(a)):(b="DEVICE_SIGNATURE_MISMATCH",a.isDfpMismatchErrorMessageAvailableForCheckBalance?
a._showCheckBalanceDfpErrorMessage(a):a._redirectToDeviceVerification(!1));a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:"UPI Redirection",ActionErrorCode:b,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}else a._isUpiRedirectionRequired()?(a._handleCheckBalanceFailureResponseCode(a),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_Unknown_FetchOnClick",
resource:"_Count"}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:"Failed due to Unknown Reason",ActionErrorCode:"UNKNOWN_ERROR",ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})):a.getPMS2SCallStatus===p.GetPMCallStatusEnum.Completed?(b=a._createPayloadForCheckBalance(a),a._callCheckBalanceAndHandleResponse(a,b),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCallPresent_FetchOnClick",
resource:"_Count"})):(f.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_Count"}),a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiGetPMByIdStart",ActionValueType:"GetPaymentMethodById",ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)}),C.getPaymentMethodDetailsById({payerPaymentMethodId:a.instrumentId,obfuscatedMarketplaceId:a.marketPlaceId,url:a.aipsOnboardingEndpointUrl},function(b){if("SUCCESS"===b.status){a.getPMS2SCallStatus=
p.GetPMCallStatusEnum.Completed;a.npciKey=b.npciKey;a.customerVpa=b.payerVpa;a.bankAccountUniqueId=b.payerBankAccountUniqueId;a.customerMobileNumber=b.payerMobileNumber;a.bankName=b.payerBankName;var d=a._createPayloadForCheckBalance(a);a._callCheckBalanceAndHandleResponse(a,d);f.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_SuccessCount"});f.logLatencyMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_Latency",startTime:a.checkBalanceStartTime});
a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiGetPMByIdCompleted",ActionValueType:"GetPaymentMethodById",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}else a.getPMS2SCallStatus=p.GetPMCallStatusEnum.Error,a._handleCheckBalanceFailureResponseCode(a),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),f.logLatencyMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",
resource:"_Latency",startTime:a.checkBalanceStartTime}),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_ErrorCount"}),f.logLatencyMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_Latency",startTime:a.checkBalanceStartTime}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiGetPMByIdCompleted",ActionValueType:"GetPaymentMethodById",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",
ActionParentValue:String(a.instrumentId)}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}));f.publishMetrics()},_callCheckBalanceAndHandleResponse:function(a,b){var d=a.checkBalanceStartTime,c=A.deleteWindowAppReappear();B.checkBalance(b,function(b){A.enableWindowAppReappear(c);if("SUCCESS"===
b.status){a._showAccountBalanceLabel();var e=Number(b.balance);e=e.toLocaleString("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2});a.$accountBalanceDisplayLabel.html(e);a._handleInsufficentBalanceCheck(a,Number(b.balance));f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_SuccessCount"});f.logLatencyMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_Latency",startTime:d});f.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",
ActionValueType:"CheckBalance",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}else a._handleCheckBalanceFailureResponseCode(a,b.responseCode),f.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),f.logLatencyMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_Latency",startTime:d}),f.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",
ActionValueType:"CheckBalance",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})})},_createPayloadForCheckBalance:function(a){return{deviceSignature:a.deviceSignature,paymentMethodId:a.instrumentId,npciKey:a.npciKey,customerVpa:a.customerVpa,bankAccountUniqueId:a.bankAccountUniqueId,obfuscatedMarketplaceId:a.marketPlaceId,payerMobileNumber:a.customerMobileNumber,payerMpinLength:a.mPinLength,payerBankName:a.bankName,
payerBankTail:a.bankTail,useCaseName:"CHECK_BALANCE",issuingPsp:a.issuingPsp,clientCategory:"PURCHASE",clientName:a.clientId,pageViewName:"APX",url:a.aipsOnboardingEndpointUrl,remarks:"Check Balance"}},_showCheckBalanceLabel:function(){e.hideElement(this.$checkingBalanceLabel);e.hideElement(this.$accountBalanceLabel);e.hideElement(this.$accountBalanceDisplayLabel);this.isInsufficientBalanceRevisePaymentsView?(this._toggleRevisePaymentUpfrontErrorMessageContainer(this.$insufficientBalanceUpfrontErrorContainerWrapper,
!0),e.hideElement(this.$checkBalanceLabel)):e.showElement(this.$checkBalanceLabel)},_showCheckingBalanceLabel:function(){e.hideElement(this.$checkBalanceLabel);e.showElement(this.$checkingBalanceLabel);e.hideElement(this.$accountBalanceLabel);e.hideElement(this.$accountBalanceDisplayLabel)},_showAccountBalanceLabel:function(){e.hideElement(this.$checkBalanceLabel);e.hideElement(this.$checkingBalanceLabel);e.showElement(this.$accountBalanceLabel);e.showElement(this.$accountBalanceDisplayLabel)},_hideAllCheckBalanceRelatedLabel:function(){e.hideElement(this.$checkBalanceLabel);
e.hideElement(this.$checkingBalanceLabel);e.hideElement(this.$accountBalanceLabel);e.hideElement(this.$accountBalanceDisplayLabel)},_handleCheckBalanceFailureResponseCode:function(a,b){a.isTurboView?(a._hideAllCheckBalanceRelatedLabel(),a._toggleUpiCheckBalanceTurboInlineErrorMessage(!0),a._showErrorCodeSpecificDiv(a,b)):(a._showCheckBalanceLabel(),a.$checkBalanceErrorBottomSheet||a._createCheckBalanceErrorBottomSheet(a),a._hideCheckBalanceErrorClass(),a._showErrorCodeSpecificDiv(a,b),a._showCheckBalanceBottomSheet(a))},
_showErrorCodeSpecificDiv:function(a,b){b===p.CheckBalanceErrorCode.ZM?e.showElement(this.getDOMElement(this.upiCheckBalanceWrongMpinContainer)):b===p.CheckBalanceErrorCode.Z6?(e.showElement(this.getDOMElement(this.upiCheckBalanceMaxRetriesExceededContainer)),this.isUpiDisabledDueToUpfrontErrorMessage=!0,this.setDisabled(!0),a.isTurboView||(a._hideAllCheckBalanceRelatedLabel(),a._toggleUpiUpfrontRetriesExceededErrorMessage(!0))):b===p.CheckBalanceErrorCode.SCREEN_RECORDING_ON?e.showElement(this.getDOMElement(this.upiCheckBalanceScreenRecordingOnContainer)):
p.UpiBankRelatedErrorCode[b]?e.showElement(this.getDOMElement(this.upiCheckBalanceTimeoutErrorContainer)):e.showElement(this.getDOMElement(this.upiCheckBalanceGenericErrorContainer))},_hideCheckBalanceErrorClass:function(){e.hideElement(this.getDOMElement(this.upiCheckBalanceWrongMpinContainer));e.hideElement(this.getDOMElement(this.upiCheckBalanceMaxRetriesExceededContainer));e.hideElement(this.getDOMElement(this.upiCheckBalanceScreenRecordingOnContainer));e.hideElement(this.getDOMElement(this.upiCheckBalanceTimeoutErrorContainer));
e.hideElement(this.getDOMElement(this.upiCheckBalanceGenericErrorContainer))},_handleInsufficentBalanceCheck:function(a,b){this.upiMaybeAdjustedPurchaseTotal>b&&this.upiMaybeAdjustedPurchaseTotal<b+this.upiAmazonPayBalance&&(this.isApbAndUpiBalanceMoreThanPurchaseTotal=!0);!(this.isUpiSavedHandleAPBMultiTenderEligible&&this.isAPBSelected&&this.isApbAndUpiBalanceMoreThanPurchaseTotal)&&this.upiMaybeAdjustedPurchaseTotal>b&&(a._toggleUpiInsufficientBalance(!0),this.isUpiDisabledDueToUpfrontErrorMessage=
!0,this.setDisabled(!0),f.logCounterMetric({feature:"Upi_Disabled_Insufficient_Balance",resource:"_ErrorCount"}),f.publishMetrics())},_createCheckBalanceErrorBottomSheet:function(a){F.when("a-sheet").execute(function(b){a.$checkBalanceErrorBottomSheet=b.create({name:"checkbalance_bottomSheet",height:125,preloadDomId:a.upiCheckBalanceErrorBottomSheetPreloadDomId,closeType:"icon"})})},_showCheckBalanceBottomSheet:function(a){F.when("a-sheet").execute(function(b){b.showSheet(a.$checkBalanceErrorBottomSheet)})},
_showCheckBalanceDfpErrorMessage:function(a){a._toggleCheckBalanceContainer(!1);a._toggleCheckingBalanceContainer(!1);a._toggleUpiCheckBalanceDfpMismatchMessage(!0);a.isDfpMismatchViolationPresent=!0}})});r("upi-redirection-util",["mash-helper","jQuery"],function(c,k){var n=function(l){try{var h;l.bankCode&&(h={"bank-info":{"bank-code":l.bankCode}});var e={};l.id&&(e["payment-method-id"]=l.id);h&&(e["payment-method-specific-data"]=h);var k={operation:l.operation,"payment-method-details":e,"return-location":l.returnUrl,
"client-category":"PURCHASE","client-name":l.clientId,"client-context":{}};l.enableGetReturnHttpMethod&&(k["return-http-method"]="GET");l.failureReturnUrl&&(k["failure-return-location"]=l.failureReturnUrl);l.issuingPsp&&(k["issuing-psp"]=l.issuingPsp);l.skipRegistrationContext&&(k["skip-reregistration-context"]=l.skipRegistrationContext);l.enableCallbackRedirectionBehavior&&(k["return-location-post-params"]=l.returnUrlPostParams);if(l.purchaseId){var b={"purchase-id":l.purchaseId};l.enableMultiTenderContextInUPIRedirectionClientContext&&
l.isAPBSelected&&(b["is-apb-selected"]=l.isAPBSelected,b["gift-card-id"]=l.giftCardId,b["stored-value-id"]=l.storedValueId);k["client-context"]=b}l.enableOrderIdInClientContext&&l.orderId&&(b={"order-id":l.orderId},k["client-context"]=b);var a=JSON.stringify(k),f=m.btoa(a),w=l.redirectUrl+m.encodeURIComponent(f);m&&(m.app=m.app||{},m.app.willReappear=function(){m.location.reload()});"POST"===l.httpMethod?q(w):c.navigateToUrl(w);return!0}catch(u){return m.ueLogError&&m.ueLogError(u,{logLevel:"FATAL",
attribution:"upi_redirect_util",message:"Got an exception while generating request body for AIPS redirection"+u.name+", message\x3d"+u.message}),g("RequestBody:Generation:Failed"),!1}},q=function(c){c=k("\x3cform\x3e\x3c/form\x3e").attr({method:"post",action:c});k("body").append(c);c.submit()},g=function(c){m.ue&&"function"===typeof m.ue.count&&m.ue.count("APX:UPI:REDIRECTION:"+c,1)},h=function(c,h,e,k,b){return c.redirectUrl&&c.returnUrl?k.areReturnUrlsSentByClient&&!c.failureReturnUrl?(g(e+b+"Empty:failureReturnUrl"),
!1):k.isPurchaseIdRequired&&!h?(g(e+b+"Empty:purchaseId"),!1):!0:(g(e+b+"Empty:redirectUrl or returnUrl"),!1)};return{upiRegistration:function(c,g,e,k,b,a){if(h(g,e,k,a,"NEW_REGISTRATION"))return n({operation:"NEW_REGISTRATION",bankCode:c,redirectUrl:g.redirectUrl,returnUrl:g.returnUrl,failureReturnUrl:g.failureReturnUrl,purchaseId:e,clientId:k,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,
enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,orderId:a.orderId,enableCallbackRedirectionBehavior:a.enableCallbackRedirectionBehavior,returnUrlPostParams:a.returnUrlPostParams})},upiLinkAnotherBankAccount:function(c,g,e,k,b,a){if(h(g,e,k,a,"NEW_REGISTRATION"))return n({operation:"ADD_ANOTHER_BANK_ACCOUNT",bankCode:c,redirectUrl:g.redirectUrl,returnUrl:g.returnUrl,failureReturnUrl:g.failureReturnUrl,purchaseId:e,clientId:k,httpMethod:b,
isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,orderId:a.orderId,enableCallbackRedirectionBehavior:a.enableCallbackRedirectionBehavior,returnUrlPostParams:a.returnUrlPostParams})},upiPinNotSet:function(c,g,e,k,b,a){if(h(g,e,k,a,"SET_PIN"))return n({operation:"SET_PIN",
id:c,redirectUrl:g.redirectUrl,returnUrl:g.returnUrl,failureReturnUrl:g.failureReturnUrl,purchaseId:e,clientId:k,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,orderId:a.orderId,enableCallbackRedirectionBehavior:a.enableCallbackRedirectionBehavior,
returnUrlPostParams:a.returnUrlPostParams})},upiDeviceFingerprintDoesNotMatch:function(c,g,e,k,b,a){if(h(g,e,k,a,"RE_REGISTRATION"))return n({operation:"RE_REGISTRATION",id:c,redirectUrl:g.redirectUrl,returnUrl:g.returnUrl,failureReturnUrl:g.failureReturnUrl,purchaseId:e,clientId:k,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,
orderId:a.orderId,issuingPsp:a.issuingPsp,skipRegistrationContext:a.skipRegistrationContext,enableCallbackRedirectionBehavior:a.enableCallbackRedirectionBehavior,returnUrlPostParams:a.returnUrlPostParams})}}});r("ajaxUtil",["AUI!P","upiEnums","commonUtil"],function(c,k,n){function q(c){c.sif_profile="upi_profile";return c}function g(c,g,k){var e=q(g),h="";Object.keys(e).forEach(function(b){h+=m.encodeURIComponent(b)+"\x3d"+m.encodeURIComponent(e[b])+"\x26"});g=k?k:m.location.origin;return g+c+"?"+
h}return{makePostCall:function(h,l,k,e,q,b){l=n.getPageLoadDetails();e["page-load-id"]=l.id;e["page-load-start-time"]=l.startTime;c.when("A").execute(function(a){a.$.ajax({url:g(h.path,k,e.url),xhrFields:{withCredentials:!0},data:JSON.stringify(e),contentType:"application/json; charset\x3dutf-8",dataType:"text",type:"POST",timeout:h.timeoutMillis,success:function(a,c,e){c=c+":"+e.status+":";e=e.statusText+":";try{var f=JSON.parse(a);q(f);var g=n.generateSuccessResponse(c+"SUCCESS",e+"SUCCESS");g.responseJson=
f;b(g)}catch(B){f=n.generateFailureResponse(c+"DEPENDENCY_FAILURE",e+B.message),f.responseData=a,b(f)}},error:function(a,c,e){c=c+":"+a.status+":";e=e+":"+a.statusText+":";try{var f=JSON.parse(a.responseText);e+=f.message;c+=f["error-code"]}catch(C){f={}}a=n.generateFailureResponse(c,e);a.responseJson=f;f=a;"timeout:0:"===f.responseCode&&(f=n.generateFailureResponse("S2S_CALL_TIMEOUT","S2S call timed out with a timeout of "+h.timeoutMillis));b(f)}})})}}});r("checkBalanceUtil","commonUtil npciTokenUtil deviceSignatureUtil ajaxUtil upiEnums npciSdkUtil".split(" "),
function(c,k,n,q,g,h){function l(b,a){c.validateTruthy(b,"Input requestId is null or blank");c.validateTruthy(a,"Input payload is null");c.validateTruthy(a.deviceSignature,"Input deviceSignature is null or blank");c.validateTruthy(a.npciKey,"Input npciKey is null or blank");c.validateTruthy(a.customerVpa,"Input customerVpa is null or blank");c.validateTruthy(a.bankAccountUniqueId,"Input bankAccountUniqueId is null or blank");c.validateTruthy(a.paymentMethodId,"Input paymentMethodId is null or blank");
c.validateTruthy(a.obfuscatedMarketplaceId,"Input obfuscatedMarketplaceId is null or blank");c.validateTruthy(a.payerMobileNumber,"Input payerMobileNumber is null or blank");c.validateTruthy(a.payerMpinLength,"Input payerMpinLength is null or blank");c.validateTruthy(a.payerBankName,"Input payerBankName is null or blank");c.validateTruthy(a.payerBankTail,"Input payerBankTail is null or blank");c.validateTruthy(a.useCaseName,"Input useCaseName is null or blank");c.validateTruthy(a.issuingPsp,"Input issuingPsp is null or blank");
c.validateTruthy(a.url,"Input url is null or blank")}function t(b){c.validateTruthy(b,"response is null or blank");c.validateTruthy(b.status,"response status is null or blank");c.validateTruthy(b["response-code"],"response code is null or blank");c.validateTruthy(b["response-message"],"response message is null or blank");"SUCCESS"===b.status&&"00"===b["response-code"]&&c.validateTruthy(b.balance,"balance is null or blank")}function e(b,a,f){var e=a.issuingPsp,h=a.clientContext||{};h.requestId=b;e=
{"device-signature":a.deviceSignature,"device-signature-fallback":a.deviceSignatureFallback,"upi-request-id":a.upiRequestId,"bank-account-unique-id":a.bankAccountUniqueId,"encrypted-customer-vpa":a.customerVpa,"encrypted-encoded-cred-blocks":a.encodedCredBlocks,"obfuscated-marketplace-id":a.obfuscatedMarketplaceId,"issuing-psp":e,"client-context":h,"payment-method-id":a.paymentMethodId||null,"skip-mpin-required-check":!1,"client-category":a.clientCategory,"client-name":a.clientName,"use-case-name":a.useCaseName,
"page-view-name":a.pageViewName,url:a.url,"customer-device-details":c.getCustomerDeviceDetails(a)};q.makePostCall(g.S2SMethods.CHECK_BALANCE,b,{},e,t,function(c){if("SUCCESS"===c.status){var e={};e.status=c.responseJson.status;e.responseCode=c.responseJson["response-code"];e.responseMessage=c.responseJson["response-message"];e.merchantId=c.responseJson["merchant-id"];e.merchantChannelId=c.responseJson["merchant-channel-id"];e.merchantCustomerId=c.responseJson["merchant-customer-id"];e.encryptedCustomerMobileNumber=
c.responseJson["encrypted-customer-mobile-number"];e.bankAccountUniqueId=c.responseJson["bank-account-unique-id"];e.bankCode=c.responseJson["bank-code"];e.encryptedCustomerVpa=c.responseJson["encrypted-customer-vpa"];e.maskedAccountNumber=c.responseJson["masked-account-number"];e.npciTransactionId=c.responseJson["npci-transaction-id"];e.balance=c.responseJson.balance;e.forcedTokenRefreshStatus="NOT_REQUIRED";c.responseJson["response-code"]===g.ForceTokenRefreshResponseCode[c.responseJson["response-code"]]?
(a.forceRefresh=!0,k.getOrCreateNpciToken(b+"-gcntf",a,function(a){e.forcedTokenRefreshStatus=a.status;f(e)})):f(e)}else f(c)})}function v(b,a,f){a.credRequestType="MPIN";a.credType=["reqBalEnq"];var g=c.generateRequestIdForPsp(a.issuingPsp);a.upiRequestId=g;h.getCredential(b,a,function(c){"SUCCESS"===c.status?(a.encodedCredBlocks=c.encodedCredBlocks,e(b+"-cb",a,f)):f(c)})}return{checkBalance:function(b,a){var e=c.generateRequestId();try{l(e,b)}catch(w){a(c.generateFailureResponse("INVALID_INPUT",
w.message+""));return}e+="-gcnt";k.getOrCreateNpciToken(e,b,function(c){"SUCCESS"===c.status?(b.npciToken=c.npciToken,b.deviceId=c.deviceDetails.deviceId,b.packageName=c.deviceDetails.packageName,b.deviceSignature=c.deviceSignature,b.deviceSignatureFallback=c.deviceSignatureFallback,b.deviceDetails=c.deviceDetails,b.simDetail=c.simDetail,v(e+"-gcr",b,a)):a(c)})}}});r("commonUtil",["upiEnums"],function(c){var k=function(){function c(){return("0000"+Math.random().toString(16)).slice(-4)}return("000000000000"+
n().toString(16)).slice(-12)+c()+c()+c()+c()+c()},n=function(){return Date.now()},q=function(c,h){m.ue&&"function"===typeof m.ue.trigger&&m.ue.trigger(c,h)};return{validateTruthy:function(c,h){if(!c)throw Error(h);},generateRequestIdForPsp:function(g){if(c.SupportedIssuingPspAndConfig.hasOwnProperty(g))return c.SupportedIssuingPspAndConfig[g].requestIdPrefix+k();throw Error("Unsupported psp: "+g);},generateRequestId:k,generateFailureResponse:function(c,h){return{status:"FAILURE",responseCode:c||"FAILURE",
responseMessage:h||"unknown"}},generateSuccessResponse:function(c,h){return{status:"SUCCESS",responseCode:c||"SUCCESS",responseMessage:h||"unknown"}},generateCallbackResponse:function(c,h,l){return{status:c,responseCode:h,responseMessage:l}},isTrue:function(c){return"boolean"===typeof c&&c||"string"===typeof c&&"TRUE"===c.toUpperCase()},getDevicePlatform:function(){return m.device&&m.device.platform?m.device.platform:m.cordova&&m.cordova.platformId?"undefined"!==typeof c.OperatingSystem[m.cordova.platformId.toUpperCase()]?
c.OperatingSystem[m.cordova.platformId.toUpperCase()]:"UNKNOWN":"UNKNOWN"},getPageLoadDetails:function(){try{var c=m.ue_id;var h=m.performance.timing.navigationStart}catch(l){h=-1}return{startTime:h||-1,id:c||"unknown"}},getCurrentTime:n,deleteWindowAppReappear:function(){if(m.app&&m.app.willReappear){var c=m.app.willReappear;delete m.app.willReappear}return c},enableWindowAppReappear:function(c){m.app.willReappear=c},getCustomerDeviceDetails:function(g){var h=g.deviceDetails;g=g.simDetail;var l=
{},k={};l["device-manufacturer"]=h.manufacturer;l["device-model"]=h.model;l["os-version"]=h.version;l["os-name"]=h.os?h.os.toUpperCase():null;l["app-version"]=h.appVersion;l["package-name"]=c.PackageName[h.packageName];null!==g&&g!==x&&(k["sim-id"]=g.id,h=g.provider,k["sim-operator"]=h!==x&&""!==h&&"No service"!==h?g.provider:"UNKNOWN",k["slot-index"]=g.slotIndex,k["is-sim-inactive"]=g.isSimInactive,l["sim-info-list"]=[k]);return l},compareVersions:function(c,h){c=c.split(".");h=h.split(".");for(var g=
0;g<Math.max(c.length,h.length);g++){var k=parseInt(c[g])||0,e=parseInt(h[g])||0;if(k<e)return-1;if(k>e)return 1}return 0},recordWeblabTrigger:q,recordWeblabTriggerAndReturn:function(c,h){q(c,h);return!0}}});r("cordovaUtil",["commonUtil"],function(c){var k=function(){if(m.cordova)try{return m.cordova.require("cordova/exec")}catch(q){return function(g,h){h(c.generateCallbackResponse("FAILURE","CORDOVA_EXCEPTION",q.message+""))}}else return function(k,g){g(c.generateCallbackResponse("FAILURE","CORDOVA_NOT_AVAILABLE",
"Cordova is not loaded properly"))}},n=function(k){if("string"===typeof k)var g="STRING_SDK_RESPONSE";else k&&"object"===typeof k?(g=k.errorCode||"NULL_RESPONSE_CODE",k=k.errorDescription||"Null Response Message"):(g="UNKNOWN_SDK_RESPONSE",k=JSON.stringify(k)||"NullSdkResponse");return c.generateCallbackResponse("FAILURE",g,k)};return{executeNativeAction:function(q,g,h,l,t,e){h={requestId:g,payload:h,instrumentationData:e||{}};if("iOS"===c.getDevicePlatform()){e="upiIssuanceSMASHPlugin";var v="executeSdkApi";
h.command=q}else e="AipsJusPayPlugin",v=q;k()(function(b){b&&"object"===typeof b&&"SUCCESS"===b.status?(b.responseCode=b.responseCode||"NULL_RESPONSE_CODE",b.responseMessage=b.responseMessage||"Null Response Message"):b=n(b);"SUCCESS"===b.status?l(q,g,b):t(q,g,b)},function(b){t(q,g,n(b))},e,v,[h])}}});r("deviceSignatureUtil",["commonUtil","cordovaUtil"],function(c,k){var n,q=function(a){var b=c.generateRequestId(),e={permission:["android.permission.READ_PHONE_STATE","android.permission.SEND_SMS",
"android.permission.RECEIVE_SMS"]};"iOS"===c.getDevicePlatform()?(b=c.generateCallbackResponse("SUCCESS","SUCCESS","Permissions are already granted at app install in iOS"),a(b)):k.executeNativeAction("UPI_CHECK_PERMISSION",b,e,function(b,f,d){try{if(g(d,e.permission))a(d);else{var k=c.generateCallbackResponse("FAILURE","PERMISSION_NOT_GRANTED","Some permissions not granted by the user");k.permissions=d.permissions;a(k)}}catch(E){a(c.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",E.message+
""))}},function(b,c,d){a(d)})},g=function(a,b){for(var c={},e=a.permissions.length,f=0;f<e;f++)if(a.permissions[f].label)c[a.permissions[f].label]=a.permissions[f].status;else throw Error("Invalid response structure. Label field not found");return b.every(function(a){if(c[a])return"GRANTED"===c[a];throw Error("Response does not contain all requested permission status");})},h=function(a,b){l(function(e){if("SUCCESS"===e.status)a:{var f,g=e.deviceSignatures.length;n=e.deviceDetails;for(f=0;f<g;f++){var d=
a===e.deviceSignatures[f].deviceSignature;e.deviceSignatures[f].simDetail.serialNumber&&(d=d||a===e.deviceSignatures[f].deviceSignatureFallback);if(d){d=c.generateCallbackResponse("SUCCESS","SUCCESS","SUCCESS");d.deviceDetails=e.deviceDetails;d.simDetail=e.deviceSignatures[f].simDetail;d.deviceSignature=a===e.deviceSignatures[f].deviceSignature?e.deviceSignatures[f].deviceSignature:e.deviceSignatures[f].deviceSignatureFallback;b(d);break a}}b(c.generateCallbackResponse("FAILURE","DEVICE_SIGNATURE_MISMATCH",
"Device signature passed in input does not matches with any of the sim present"))}else b(e)})},l=function(a){try{t(function(b){"SUCCESS"===b.status?e(b,a):a(b)})}catch(B){a(c.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",B.message+""))}},t=function(a){var b=c.generateRequestId();k.executeNativeAction("UPI_GET_DEVICE_DETAILS",b,{},function(b,e,f){try{c.validateTruthy(f,"Null response returned"),c.validateTruthy("SUCCESS"===f.status,"Non success response status returned : "+f.status),c.validateTruthy(f.deviceDetails,
"Null device details returned"),c.validateTruthy(f.deviceDetails.deviceId,"Null or blank deviceId returned"),c.validateTruthy(f.deviceDetails.manufacturer,"Null or blank manufacturer returned"),c.validateTruthy(f.deviceDetails.model,"Null or blank model returned"),c.validateTruthy(f.deviceDetails.version,"Null or blank version returned"),c.validateTruthy(f.deviceDetails.os,"Null or blank os returned"),c.validateTruthy(f.deviceDetails.appVersion,"Null or blank appVersion returned"),c.validateTruthy(f.deviceDetails.packageName,
"Null or blank packageName returned"),a(f)}catch(d){a(c.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",d.message+""))}},function(b,c,e){a(e)})},e=function(a,b){v(function(c){"SUCCESS"===c.status?w(a,c,b):b(c)})},v=function(e){var g=c.generateRequestId();k.executeNativeAction("UPI_GET_SIM_DETAILS",g,{},function(g,k,h){try{c.validateTruthy(h,"Null response returned");c.validateTruthy("SUCCESS"===h.status,"Non success response status returned : "+h.status);c.validateTruthy(h.simDetails,"Null sim details returned");
h.simDetails=f(h.simDetails);var d=h.simDetails.length;c.validateTruthy(0!==d,"Empty sim details returned");var z;for(z=0;z<d;z++)c.validateTruthy(h.simDetails[z].id,"Null or blank slot id returned for sim"+z),c.validateTruthy(h.simDetails[z].slotIndex,"Null or blank slot index returned for sim"+z),"iOS"===c.getDevicePlatform()?c.validateTruthy(h.simDetails[z].serialNumber,"Null or blank serialNumber returned for sim "+z+" for iOS"):c.validateTruthy(h.simDetails[z].subscriptionId,"Null or blank subscriptionId returned for sim "+
z+" for Android");if(c.isTrue(h.simDetails[0].isAirplaneModeOn))e(c.generateCallbackResponse("FAILURE","AIRPLANE_MODE_ACTIVE","Airplane mode is turned on device"));else{var l=b(h.simDetails);l.length?(h.simDetails=a(l),e(h)):e(c.generateCallbackResponse("FAILURE","ACTIVE_SIM_CARD_NOT_AVAILABLE","No active sim card present in device"))}}catch(I){"Empty sim details returned"===I.message?e(c.generateCallbackResponse("FAILURE","SIM_CARD_NOT_AVAILABLE",I.message+"")):e(c.generateCallbackResponse("FAILURE",
"DEPENDENCY_FAILURE",I.message+""))}},function(a,b,c){e(c)})},b=function(a){return a.filter(function(a){return!c.isTrue(a.isSimInactive)})},a=function(a){a.forEach(function(a){a.mobileNumber=(a.mobileNumber||"").slice(-12);"iOS"===c.getDevicePlatform()?a.ssid=a.serialNumber:a.ssid=a.subscriptionId});return a},f=function(a){return"iOS"===c.getDevicePlatform()?a.filter(function(a){return"undefined"!==typeof a.slotIndex}):a},w=function(a,b,e){var f=a.deviceDetails.deviceId,g=c.generateCallbackResponse("SUCCESS",
"SUCCESS","SUCCESS");g.deviceDetails=a.deviceDetails;g.deviceSignatures=[];var d=b.simDetails.length;a=function(a){p(f+a.ssid,function(b){a.serialNumber?p(f+a.serialNumber,function(c){u(g,a,d,b,c,e)}):u(g,a,d,b,"",e)})};var h;for(h=0;h<d;h++)a(b.simDetails[h])},u=function(a,b,c,e,f,d){a.deviceSignatures.push({simDetail:b,deviceSignature:e,deviceSignatureFallback:f});a.deviceSignatures.length===c&&d(a)},p=function(a,b){if("function"!==typeof b)throw Error("Input callback should be a function");if("function"===
typeof m.TextEncoder)return a=(new m.TextEncoder("utf-8")).encode(a),m.crypto.subtle.digest("SHA-256",a).then(function(a){var c=[];a=new DataView(a);for(var e=0;e<a.byteLength;e+=4){var d=("00000000"+a.getUint32(e).toString(16)).slice(-8);c.push(d)}c=c.join("");b(c)});throw Error("Unsupported platform. TextEncoder is not available");};return{checkDeviceSignature:function(a,b){q(function(c){"SUCCESS"===c.status?h(a,b):b(c)})},getCachedDeviceDetails:function(){return n}}});r("eagerInitUtil",["commonUtil",
"deviceSignatureUtil","npciSdkUtil","upiEnums","clog"],function(c,k,n,q,g){function h(c){g.logCounterMetric({feature:"EagerInitComplete_"+c.status,resource:"_Count"});g.publishMetrics()}function l(c){c=c||{};return{useCaseName:"EAGER_INIT_NPCI_CL",clientName:c.clientName,clientCategory:c.clientId,merchantCustomerId:c.merchantCustomerId}}return{performNpciClEagerInit:function(t,e,v,b,a,f){if(t&&m.ue&&!n.isInitNpciSdkApiCalled()){var w=k.getCachedDeviceDetails();if(w){var u=w.os?w.os.toUpperCase():
null;w=w.appVersion;e=u!==q.OperatingSystem.ANDROID.toUpperCase()||0>c.compareVersions(w,"26.8.2.300")||!e||v!==q.SdkCallStatusEnum.Completed||b||!a&&(t===q.WeblabTreatment.T1||t===q.WeblabTreatment.C)?!1:!0}else e=!1}else e=!1;e&&t!==q.WeblabTreatment.C&&(n.initNpciSdk(c.generateRequestId()+"-einc",{},h,l(f)),g.logCounterMetric({feature:"EagerInitStart",resource:"_Count"}),g.publishMetrics())}}});r("npciSdkUtil",["commonUtil","deviceSignatureUtil","upiEnums","cordovaUtil"],function(c,k,n,q){function g(a,
b,d,e,f,g,h,k){try{b(e,f)}catch(K){h(c.generateFailureResponse("INVALID_INPUT",K.message+""));return}q.executeNativeAction(a,e,g(f),function(a,b,e){try{d(e),h(e)}catch(G){h(c.generateFailureResponse("DEPENDENCY_FAILURE",G.message+""))}},function(a,b,c){h(c)},k)}function h(a,b){c.validateTruthy(a,"Input requestId is null or blank");c.validateTruthy(b,"Input payload is null")}function l(a){c.validateTruthy(a,"Null response returned");c.validateTruthy("SUCCESS"===a.status,"Non success response status returned : "+
a.status)}function t(){return{}}function e(a,b){h(a,b);c.validateTruthy(b.deviceId,"Input deviceId is null or blank");c.validateTruthy(b.tokenRequestType,"Input tokenRequestType is null or blank");"iOS"===c.getDevicePlatform()&&c.validateTruthy(b.packageName,"Input packageName is null or blank")}function v(a){l(a);c.validateTruthy(a.challenge,"Returned challenge is null or blank")}function b(a){var b={deviceId:a.deviceId,tokenRequestType:a.tokenRequestType};"iOS"===c.getDevicePlatform()&&(b.appId=
a.packageName);return b}function a(a,b){h(a,b);c.validateTruthy(b.deviceId,"Input deviceId is null or blank");c.validateTruthy(b.npciToken,"Input npciToken is null or blank");c.validateTruthy(b.tokenCreationTimeEpoch,"Input tokenCreationTimeEpoch is null or blank");c.validateTruthy(b.packageName,"Input packageName is null or blank");c.validateTruthy(b.payerMobileNumber,"Input payerMobileNumber is null or blank")}function f(a){l(a);c.validateTruthy(c.isTrue(a.responseCode),"Unexpected responseCode returned: "+
a.responseCode)}function w(a){return{deviceId:a.deviceId,token:a.npciToken,tokenCreationTimeEpoch:""+a.tokenCreationTimeEpoch,appId:a.packageName,mobileNumber:a.payerMobileNumber}}function u(a,b){h(a,b);c.validateTruthy(b.deviceId,"Input deviceId is null or blank");c.validateTruthy(b.npciToken,"Input npciToken is null or blank");c.validateTruthy(b.npciKey,"Input npciKey is null or blank");c.validateTruthy(b.payerBankName,"Input payerBankName is null or blank");c.validateTruthy(b.payerMobileNumber,
"Input payerMobileNumber is null or blank");c.validateTruthy(b.packageName,"Input packageName is null or blank");c.validateTruthy(b.upiRequestId,"Input upiRequestId is null or blank");c.validateTruthy(b.payerBankTail,"Input payerBankTail is null or blank");c.validateTruthy(b.credRequestType,"Input credRequestType is null or blank");switch(b.credRequestType){case "MPIN":c.validateTruthy(b.payerMpinLength,"Input payerMpinLength is null or blank");break;default:throw Error("Unsupported credRequestType: "+
b.credRequestType);}}function p(a){l(a);c.validateTruthy("SUCCESS"===a.responseCode,"Non success response code returned : "+a.responseCode);c.validateTruthy(a.encodedCredBlocks,"Returned encoded cred block is null or blank")}function m(a,b){return{name:a,value:b}}function B(a){var b=a.npciToken,c=a.npciKey;a:switch(a.credRequestType){case "MPIN":var e='{\n\t"CredAllowed": [{\n\t\t"type": "PIN",\n\t\t"subtype": "MPIN",\n\t\t"dType": "NUM",\n\t\t"dLength": '+a.payerMpinLength+"\n\t}]\n}";break a;default:throw Error("Unsupported credRequestType: "+
a.credRequestType);}b={token:b,encodedXmlPayload:c,credAllowed:e,keyCode:a.keyCode||"NPCI",languagePref:a.languagePref||"en_US",configuration:{payerBankName:a.payerBankName},salt:{payerAddr:a.payerVpa||"",payeeAddr:a.payeeVpa||"",mobileNumber:a.payerMobileNumber,appId:a.packageName,deviceId:a.deviceId,txnAmount:a.amount||"",txnId:a.upiRequestId,credType:a.credType},payInfoArray:[]};a.payeeName&&b.payInfoArray.push(m("payeeName",a.payeeName));b.payInfoArray.push(m("refId",a.upiRequestId));b.payInfoArray.push(m("account",
a.payerBankTail));a.remarks&&b.payInfoArray.push(m("note",a.remarks));a.amount&&b.payInfoArray.push(m("txnAmount",a.amount));a.refUrl&&b.payInfoArray.push(m("refUrl",a.refUrl));b.trustParamInput=(a.amount?a.amount+"|":"")+a.upiRequestId+"|"+(a.payerVpa?a.payerVpa+"|":"")+(a.payeeVpa?a.payeeVpa+"|":"")+a.packageName+"|"+a.payerMobileNumber+"|"+a.deviceId;return b}var r=!1;return{initNpciSdk:function(a,b,d,e){"iOS"===c.getDevicePlatform()?(a=c.generateSuccessResponse("SUCCESS","Npci Sdk is already initialised in iOS"),
d(a)):(g("INIT_NPCI_SDK",h,l,a,b,t,d,e),r=!0)},getNpciTokenFromLocalStorage:function(a,b,c){g("GET_TOKEN_FROM_LS",h,l,a,b,t,c)},getChallenge:function(a,c,d){g("GET_CHALLENGE",e,v,a,c,b,d)},registerApp:function(b,c,d){g("REGISTER_APP",a,f,b,c,w,d)},getCredential:function(a,b,c){g("GET_CREDENTIAL",u,p,a,b,B,c)},isInitNpciSdkApiCalled:function(){return r}}});r("npciTokenUtil",["commonUtil","npciSdkUtil","deviceSignatureUtil","upiEnums","ajaxUtil"],function(c,k,n,q,g){function h(a,b){c.validateTruthy(a,
"Input requestId is null or blank");c.validateTruthy(b,"Input payload is null");c.validateTruthy(b.payerMobileNumber,"Input payerMobileNumber is null or blank");c.validateTruthy(b.deviceSignature,"Input deviceSignature is null or blank");c.validateTruthy(b.clientCategory,"Input clientCategory is null or blank");c.validateTruthy(b.clientName,"Input clientName is null or blank");c.validateTruthy(b.url,"Input url is null or blank")}function l(a){c.validateTruthy(a,"response is null or blank");c.validateTruthy(a["encrypted-npci-token"],
"encryptedNpciToken is null or blank");c.validateTruthy(a["token-creation-time-epoch"],"tokenCreationTimeEpoch is null or blank")}function m(a,b,e){k.registerApp(a,b,function(a){"SUCCESS"===a.status?(a=c.generateSuccessResponse("SUCCESS_CREATE_TOKEN","Successfully created a new token"),a.npciToken=b.npciToken,e(a)):e(a)})}function e(a,b,e,h){var f=b.issuingPsp,k=c.generateRequestIdForPsp(f),p=b.clientContext||{};p.requestId=a;e={"device-signature":b.deviceSignature,"device-signature-fallback":b.deviceSignatureFallback,
"token-request-type":b.tokenRequestType,"token-challenge":e.challenge,"encrypted-mobile-number":b.payerMobileNumber,"issuing-psp":f,"upi-request-id":k,"client-context":p,"client-category":b.clientCategory,"client-name":b.clientName,"use-case-name":b.useCaseName,"page-view-name":b.pageViewName,"obfuscated-marketplace-id":b.obfuscatedMarketplaceId,url:b.url,"customer-device-details":c.getCustomerDeviceDetails(b)};g.makePostCall(q.S2SMethods.CREATE_NPCI_TOKEN,a,{},e,l,function(c){"SUCCESS"===c.status?
(b.npciToken=c.responseJson["encrypted-npci-token"],c=c.responseJson["token-creation-time-epoch"],c="24.17.0.300"===b.appVersion?c+" V2":c+" "+b.supportedNpciTokenVersion,b.tokenCreationTimeEpoch=c,m(a+"-ra",b,h)):h(c)})}function v(a,b,c){b.tokenRequestType="INITIAL";k.getChallenge(a,b,function(f){"SUCCESS"===f.status?e(a+"-cnts",b,f,c):c(f)})}function b(a,b,e){b.forceRefresh?v(a+"-gchf",b,e):k.getNpciTokenFromLocalStorage(a,b,function(f){if("SUCCESS"===f.status){if(!f.token||b.expectedNpciToken&&
b.expectedNpciToken!==f.token||f.mobileNumber!==b.payerMobileNumber)var h=!1;else{var g=f.tokenCreationTimeEpoch.toString().split(" ");h=g[0];var k="";1<g.length&&(k=g[1]);b.os.toUpperCase()===q.OperatingSystem.ANDROID.toUpperCase()&&"24.17.0.300"===b.appVersion&&"V2"!==k||b.os.toUpperCase()===q.OperatingSystem.ANDROID.toUpperCase()&&"24.17.0.300"!==b.appVersion&&k!==b.supportedNpciTokenVersion||b.os.toUpperCase()===q.OperatingSystem.IOS.toUpperCase()&&k!==b.supportedNpciTokenVersion?h=!1:(g=c.getCurrentTime(),
h=parseInt(h,10),h=76032E5>g-h)}h?(h=c.generateSuccessResponse("SUCCESS_EXISTING_TOKEN","Existing token fetched from Local storage is valid"),h.npciToken=f.token,e(h)):v(a+"-gch",b,e)}else e(f)})}function a(a,c,e,h){var f=function(a){a.deviceDetails=e.deviceDetails;a.deviceSignature=e.deviceSignature;a.deviceSignatureFallback=e.deviceSignatureFallback;a.simDetail=e.simDetail;h(a)};c.deviceId=e.deviceDetails.deviceId;c.packageName=e.deviceDetails.packageName;c.deviceSignature=e.deviceSignature;c.deviceSignatureFallback=
e.deviceSignatureFallback;c.supportedNpciTokenVersion=e.deviceDetails.supportedNpciTokenVersion||"V1";c.appVersion=e.deviceDetails.appVersion;c.os=e.deviceDetails.os;c.deviceDetails=e.deviceDetails;c.simDetail=e.simDetail;k.initNpciSdk(a,c,function(e){"SUCCESS"===e.status?b(a+"-gntls",c,f):f(e)})}return{getOrCreateNpciToken:function(b,e,g){try{h(b,e)}catch(p){g(c.generateFailureResponse("INVALID_INPUT",p.message+""));return}b+="-idfv";n.checkDeviceSignature(e.deviceSignature,function(c){"SUCCESS"===
c.status?a(b+"-ins",e,c,g):g(c)})}}});r("p2mIntentUtil",["AUI!P","commonUtil","cordovaUtil","lang"],function(c,k,n,m){function g(c,e){k.validateTruthy(c,"Input requestId is null or blank");k.validateTruthy(e,"Input payload is null");k.validateTruthy(e.intentFilterUri,"Input intentFilterUri is null or blank")}function h(h,e){c.when("mash").execute(function(c){var b=[],a=0;m.forEach(h,function(f){c.canLaunchIntentURL({url:f+"://upi",successCallback:function(c){a++;c&&b.push({intentAppPackageName:f});
a===h.length&&e(b)},failCallback:function(c){a++;a===h.length&&e(b)}})})})}function l(c,e){if(c)var g;h(c,function(b){g=0<b.length?k.generateCallbackResponse("SUCCESS","SUCCESS","SUCCESS"):k.generateCallbackResponse("SUCCESS","UPI_INTENT_ELIGIBLE_APPS_NOT_AVAILABLE","UPI_INTENT_ELIGIBLE_APPS_NOT_AVAILABLE");g.upiIntentEligibleApps=b;e(g)})}return{getIntentEligibleApps:function(c,e){if("iOS"===k.getDevicePlatform())l(c.intentAppsList,function(b){try{e(b)}catch(a){e(k.generateFailureResponse("FAILURE",
"DEPENDENCY_FAILURE",a.message+""))}});else{var h=k.generateRequestId();h+="-giea";try{g(h,c)}catch(b){e(k.generateFailureResponse("INVALID_INPUT",b.message+""));return}n.executeNativeAction("GET_UPI_INTENT_ELIGIBLE_APPS",h,c,function(b,a,c){try{e(c)}catch(w){e(k.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",w.message+""))}},function(b,a,c){e(c)})}}}});r("paymentMethodUtil",["commonUtil","upiEnums","ajaxUtil"],function(c,k,n){function m(h){c.validateTruthy(h,"response is null or blank");
c.validateTruthy(h["encrypted-payer-vpa"],"response encryptedPayerVpa is null or blank");c.validateTruthy(h["encrypted-mobile-number"],"response encryptedMobileNumber is null or blank");c.validateTruthy(h["npci-public-key"],"response npciPublicKey is null or blank");c.validateTruthy(h["bank-name"],"response bankName is null or blank");c.validateTruthy(h["bank-tail"],"response bankTail is null or blank");c.validateTruthy(h["mpin-length"],"response mpinLength is null or blank");c.validateTruthy(h.version,
"response version is null or blank");c.validateTruthy(h["payer-bank-account-unique-id"],"response payerBankAccountUniqueId is null or blank");c.validateTruthy(h["device-signature"],"response deviceSignature is null or blank")}function g(c,g,q){var e=g.clientContext||{};e.requestId=c;n.makePostCall(k.S2SMethods.GET_PAYMENT_METHOD_DETAILS,c,{},{"payer-payment-method-id":g.payerPaymentMethodId,"obfuscated-marketplace-id":g.obfuscatedMarketplaceId,"client-context":e,"client-category":g.clientCategory,
"client-name":g.clientName,"use-case-name":g.useCaseName,"page-view-name":g.pageViewName,url:g.url},m,function(c){if("SUCCESS"===c.status){var b={};b.status=c.status;b.responseCode=c.responseCode;b.responseMessage=c.responseMessage;b.payerVpa=c.responseJson["encrypted-payer-vpa"];b.payerMobileNumber=c.responseJson["encrypted-mobile-number"];b.npciKey=c.responseJson["npci-public-key"];b.payerBankName=c.responseJson["bank-name"];b.payerBankTail=c.responseJson["bank-tail"];b.payerMpinLength=c.responseJson["mpin-length"];
b.issuingPsp=c.responseJson["issuing-psp"];b.version=c.responseJson.version;b.payerBankAccountUniqueId=c.responseJson["payer-bank-account-unique-id"];b.deviceSignature=c.responseJson["device-signature"];b.clientContext=c.responseJson["client-context"];q(b)}else q(c)})}return{getPaymentMethodDetailsById:function(h,k){var l=c.generateRequestId();try{c.validateTruthy(l,"Input requestId is null or blank"),c.validateTruthy(h,"Input payload is null"),c.validateTruthy(h.payerPaymentMethodId,"Input payerPaymentMethodId is null or blank"),
c.validateTruthy(h.obfuscatedMarketplaceId,"Input obfuscatedMarketplaceId is null or blank"),c.validateTruthy(h.url,"Input url is null or blank")}catch(e){k(c.generateFailureResponse("INVALID_INPUT",e.message+""));return}g(l+"-gpm",h,k)}}});r("sdkUtil",["AUI!P","clog","upiEvents"],function(c,k,n){var q,g,h,l,t,e=function(a,b,c,d,e){if(!q){var f=m.cordova;if(f)q=f.require("cordova/exec");else{e(a,b,null,"cordova undefined");return}}var g=r();c.requestId=g;q(function(c){d(a,b,g,c)},function(c){e(a,
b,g,c)},h.serviceName,b,[c])},r=function(){function a(){return Math.random().toString(16).slice(-4)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},b=function(a,b,c,d,e,f){var g={};if("SUCCESS"===d.status)if(e.forEach(function(a){g[a]=0}),d.hasOwnProperty("permissions")){d.permissions.forEach(function(a){"GRANTED"===a.status&&(g[a.label]=1)});for(var h in g)if(!g[h]){f.externalNeedsPermissionsHandler(a);return}f.externalHasPermissionsHandler(a)}else f.externalErrorHandler(a,b,c,d);else f.externalErrorHandler(a,
b,c,d)},a=function(a,b,c,d){h.executeUpi(a,"CHECK_PERMISSION",{permission:b},c,d)},f=function(c,d){var e=["android.permission.READ_PHONE_STATE","android.permission.SEND_SMS","android.permission.RECEIVE_SMS"];a(c,e,function(a,c,f,g){b(a,c,f,g,e,d)},d.externalErrorHandler)},w=function(a,b,c,d){h.executeUpi(a,"IS_DEVICE_FINGERPRINT_VALID",{deviceFingerPrint:b},c,d)},u=function(a,b,c){h.executeUpi(a,"SDK_INIT",{},b,c)},p=function(a){t=!0;a.widget.trigger(n.JuspayHasPermissionsEventName)},x=function(a,
b){a=Object.create(a);for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};Object.create||(Object.create=function(a){function b(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");b.prototype=a;return new b});var B={executeUpi:function(){},serviceName:""},A={getSDKHelper:function(a){return"iOS"===a?x(B,{executeUpi:function(a,b,c,d,f){e(a,"executeSdkApi",{payload:c,command:b},d,f)},serviceName:"upiIssuanceSMASHPlugin"}):x(B,{executeUpi:function(a,
b,c,d,f){e(a,b,{payload:c},d,f)},serviceName:"AipsJusPayPlugin"})}},z=function(a,b,c,d){"Enabled"===d.Status?(l=!0,p(a),a.widget.trigger(n.UPIIssuanceSupportedEventName)):a.widget.trigger(n.UPIIssuanceNotSupportedEventName)},D=function(a,b,c,d){a.widget.trigger(n.UPIIssuanceNotSupportedEventName)},d=function(a,b,c,d){"Enabled"===d.Status?(a.widget.trigger(n.InitializeDeviceSignatureCheckEventName),a.widget.trigger(n.UPIIssuanceSupportedEventName)):a.widget.trigger(n.UPIIssuanceNotSupportedEventName)},
y=function(a,b,c,d){a.widget.trigger(n.UPIIssuanceNotSupportedEventName)};return{initializeDeviceSignatureCheck:function(a,b,d,e){var k={externalHasPermissionsHandler:b,externalNeedsPermissionsHandler:d,externalErrorHandler:e};c.when("safe-mash").execute(function(b){b&&(g||(g=m.device),h=A.getSDKHelper(g.platform),"iOS"!==g.platform&&u(a,function(a,b,c,d){"SUCCESS"===d.status?(l=!0,f(a,k)):k.externalErrorHandler(a,b,c,d)},k.externalErrorHandler))})},juspayHasPermissionsHandler:p,juspayHasNoPermissionsHandler:function(a){t=
!1;a.widget.trigger(n.NoDevicePermissionsEventName);k.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_SuccessCount"});k.logCounterMetric({feature:"SelectableUpiSdkCalls_NoPermissions",resource:"_Count"});k.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});k.publishMetrics()},checkDeviceSignature:function(a,b,c,d,e,f){var g={externalMatchHandler:d,externalMismatchHandler:e,externalErrorHandler:f};w(a,c,function(a,d,e,f){f&&"SUCCESS"===
f.status?"true"===f.isValid?g.externalMatchHandler(a,b,c):g.externalMismatchHandler(a,b):g.externalErrorHandler(a,d,e,f)},g.externalErrorHandler)},juspayHandleDeviceSignatureMatchesHandler:function(a,b,c){for(var d in a.savedHandleIndexes)a.widget.trigger(n.DeviceSignatureMatchesEventName,d,c);k.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_SuccessCount"});k.logCounterMetric({feature:"SelectableUpiSdkCalls_SignatureMatch",resource:"_Count"});k.logLatencyMetric({feature:"SelectableUpiSdkCalls",
resource:"_Latency",startTime:a.sdkCallStartTime});k.publishMetrics()},juspayHandleDeviceSignatureDoesNotMatchHandler:function(a,b){for(var c in a.savedHandleIndexes)a.widget.trigger(n.DeviceSignatureDoesNotMatchEventName,c);k.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_SuccessCount"});k.logCounterMetric({feature:"SelectableUpiSdkCalls_SignatureMismatch",resource:"_Count"});k.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});k.publishMetrics()},
juspayErrorHandler:function(a,b,c,d){l=!1;m.console.error("JusPay SDK failed",b,c,d);a.widget.trigger(n.ErrorEventName);k.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_ErrorCount"});k.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});k.publishMetrics()},checkUPIIssuanceSupported:function(a){c.when("safe-mash").execute(function(b){b&&(g||(g=m.device),h=A.getSDKHelper(g.platform),a.isSavedHandleComponentUsable&&"iOS"===g.platform&&(a.widget.trigger(n.UPIIssuanceNotSupportedEventName),
e(a,"isUPIIssuanceSupported",{},z,D)))})},checkUPIIssuanceSupportedForJsLibApps:function(a){c.when("safe-mash").execute(function(b){b&&(g||(g=m.device),h=A.getSDKHelper(g.platform),"iOS"===g.platform?(a.widget.trigger(n.UPIIssuanceNotSupportedEventName),e(a,"isUPIIssuanceSupported",{},d,y)):a.widget.trigger(n.InitializeDeviceSignatureCheckEventName))})},getIsJuspaySdkCallEligible:function(){return l},getIsDeviceSignatureCheckEligible:function(){return t}}});r("upiEnums",[],function(){var c={Pending:"Pending",
Completed:"Completed",Error:"Error"};Object.freeze(c);var k={C:"C",T1:"T1",T2:"T2"};Object.freeze(k);var m={Pending:"Pending",Completed:"Completed",Error:"Error"};Object.freeze(m);var q={U13:!0,U78:!0,U99:!0,U88:!0,U28:!0,IR:!0,XB:!0,HS:!0,U80:!0,Y1:!0};Object.freeze(q);var g={U66:!0,21:!0};Object.freeze(g);var h={ZM:"ZM",Z6:"Z6",SCREEN_RECORDING_ON:"SCREEN_RECORDING_ON"};Object.freeze(h);var l={SdkError:"SdkError",AIPSRedirectionNotEnabled:"AIPSRedirectionNotEnabled",MultitenderNotSupported:"MultitenderNotSupported"};
Object.freeze(l);var r={AXIS:{requestIdPrefix:"APL"},ICICI:{requestIdPrefix:"ICI"},YES:{requestIdPrefix:"APY"},RBL:{requestIdPrefix:"RBA"}};Object.freeze(r);var e={CHECK_BALANCE:{name:"CheckBalance",path:"/upi/check-balance",timeoutMillis:45E3},CREATE_NPCI_TOKEN:{name:"CreateNpciToken",path:"/upi/customer/device/create-npci-token",timeoutMillis:2E4},GET_PAYMENT_METHOD_DETAILS:{name:"GetPaymentMethodDetailsById",path:"/upi/get-payment-method-details-by-id",timeoutMillis:45E3}};Object.freeze(e);var v=
{ANDROID:"Android",IOS:"iOS"};Object.freeze(v);var b={"in.amazon.mShop.android.shopping":"IN_AMAZON_MSHOP_ANDROID_SHOPPING","com.amazon.mShop.android.beta":"COM_AMAZON_MSHOP_ANDROID_SHOPPING_BETA","in.amazon.mShop.android.business.shopping":"IN_AMAZON_MSHOP_ANDROID_BUSINESS_SHOPPING","com.amazon.AmazonIN":"IN_AMAZON_MSHOP_IOS_SHOPPING","com.amazon.AmazonIN.Enterprise":"IN_AMAZON_MSHOP_IOS_SHOPPING_ENTERPRISE","com.amazon.AmazonIN.development":"IN_AMAZON_MSHOP_IOS_SHOPPING_DEVELOPMENT","com.amazon.AmazonBusinessIndia":"IN_AMAZON_BUSINESS_IOS_SHOPPING",
"com.amazon.AmazonBusinessIndia.Enterprise":"IN_AMAZON_BUSINESS_IOS_SHOPPING_ENTERPRISE","com.amazon.AmazonBusinessIndia.development":"IN_AMAZON_BUSINESS_IOS_SHOPPING_DEVELOPMENT"};Object.freeze(b);return{SdkCallStatusEnum:c,GetPMCallStatusEnum:m,ForceTokenRefreshResponseCode:g,UpiBankRelatedErrorCode:q,CheckBalanceErrorCode:h,WeblabTreatment:k,FailureReasonEnum:l,SupportedIssuingPspAndConfig:r,S2SMethods:e,OperatingSystem:v,PackageName:b}});r("upiEvents",[],function(){return{DeviceSignatureMatchesEventName:"DeviceSignatureMatchesEvent",
DeviceSignatureDoesNotMatchEventName:"DeviceSignatureDoesNotMatchEvent",DeviceFingerprintValidationPerformedEventName:"DeviceFingerprintValidationPerformed",JuspayHasPermissionsEventName:"JuspayHasPermissionsEvent",NoDevicePermissionsEventName:"NoDevicePermissionsEvent",ErrorEventName:"ErrorEvent",JuspayCheckDeviceSignatureEventName:"JuspayCheckDeviceSignatureEvent",UPIIssuanceNotSupportedEventName:"UPIIssuanceNotSupportedEvent",UPIIssuanceSupportedEventName:"UPIIssuanceSupportedEvent",UpiIdValidateSuccessEvent:"UpiIdValidateSuccess",
UpiRedirectionContinueEventName:"UpiRedirectionContinueEvent",InitializeDeviceSignatureCheckEventName:"InitializeDeviceSignatureCheckEvent",CheckDeviceSignatureEventName:"CheckDeviceSignatureEvent",GetPaymentMethodDetailsByIdEventName:"GetPaymentMethodDetailsByIdEvent",DeviceSignatureCheckMockEventNameForApxSandbox:"DeviceSignatureCheckMockEventNameForApxSandbox"}})})()});
/* ******** */
(function(k){var e=window.AmazonUIPageJS||window.P,c=e._namespace||e.attributeErrors,d=c?c("APXWidgetsAssets@APXWidgets-PayApps","APXWidgetsAssets"):e;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,e,c){(function(){var d=PaymentsPortal2.modules.define;d("redirection-utils",["jQuery","mini-browser-helper","AUI!P","clog"],function(d,n,p,a){var g={},k={width:600,height:800};g.handleInterstitialPageRedirection=function(h,l,f){var b=h.interstitialPageUrl,m=h.widgetAction;
h=h.widgetActionType;l&&("add-pay-apps"===m&&"add-payment-instrument"===h||"add-pay-pay-funds"===m)&&(b===c?(a.logCounterMetric({feature:"PayAppInterstitialPageUrlUndefined",resource:"_Count"}),a.publishMetrics()):f&&"add-pay-apps"===m?g.openPayPayMiniBrowserWindow(b):e.location.href=b)};g.openPayPayMiniBrowserWindow=function(a){this._paypay_window=n.openInMiniBrowser(a,"apx-add-paypay-mini-window",k);this._paypay_window.focus();monitorPayPayMinibrowserWindow()};monitorPayPayMinibrowserWindow=function(){e.clearTimeout(this._paypay_window_timer);
!this._paypay_window||this._paypay_window.closed?(hidePopoverModal(),this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})):this._paypay_window_timer=setTimeout(monitorPayPayMinibrowserWindow.bind(this),100)};hidePopoverModal=function(){p.when("a-modal").execute(function(a){a&&(a=a.get("apx-add-paypay-modal"))&&a.hide()})};return g});d("components/AddPayAppComponent",
"events/form-submitted-event jQuery form-component lang AUI!P clog redirection-utils".split(" "),function(g,c,d,a,k,q,h){return d.extend({_hasErrors:!1,_redirectionEnabled:!1,initialize:function(a,f){this._action=f.data.action;this._hasErrors=f.data.hasErrors;this._instrumentId=f.data.instrumentId;this._redirectionEnabled=f.data.redirectionEnabled;this._isMiniBrowserEnabled=f.data.isMiniBrowserEnabled;this._interstitialPageUrl=f.data.interstitialPageUrl},bindToElements:function(){var l=this;k.when("A",
"a-modal","ready").execute(function(a,b){l.getDOMElement("apx-add-paypay-modal-go-button").click(function(){h.openPayPayMiniBrowserWindow(l._interstitialPageUrl)})});this.getDOMElement("addPayPaySubmitButton").click(a.bind(this._handleFormSubmission,this));l._isMiniBrowserEnabled&&this.getDOMElement("addPayPayPopOverButton").click(a.bind(this._showPopoverModal,this))},_showPopoverModal:function(){this.getDOMElement("apx-add-paypay-modal-trigger").click()},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",
a,function(){a._initPopoverState();a._interstitialPageUrl&&(a._isMiniBrowserEnabled?a._showPopoverModal():e.location.href=this._interstitialPageUrl)});a.widget.on(g,a,function(f){f.action===a._action&&c(a.getDOMElement("addPayAppForm")).submit()});a.widget.on("WidgetAction",this,function(a){h.handleInterstitialPageRedirection(a,this._redirectionEnabled,this._isMiniBrowserEnabled)})},_initPopoverState:function(){this.refreshAddPayAppPopover()},refreshAddPayAppPopover:function(){k.when("a-modal").execute(function(a){a&&
(a=a.get("addPayAppPopover"))&&a.isActive()&&a.refresh()})},_handleFormSubmission:function(a){var c=this.form.validateForm(),b=this.getFormSubmissionParameters("addPayAppFormContainer"),m=e.location.pathname+e.location.search;this.getDOMElement("pmts-portal-pay-apps-client-page-url").val(m);if("/unlimited/signup"===m||"/music/settings/editpayment"===m)console.log("There are {} errors in the list for handleFormSubmissions.",c.length),console.log("errorMessage list is : {}",c);0===c.length?this.widget.trigger(g,
{event:a,submissionParameters:b,action:this._action}):a.preventDefault();return!1}})});d("components/SelectablePayAppsListComponent",["form-component"],function(c){return c});d("components/SelectablePayAppsListItemComponent","components/SelectableDPMInstrumentListItemComponent events/InstrumentRowSelectedEvent clog css-utils continuable jQuery redirection-utils events/SelectablePaymentOptionEvents fetch-balance".split(" "),function(d,n,p,a,r,q,h,l,f){return d.extend(r,{_instrumentId:c,_redirectionEnabled:!1,
_authenticationRetryEnabled:!1,_numberOfRetries:2,_retryIntervalInMillis:1E3,_payPayLiveBalanceLookUpEnabled:!1,_shouldDisableContinueButton:!1,_totalPurchaseAmount:c,_gcAmount:0,_jpPointsAmount:0,_promoAmount:0,_isDigitalWalletAlreadySelected:!1,_balanceDisplayed:!1,_fetchedBalance:c,_externalTokenSecureData:null,_externalTokenSecureEncryptionSystem:null,initialize:function(b,a){this.paymentMethodCategory=a.data.paymentMethodCategory;this.isMultiTenderEnabled=a.data.isMultiTenderEnabled;this.shouldDisableMultipleFetchBalance=
a.data.shouldDisableMultipleFetchBalance;this._instrumentId=a.data.instrumentId;this._redirectionEnabled=a.data.redirectionEnabled;this._authenticationRetryEnabled=a.data.authenticationRetryEnabled;this._payPayLiveBalanceLookUpEnabled=a.data.payPayLiveBalanceLookUpEnabled;this._shouldDisableContinueButton=a.data.payPayDisableContinueButton;this._externalTokenSecureData=a.data.externalTokenSecureData;this._externalTokenSecureEncryptionSystem=a.data.externalTokenSecureEncryptionSystem;this._isMiniBrowserEnabled=
a.data.isMiniBrowserEnabled;a.data.fetchBalanceRetries!==c&&(this._numberOfRetries=a.data.fetchBalanceRetries);a.data.fetchBalanceRetryIntervalInMs!==c&&(this._retryIntervalInMillis=a.data.fetchBalanceRetryIntervalInMs);a.data.purchaseAmount!==c&&(this._totalPurchaseAmount=a.data.purchaseAmount);this.closeAddPayAppsPopover()},bindToEvents:function(){var b=this;b.widget.on("WidgetAction",b,function(a){h.handleInterstitialPageRedirection(a,b._redirectionEnabled,b._isMiniBrowserEnabled)});b.widget.on(n,
b,function(a){b._instrumentRowSelected(a.instrumentId);b._authenticationRetryEnabled&&b._handleAuthRetryButtonDisplay(a);b.shouldDisableMultipleFetchBalance&&b._isDigitalWalletAlreadySelected||!b._digitalWalletInstrumentRowSelected(a)||!b._payPayLiveBalanceLookUpEnabled||b._authenticationRetryEnabled||b._handlePayPayBalanceLinkClick();b._isDigitalWalletAlreadySelected=b.isMultiTenderEnabled&&b._digitalWalletInstrumentRowSelected(a)});b.widget.on("balanceSelectionChanged",b,function(a){b.isMultiTenderEnabled&&
b._balanceSelectionChangedEventHandler(a)})},_balanceSelectionChangedEventHandler:function(b){"JPPoints"===b.paymentMethod?this._jpPointsAmount=b.balance:"GC"===b.paymentMethod?this._gcAmount=b.isSelected?b.balance:0:"PROMO"===b.paymentMethod&&(this._promoAmount=b.isSelected?b.balance:0);this._balanceDisplayed&&this._fetchedBalance!==c&&(b=parseInt(this._jpPointsAmount)+parseInt(this._gcAmount)+parseInt(this._promoAmount),this._handleInsufficientBalanceMessage(b))},_digitalWalletInstrumentRowSelected:function(b){return b.instrumentId===
this._instrumentId&&b.instrumentCategory===this.paymentMethodCategory},_handleAuthRetryButtonDisplay:function(b){this._digitalWalletInstrumentRowSelected(b)?(this.setContinuable(!1),this.widget.trigger(l.PaymentPlanSelected,{isValid:!1,message:"",notValidReason:"NotAuthenticated",paymentMethod:this.paymentMethodCategory}),a.showElement(this.getDOMElement("pmts-portal-pay-apps-authenticate-pay-app-button-section-binding"))):a.hideElement(this.getDOMElement("pmts-portal-pay-apps-authenticate-pay-app-button-section-binding"))},
_handleRetry:function(b){b.preventDefault();this.widget.submitFormAJAX({"ppw-widgetEvent":"AuthenticatePayAppEvent","ppw-paymentMethodId":this._instrumentId,"ppw-payAppsClientPageURL":e.location.pathname+e.location.search,"ppw-widgetState":this.widget.options.serializedState})},poaInstrumentClicked:function(b){this.widget.trigger(n,{instrumentId:b,instrumentCategory:this.paymentMethodCategory,isMultiTenderEnabled:this.isMultiTenderEnabled,isAuthenticationRetryEnabled:this._authenticationRetryEnabled})},
closeAddPayAppsPopover:function(){k.when("a-modal").execute(function(b){b&&(b=b.get("addPayAppPopover"))&&b.hide()})},bindToElements:function(){var b=this;b.getDOMElement("pmts-portal-pay-apps-see-pay-pay-balance").click(function(a){b.publishCountMetrics("PayAppsSeePayPayBalanceClick");a.preventDefault();b._handlePayPayBalanceLinkClick()});b.getDOMElement("pmts-portal-pay-apps-pay-pay-refresh-balance-success").click(function(a){b.publishCountMetrics("PayAppsRefreshPayPayBalanceClick");a.preventDefault();
b._handlePayPayBalanceLinkClick()});b.getDOMElement("pmts-portal-pay-apps-see-pay-pay-balance-failure").click(function(a){b.publishCountMetrics("PayAppsSeePayPayBalanceAfterFailureClick");a.preventDefault();b._handlePayPayBalanceLinkClick()});b.getDOMElement("pmts-portal-pay-apps-authenticate-pay-app-button-binding").click(function(a){b._handleRetry(a)});b.getDOMElement("pmts-portal-pay-apps-add-funds").click(function(a){b._handlePayPayAddFundsClick(a)});b.instrumentSpecificHelper?b.instrumentSpecificHelper.bindToElements():
(b.getDOMElementsByPrefix("POAInstrumentContainer").click(function(a){q(a.currentTarget).data("disabled")||b.poaInstrumentClicked(b._instrumentId)}),b.widget.on("initializeRecommendedInstrument",b,function(a){a.instrumentId!==b._instrumentId||b.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||(b._poaInstrumentSelected(),b.poaInstrumentClicked(b._instrumentId))}))},_handlePayPayBalanceLinkClick:function(){var a=this,c={widget:a.widget,instrumentId:a._instrumentId,eventName:"FetchBalanceEvent",
successView:function(b){a.showPayPayBalanceSuccessView(b)},failureView:function(){a.showPayPayBalanceFailureView()},pendingView:function(){a.showPayPayBalancePendingView()},numberOfRetries:a._numberOfRetries,retryDelayInMs:a._retryIntervalInMillis};a.publishCountMetrics("PayAppsPayPayFetchBalanceInitiated");f.fetchBalance(c)},_handlePayPayAddFundsClick:function(){event.preventDefault();var a=e.location.pathname+e.location.search,d=this._totalPurchaseAmount,g=parseInt(this._jpPointsAmount)+parseInt(this._gcAmount)+
parseInt(this._promoAmount);this.isMultiTenderEnabled&&this._totalPurchaseAmount!==c&&parseInt(d)>g&&(d=(parseInt(d)-g).toString());this.widget.submitFormAJAX({"ppw-widgetEvent":"AddPayPayFundsEvent","ppw-paymentMethodId":this._instrumentId,"ppw-payAppsClientPageURL":a,"ppw-widgetState":this.widget.options.serializedState,"ppw-externalTokenSecureData":this._externalTokenSecureData,"ppw-externalTokenSecureEncryptionSystem":this._externalTokenSecureEncryptionSystem,"ppw-purchaseAmount":d})},showPayPayBalanceSuccessView:function(b,
c){c=Number(b).toLocaleString("en-US");c=this.widget.getLocalizedString("pmts_portal_pay_apps_pay_pay_success_balance",{balance:c});this.getDOMElement("pmts-portal-pay-apps-pay-pay-success-balance-text").html(c);a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-initial-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-failure-section"));a.showElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-success-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-pay-fetch-balance-pending-section"));
this.publishCountMetrics("PayAppsPayPayBalanceSuccessView");this._balanceDisplayed=!0;this._fetchedBalance=b;this.isMultiTenderEnabled?(b=parseInt(this._jpPointsAmount)+parseInt(this._gcAmount)+parseInt(this._promoAmount),this._handleInsufficientBalanceMessage(b)):this._handleInsufficientBalanceMessage(0)},showPayPayBalancePendingView:function(){this._balanceDisplayed=!1;a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-initial-section"));
a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-failure-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-success-section"));a.showElement(this.getDOMElement("pmts-portal-pay-pay-fetch-balance-pending-section"))},showPayPayBalanceFailureView:function(){this._balanceDisplayed=!1;this._fetchedBalance=c;a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-initial-section"));
a.showElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-failure-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-success-section"));a.hideElement(this.getDOMElement("pmts-portal-pay-pay-fetch-balance-pending-section"));this.publishCountMetrics("PayAppsPayPayBalanceFailureView")},_handleInsufficientBalanceMessage:function(b){this._totalPurchaseAmount!==c&&parseInt(this._totalPurchaseAmount)>parseInt(this._fetchedBalance)+parseInt(b)?(a.showElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section")),
this._isDigitalWalletAlreadySelected&&this._shouldDisableContinueButton&&(this.setContinuable(!1),this.widget.trigger(l.PaymentPlanSelected,{isValid:!1,message:"",notValidReason:"InsufficientBalance",paymentMethod:this.paymentMethodCategory})),this.publishCountMetrics("PayAppsPayPayInsufficientBalanceView")):a.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section"))},publishCountMetrics:function(a){p.logCounterMetric({feature:a,resource:"_Count"});p.publishMetrics()}})});
d("components/PayPayDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,a){this._paymentMethodId=a.data.paymentMethodId;this._paymentMethodType=a.data.paymentMethodType;this._paymentMethodSubCategory=a.data.paymentMethodSubCategory},bindToElements:function(){this._bindEditPMLink()}})});d("components/PayPayEditComponent",["component","EditComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,a){d._initializePopover(c,
a,this)},bindToEvents:function(){d._bindPopoverCloseButtonClickedEvent(this)}})});d("components/PayPaySleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,a){this._instrumentId=a.data.instrumentId}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-AmazonBankConnect","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/LinkAccountCardComponent",["component","metrics-helper","lang","jQuery"],function(a,c,d,b){return a.extend({bindToElements:function(){var a=this;this.redirectionUrl=this.data.redirectionUrl;
b(".abc-linkable-accounts-dropdown").change(function(){a._handleAbcDropdownChange()});this.getDOMElement("add-card-continue-button").click(d.bind(this._handleAbcContinueButtonClick,this));c.publishOnClickSuccessSushiMetrics(a,[{JsBindElementId:"add-card-continue-button",MetricsObject:{ActionType:"AddCreditCard",ActionValueType:"AddMethod",ActionValue:"BankConnect"}}])},_handleAbcContinueButtonClick:function(a){return b(".abc-linkable-accounts-dropdown").val()?!0:(this._displayAbcChooseBankErrorMessage(),
!1)},_handleAbcDropdownChange:function(){this._hideAbcChooseBankErrorMessage();this._assignAbcContinueButtonRedirectUrl()},_displayAbcChooseBankErrorMessage:function(){b("#abc-add-card-partner-select-id").toggleClass("a-button-error",!0);b("#abc-linkable-accounts-dropdown-error-container-id").toggleClass("a-hidden aok-hidden",!1)},_hideAbcChooseBankErrorMessage:function(){b("#abc-add-card-partner-select-id").attr("class").includes("a-button-error")&&(b("#abc-add-card-partner-select-id").toggleClass("a-button-error",
!1),b("#abc-linkable-accounts-dropdown-error-container-id").toggleClass("a-hidden aok-hidden",!0))},_assignAbcContinueButtonRedirectUrl:function(){var a=b(".abc-linkable-accounts-dropdown").val();b(".abc-add-card-continue-button").attr("href",encodeURI(this.redirectionUrl+a))}})});a("components/LinkToAddCardComponent","component metrics-helper mash-helper lang jQuery clog".split(" "),function(a,d,e,b,g,f){return a.extend({initialize:function(a,b){this.partnerListURL=b.data.partnerListURL;this.isAmazonApp=
b.data.isAmazonApp},bindToElements:function(){this.getDOMElement("link-to-add-card-button").click(b.bind(this._handleLinkToAddButtonClick,this))},_handleLinkToAddButtonClick:function(a){f.logCounterMetric({feature:"LinkYourCard",resource:"_Count"});f.publishMetrics();a.preventDefault();this.isAmazonApp?e.navigateToUrl("https://www.amazon.com/amazonbankconnect"):c.parent.location.href=this.partnerListURL}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,e=b._namespace||b.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-AmazonPaymentProducts","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,e){(function(){var a=PaymentsPortal2.modules.define;a("components/APPCardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(a,b,d){return a.extend(b,{initialize:function(a,c){this._paymentMethodId=c.data.paymentMethodId;
this._paymentMethodType=c.data.paymentMethodType;this._foregroundColor=c.data.foregroundColor;this._refreshData=c.data.refreshData;this._messageHeader=c.data.messageHeader;this._messageType=c.data.messageType;this._messageContent=c.data.messageContent;this._paymentInstrumentId=c.data.paymentInstrumentId},bindToElements:function(){var a=this;a._bindEditPMLink();d(".apx-wallet-card-art-foreground-color").css("color",a._foregroundColor);a.widget.on("componentsInitialized",a,function(){this._refreshData&&
a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"CardClaimOwnershipRefreshEvent","ppw-messageHeader":this._messageHeader,"ppw-messageType":this._messageType,"ppw-messageContent":this._messageContent,"ppw-paymentInstrumentId":this._paymentInstrumentId})})}})});a("components/APPSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(e){var f=window.AmazonUIPageJS||window.P,g=f._namespace||f.attributeErrors,b=g?g("APXWidgetsAssets@APXWidgets-PayTo","APXWidgetsAssets"):f;b.guardFatal?b.guardFatal(e)(b,window):b.execute(function(){e(b,window)})})(function(e,f,g){(function(){var b=PaymentsPortal2.modules.define;b("components/AddPayToComponent",["jQuery","component","lang"],function(b,d,h){return d.extend({initialize:function(a){this._deviceType=a.options.deviceType;this._isDesktop="desktop"===this._deviceType;this._isMobile=
"mobile"===this._deviceType;this._popoverComponent=this._isDesktop?"a-modal":"a-secondary-view";this._widgetAction="add-payto"},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){e.when("A",a._popoverComponent,"ready").execute(function(c){c.on("a:popover:show:apx-payto-creatable-popover-modal",function(){a._lockPopoverModal()});c.on("a:popover:hide:apx-payto-creatable-popover-modal",function(){a.getDOMElement("apx-payto-iframe").attr("src","about:blank")});c.declarative("apx-payto-creatable-modal-close-button",
"click",function(){a._closePopoverModal();a._triggerRefreshWidget()})});this._bindMessageListener()})},bindToElements:function(){},_lockPopoverModal:function(){e.when("A",this._popoverComponent,"ready").execute(function(a,c){c&&(a=c.get("apx-payto-creatable-popover-modal"))&&a.isActive()&&a.lock(11).show()})},_closePopoverModal:function(){e.when("A",this._popoverComponent,"ready").execute(function(a,c){c&&(a=c.get("apx-payto-creatable-popover-modal"))&&a.isActive()&&a.unlock(11).hide()})},_triggerRefreshWidget:function(a){"undefined"==
typeof a?this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent","ppw-widgetAction":this._widgetAction}):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a,"ppw-widgetAction":this._widgetAction})},_bindMessageListener:function(){var a=h.bind(this._processBetsyMessage,this);h.addEventListener(f,"message",a)},_processBetsyMessage:function(a){try{var c=
JSON.parse(a.data)}catch(k){return}if(c&&c.linkingStatus)switch(c.linkingStatus){case "LinkingSuccessful":this._isDesktop&&this._resizeIFrame("342px");break;case "LinkingFailed":this._isDesktop&&this._resizeIFrame("343px");break;case "LinkingPending":this._isDesktop&&this._resizeIFrame("349px");break;case "LinkingCancelled":this._closePopoverModal();break;case "LinkingCompleted":this._closePopoverModal(),this._triggerRefreshWidget(c.paymentMethodId)}},_resizeIFrame:function(a){this.getDOMElement("apx-payto-iframe").css("height",
a)}})});b("components/SelectablePayToListComponent",["form-component"],function(b){return b});b("components/SelectablePayToListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(b,d){return b.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(d,{instrumentId:this._instrumentId})});this.widget.on(d,this,function(b){this._instrumentRowSelected(b.instrumentId)})}})});
b("components/PayToDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(b,d,e){return b.extend(d,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});b("components/PayToSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(b,d){return b.extend(d,{initialize:function(b,a){this._instrumentId=a.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-NetBankingCard","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/NetBankingCardListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang","public-event-registry"],function(a,b,c,d,e){return c.extend({initialize:function(f,
b){e.register(a);this._toggleBankSelectionInput(b.data.initiallySelected);this._togglePayURedirectionInfoMessage(!1)},_toggleBankSelectionInput:function(a){this.getDOMElement("netbanking-card-bank-selection-hidden-input").prop("disabled",!a)},_togglePayURedirectionInfoMessage:function(a){b.toggleElement(this.getDOMElement("netbanking-card-payu-redirection-info-message"),a)},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",
!0);this._toggleBankSelectionInput(!0);this._triggerBackingInstrumentSelectedEvent(this._getDisplayableErrors(this.form.validateForm(!0)));this._togglePayURedirectionInfoMessage(!0)},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this._toggleBankSelectionInput(!1);this._togglePayURedirectionInfoMessage(!1)},_getContainerElement:function(){return this.getDOMElement("netBankingCardContainer")},
bindToEvents:function(){var b=this;d.forEach(["initializeRecommendedInstrument",a],function(a){b.widget.on(a,b,function(a){a.instrumentId===b._getInstrumentId()?b._onInstrumentSelected():b._onInstrumentDeselected()})})}})})})()});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-RewardsInfluencer","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,e){(function(){var a=PaymentsPortal2.modules.define;a("components/RewardsInfluencerComponent","events/InstrumentRowSelectedEvent css-utils component lang aui-helper jQuery keyboard clog AUI!P".split(" "),function(a,d,c,e,g,h,k,l,f){return c.extend({initialize:function(a,
b){},bindToEvents:function(){f.when("A","ready").execute(function(a){a.on("a:expander:toggle:expand",function(b){var a=b.expander.expanderName||"";b=b.expander.$expander;!a.includes("RewardsInfluencerOfferExpanderFooter_")&&b&&0<b.find(".a-divider-normal").length?b.find(".apx-rewards-influencer-offer-expander-upto-price-div").hide():a.includes("RewardsInfluencerOfferExpanderFooter_")&&b&&(b.find(".apx-rewards-influencer-offer-category-footer-header-expand").hide(),b.find(".apx-rewards-influencer-offer-category-footer-header-collapse").show())});
a.on("a:expander:toggle:collapse",function(a){var b=a.expander.$expander;(a.expander.expanderName||"").includes("RewardsInfluencerOfferExpanderFooter_")&&b?(b.find(".apx-rewards-influencer-offer-category-footer-header-expand").show(),b.find(".apx-rewards-influencer-offer-category-footer-header-collapse").hide()):b&&b.find(".apx-rewards-influencer-offer-expander-upto-price-div").show()})})}})})})()});
/* ******** */
(function(f){var c=window.AmazonUIPageJS||window.P,h=c._namespace||c.attributeErrors,a=h?h("APXWidgetsAssets@APXWidgets-ClientSideTestingSupport","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,c,h){(function(){var a=PaymentsPortal2.modules.define;a("test/client/default",["base","lang"],function(a,e){return a.extend({initialize:function(){this.testWidget=TestWidgetFactory.create();this.selectableCCListProxy=this._getSelectableCCListProxy();
this.ccListItemProxies=this._getCCListItemProxies()},_getSelectableCCListProxy:function(){var a=this.testWidget.getComponentProxiesByType("SelectableCreditCardListComponent");if(a)return a[0];console.log("No selectable CC list found.")},_getCCListItemProxies:function(){var a=this.testWidget.getComponentProxiesByType("CreditCardListItemComponent");if(a)return a;console.log("No CC List Items found.")},getCCSelectionElementByTail:function(a){if(this.ccListItemProxies){var b=e.filter(this.ccListItemProxies,
function(b){return b.getAccountTail()===a});if(b)return b=b[0].getInstrumentId(),this.selectableCCListProxy.getCCSelectionElement(b);console.log("No matching CC Item found for tail: "+a)}else console.log("No CC Items to lookup.")}})});a("test/proxy/CreditCardListItemComponent",["base","lang","when"],function(a,e,c){return a.extend({initialize:function(a,d){a=d.data;this.instrumentId=a.instrumentId;this.accountTail=a.tail},getInstrumentId:function(){return this.instrumentId},getAccountTail:function(){return this.accountTail}})});
a("test/proxy/SelectableCreditCardListComponent",["base","lang","when"],function(a,e,c){var b=/^instrumentRowSelection-(.*)/,d=function(a){return b.test(a)};return a.extend({initialize:function(a,c){var k=c.data;a=e.filter(e.keys(k),d);var g=this;this.instrumentIdToSelectionElement={};e.forEach(a,function(a){var d=b.exec(a)[1];g.instrumentIdToSelectionElement[d]=k[a]})},getCCSelectionElement:function(a){return this.instrumentIdToSelectionElement[a]}})});a("test/widget",["base","lang","when"],function(a,
e,c){return a.extend({initialize:function(a,d,c){this.id=a;this.name=d;this.componentProxiesByType={};this._initializeProxies(c)},_initializeProxies:function(a){var d=this,b=e.map(a,function(a){return"test/proxy/"+a.type});e.forEach(b,function(b,e){var g=a[e],f=g.type;c([b],function(a){d.componentProxiesByType[f]||(d.componentProxiesByType[f]=[]);d.componentProxiesByType[f].push(new a(d,g))})})},getComponentProxiesByType:function(a){return this.componentProxiesByType[a]}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-PayNow","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/PayNowListItemComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({initialize:function(b,a){this.setDisabled(a.data.isPayNowDisabled)},
bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("payNowContainer")}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-DPMCommon","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableDPMCommonListComponent",["form-component"],function(a){return a});a("components/SelectableDPMCommonListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],function(a){return a})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,b=c._namespace||c.attributeErrors,a=b?b("APXWidgetsAssets@APXWidgets-PaymentLocation","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,b){(function(){var a=PaymentsPortal2.modules.define;a("components/PaymentLocationComponent","events/form-submitted-event form-component lang jQuery css-utils clog aui-helper events/spinner-events".split(" "),function(a,c,e,b,g,h,k,f){return c.extend({initialize:function(a,
b){this._action=b.data.action},bindToElements:function(){this.getDOMElement("pmts-search-continue-button").click(e.bind(this._handleFormSubmission,this))},bindToEvents:function(){var d=this;d.widget.trigger(f.hideSpinner);d.widget.forceToScrollToTopOfThePage();b("#pmts-edit-button-id").click(function(a){b("#pmts-search-edit-form-container").css("display","none");b("#pmts-search-form-container").css("display","block");a.preventDefault()});d.widget.on(a,d,function(a){a.action===d._action&&d.getDOMElement("pmts-search-form").submit()})},
_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var c=this.getFormSubmissionParameters("searchFormContainer");this.widget.trigger(a,{queryParameters:this.data.queryParams,submissionParameters:c,event:b,action:this._action})}}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-ConsumerInvoicing","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/ConsumerInvoicingDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(b,a,c){return b.extend(a,{initialize:function(b,a){this._paymentMethodId=
a.data.paymentMethodId;this._paymentMethodType=a.data.paymentMethodType;this._isDefault=a.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});b("components/ConsumerInvoicingSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(b,a){return b.extend(a,{initialize:function(b,a){this._instrumentId=a.data.instrumentId}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-Boleto","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/BoletoComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({initialize:function(b,a){this.setDisabled(a.data.isBoletoDisabled)},
bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?(this._toggleRecurringPaymentEligibilityMessage(!0),a._onInstrumentSelected()):(this._toggleRecurringPaymentEligibilityMessage(!1),a._onInstrumentDeselected())})},_toggleRecurringPaymentEligibilityMessage:function(a){this.widget.trigger("toggleRecurringPaymentEligibilityMessage",{instrumentId:this.data.instrumentId,isSelected:a})},_getContainerElement:function(){return this.getDOMElement("boletoContainer")}})})})()});
/* ******** */
(function(g){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,c=e?e("APXWidgetsAssets@APXWidgets-AmazonPayInstruments","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(g)(c,window):c.execute(function(){g(c,window)})})(function(g,d,e){(function(){var c=PaymentsPortal2.modules.define;c("components/SelectableAmazonPayInstrumentsListComponent","component css-utils continuable events/InstrumentRowSelectedEvent lang public-event-registry events/spinner-events clog".split(" "),function(c,
g,e,h,l,k,m,f){return c.extend(e,{initialize:function(a,b){k.register("APPInstrumentsRedirectionRequiredEvent");k.register("APPRedirectionContinueEvent");this.currentInstrumentId=b.data.instrumentId;this.instrumentType=b.data.instrumentType;this.appInstrumentsIssuance=b.data.appInstrumentsIssuance;this.nomenclatureWave2Enabled=b.data.nomenclatureWave2Enabled;this.isInlineIssuanceEnabled=b.data.isInlineIssuanceEnabled;this.redirectUrl=b.data.redirectUrl;this.isInlineIssuanceEnabled&&k.register(h);
this.bindToEvents()},_getAmazonPayInstrumentsContainer:function(){return this.getDOMElementsByPrefix("appInstrumentsContainer")},_onInstrumentSelected:function(){this._getAmazonPayInstrumentsContainer().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._triggerBackingInstrumentSelectedEvent()},_getInstrumentSelectionInputElement:function(){return this.nomenclatureWave2Enabled?this.getDOMElement("instrumentRowSelection-"+this.appInstrumentsIssuance):this.getDOMElement("instrumentRowSelection-"+
this.currentInstrumentId)},_onInstrumentDeselected:function(){this._getAmazonPayInstrumentsContainer().removeClass("pmts-selected")},_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.currentInstrumentId,instrumentType:this.instrumentType,errors:[],isAPPInstrumentRedirectionRequired:this._isAPPRedirectionRequired()});this._publishMetricsOnInstrumentSelection()},_publishMetricsOnInstrumentSelection:function(){this.isFirstTimeInstrumentSelection&&
(f.publishMetrics(),this.isFirstTimeInstrumentSelection=!1)},_isAPPRedirectionRequired:function(){return this.isInlineIssuanceEnabled},_isInstrumentSelected:function(){return this._getAmazonPayInstrumentsContainer().hasClass("pmts-selected")},_amazonPayInlineIssuanceOptionClicked:function(a){this.isInlineIssuanceEnabled&&this.widget.trigger(h,{instrumentId:this.currentInstrumentId,instrumentType:this.instrumentType,isInstrumentOwned:!0})},bindToEvents:function(){var a=this;this.getDOMElementsByPrefix("appInstrumentsContainer").click(l.bind(this._amazonPayInlineIssuanceOptionClicked,
this));a.widget.on(h,this,function(b){b.instrumentId===this.currentInstrumentId?this._onInstrumentSelected():a._onInstrumentDeselected()})},bindToElements:function(){var a=this;a.widget.on("APPInstrumentsRedirectionRequiredEvent",a,function(){return!1});a.widget.on("APPRedirectionContinueEvent",a,function(){var b=f.getCurrentTime();a._isInstrumentSelected()&&(a.widget.trigger(m.showSpinner),"undefined"!==typeof this.redirectUrl&&(f.logCounterMetric({feature:"APPRegistrationRedirection",resource:"_Count"}),
d.location=this.redirectUrl),f.logLatencyMetric({feature:"APPRegistrationRedirection",resource:"_Latency",startTime:b}),f.publishMetrics());return!1})}})})})()});
/* ******** */
(function(h){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,c=f?f("APXWidgetsAssets@APXWidgets-AmazonProductVouchers","APXWidgetsAssets"):e;c.guardFatal?c.guardFatal(h)(c,window):c.execute(function(){h(c,window)})})(function(h,e,f){(function(){var c=PaymentsPortal2.modules.define;c("components/AddProductVoucherComponent",["component","clog"],function(g,c){return g.extend({bindToElements:function(){this.getDOMElement("WalletAddBalanceRedeemPV").bind("click",function(){c.logCounterMetric({feature:"WalletAddBalanceRedeemPV",
resource:"_Count"});c.publishMetrics()})}})});c("components/ProductVoucherDetailsSlotComponent",["component"],function(c){return c.extend({initialize:function(c,g){this._paymentMethodId=g.data.paymentMethodId}})});c("components/DummyComponent",["component"],function(c){return c.extend({initialize:function(){e.alert("DummyComponent initialized")}})});c("components/ProductVoucherListComponent",["component"],function(c){return c.extend({initialize:function(){}})});c("components/ProductVoucherListItemComponent",
"events/InstrumentRowSelectedEvent public-event-registry jQuery css-utils component clog lang mixins/b2b-cross-wallet-mixin".split(" "),function(c,e,q,d,m,k,n,p){return m.extend(p,{_isNotOwnedInstrumentSelected:!1,initialize:function(a,b){e.register(c);this.canPVEligibleAmountCoverPurchaseTotalAfterPromo=b.data.canPVEligibleAmountCoverPurchaseTotalAfterPromo;this.canPVEligibleAmountCoverPurchaseTotalWithOutPromo=b.data.canPVEligibleAmountCoverPurchaseTotalStandalone;this.canPVBalanceCoverPurchaseTotalAfterPromo=
b.data.canPVBalanceCoverPurchaseTotalAfterPromo;this.canPVBalanceCoverPurchaseTotalWithOutPromo=b.data.canPVBalanceCoverPurchaseTotalStandalone;this.canPromoCoverPurchaseWithoutProductVoucher=b.data.canPromoCoverPurchaseWithoutProductVoucher;this.productVoucherBalance=b.data.productVoucherBalance;this.displayablePurchaseTotal=b.data.displayablePurchaseTotal;this.displayablePurchaseTotalAfterPromo=b.data.displayablePurchaseTotalAfterPromo;this.promoIdentifier=b.data.promoIdentifier;this.productVoucherIdentifier=
b.data.productVoucherIdentifier;this.productVoucherTypeStringId=b.data.productVoucherTypeStringId;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.disallowAutoSelectionWhenConvertingToCheckbox=b.data.disallowAutoSelectionWhenConvertingToCheckbox;this.productVoucherType=this.widget.getLocalizedString(this.productVoucherTypeStringId);this.isPromoBalanceNone=b.data.isPromoBalanceNone;this.shouldDisplayModernizedFrameCX=b.data.shouldDisplayModernizedFrameCX;
this.instrumentRowSelectionValue=b.data.instrumentRowSelectionValue;this.productVoucherToggleSwitchName=b.data.productVoucherToggleSwitchName;this._modernizedPaymentArtGridCssClass=b.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=b.data.disabledSectionCssClass;this.isRadioButtonDisplay=this._shouldDisplayRadioButton(!0);this.productVoucherId=b.data.productVoucherId;this.isPVIneligible=b.data.isPVIneligible;this.$checkbox=this.getDOMElement("productVoucherBalanceSelection");this.$toggleSwitch=
this.getDOMElement(this.productVoucherToggleSwitchName);this.$toggleSwitchInput=this.$toggleSwitch.find("input");this.$checkboxContainer=this.getDOMElement("productVoucherCheckboxDisplay");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.productVoucherId);this.$radioButtonContainer=this.getDOMElement("productVoucherRadioButtonDisplay");this.$container=this.getDOMElement("productVoucherContainer");this.$pvIneligibleWarningMessage=this.getDOMElement("pvIneligibleWarningMessageDisplay");
this._setTitleAttributeToElement(this.$checkbox);this._setTitleAttributeToElement(this.$radioButton);this._setTitleAttributeToElement(this.$toggleSwitch)},_setTitleAttributeToElement:function(a){try{a.length&&this.getDOMElement("productVoucherMsgWithPromo")&&this.getDOMElement("productVoucherMsgWithPromo")[0]&&a.attr({title:this.getDOMElement("productVoucherMsgWithPromo")[0].textContent})}catch(b){k.logCounterMetric({feature:"ProductVoucherSetTitleAttributeToElement",resource:"_ErrorCount"}),k.publishMetrics()}},
_checkFormInput:function(a){this.isRadioButtonDisplay?this.$radioButton.prop("checked",a):this._updateOptionalProductVoucherSelected(a)},_toggleOptionalProductVoucher:function(){this._isOptionalProductVoucherEnabled()&&this._setProductVoucher(!this._isOptionalProductVoucherSelected())},_setProductVoucher:function(a){a?this._selectProductVoucher():this._unselectProductVoucher()},_unselectProductVoucher:function(){this.isRadioButtonDisplay?this.$container.toggleClass("pmts-selected",!1):this._triggerOptionalInstrumentDeselectedEvent();
this._checkFormInput(!1);this._triggerBalanceSelectionChangedEvent(!1)},_selectProductVoucher:function(){this.isRadioButtonDisplay?(this.$container.toggleClass("pmts-selected",!0),this._triggerBackingInstrumentSelectedEvent(this.productVoucherId)):this._triggerOptionalInstrumentSelectedEvent();this._checkFormInput(!0);this._triggerBalanceSelectionChangedEvent(!0)},_deselectCurrentDisplay:function(){!0===this.isRadioButtonDisplay&&this.$radioButton.prop("checked")?(this._unselectProductVoucher(),this.widget.trigger(c,
{}),this._triggerBackingInstrumentSelectedEvent(null)):!1===this.isRadioButtonDisplay&&this.$checkbox.prop("checked")&&this._unselectProductVoucher()},_setDisplayToRadioButton:function(){this.isRadioButtonDisplay||(this._isOptionalProductVoucherSelected()&&this._unselectProductVoucher(),this.isRadioButtonDisplay=!0,this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_setDisplayToCheckBoxOrToggleSwitch:function(){this.isRadioButtonDisplay&&(this.$radioButton.prop("checked")&&(this._unselectProductVoucher(),
this._triggerBackingInstrumentSelectedEvent(null)),this.isRadioButtonDisplay=!1,!0===this._isB2BCrossWalletMultitenderEnforcementEnabled?!0!==this.disallowAutoSelectionWhenConvertingToCheckbox&&this._selectProductVoucher():this.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected||this._selectProductVoucher(),this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_toggleRadioButtonDisplay:function(a){d.toggleElement(this.$radioButtonContainer,a);this.shouldDisplayModernizedFrameCX&&
this.$toggleSwitch?d.toggleElement(this.$toggleSwitch,!a):!this.shouldDisplayModernizedFrameCX&&this.$checkboxContainer&&d.toggleElement(this.$checkboxContainer,!a)},_canPVEligibleAmountCoverPurchaseAfterPromoApplied:function(a){return a&&this.canPVEligibleAmountCoverPurchaseTotalAfterPromo&&!this.canPromoCoverPurchaseWithoutProductVoucher||this.canPVEligibleAmountCoverPurchaseTotalWithOutPromo},_canPVBalanceCoverPurchaseAfterPromoApplied:function(a){return a&&this.canPVBalanceCoverPurchaseTotalAfterPromo&&
!this.canPromoCoverPurchaseWithoutProductVoucher||this.canPVBalanceCoverPurchaseTotalWithOutPromo},_shouldDisplayUseSomeOfYourAvailableBalanceMessageType:function(a){return this._canPVBalanceCoverPurchaseAfterPromoApplied(a)&&this.isPromoBalanceNone},_shouldDisplayRadioButton:function(a){return this._canPVEligibleAmountCoverPurchaseAfterPromoApplied(a)},_handlePromoSelectionChange:function(a){this._toggleProductVoucherMsg(a);this._shouldDisplayRadioButton(a)?this._setDisplayToRadioButton():this._setDisplayToCheckBoxOrToggleSwitch()},
_toggleProductVoucherMsg:function(a){if(this.shouldDisplayModernizedFrameCX){var b=this.getDOMElement("productVoucherMsgWithoutPromoMCXRadioButtonString"),c=this.getDOMElement("productVoucherMsgWithPromoMCXRadioButtonString"),e=this.getDOMElement("productVoucherMsgWithoutPromoMCXToggleSwitchString"),f=this.getDOMElement("productVoucherMsgWithPromoMCXToggleSwitchString");d.toggleElement(c,a);d.toggleElement(b,!a);d.toggleElement(f,!a);d.toggleElement(e,a)}else{b=this.getDOMElement("productVoucherMsgWithoutPromo");
c=this.getDOMElement("productVoucherMsgWithPromo");e=this.getDOMElement("productVoucherMsgWithoutPromoWithCheckbox");f=this.getDOMElement("productVoucherMsgWithPromoWithCheckbox");var g=this._productVoucherCoverageMessage(a);g=this.widget.getLocalizedString(g.stringId,g.args);if(a){var h=c;var l=f}else h=b,l=e;try{h[0].innerHTML=g,l[0].innerHTML=g}catch(r){k.logCounterMetric({feature:"ProductVoucherToggleProductVoucherMsg",resource:"_ErrorCount"}),k.publishMetrics()}d.toggleElement(b,!a);d.toggleElement(c,
a);d.toggleElement(e,!a);d.toggleElement(f,a)}},_productVoucherCoverageMessage:function(a){var b=!this.canPromoCoverPurchaseWithoutProductVoucher&&a;return this._shouldDisplayUseSomeOfYourAvailableBalanceMessageType(a)?{stringId:"pmts_portal_payselect_use_some_of_your_available_balance_pv_type",args:{pv_balance:this.productVoucherBalance,amount_to_use:b?this.displayablePurchaseTotalAfterPromo:this.displayablePurchaseTotal,pv_type:this.productVoucherType}}:{stringId:"pmts_portal_payselect_your_available_balance_pv_type",
args:{pv_balance:this.productVoucherBalance,pv_type:this.productVoucherType}}},_triggerBalanceSelectionChangedEvent:function(a){this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.productVoucherIdentifier,isSelected:a,balance:this.productVoucherBalance,isBackingInstrument:this.isRadioButtonDisplay})},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",
{instrumentId:a,paymentMethod:this.productVoucherIdentifier})},_triggerOptionalInstrumentSelectedEvent:function(){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier,requireBackingInstrument:this.requireBackingInstrument,balance:this.productVoucherBalance})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},
_isProductVoucherSelectedAsInstrument:function(){return this.$container.hasClass("pmts-selected")},_triggerDeselectGiftCardCheckboxEvent:function(){this.widget.trigger("deselectGiftCardCheckbox",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},_getToggleSwitchAuiElement:function(){var a=this,b=null;h.now("a-switch","jQuery").execute(function(c,d){c!==f&&d!==f&&(b=c.getSwitch(a.$toggleSwitch))});return b},_isOptionalProductVoucherSelected:function(){if(this.shouldDisplayModernizedFrameCX){var a=
this._getToggleSwitchAuiElement();return a&&a.isOn()}return this.$checkbox.prop("checked")},_updateOptionalProductVoucherSelected:function(a){if(this.shouldDisplayModernizedFrameCX){var b=this._getToggleSwitchAuiElement();return b&&this._isOptionalProductVoucherSelected()!==a&&b.isOn(a)}return this.$checkbox.prop("checked",a)},_isOptionalProductVoucherEnabled:function(){if(this.shouldDisplayModernizedFrameCX){var a=this._getToggleSwitchAuiElement();return a&&a.enabled()}return!this.$checkbox.prop("disabled")},
_updateOptionalProductVoucherEnabled:function(a){if(this.shouldDisplayModernizedFrameCX){var b=this._getToggleSwitchAuiElement();b&&this._isOptionalProductVoucherEnabled()==a&&b.enabled(!a)}else return this.$checkbox.prop("disabled",a)},bindToElements:function(){var a=this;if(a.shouldDisplayModernizedFrameCX&&a.productVoucherToggleSwitchName){a.$toggleSwitchInput.val(a.instrumentRowSelectionValue);var b="a:switch:"+a.productVoucherToggleSwitchName+":flip";a.widget.offAui(b);a.widget.onAui(b,function(b){a._setProductVoucher(b.switchState.isOn)})}a.$container.click(function(b){a.isRadioButtonDisplay?
a._isProductVoucherSelectedAsInstrument()||(a._triggerDeselectGiftCardCheckboxEvent(),a._triggerInstrumentRowSelectedEvent()):a.shouldDisplayModernizedFrameCX||(b.preventDefault(),a._toggleOptionalProductVoucher())});a.$checkbox.click(function(b){a._setProductVoucher(a._isOptionalProductVoucherSelected());b.stopPropagation()})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){this._isNotOwnedInstrumentSelected=n.isDefined(b.isInstrumentOwned)&&!b.isInstrumentOwned;a.isRadioButtonDisplay?
(b.instrumentId===a.productVoucherId||a._isProductVoucherSelectedAsInstrument())&&a._setProductVoucher(b.instrumentId===a.productVoucherId):(!0===a._isB2BCrossWalletMultitenderEnforcementEnabled?a.shouldBeDeselectedPerB2BMultitenderRules(c,b)&&a._unselectProductVoucher():a.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected&&this._unselectProductVoucher(),b=b.instrumentId===a.promoIdentifier||this.isPVIneligible,a.shouldDisplayModernizedFrameCX?(a._updateOptionalProductVoucherEnabled(b),
this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!!b)):a.$checkbox.prop("disabled",b),d.toggleElement(this.$pvIneligibleWarningMessage,this.isPVIneligible))});a.widget.on("balanceSelectionChanged",a,function(b){"ProductVoucher"===b.paymentMethod&&a.shouldDisplayModernizedFrameCX&&a.widget.trigger("updateEstimatedTotal",{type:b.paymentMethod,status:b.isSelected,balance:b.balance,isValid:!0});a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",
b)&&a._deselectCurrentDisplay();b.paymentMethod===this.promoIdentifier&&a._handlePromoSelectionChange(b.isSelected)});a.widget.on("componentsInitialized",a,function(){if(!a.isRadioButtonDisplay){var b=a.$checkbox.prop("checked"),c=a.$toggleSwitchInput.prop("checked");b||c?(a._triggerOptionalInstrumentSelectedEvent(),a._triggerBalanceSelectionChangedEvent(!0)):a._triggerOptionalInstrumentDeselectedEvent()}});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.productVoucherId&&
a.isRadioButtonDisplay&&a._triggerInstrumentRowSelectedEvent()})}})});c("components/ProductVoucherSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,e){return c.extend(e,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(d){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-MobileCarrierBilling","APXWidgetsAssets"):e;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,e,f){(function(){var a=PaymentsPortal2.modules.define;a("components/AddMobileCarrierBillingComponent",["jQuery","form-component","events/form-submitted-event","lang"],function(a,c,g,h){return c.extend({initialize:function(b,a){this.ADD_MCB_BUTTON_ID=
a.data.ADD_MCB_BUTTON_ID;this.ADD_MCB_FORM_ID=a.data.ADD_MCB_FORM_ID;this.ADD_MCB_COMPACT_BUTTON_ID=a.data.addMobileCarrierBillingCompactButtonSelector;this.showSpinnerWhenSubmit=a.data.showSpinnerWhenSubmit;this._action=a.data.action;this.$addMobileCarrierBillingPopoverTriggerLink=this.getDOMElement("addMobileCarrierBillingPopoverTriggerLink");this.isExpanded=a.data.isExpanded},bindToElements:function(){this.getDOMElement(this.ADD_MCB_BUTTON_ID).click(h.bind(this._handleCreate,this))},bindToEvents:function(){var b=
this;b.widget.on("componentsInitialized",b,function(a){b._initPopoverState()});a(this.ADD_MCB_COMPACT_BUTTON_ID).click(function(a){b.closeAddMobileCarrierBillingPopover()});b.widget.on("openAddMobileCarrierBillingPopover",b,function(a){b.$addMobileCarrierBillingPopoverTriggerLink.trigger("click")})},_initPopoverState:function(){this.refreshAddMobileCarrierBillingPopover();"true"===this.isExpanded&&this.widget.trigger("openAddMobileCarrierBillingPopover")},closeAddMobileCarrierBillingPopover:function(){d.when("a-modal").execute(function(b){b&&
(b=b.get("addMobileCarrierBillingPopover"))&&b.hide()})},refreshAddMobileCarrierBillingPopover:function(){d.when("a-modal").execute(function(b){b&&(b=b.get("addMobileCarrierBillingPopover"))&&b.isActive()&&b.refresh()})},_handleCreate:function(b){this.widget.trigger(g,{action:this._action,event:b,submissionParameters:this.getFormSubmissionParameters(this.ADD_MCB_FORM_ID)});this.showSpinnerWhenSubmit&&this.widget.trigger("submitFormAjaxStarted")}})});a("components/MobileCarrierBillingDetailsSlotComponent",
["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(a,c,d){return a.extend(c,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType;this._isDefault=b.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});a("components/MobileCarrierBillingEditComponent",["component","EditComponentSupport"],function(a,c){return a.extend(c,{initialize:function(a,d){c._initializePopover(a,d,this)},bindToEvents:function(){c._bindPopoverCloseButtonClickedEvent(this)}})});
a("components/MobileCarrierBillingSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,c){return a.extend(c,{initialize:function(a,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(h){var g=window.AmazonUIPageJS||window.P,k=g._namespace||g.attributeErrors,d=k?k("APXWidgetsAssets@APXWidgets-PostPay","APXWidgetsAssets"):g;d.guardFatal?d.guardFatal(h)(d,window):d.execute(function(){h(d,window)})})(function(h,g,k){(function(){var d=PaymentsPortal2.modules.define;d("paidy-redirection-utils",["clog"],function(l){return{handlePaidyInterstitialPageRedirection:function(e){var f=e.interstitialPageUrl;"postpay-account-upgrade"===e.widgetAction&&(f===k?(l.logCounterMetric({feature:"PaidyInterstitialPageUrlUndefined",
resource:"_Count"}),l.publishMetrics()):g.location.href=f)}}});d("components/ChooseAddressPostPayComponent",["components/SelectAddressComponent","lang","jQuery","css-utils"],function(l,e,f,c){var d;return l.extend({initialize:function(b,a){this.$validateAgreeAndSendOTPButton=this.getDOMElement("validateAgreeAndSentOTP");this.postPayAddressSelectedEventWebLabEnabled=a.data.postPayAddressSelectedEventWebLabEnabled},bindToEvents:function(){this.widget.on("addressRowSelected",this,function(b){this._logPostPayJsMetric("addressRowSelectedEvent observed with ",
b.addressId);d=b.addressId});this.widget.on("sendDefaultAddressRowSelected",this,function(b){this._logPostPayJsMetric("sendDefaultAddressRowSelectedEvent observed with default addresID ",b.addressId);d=b.addressId;this._isValidAddressId(d)||c.disableElement(this.$validateAgreeAndSendOTPButton)})},bindToElements:function(){this.$validateAgreeAndSendOTPButton.click(e.bind(this._clickValidateAgreeAndSendOTP,this))},_clickValidateAgreeAndSendOTP:function(b){this._logPostPayJsMetric("addressID submitted ",
d);this._isValidAddressId(d)&&(this.postPayAddressSelectedEventWebLabEnabled?this.widget.submitFormAJAX({"ppw-widgetEvent":"PostPayAddressSelectedEvent","ppw-addressId":d,"ppw-widgetState":this.widget.options.serializedState}):this.widget.submitFormAJAX({"ppw-widgetEvent":"SelectAddressEvent","ppw-addressSelection":d,"ppw-widgetState":this.widget.options.serializedState}))},_logPostPayJsMetric:function(b,a){console.log(b+a)},_isValidAddressId:function(b){return!("undefined"===typeof b||null===b||
""===b)}})});d("components/RegisterPostPayComponent",["form-component","lang"],function(d,e){return d.extend({bindToElements:function(){this.getDOMElement("registerPostPayContinueButtonJSBinding").click(e.bind(this._handleContinueToBillingAddressFormSubmission,this))},_handleContinueToBillingAddressFormSubmission:function(d){this.widget.trigger("RegisterPostpayContinueButtonSelected");0===this.form.validateForm().length?this.getDOMElement("registerPostPayDetailFormJSBinding").submit():d.preventDefault()}})});
d("components/ValidatePostPayComponent",["jQuery","form-component","lang"],function(d,e,f){return e.extend({bindToElements:function(){this.getDOMElement("confirmOTPSubmitButton").click(f.bind(this._handleConfirmOTPFormSubmission,this));var c=this;d("input:radio[name\x3dppw-resendOTPSelection]").change(function(){c._toggleResendOTPButtonText()})},_handleConfirmOTPFormSubmission:function(c){0===this.form.validateForm().length?this.getDOMElement("confirmOTPForm").submit():(this.getDOMElement("OTPSentViaDispatchText").addClass("apx-js-hide"),
c.preventDefault())},_toggleResendOTPButtonText:function(){var c=this.getDOMElement("resendOTPSelection-sms").is(":checked"),d=this.getDOMElement("sendViaSMS"),b=this.getDOMElement("sendViaVoice");c?(b.addClass("apx-js-hide"),d.removeClass("apx-js-hide")):(d.addClass("apx-js-hide"),b.removeClass("apx-js-hide"))}})});d("components/AddPostPayWorkflowComponent","component css-utils AUI!P jQuery lang clog".split(" "),function(d,e,f,c,g,b){return d.extend({initialize:function(a,b){this.autofillName=b.data.autofillName;
this.autofillEmail=b.data.autofillEmail;this.autofillMobile=b.data.autofillMobile;e.showElement(this.getDOMElement("pmtsPostPayCreatableWrapper"));this.autofillFields()},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(a){this._initPopoverState()});this.widget.on("RegisterPostpayContinueButtonSelected",this,function(){this._publishMetrics()})},_initPopoverState:function(){this.refreshAddPostPayPopover()},_publishMetrics:function(){var a=c("[name\x3d'__sif_encrypted_postpay_fullName']").val(),
b=c("[name\x3d'__sif_encrypted_postpay_email']").val(),d=c("[name\x3d'__sif_encrypted_postpay_mobileNumber']").val();this._publishCountMetric("RegisterPostpayFormSubmitted");""!=this.autofillName&&a!=this.autofillName&&this._publishCountMetric("Autofill.PostpayNameFieldChanged");""!=this.autofillEmail&&b!=this.autofillEmail&&this._publishCountMetric("Autofill.PostpayEmailFieldChanged");""!=this.autofillMobile&&d!=this.autofillMobile&&this._publishCountMetric("Autofill.PostpayMobileFieldChanged")},
_publishCountMetric:function(a){b.logCounterMetric({feature:a,resource:"_Count"});b.publishMetrics()},refreshAddPostPayPopover:function(){f.when("a-modal").execute(function(a){a&&(a=a.get("addPostPayPopover"))&&a.isActive()&&a.refresh()})},autofillFields:function(){var a=c("[name\x3d'__sif_encrypted_postpay_fullName']").val(),b=c("[name\x3d'__sif_encrypted_postpay_email']").val(),d=c("[name\x3d'__sif_encrypted_postpay_mobileNumber']").val();""==a&&c("[name\x3d'__sif_encrypted_postpay_fullName']").val(this.autofillName);
""==b&&c("[name\x3d'__sif_encrypted_postpay_email']").val(this.autofillEmail);""==d&&c("[name\x3d'__sif_encrypted_postpay_mobileNumber']").val(this.autofillMobile)}})});d("components/PaidyDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery","css-utils","fetch-balance"],function(d,e,f,c,g){return d.extend(e,{initialize:function(b,a){this._paymentMethodId=a.data.paymentMethodId;this._paymentMethodType=a.data.paymentMethodType;this._paymentMethodSubCategory=a.data.paymentMethodSubCategory;
this._isDefault=a.data.isDefault;this._isFetchBalanceEnabled=a.data.isFetchBalanceEnabled},bindToElements:function(){var b=this;b._bindEditPMLink();b._isFetchBalanceEnabled&&(b.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section").click(function(a){b._handlePostPayBalanceButtonClick(a)}),b.getDOMElement("pmts-portal-post-pay-see-paidy-balance").click(function(a){b._handlePostPayBalanceButtonClick(a)}),b.getDOMElement("pmts-portal-see-post-pay-balance-failure").click(function(a){b._handlePostPayBalanceButtonClick(a)}))},
_handlePostPayBalanceButtonClick:function(b){var a=this;b.preventDefault();g.fetchBalance({widget:a.widget,instrumentId:a._paymentMethodId,eventName:"FetchBalanceEvent",successView:function(b,c){a.showPostPayBalanceSuccessView(b,c)},failureView:function(){a.showPostPayBalanceFailureView()},pendingView:function(){a.showPostPayBalancePendingView()}})},showPostPayBalanceSuccessView:function(b,a){a=Number(b).toLocaleString("en-US");b=this.getDOMElement("pmts-portal-post-pay-success-balance-amount");a=
this.widget.getLocalizedString("pmts_portal_paidy_available_balance_amount",{balance:a});b.html(a);c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},showPostPayBalancePendingView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));
c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},showPostPayBalanceFailureView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));
c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))}})});d("components/PaidyEditComponent",["component","EditComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){e._initializePopover(d,c,this)},bindToEvents:function(){e._bindPopoverCloseButtonClickedEvent(this)}})});d("components/SelectablePostPayListComponent",["component","css-utils"],function(d,e){return d.extend({initialize:function(){e.showElement(this.getDOMElement("pmtsPostPaySelectableWrapper"))}})});
d("components/SelectablePostPayListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","lang","css-utils","fetch-balance"],function(d,e,f,c,g){return d.extend({initialize:function(b,a){this.$PostPaySelectedNote=this.getDOMElement("pmtsPostPaySelectNote");this.$FetchBalanceDisplayed=this.getDOMElement("pmtsFetchBalanceDisplayed");this.$isDisabled=this.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled");this.$PostPaySelectedNote.addClass("apx-js-hide");
this._isFetchBalanceEnabled=a.data.fetchBalanceStatus;this.closeAddPostPayPopover()},_triggerInstrumentRowSelectedEvent:function(b){this.widget.trigger(e,{instrumentId:b.instrumentId})},bindToEvents:function(){var b=this;b.widget.on("initializeRecommendedInstrument",b,function(a){this.$PostPaySelectedNote.addClass("apx-js-hide");a.instrumentId!==b._instrumentId||this.$isDisabled||(b._poaInstrumentSelected(),b._triggerInstrumentRowSelectedEvent(a))});b.widget.on(e,b,function(a){a.instrumentId===b._instrumentId?
(this.$PostPaySelectedNote.removeClass("apx-js-hide"),this.$FetchBalanceDisplayed.removeClass("apx-js-hide")):(this.$PostPaySelectedNote.addClass("apx-js-hide"),this.$FetchBalanceDisplayed.addClass("apx-js-hide"));this._instrumentRowSelected(a.instrumentId)});this._isFetchBalanceEnabled&&(b.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section").click(function(a){b._handlePostPayBalanceButtonClick(a)}),b.getDOMElement("pmts-portal-post-pay-see-paidy-balance").click(function(a){b._handlePostPayBalanceButtonClick(a)}),
b.getDOMElement("pmts-portal-see-post-pay-balance-failure").click(function(a){b._handlePostPayBalanceButtonClick(a)}))},_handlePostPayBalanceButtonClick:function(b){var a=this;b.preventDefault();g.fetchBalance({widget:a.widget,instrumentId:a._instrumentId,eventName:"FetchBalanceEvent",successView:function(b,c){a.showPostPayBalanceSuccessView(b,c)},failureView:function(){a.showPostPayBalanceFailureView()},pendingView:function(){a.showPostPayBalancePendingView()}})},showPostPayBalanceSuccessView:function(b,
a){a=Number(b).toLocaleString("en-US");b=this.getDOMElement("pmts-portal-post-pay-success-balance-amount");a=this.widget.getLocalizedString("pmts_portal_paidy_available_balance_amount",{balance:a});b.html(a);c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},
showPostPayBalancePendingView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},showPostPayBalanceFailureView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));
c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},closeAddPostPayPopover:function(){h.when("a-modal").execute(function(b){b&&(b=b.get("addPostPayPopover"))&&b.hide()})}})});d("components/SelectablePostPayListItemInstallmentComponent","events/InstrumentRowSelectedEvent form-component lang AUI!P jQuery paidy-redirection-utils".split(" "),
function(d,e,f,c,h,b){return e.extend({_currentInstrumentId:k,_paidyAccountUpgradeStatus:k,initialize:function(a,b){this._currentInstrumentId=b.data.instrumentId;this._paidyAccountUpgradeStatus=b.data.paidyAccountUpgradeStatus;this.installmentsAvailableMessage=b.data.installmentsAvailableMessage;this.$paymentOptionsContainer=this.getDOMElement("pmtsPostPayPaymentOptionContainer");this.$installmentsNote=this.getDOMElement("pmtsPostPayInstallmentsAvailableNote");this.$installmentsMobileTouchLink=this.getDOMElement("pmtsPostPayInstallmentsMobileTouchLink");
this.$installmentsMobilePopover=this.getDOMElement("pmtsPostPayInstallmentsMobilePopover");this.$installmentsEligibilityInfo=this.getDOMElement("pmtsPostPayInstallmentsEligibilityInfoNote");this.$paidyApplyForUpgradeMobileTopButton=this.getDOMElement("pmtsPostPayAccountUpgradeTopButton");this.$paidyApplyForUpgradeMobileBottomButton=this.getDOMElement("pmtsPostPayAccountUpgradeBottomButton");this.$paidyInstallmentsMobilePrimaryContinueButton=this.getDOMElement("pmtsPostPayInstallmentsPrimaryContinueButton");
this.$paidyInstallmentsMobileSecondaryContinueButton=this.getDOMElement("pmtsPostPayInstallmentsSecondaryContinueButton");this.$paidyAccountUpgradeInfoSectionUnstartedMobile=this.getDOMElement("pmtsPostPayAccountUpgradeInfoSectionUnstartedMobile");this.$paidyAccountUpgradeInfoSectionPendingMobile=this.getDOMElement("pmtsPostPayAccountUpgradeInfoSectionPendingMobile");this.$paidyAccountUpgradeInfoSectionIdentityFailedMobile=this.getDOMElement("pmtsPostPayAccountUpgradeInfoSectionIdentityFailedMobile");
this.$paidyAccountUpgradeMobilePopover=this.getDOMElement("pmtsPostpayAccountUpgradeMobilePopover");this.$paidyAccountUpgradePendingNoteMobile=this.getDOMElement("pmtsPostPayAccountUpgradeAppliedNoteMobile");this.$paidyAccountUpgradeInfoSectionUnstartedMobile.addClass("apx-js-hide");this.$paidyAccountUpgradeInfoSectionPendingMobile.addClass("apx-js-hide");this.$paidyAccountUpgradeInfoSectionIdentityFailedMobile.addClass("apx-js-hide");this.$paidyAccountUpgradePendingNoteMobile.addClass("apx-js-hide");
this.$paidyApplyForUpgradeMobileTopButton.addClass("apx-js-hide");this.$paidyApplyForUpgradeMobileBottomButton.addClass("apx-js-hide");this.$paymentOptionsContainer.addClass("apx-js-hide");this.$installmentsEligibilityInfo.addClass("apx-js-hide");this.$installmentsMobileTouchLink.addClass("apx-js-hide")},bindToElements:function(){this.getDOMElement("pmtsPostPayInstallmentsPrimaryContinueButton").click(f.bind(this._postpayInstallmentsPopoverContinueButtonClick,this));this.getDOMElement("pmtsPostPayInstallmentsSecondaryContinueButton").click(f.bind(this._postpayInstallmentsPopoverContinueButtonClick,
this));var a=this;a.getDOMElement("pmtsPostPayAccountUpgradeTopButton").click(function(b){a._postpayAccountUpgradeButtonClick(b)});a.getDOMElement("pmtsPostPayAccountUpgradeBottomButton").click(function(b){a._postpayAccountUpgradeButtonClick(b)});this.getDOMElementsByPrefix("pmtsPostPayPaymentOption").click(f.bind(this._postpayAccountUpgradePopoverChangeActions,this))},bindToEvents:function(){var a=this;a.widget.on("WidgetAction",a,function(a){b.handlePaidyInterstitialPageRedirection(a)});a.widget.on(d,
a,function(b){b.instrumentId===a._currentInstrumentId?(this.$paymentOptionsContainer.removeClass("apx-js-hide"),this.$installmentsNote.addClass("apx-js-hide"),this.$installmentsMobileTouchLink.removeClass("apx-js-hide"),this.$installmentsEligibilityInfo.removeClass("apx-js-hide"),this.$paidyAccountUpgradePendingNoteMobile.removeClass("apx-js-hide")):(this.$paymentOptionsContainer.addClass("apx-js-hide"),this.$installmentsNote.removeClass("apx-js-hide"),this.$installmentsMobileTouchLink.addClass("apx-js-hide"),
this.$installmentsEligibilityInfo.addClass("apx-js-hide"),this.$paidyAccountUpgradePendingNoteMobile.addClass("apx-js-hide"))})},_postpayInstallmentsPopoverContinueButtonClick:function(){this._updateTouchLinkContent();this._closePostPayPaymentOptionsSecondaryPopover()},_postpayAccountUpgradeButtonClick:function(a){a.preventDefault();a=this._extractInputs(this.$paidyAccountUpgradeMobilePopover);a=this._getElementMap(a.value.toString());var b=g.location.pathname+g.location.search;a={"ppw-widgetEvent":"PostpayAccountUpgradeStarted",
"ppw-paymentMethodId":this._currentInstrumentId,"ppw-selectedFinancialOfferId":a.get("financialOfferId"),"ppw-selectedFinancialOfferCategory":a.get("financialOfferCategory"),"ppw-selectedFinancialOfferSubCategory":a.get("financialOfferSubCategory"),"ppw-selectedFinancialOfferNumberOfInstallments":a.get("financialOfferNumberOfInstallments"),"ppw-postpayCurrentPageURL":b,"ppw-widgetState":this.widget.options.serializedState};this.widget.submitFormAJAX(a)},_postpayAccountUpgradePopoverChangeActions:function(){var a=
this._extractInputs(this.$paidyAccountUpgradeMobilePopover).value.includes("INSTALLMENT")?"INSTALLMENT":"ONETIME",b=this._paidyAccountUpgradeStatus,c=["PartnerAccountUpgradeRecommendedUnstarted","PartnerAccountUpgradeRecommendedPending","PartnerAccountUpgradeRecommendedPartnerUnavailable","PartnerAccountUpgradeRecommendedIdentityFailed"];"ONETIME"===a?c.includes(b)&&(this._unHidePaidyContinueButtons(),this._hidePaidyApplyForUpgradeButtons(),this.$paidyAccountUpgradeInfoSectionUnstartedMobile.addClass("apx-js-hide"),
this.$paidyAccountUpgradeInfoSectionPendingMobile.addClass("apx-js-hide"),this.$paidyAccountUpgradeInfoSectionIdentityFailedMobile.addClass("apx-js-hide")):"PartnerAccountUpgradeRecommendedUnstarted"===b?(this._hidePaidyContinueButtons(),this._unHidePaidyApplyForUpgradeButtons(),this.$paidyAccountUpgradeInfoSectionUnstartedMobile.removeClass("apx-js-hide")):"PartnerAccountUpgradeRecommendedPending"===b?(this._hidePaidyApplyForUpgradeButtons(),this._unHidePaidyContinueButtons(),this.$paidyAccountUpgradeInfoSectionPendingMobile.removeClass("apx-js-hide")):
"PartnerAccountUpgradeRecommendedIdentityFailed"===b&&(this._hidePaidyContinueButtons(),this._unHidePaidyApplyForUpgradeButtons(),this.$paidyAccountUpgradeInfoSectionIdentityFailedMobile.removeClass("apx-js-hide"))},_hidePaidyContinueButtons:function(){this.$paidyInstallmentsMobilePrimaryContinueButton.addClass("apx-js-hide");this.$paidyInstallmentsMobileSecondaryContinueButton.addClass("apx-js-hide")},_unHidePaidyContinueButtons:function(){this.$paidyInstallmentsMobilePrimaryContinueButton.removeClass("apx-js-hide");
this.$paidyInstallmentsMobileSecondaryContinueButton.removeClass("apx-js-hide")},_unHidePaidyApplyForUpgradeButtons:function(){this.$paidyApplyForUpgradeMobileTopButton.removeClass("apx-js-hide");this.$paidyApplyForUpgradeMobileBottomButton.removeClass("apx-js-hide")},_hidePaidyApplyForUpgradeButtons:function(){this.$paidyApplyForUpgradeMobileTopButton.addClass("apx-js-hide");this.$paidyApplyForUpgradeMobileBottomButton.addClass("apx-js-hide")},_updateTouchLinkContent:function(){this.$installmentsMobileTouchLink.find("input").remove();
var a=this._extractInputs(this.$installmentsMobilePopover),b=this._extractInputs(this.$paidyAccountUpgradeMobilePopover);null!=a?(this._appendHiddenInput(a,this.$installmentsMobileTouchLink),a=a.value.includes("INSTALLMENT")?a.parentElement.innerText:this.installmentsAvailableMessage,this.$installmentsMobileTouchLink.find("span").text(a)):null!=b&&(this._appendHiddenInput(b,this.$installmentsMobileTouchLink),a=b.value.includes("INSTALLMENT")?b.parentElement.innerText:this.installmentsAvailableMessage,
this.$installmentsMobileTouchLink.find("span").text(a))},_extractInputs:function(a){var b=null;a.find("input").each(function(a,c){c&&c.type&&c.name&&c.value&&"radio"===c.type&&c.checked&&(b=c)});return b},_appendHiddenInput:function(a,b){h('\x3cinput type\x3d"hidden"\x3e').attr({name:a.name,value:a.value}).appendTo(b)},_closePostPayPaymentOptionsSecondaryPopover:function(){c.when("a-secondary-view").execute(function(a){if(a){var b=a.get("PostpayInstallmentsSecondaryPopover");a=a.get("PostpayAccountUpgradePopover");
b?b.hide():a&&a.hide()}})},_getElementMap:function(a){var b=new Map;a.replace(/([^&=]+)=([^&]*)/g,function(a,c,d){b.set(decodeURIComponent(c),decodeURIComponent(d))});return b}})});d("components/PaidySleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-RewardsAccount","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/RewardsAccountMetadataSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})})})()});
/* ******** */
(function(q){var u=window.AmazonUIPageJS||window.P,k=u._namespace||u.attributeErrors,g=k?k("APXWidgetsAssets@APXWidgets-EquatedMonthlyInstallments","APXWidgetsAssets"):u;g.guardFatal?g.guardFatal(q)(g,window):g.execute(function(){q(g,window)})})(function(q,u,k){(function(){var g=PaymentsPortal2.modules.define;g("components/EmiListItemComponent","events/InstrumentRowSelectedEvent public-event-registry css-utils component lang jQuery AUI!P form-component InstallmentOptionsAccordionHelper".split(" "),
function(h,g,d,l,n,c,m,a,f){return a.extend({isNomenclatureWave2Enabled:!1,invalidCvv:!0,invalidPostalCode:!0,installmentNotSelected:!0,cvvFieldPrefix:"",postalFieldPrefix:"",noCostEMIMessageId:"",emiMenuKFSViewId:"",limitUpdateConsentMessage:"",isCvvRequired:!1,isPostalCodeRequired:!1,emiMenuInstrumentId:"",id:"",cvvId:"",postalCodeId:"",postalFieldName:"",cvvFieldName:"",installmentSelectionError:"",invalidVerificationCodeError:"",idSecView:"",isSecondaryViewEnabled:!1,isAPBWithEMIEnabled:!1,isAPBSelected:!1,
currentInstrumentId:null,installmentOfferBOsWithoutAPB:[],installmentOfferBOsWithAPB:[],isPaylastEligible:!1,showFloatingContinueBarOnNonPaylastPSP:!1,initialize:function(b,a){this.isNomenclatureWave2Enabled=a.data.isNomenclatureWave2Enabled;this.currentInstrumentId="EMI-"+this.data.instrumentId;this.cvvFieldPrefix=this.data.cvvFieldPrefix;this.emiMenuInstrumentId=this.data.emiMenuInstrumentId;this.id=this.emiMenuInstrumentId+"-"+this.data.instrumentId;this.idSecView="EMISec-"+this.data.instrumentId;
this.cvvId=this.cvvFieldPrefix+this.data.index;this.noCostEMIMessageId=this.data.noCostEMIMessageKey+this.data.index;this.emiMenuKFSViewId=this.data.emiMenuKFSViewContainerKey;this.limitUpdateConsentMessageId=this.data.limitUpdateConsentMessage;this.postalCodeId=this.postalCodeFieldPrefix+this.data.index;this.isCvvRequired=this.data.isCvvRequired;this.isPostalCodeRequired=this.data.isPostalCodeRequired;this.postalFieldName=this.data.postalFieldName;this.cvvFieldName=this.data.cvvFieldName;this.installmentSelectionError=
this.data.installmentSelectionError;this.invalidVerificationCodeError=this.data.invalidVerificationCodeError;this.isSecondaryViewEnabled=this.data.isSecondaryViewEnabled;this.isAPBWithEMIEnabled=this.data.isAPBWithEMIEnabled;this.isPaylastEligible=this.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=this.data.showFloatingContinueBarOnNonPaylastPSP;this.isDownPaymentEnabled=this.data.isDownPaymentEnabled;this.isDownPaymentWithAPBSelectionFixEnabled=this.data.isDownPaymentWithAPBSelectionFixEnabled;
this.installmentOptionsAccordionHelper=new f(this);this.isEmiKfsViewEnabled=this.data.isEmiKfsViewEnabled;this.installmentOfferBOsWithoutAPB=this.data.installmentOfferBOsWithoutAPB;this.installmentOfferBOsWithAPB=this.data.installmentOfferBOsWithAPB;this.hideEMIInfoMessage();this.isAccordionViewForDesktopEnabled=this.data.isAccordionViewForDesktopEnabled;this.isMobile="mobile"===b.options.deviceType},updateEmiContinueButton:function(){var b=!1;if(this.installmentNotSelected)var a=this.installmentSelectionError;
else this.invalidCvv&&this.isCvvRequired?(a=this.invalidVerificationCodeError,b=!0):this.isPostalCodeRequired&&this.invalidPostalCode?(b=!0,a=this.invalidVerificationCodeError):(a=null,b=!0);(this.data.skipFormValidation||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:b});this.displayableError=a?this.widget.getLocalizedString(a):null;this._triggerEmiBackingInstrumentSelectedEvent([this.displayableError])},_mobileView:function(){return"mobile"===
this.widget.options.deviceType},_validateFormField:function(b){return n.filter(this.form.validateForm(),function(a){return a.field===b})},_triggerEmiBackingInstrumentSelectedEvent:function(b){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.emiMenuInstrumentId,instrumentType:this.data.instrumentType,errors:b,paymentMethod:this.data.paymentMethod})},checkCreditCardVerificationCode:function(){this.invalidCvv=0<this._validateFormField(this.cvvFieldName).length},checkPostalCode:function(){this.invalidPostalCode=
0<this._validateFormField(this.postalFieldName).length},checkInstallmentsField:function(){this.installmentNotSelected=0<this._validateFormField(this.data.installmentSelection).length;this.isNomenclatureWave2Enabled||this.getDOMElement(this.idSecView).toggleClass("a-button-error",this.installmentNotSelected)},extractCreditCardInstrumentFromInstrumentId:function(b){return b.replace("EMI-","")},_getCreditCardInstallmentMobileHiddenInput:function(b){b=this.extractCreditCardInstrumentFromInstrumentId(b);
return this.getDOMElement("emiListItemSelectionHiddenInput-"+b).add(this.getDOMElement("emiListItemSelectionHiddenInput-"))},_getCreditCardInstallmentDownPaymentValueHiddenInput:function(b){b=this.extractCreditCardInstrumentFromInstrumentId(b);return this.getDOMElement("emiListItemDownPaymentValueSelectionHiddenInput-"+b).add(this.getDOMElement("emiListItemDownPaymentValueSelectionHiddenInput-"))},_getCreditCardInstallmentDownPaymentCurrencyHiddenInput:function(b){b=this.extractCreditCardInstrumentFromInstrumentId(b);
return this.getDOMElement("emiListItemDownPaymentCurrencySelectionHiddenInput-"+b).add(this.getDOMElement("emiListItemDownPaymentCurrencySelectionHiddenInput-"))},_getCreditCardInstallmentMobileTouchLink:function(b){b=this.extractCreditCardInstrumentFromInstrumentId(b);return this.getDOMElement("emiListItemMobileTouchLink-"+b).add(this.getDOMElement("emiListItemMobileTouchLink-"))},_triggerInstallmentOptionChangedEvent:function(b){this.widget.trigger("installmentOptionChanged",{summaryDisplay:b})},
_getPrimaryViewButtonDisplay:function(b){b=this.extractCreditCardInstrumentFromInstrumentId(b);return this.getDOMElement("emiListItemOfferButtonText-"+b).add(this.getDOMElement("emiListItemOfferButtonText-"))},_showAndUpdateKFSComponentFromCurrentSelection:function(b){this.isEmiKfsViewEnabled&&this.currentInstrumentId===b.data("instrumentid").toString()&&(this.triggerEventToUpdateKFSInfo(b.data("financialofferid")),this.toggleKfsView(!0))},_toggleAndUpdateKFSComponentFromHiddenInput:function(){if(this.isEmiKfsViewEnabled){var b=
this._getCreditCardInstallmentMobileHiddenInput(this.currentInstrumentId);b[0]!==k&&""!==b[0].value?(this.triggerEventToUpdateKFSInfo(b[0].value),this.toggleKfsView(!0)):this.toggleKfsView(!1)}},triggerEventToUpdateKFSInfo:function(b){this.widget.trigger("updateKfsInfo",{instrumentId:this.currentInstrumentId,installmentPlanId:b})},closeCreditCardInstallmentsSecondaryPopover:function(b){var a=this.extractCreditCardInstrumentFromInstrumentId(b);m.when("a-secondary-view").execute(function(b){b&&(b=b.get("emiListItemSecondaryPopoverEMIMenu-"+
a))&&b.hide()});"undefined"!==typeof this._getCreditCardInstallmentMobileHiddenInput(this.currentInstrumentId)[0]&&(this.checkInstallmentsField(),this.updateEmiContinueButton())},displayNCEMessageWithAPB:function(){d.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),!0);d.toggleElement(this.getDOMElement("nceAvailableTextWithoutAPB"),!1)},displayNCEMessageWithoutAPB:function(){d.toggleElement(this.getDOMElement("nceAvailableTextWithoutAPB"),!0);d.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),
!1)},showEMIInfoMessage:function(b){var a=this.getDOMElement("emiInfoMessage");d.toggleElement(a,!0);b=this.getEMIInfoDisplayMessage(b);a[0].getElementsByClassName("a-alert-content")[0].textContent=b},hideEMIInfoMessage:function(){var b=this.getDOMElement("emiInfoMessage");d.toggleElement(b,!1)},toggleKfsView:function(b){d.toggleElement(this.getDOMElement(this.emiMenuKFSViewId),b)},getEMIInfoDisplayMessage:function(b){return b?this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message"):
this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_to_view_emi_options_message")},bindToEvents:function(){this.widget.on("toggleEmiDropDown",this,function(b){c(".emiMenuDropdown").val()===this.data.instrumentId&&b.instrumentId===this.emiMenuInstrumentId?(this._onInstrumentSelected(),this.isAPBSelected&&this.isAPBWithEMIEnabled&&0===this.installmentOfferBOsWithAPB.length&&(this._onInstrumentDeselected(),this.showEMIInfoMessage(this.isAPBSelected)),!this.isAPBSelected&&this.isAPBWithEMIEnabled&&
0===this.installmentOfferBOsWithoutAPB.length&&(this._onInstrumentDeselected(),this.showEMIInfoMessage(this.isAPBSelected))):(this._onInstrumentDeselected(),this.hideEMIInfoMessage())});this.widget.on("componentsInitialized",this,function(){d.toggleElement(this.getDOMElement(this.id),!1)});(this._mobileView()||this.isAccordionViewForDesktopEnabled)&&this.installmentOptionsAccordionHelper.bindToEvents();this.widget.on("installmentOptionsAccordionChanged",this,function(b){b.instrumentId===this.currentInstrumentId&&
(this._getCreditCardInstallmentMobileHiddenInput(b.instrumentId).val(b.financialofferid),this._triggerInstallmentOptionChangedEvent(b.summaryDisplay),this.checkInstallmentsField(),this.updateEmiContinueButton())});this.widget.on("updatePrimaryButtonDisplayString",this,function(b){if(this.currentInstrumentId===b.instrumentId){var a=this._getPrimaryViewButtonDisplay(this.currentInstrumentId),e=this._getCreditCardInstallmentMobileHiddenInput(b.instrumentId);""===b.displayString&&(b.displayString=this.widget.getLocalizedString("apx_emi_menu_sec_view_default_text"));
a.html(b.displayString);e.val(b.installmentPlanId);this.isDownPaymentWithAPBSelectionFixEnabled&&b.downPaymentAmount!==k&&""!==b.downPaymentAmount&&(a=this._getCreditCardInstallmentDownPaymentValueHiddenInput(b.instrumentId),e=this._getCreditCardInstallmentDownPaymentCurrencyHiddenInput(b.instrumentId),b=JSON.parse(b.downPaymentAmount),a.val(b.amount),e.val(b.currency))}});if(this.isAPBWithEMIEnabled)this.widget.on("apbSelectionChanged",this,function(b){b.isSelected?(this.displayNCEMessageWithAPB(),
this.isAPBSelected=!0):(this.displayNCEMessageWithoutAPB(),this.isAPBSelected=!1);if(c(".emiMenuDropdown").val()===this.data.instrumentId){var a=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message");b.isSelected?0===this.installmentOfferBOsWithAPB.length&&(a=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message")):0===this.installmentOfferBOsWithoutAPB.length&&(a=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_to_view_emi_options_message"));
this.widget.trigger("infoMessageAfterChangeInAPBSelection",{message:a});this._toggleAndUpdateKFSComponentFromHiddenInput()}})},bindToElements:function(){var b=this;this.isCvvRequired&&c(this.getDOMElement(this.cvvFieldName)).bind("input",function(){b.checkCreditCardVerificationCode();b.updateEmiContinueButton()});this.isPostalCodeRequired&&c(this.getDOMElement(this.postalFieldName)).bind("input",function(){b.checkPostalCode();b.updateEmiContinueButton()});b.form.bindToParameter(this.data.installmentSelection,
"change",function(){b.checkInstallmentsField();b.updateEmiContinueButton()})},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_onInstrumentDeselected:function(){d.toggleElement(this.getDOMElement(this.idSecView),!1);d.toggleElement(this.getDOMElement(this.id),!1);d.toggleElement(this.getDOMElement(this.cvvId),!1);d.toggleElement(this.getDOMElement(this.postalCodeId),
!1);d.toggleElement(this.getDOMElement(this.noCostEMIMessageId),!1);d.toggleElement(this.getDOMElement(this.limitUpdateConsentMessageId),!1);this.toggleKfsView(!1)},_onInstrumentSelected:function(){this._mobileView()?this.isSecondaryViewEnabled?(d.toggleElement(this.getDOMElement(this.idSecView),!0),d.toggleElement(this.getDOMElement(this.id),!1)):(d.toggleElement(this.getDOMElement(this.idSecView),!1),d.toggleElement(this.getDOMElement(this.id),!0)):(d.toggleElement(this.getDOMElement(this.idSecView),
!1),d.toggleElement(this.getDOMElement(this.id),!0));this.isCvvRequired?d.toggleElement(this.getDOMElement(this.cvvId),!0):d.toggleElement(this.getDOMElement(this.cvvId),!1);this.isPostalCodeRequired?d.toggleElement(this.getDOMElement(this.postalCodeId),!0):d.toggleElement(this.getDOMElement(this.postalCodeId),!1);d.toggleElement(this.getDOMElement(this.noCostEMIMessageId),!0);this.checkInstallmentsField();this.updateEmiContinueButton();(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&
this._resetOrderTotalComputation();this._toggleAndUpdateKFSComponentFromHiddenInput();d.toggleElement(this.getDOMElement(this.limitUpdateConsentMessageId),!0)}})});g("components/SelectableEmiMenuComponent","events/InstrumentRowSelectedEvent public-event-registry css-utils component lang jQuery components/SimplePaymentOptionListItemComponent form-component continuable".split(" "),function(h,g,d,k,n,c,m,a,f){return a.extend(f,{creditCardSelectionError:"",instrumentId:"",paymentMethod:"",instrumentType:"",
emiMenuContainer:"",emiDisabledContainer:"",emiDisabledAPBSelection:"",emiDisabledInvalidPurchase:"",emiEnabledContainer:"",emiContentWrapper:"",isAnyEMIOptionAvailable:!0,addCreditCardContainer:"",addCreditCardWorkflowId:"",addCardIntermittentStepRemoved:!1,addCreditCardSelectedEvent:"",addCreditCardDeselectedEvent:"",addCreditCardOptionValue:"",amazonCreditUnavailableMessage:"",isAPBWithEMIEnabled:!1,isDebitEMIRecommendationMessage:!1,isMShop:!1,initialize:function(b,a){this.addCardIntermittentStepRemoved=
a.data.addCardIntermittentStepRemoved;this.addCreditCardWorkflowId=this.data.addCreditCardWorkflowId;this.addCreditCardSelectedEvent=this.data.addCreditCardSelectedEvent;this.addCreditCardDeselectedEvent=this.data.addCreditCardDeselectedEvent;this.addCreditCardOptionValue=this.data.addCreditCardOptionValue;this.addCreditCardContainer=this.data.addCreditCardContainer;this.enterAddCardDetailsError=this.data.enterAddCardDetailsError;this.instrumentId=this.data.instrumentId;this.paymentMethod=this.data.paymentMethod;
this.instrumentType=this.data.instrumentType;this.emiMenuContainer=this.data.emiMenuContainer;this.emiDisabledContainer=this.data.emiDisabledContainer;this.emiDisabledAPBSelection=this.data.emiDisabledAPBSelection;this.emiDisabledInvalidPurchase=this.data.emiDisabledInvalidPurchase;this.emiEnabledContainer=this.data.emiEnabledContainer;this.emiContentWrapper=this.data.emiContentWrapper;this.isAnyEMIOptionAvailable=this.data.isAnyEMIOptionAvailable;this.creditCardSelectionError=this.data.creditCardSelectionError;
this.amazonCreditUnavailableMessage=this.data.amazonCreditUnavailableMessage;this.isAPBWithEMIEnabled=this.data.isAPBWithEMIEnabled;this.isDebitEMIRecommendationMessage=this.data.isDebitEMIRecommendationMessage;this.isShowingAddCard=!1;this.isMShop=this.data.isMShop;this.isInlineEMIPlanChangeMessageExperienceEnabled=a.data.isInlineEMIPlanChangeMessageExperienceEnabled;this.isAnyEMIOptionAvailable&&(d.toggleElement(this.getDOMElement(this.emiDisabledContainer),!1),this._toggleEmiContentWrapper(!1),
this._toggleAmazonCreditUnavailableMessage(!1),g.register(h));d.toggleElement(this.getDOMElement("emiMenuAlertMessage"),!0);this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled?(d.toggleElement(this.getDOMElement(this.emiDisabledAPBSelection),!0),d.toggleElement(this.getDOMElement(this.emiDisabledInvalidPurchase),!1)):(d.toggleElement(this.getDOMElement(this.emiDisabledAPBSelection),!1),d.toggleElement(this.getDOMElement(this.emiDisabledInvalidPurchase),!0))},_triggerEmiBackingInstrumentSelectedEvent:function(b){this.widget.trigger("backingInstrumentSelected",
{instrumentId:this.instrumentId,instrumentType:this.instrumentType,errors:b,paymentMethod:this.paymentMethod})},_getContainerElement:function(){return this.getDOMElement(this.emiMenuContainer)},_validateFormField:function(b){return n.filter(this.form.validateForm(),function(a){return a.field===b})},checkCreditCardSelection:function(){return 0<this._validateFormField(this.data.creditCardField).length},_toggleEmiContentWrapper:function(b){d.toggleElement(this.getDOMElement(this.emiContentWrapper),b)},
_toggleDebitEmiRecommendationMessage:function(b){d.toggleElement(this.getDOMElement("DebitEMIRecommendationMessage"),b)},_toggleAmazonCreditUnavailableMessage:function(b){d.toggleElement(this.getDOMElement(this.amazonCreditUnavailableMessage),b)},_isAmazonPayBalanceSelected:function(){return!!this.widget.get("apbCheckboxSelected")},isEmiAvailable:function(){return(!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled)&&this.isAnyEMIOptionAvailable},bindToEvents:function(){var b=this;b.widget.on(h,
this,function(b){b.instrumentId===this.addCreditCardOptionValue&&this.isEmiAvailable()&&this._onInstrumentSelected();b.instrumentId===this._getInstrumentId()&&this.isEmiAvailable()?this._onInstrumentSelected():this._onInstrumentDeselected(b)});this.widget.on("pmts-close-add-card-form",this,this._resetBackingInstrumentSelection);b.widget.on("apbSelectionChanged",b,function(a){this.isAPBWithEMIEnabled&&this._isInstrumentSelected()?(this._onInstrumentDeselected(a),this.setContinuable(!1),a=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"),
""===c(".emiMenuDropdown").val()&&this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:a}),b.isInlineEMIPlanChangeMessageExperienceEnabled?this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:this.widget.getLocalizedString("apx_select_payment_method_to_continue")}):this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:a})):this._toggleEmiMenu(a)});b.widget.on("infoMessageAfterChangeInAPBSelection",b,function(b){this.isAPBWithEMIEnabled&&this._isInstrumentSelected()&&
this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:b.message})});b.widget.on("selectableAddEmiCardSelectedOnInitialize",this,function(){d.toggleElement(this.getDOMElement(this.data.paymentOptionDropdownContainer),!1);this._onInstrumentSelected()});this.widget.on("initializeRecommendedInstrument",this,function(b){b.instrumentId===this._getInstrumentId()&&this.isEmiAvailable()&&this._onInstrumentSelected()});q.when("A","a-popover","ready").execute(function(a,e){var f=
a.$;f(document).delegate(".a-popover-wrapper","keydown",function(b){f("li.suppressed-dropdown-option").unbind("keydown").keydown(function(b){if(13===b.keyCode)return b.preventDefault(),!1})});f(document).delegate(".emi-dropdown-add-card-item","click",function(a){b.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"AddCardOnEMIOption"})});f(document).delegate(".emi-menu-dropdown-item","click",function(a){b.widget.publishSuccessSushiMetrics({ActionValueType:"ClickSavedCard",ActionValue:a.target.innerHtml})})})},
bindToElements:function(){var b=this;c(".emiMenuDropdown").change(function(){d.toggleElement(b.getDOMElement("emiMenuAlertMessage"),!1);b.checkCreditCardSelection();b._onInstrumentSelected()});b.data.isAnyEMIOptionAvailable&&b._getContainerElement().click(function(){!b._isInstrumentSelected()&&b.isEmiAvailable()&&b.widget.trigger(h,{instrumentId:b.instrumentId})});this.getDOMElement(this.data.paymentOptionDropdownContainer).click(function(){b.widget.publishSuccessSushiMetrics({ActionValueType:"Click",
ActionValue:"SelectEMIOption"})})},_toggleEmiMenu:function(b){d.toggleElement(this.getDOMElement(this.emiEnabledContainer),this.isEmiAvailable());d.toggleElement(this.getDOMElement(this.emiDisabledContainer),!this.isEmiAvailable());d.toggleElement(this.getDOMElement(this.emiDisabledAPBSelection),this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled);d.toggleElement(this.getDOMElement(this.emiDisabledInvalidPurchase),!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled);this._getInstrumentSelectionInputElement().prop("disabled",
!this.isEmiAvailable());this._isInstrumentSelected()&&!this.isEmiAvailable()&&(this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(h,{}),this.setContinuable(!1),this.widget.trigger("PaymentPlanSelected",{isValid:!1}))},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},_getInstrumentId:function(){return this.instrumentId},_getInstrumentSelectionInputElement:function(){return this.getDOMElement("instrumentRowSelection-"+this.instrumentId)},
_toggleAddEmiCreditCardContainer:function(b){d.toggleElement(this.getDOMElement(this.addCreditCardContainer),b)},_onInstrumentSelected:function(){this.isDebitEMIRecommendationMessage&&this._toggleDebitEmiRecommendationMessage(!1);this._triggerEmiBackingInstrumentSelectedEvent(["enter payment option details"]);this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._toggleEmiContentWrapper(!0);this._toggleAmazonCreditUnavailableMessage(!0);
if(c(".emiMenuDropdown").val()===this.addCreditCardOptionValue)if(this.addCardIntermittentStepRemoved){var b=this._getContainerElement().find("#apx-add-credit-card-action-test-id");b.length&&b.trigger("click");this._toggleShowAddCardExperience(!0);this.isMShop&&this._delay(this).then(this._resetBackingInstrumentSelection)}else this._toggleAddEmiCreditCardContainer(!0),this.widget.trigger(this.addCreditCardSelectedEvent),this.widget.trigger("toggleEmiDropDown",{instrumentId:this.instrumentId});else this._toggleAddEmiCreditCardContainer(!1),
this.widget.trigger(this.addCreditCardDeselectedEvent),this.widget.trigger("toggleEmiDropDown",{instrumentId:this.instrumentId}),this.addCardIntermittentStepRemoved&&this._toggleShowAddCardExperience(!1)},_resetBackingInstrumentSelection:function(){q.when("a-dropdown","ready").execute(function(b){null!==b&&(b=b.getSelect(c(".emiMenuDropdown")),null!==b&&b.setValue(""))})},_delay:function(b){return new Promise(function(a,e){setTimeout(function(){a(b)},1E3)})},_toggleShowAddCardExperience:function(b){b?
(this.isShowingAddCard=!0,c(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!1)):this.isShowingAddCard&&(this.isShowingAddCard=!1,c(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!0))},_onInstrumentDeselected:function(b){this.isDebitEMIRecommendationMessage&&this._toggleDebitEmiRecommendationMessage(!0);this._getContainerElement().removeClass("pmts-selected");this._toggleAddEmiCreditCardContainer(!1);
this._getInstrumentSelectionInputElement().prop("checked",!1);this.widget.trigger("toggleEmiDropDown",{instrumentId:b.instrumentId});this._toggleEmiContentWrapper(!1);this._toggleAmazonCreditUnavailableMessage(!1);this.addCardIntermittentStepRemoved&&this._toggleShowAddCardExperience(!1)}})});g("components/InstallmentOptionsAccordionComponent","css-utils component lang jQuery AUI!P InstallmentOptionsAccordionHelper".split(" "),function(h,g,d,l,n,c){var m=!1;return g.extend({isEMIAvailable:!1,installmentOfferBOsWithoutAPB:[],
installmentOfferBOsWithAPB:[],initialize:function(a,f){this.hideAccordionWithAPB();this.installmentOfferBOsWithoutAPB=this.data.installmentOfferBOsWithoutAPB;this.installmentOfferBOsWithAPB=this.data.installmentOfferBOsWithAPB;this.isDynamicOrderSummaryEnabled=f.data.isDynamicOrderSummaryEnabled;this.installmentOptionPopoverTriggerSource=this.data.popoverTriggerSource;this.isEMIAvailable=this.installmentOfferBOsWithoutAPB!==k&&0!==this.installmentOfferBOsWithoutAPB.length||this.installmentOfferBOsWithAPB!==
k&&0!==this.installmentOfferBOsWithAPB.length;h.hideElement(this.getDOMElement("emiErrorMessagingSlotInAccordion"));this.installmentOfferBOsWithoutAPB!==k&&0!==this.installmentOfferBOsWithoutAPB.length&&(f=this.installmentOfferBOsWithoutAPB[0],null!==f.maybeProcessingFeeAmount&&this.displayProcessingFeeMessage({instrumentId:this.data.instrumentId,bankDisplayName:this.data.bankDisplayName,processingFeeAmount:f.maybeProcessingFeeAmount.value,fosId:f.financialOfferId}));this.data.isEMISuppressed&&this.displayEMILowPSRMessage();
this.isMobile="mobile"===a.options.deviceType;this.installmentOptionsAccordionHelper=new c(this);this.isDownPaymentWithAPBSelectionFixEnabled=this.data.isDownPaymentWithAPBSelectionFixEnabled;(this.isBuyNowPayLaterSeparateSectionEnabledForDesktop=this.data.isBuyNowPayLaterSeparateSectionEnabledForDesktop)?"AMAZON_EMI"===this.installmentOptionPopoverTriggerSource&&(this.initializeHiddenInputs("displayStringHiddenInputWithoutAPBEMI-","installmentPlanIdHiddenInputWithoutAPBEMI-",this.installmentOfferBOsWithoutAPB),
this.initializeHiddenInputs("displayStringHiddenInputWithAPBEMI-","installmentPlanIdHiddenInputWithAPBEMI-",this.installmentOfferBOsWithAPB)):this.isMobile&&"AMAZON_EMI"===this.installmentOptionPopoverTriggerSource&&(this.initializeHiddenInputs("displayStringHiddenInputWithoutAPBEMI-","installmentPlanIdHiddenInputWithoutAPBEMI-",this.installmentOfferBOsWithoutAPB),this.initializeHiddenInputs("displayStringHiddenInputWithAPBEMI-","installmentPlanIdHiddenInputWithAPBEMI-",this.installmentOfferBOsWithAPB))},
_triggerRadioAction:function(a){a=l(a.currentTarget);var f=this.data.instrumentId,b=l("input:radio[name\x3demi-radio-"+f+"]:checked").val();b===a.data("financialofferid").toString()&&(h.hideElement(this.getDOMElementsByPrefix("installmentOptionsDetailBox-"+f)),this.getDOMElementsByPrefix("installmentOptionsRadioButton-"+f).addClass("a-color-alternate-background"),h.showElement(this.getDOMElement("installmentOptionsDetailBox-"+f+b)),this.getDOMElement("installmentOptionsRadioButton-"+f+b).removeClass("a-color-alternate-background"),
this.widget.trigger("installmentOptionsAccordionChanged",{instrumentId:f,financialofferid:b,summaryDisplay:a.data("summarydisplay")}))},bindToElements:function(){this.getDOMElementsByPrefix("installmentOptionsRadioButton-").click(d.bind(this._triggerRadioAction,this))},bindToEvents:function(){this.data.isAPBWithEMIEnabled&&(this.widget.on("apbSelectionChanged",this,function(a){m=a.isSelected;var b=this.handleAPBSelection(m);if(this.mobile){a=this.getDOMElement("emiErrorMessagingSlotInAccordion");
h.hideElement(a);var f=b.displayMessage;b=b.message;this.isEMIAvailable&&f&&this.isMobile&&(h.showElement(a),a[0].getElementsByClassName("a-alert-content")[0].textContent=b)}else this.updateInstallmentOptionsPopoverPrimaryButtonTextForDesktop(b.displayString,m)}),this.widget.on("installmentPlanChanged",this,function(a){if(a.instrumentId===this.data.instrumentId){if(m){var b=this.getDOMElement("displayStringHiddenInputWithAPBEMI-"+a.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithAPBEMI-")),
f=this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"+a.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"));b.val(a.displayHtml);f.val(a.installmentPlanId)}else b=this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-"+a.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-")),f=this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-"+a.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-")),b.val(a.displayHtml),
f.val(a.installmentPlanId);this.updateDownPaymentAmountOnInstalmentPlanChange(m,this.data.instrumentId,a.downPaymentAmount)}}));this.widget.on("installmentPlanSelectedForDesktop",this,function(a){this.data.instrumentId===a.instrumentId&&(this.closeInstallmentOptionsPopover(a),this.updateInstallmentOptionsPopoverPrimaryButtonText(a))});var a=this;n.when("A").execute(function(f){f.declarative("actionWithDownpayment_withAPB","click",function(b){a.toggleDownPaymentUI(b.$event,"withDownPayment","withoutDownPayment",
!0)});f.declarative("actionWithDownpayment_withoutAPB","click",function(b){a.toggleDownPaymentUI(b.$event,"withDownPayment","withoutDownPayment",!1)});f.declarative("actionWithoutDownpayment_withAPB","click",function(b){a.toggleDownPaymentUI(b.$event,"withoutDownPayment","withDownPayment",!0)});f.declarative("actionWithoutDownpayment_withoutAPB","click",function(b){a.toggleDownPaymentUI(b.$event,"withoutDownPayment","withDownPayment",!1)})});a.widget.on("installmentOptionsAccordionSelection",this,
function(a){this.toggleIBDMessage(a);(this.data.processingFeeMessageEnabled||this.data.processingFeeMessageAboveAccordionEnabled)&&this.displayProcessingFeeMessage(a)})},toggleIBDMessage:function(a){a.instrumentId===this.data.instrumentId&&(a.fosId?(h.hideElement(this.getDOMElement("IBDMessageForFullPayment")),h.showElement(this.getDOMElement("IBDMessageForEMI"))):(h.showElement(this.getDOMElement("IBDMessageForFullPayment")),h.hideElement(this.getDOMElement("IBDMessageForEMI"))))},displayProcessingFeeMessage:function(a){if(a.instrumentId===
this.data.instrumentId){var f=this.getDOMElement("processingFeeMessageContainer");a.fosId&&a.processingFeeAmount?(a=this.widget.getLocalizedString("apx_emi_processing_fee_message",{bankName:a.bankDisplayName,processingFee:a.processingFeeAmount}),this.getDOMElement("processingFeeMessage").html(a),h.showElement(f)):h.hideElement(f)}},displayEMILowPSRMessage:function(){var a=this.getDOMElement("emiLowPSRMessageContainer");h.showElement(a)},initializeHiddenInputs:function(a,f,b){a=this.getDOMElement(a+
this.data.instrumentId).add(this.getDOMElement(a));f=this.getDOMElement(f+this.data.instrumentId).add(this.getDOMElement(f));b&&0<b.length&&(1===b[0].numberOfInstallments?a.val(this.getOneMonthDisplayString(b[0])):a.val(b[0].selectionDisplayStrings[0]),f.val(b[0].financialOfferId))},getOneMonthDisplayString:function(a){var f="";null!==a.maybeInstallmentStartTime&&(f={month:("undefined"!==typeof a.maybeInstallmentStartTime.year&&null!==a.maybeInstallmentStartTime.year?new Date(a.maybeInstallmentStartTime.year,
a.maybeInstallmentStartTime.monthValue-1,a.maybeInstallmentStartTime.dayOfMonth):new Date(1E3*a.maybeInstallmentStartTime)).toLocaleString("default",{month:"short"})},f=this.data.isNCEPromtionForAPLOneMonthTenureWeblabEnabled&&this.isOneMonthNCEInstallmentOffer(a)?this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected_nocost",f):this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected",f));return f},isOneMonthNCEInstallmentOffer:function(a){return 1===
a.numberOfInstallments&&a.maybeOfferDiscountAmount&&0<a.maybeOfferDiscountAmount.value},fetchDownPaymentAmountOnAPBSelectionChange:function(a){if(this.isDownPaymentWithAPBSelectionFixEnabled)if(a){if(a=this.getDOMElement("downPaymentAmountHiddenInputWithAPB-"+this.data.instrumentId).add(this.getDOMElement("downPaymentAmountHiddenInputWithAPB-")),0<a.length)var f=a[0].value}else a=this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-"+this.data.instrumentId).add(this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-")),
0<a.length&&(f=a[0].value);return f},updateDownPaymentAmountOnInstalmentPlanChange:function(a,f,b){this.isDownPaymentWithAPBSelectionFixEnabled&&b!==k&&(a?this.getDOMElement("downPaymentAmountHiddenInputWithAPB-"+f).add(this.getDOMElement("downPaymentAmountHiddenInputWithAPB-")).val(b):this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-"+f).add(this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-")).val(b))},handleAPBSelection:function(a){var f="",b=!1;if(a){this.hideAccordionWithoutAPB();
this.showAccordionWithAPB();var c=this.getDOMElement("displayStringHiddenInputWithAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithAPBEMI-"));var e=this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"));0<c.length&&""!==c[0].value?(c=c[0].value,e=e[0].value):e=c="";this.installmentOfferBOsWithAPB.length<this.installmentOfferBOsWithoutAPB.length&&(b=!0,f=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_for_more_tenures_message"))}else this.hideAccordionWithAPB(),
this.showAccordionWithoutAPB(),c=this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-")),e=this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-")),0<c.length&&""!==c[0].value?(c=c[0].value,e=e[0].value):e=c="",this.installmentOfferBOsWithoutAPB.length<this.installmentOfferBOsWithAPB.length&&(b=!0,f=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_for_more_tenures_message"));
a=this.fetchDownPaymentAmountOnAPBSelectionChange(a);this.widget.trigger("updatePrimaryButtonDisplayString",{instrumentId:this.data.instrumentId,displayString:c,installmentPlanId:e,downPaymentAmount:a});return{displayMessage:b,message:f,displayString:c}},closeInstallmentOptionsPopover:function(a){var c=a.instrumentId;n.when("A","a-popover-base").execute(function(b,a){a&&(b="emiInstallmentOptionPopoverDesktop-"+c.replace(/\./g,"_"),(a=a.get(b))&&a.$popover.find("button[data-action]\x3da-popover-close").trigger("click"))})},
_getPrimaryViewButtonDisplay:function(a){return this.getDOMElement("installmentOptionsPopoverPrimaryButtonTextDesktop-"+a).add(this.getDOMElement("installmentOptionsPopoverPrimaryButtonTextDesktop-"))},updateInstallmentOptionsPopoverPrimaryButtonTextForDesktop:function(a,c){if(""===a)switch(this.installmentOptionPopoverTriggerSource){case "SAVED_CARD":c&&0<this.installmentOfferBOsWithAPB.length?a=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithAPB[0]):!c&&0<this.installmentOfferBOsWithoutAPB.length&&
(a=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithoutAPB[0]));break;case "EMI_MENU":a=this.widget.getLocalizedString("apx_emi_menu_sec_view_default_text");break;case "AMAZON_EMI":a=this.getDisplayStringForPrimaryButton(c);break;default:a=""}this.updateInstallmentOptionsPopoverPrimaryButtonText({instrumentId:this.data.instrumentId,displayHtml:a})},updateInstallmentOptionsPopoverPrimaryButtonText:function(a){this._getPrimaryViewButtonDisplay(a.instrumentId).html(a.displayHtml)},toggleDownPaymentUI:function(a,
c,b,d){var e=this.data.instrumentId;a=l(a.currentTarget).find("input");if(e===a.data("instrumentid").toString()){var f=a.data("index").toString(),r="importantInformationSection-installmentOptionsAccordion-"+a.data("instrumentid").toString();this.installmentOptionsAccordionHelper.showImportantInformation(a,e,a.data("financialofferid").toString(),r);this.showDownPaymentContent(e,f,d,c);this.hideDownPaymentContent(e,f,d,b)}},getInstallmentOfferDisplayString:function(a){return a.selectionDisplayStrings[0]},
showDownPaymentContent:function(a,c,b,d){h.showElement(this.getDOMElementsByPrefix(a+b+c+d))},hideDownPaymentContent:function(a,c,b,d){h.hideElement(this.getDOMElementsByPrefix(a+b+c+d))},showAccordionWithAPB:function(){h.showElement(this.getDOMElement("accordionWithAPB"))},hideAccordionWithAPB:function(){h.hideElement(this.getDOMElement("accordionWithAPB"))},showAccordionWithoutAPB:function(){h.showElement(this.getDOMElement("accordionWithoutAPB"))},hideAccordionWithoutAPB:function(){h.hideElement(this.getDOMElement("accordionWithoutAPB"))},
getDisplayStringForPrimaryButton:function(a){var c="";a&&0<this.installmentOfferBOsWithAPB.length?c=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithAPB[0]):!a&&0<this.installmentOfferBOsWithoutAPB.length&&(c=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithoutAPB[0]));return c}})});g("InstallmentOptionsAccordionHelper",["jQuery","AUI!P","css-utils","lang"],function(h,g,d,l){return function(d){function c(b,c,f,d){if(e.data.isImportantEmiInfoEnabled&&c===b.data("instrumentid").toString()){c=
null;if(d=h("div[id\x3d'"+d+"']"))d.html(""),d.removeClass("importantInformationSection");""!==f&&(c=a(b));if(c&&0<c.length){b=e.widget.getLocalizedString("apx_important_emi_info_header_message");b=h('\x3cspan class\x3d"importantInformationTextColor a-text-bold"\x3e'+b+"\x3c/span\x3e");var p=h('\x3cul class\x3d"a-unordered-list a-vertical"/\x3e');c.forEach(function(b){p.append('\x3cli\x3e\x3cspan class\x3d"a-list-item"\x3e\x3cspan class\x3d"importantInformationTextColor"\x3e'+b+"\x3c/span\x3e\x3c/span\x3e\x3c/li\x3e")});
d&&(b.appendTo(d),p.appendTo(d),d.removeClass("importantInformationSection"))}else d&&d.addClass("importantInformationSection")}}function m(a){var c=f();if(a=b(c,a))(a=a.maybeOfferDiscountAmount)&&0<a.value?e.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:Math.round(a.value)}):e.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})}function a(a){var c=0<Number(a.data("downpaymentamount"))?!0:!1;c=c?e.isApbSelected?e.data.installmentOfferBOsWithAPBWithDownPayment:
e.data.installmentOfferBOsWithoutAPBWithDownPayment:f();var d=a.data("financialofferid");c=b(c,d);if(d=c.maybeTotalPrincipalAmount){d=Math.round(d.value);var m=Math.round(c.installmentMonthlyPaymentAmount.value),h=c.numberOfInstallments.toString;var p=c.maybeOfferDiscountAmount;var g=null;p&&p.value&&(g=Math.round(p.value));p=g;g=c.maybeDownPaymentAmount;var k=null;g&&(k=Math.round(g.value));g=k;k=a.data("issuingbank");var n=a.data("paymentmethodcode");a=a.data("installmentstartdate");if(1<c.numberOfInstallments){if(k&&
"BFL"===k)return c={emiAmount:m,tenure:h},a=e.widget.getLocalizedString("apx_important_emi_info_nce_creditLimitBlock_message_without_discount",{discountedAmount:d}),c=e.widget.getLocalizedString("apx_important_emi_info_emiAndTenureInfo_message",c),d=e.widget.getLocalizedString("apx_checkout_spc_bfl_disclaimer"),[a,c,d];if("AmazonCredit"===n){if(k&&k.endsWith("_3P"))return t(d,g,!0);c=e.widget.getLocalizedString("apx_important_emi_info_aemi_limit_utilization",{principal:d});a&&""!==a?(a=e.widget.getLocalizedString("apx_important_emi_info_aemi_due_date",
{installmentStartDate:a}),a=[c,a]):a=[c];return a}return 0<p?(a=g?e.widget.getLocalizedString("apx_important_emi_info_downpayment_message",{downPayment:g,amountForEMIConversion:d}):e.widget.getLocalizedString("apx_important_emi_info_nce_creditLimit_message",{discountedAmount:d}),c=e.widget.getLocalizedString("apx_important_emi_info_nce_interestInfo_message",{nceDiscount:p}),[a,c]):t(d,g,!1)}}return null}function f(){var b=null;e.isApbSelected?b=e.data.installmentOfferBOsWithAPB:e.data.installmentOfferBOs?
b=e.data.installmentOfferBOs:e.data.installmentOfferBOsWithoutAPB&&(b=e.data.installmentOfferBOsWithoutAPB);return b}function b(b,a){var c=null;b&&(c=b.filter(function(b){return b.financialOfferId===a})[0]);return c}function t(b,a,c){b=a?e.widget.getLocalizedString("apx_important_emi_info_downpayment_message",{downPayment:a,amountForEMIConversion:b}):c?e.widget.getLocalizedString("apx_important_emi_info_aemi_cardless_consumed_creditlimit",{amount:b}):e.widget.getLocalizedString("apx_important_emi_info_nce_creditLimitBlock_message_without_discount",
{discountedAmount:b});a=e.widget.getLocalizedString("apx_important_emi_info_amountToEMIConversion_message");return[b,a]}var e=d;e.isApbSelected=!1;return{bindToEvents:function(){g.when("A","a-modal").execute(function(a,d){function g(b,a,d,f){e.widget.trigger("installmentOptionsAccordionSelection",{fosId:a,instrumentId:b,bankDisplayName:d,processingFeeAmount:f});d="importantInformationSection-installmentOptionsAccordion-"+b;f=h("div[data-a-accordion-row-name\x3d'"+("installmentOptionAccordionRow-"+
b+a)+"']");c(f,b,a,d)}function t(b,c,e,d){a.on("a:accordion:installmentOptionsAccordion-EMI-"+b+":installmentOptionAccordionRow-EMI-"+b+c+":select",function(a){g("EMI-"+b,c,e,d)})}function p(b,c,e,d){a.on("a:accordion:installmentOptionsAccordion-"+b+":installmentOptionAccordionRow-"+b+c+":select",function(a){g(b,c,e,d)})}a.on("a:popover:afterHide:creditCardInstallmentsSecondaryPopover-"+e.currentInstrumentId,function(b){self.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"CardInstallmentSecondaryPopoverClosed"});
b=e.currentInstrumentId;var a=e._getCreditCardInstallmentMobileHiddenInput(b);h("[data-a-accordion-name\x3d'installmentOptionsAccordion-"+b+"'] [data-a-accordion-row-name\x3d'"+("installmentOptionAccordionRow-"+b+(0<a.length?a[0]:""))+"'] a").click()});a.on("a:popover:afterHide:emiListItemSecondaryPopoverEMIMenu-"+e.currentInstrumentId,function(b){self.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"EMIListItemSecondaryPopoverClosed"})});a.declarative("chooseInstallmentButton",
"click",function(a){self.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"ChooseEMIPlan"});var c=e.currentInstrumentId,d=h(a.$event.currentTarget);a=d.find("input");var g=d.find(".a-section").html();self.widget.publishSuccessSushiMetrics({ActionValueType:"SelectedEMI",ActionValue:g});c.split(".").join("-");if(c===a.data("instrumentid").toString()){d=e.currentInstrumentId;if(d===a.data("instrumentid").toString()){e._getCreditCardInstallmentMobileHiddenInput(d).val(a.data("financialofferid"));
if(e.isDownPaymentEnabled){e._getCreditCardInstallmentDownPaymentValueHiddenInput(d).val(a.data("downpaymentamount"));e._getCreditCardInstallmentDownPaymentCurrencyHiddenInput(d).val(a.data("downpaymentcurrency"));var t={amount:a.data("downpaymentamount"),currency:a.data("downpaymentcurrency")}}e._getPrimaryViewButtonDisplay(d).html(g);e.isAccordionViewForDesktopEnabled&&e.widget.trigger("installmentPlanSelectedForDesktop",{instrumentId:d,displayHtml:g});if(e.isDynamicOrderSummaryEnabled){var p=e.currentInstrumentId,
k=a.data().financialofferid,r=f();if(r=b(r,k))if((r=r.maybeOfferDiscountAmount)&&0<r.value)try{var n=-1*Math.round(r.value),l=document.getElementsByName("ppw-"+p+"_instrumentOrderTotalBalance")[0],q=JSON.parse(l&&l.value?l.value.toString():"{}");q&&0!==Object.keys(q).length?q.nceDiscount=n:q={nceDiscount:n};l&&(l.value=JSON.stringify(q))}catch(v){console.log(v)}else{if(l=document.getElementsByName("ppw-"+p+"_instrumentOrderTotalBalance")[0])l.value=JSON.stringify({})}else if(l=document.getElementsByName("ppw-"+
p+"_instrumentOrderTotalBalance")[0])l.value=JSON.stringify({});e.widget.trigger("UpdateOrderTotalHiddenInputForIBD",{fosId:k,instrumentId:p})}if(e.isPaylastEligible||e.showFloatingContinueBarOnNonPaylastPSP)""!==a.data("financialofferid")?(e.widget.trigger("UpdateOrderTotalForIBDonEMIOnly",{emiOptionSelected:!0,instrumentId:e.currentInstrumentId}),m(a.data().financialofferid)):(e.widget.trigger("UpdateOrderTotalForIBDonEMIOnly",{emiOptionSelected:!1,instrumentId:e.currentInstrumentId}),e.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",
{noCostEMIValue:0,instrumentId:e.currentInstrumentId}));e.isAPBWithEMIEnabled&&e.widget.trigger("installmentPlanChanged",{instrumentId:d,displayHtml:g,installmentPlanId:a.data("financialofferid"),downPaymentAmount:JSON.stringify(t)});t=a.data("summarydisplay");e._getCreditCardInstallmentMobileTouchLink(d).find("input").data("summarydisplay",t);e._triggerInstallmentOptionChangedEvent(t);t=d.split(".").join("-");e.closeCreditCardInstallmentsSecondaryPopover(t)}c.startsWith("EMI-")&&e._showAndUpdateKFSComponentFromCurrentSelection(a);
e.widget.trigger("UpdateIBDAmount",{fosId:a.data("financialofferid"),instrumentId:e.currentInstrumentId})}});if(e.data.differentialIBDPromotionEnabled||e.data.processingFeeMessageEnabled||e.data.processingFeeMessageAboveEnabled)if(a.on("a:accordion:installmentOptionsAccordion-"+e.data.instrumentId+":installmentOptionAccordionRow-"+e.data.instrumentId+":select",function(a){g(e.data.instrumentId,"",e.data.bankDisplayName)}),d=null,e.data.installmentOfferBOs?d=e.data.installmentOfferBOs:e.data.installmentOfferBOsWithoutAPB&&
(d=e.data.installmentOfferBOsWithoutAPB),d!==k)for(var r=0;r<d.length;r++){var n=d[r],l=n.financialOfferId,q=e.data.bankDisplayName;if(null!==n.maybeProcessingFeeAmount)var u=n.maybeProcessingFeeAmount.value;t(e.data.instrumentId,l,q,u);p(e.data.instrumentId,l,q,u)}e.widget.on("GetNoCostEMISelectionDiscountValue",e,function(a){(e.isPaylastEligible||e.showFloatingContinueBarOnNonPaylastPSP)&&a.instrumentId===e.currentInstrumentId&&(a=e._getCreditCardInstallmentMobileHiddenInput(a.instrumentId))&&0<
a.length&&m(a[0].value)});e.widget.on("apbSelectionChanged",e,function(a){e.isApbSelected=a.isSelected?!0:!1})})},showImportantInformation:c}}});g("components/EmiKfsComponent",["css-utils","component","lang","jQuery","AUI!P"],function(g,k,d,l,n){return k.extend({installmentPlanDataWithoutAPBSequence:[],installmentPlanDataWithAPBSequence:[],maxTenure:0,initialize:function(){this.installmentPlanDataWithoutAPBSequence=this.data.installmentPlanDataWithoutAPBSequence;this.installmentPlanDataWithAPBSequence=
this.data.installmentPlanDataWithAPBSequence;this.currentInstrumentId=this.data.instrumentId;this.maxTenure=this.data.maxTenure},getEligibleInstallmentPlanDataSequence:function(){return this.isAmazonPayBalanceSelected()?this.installmentPlanDataWithAPBSequence:this.installmentPlanDataWithoutAPBSequence},isAmazonPayBalanceSelected:function(){return this.widget.get("apbCheckboxSelected")},getSelectedInstallmentPlanData:function(c,d){var a=null;c&&(a=c.filter(function(a){return a.installmentPlanId===
d})[0]);return a},getInstallmentsTotals:function(c){var d=0,a=0,f=0,b=0;c.maybeInterestAmount&&(d=c.maybeInterestAmount.value);c.maybeTotalCost&&(a=c.maybeTotalCost.value);c.maybeTotalPrincipalAmount&&(f=c.maybeTotalPrincipalAmount.value);c.maybeOfferDiscountAmount&&(b=c.maybeOfferDiscountAmount.value);var g={};g.monthlyPayableAmount=c.installmentMonthlyPaymentAmount.value;g.interestAmount=d;g.totalCost=a;g.loanAmount=f;g.interestRate=this.getInterestRate(c);g.emiDiscount=b;return g},getFormattedAmount:function(c){return this.widget.getLocalizedString("apx_emi_kfs_formated_amount",
{amount:c})},getInterestRate:function(c){return c.maybeInterestRate?c.maybeInterestRate:""},getTenureDisplayString:function(c){return 1===c?this.widget.getLocalizedString("apx_emi_kfs_tenure_value_one_month",{month:c}):this.widget.getLocalizedString("apx_emi_kfs_tenure_value",{month:c})},getInterestRateDisplayString:function(c,d,a){return 1===a?this.widget.getLocalizedString("apx_emi_kfs_interest_rate_one_month"):0<d?this.widget.getLocalizedString("apx_emi_kfs_interest_rate_ncemi",{interestRate:c}):
this.widget.getLocalizedString("apx_emi_kfs_interest_rate_standard_emi",{interestRate:c})},getTotalInterestDisplayString:function(c,d,a){return 1===a?this.widget.getLocalizedString("apx_emi_kfs_total_interest_one_month"):0<d?d>=c?this.widget.getLocalizedString("apx_emi_kfs_total_interest_ncemi",{totalInterest:this.getFormattedAmount(c)}):this.widget.getLocalizedString("apx_emi_kfs_total_interest_mixed_cart",{totalInterest:this.getFormattedAmount(c)}):this.getFormattedAmount(c)},getRepaymentScheduleTable:function(c,
d,a,f){for(var b=[],g=0;g<d;g++){var e={},m=c;0<g&&(m=b[g-1].outstandingPrincipal-b[g-1].principal);var h=m*a,k=0,l=Math.round(f),n=l-h;g+1===d&&(0!==h&&(k=Math.round(m+h)-(m+h)),l=m+h,n=m);h+=k;e.installmentNumber=g+1;e.outstandingPrincipal=m.toFixed(2);e.principal=n.toFixed(2);e.interestAmount=h.toFixed(2);e.installmentAmount=l.toFixed(2);b[g]=e}return b},hideRepaymentScheduleContent:function(){for(var c=1;c<=this.maxTenure;c++)g.hideElement(this.getDOMElement("repaymentScheduleInstallmentNumber_"+
c))},updateRepaymentScheduleRow:function(c){var d=this.getDOMElement("repaymentScheduleOutstandingPrincipalInstallmentNumber_"+c.installmentNumber),a=this.getDOMElement("repaymentSchedulePrincipalInstallmentNumber_"+c.installmentNumber),f=this.getDOMElement("repaymentScheduleInterestInstallmentNumber_"+c.installmentNumber),b=this.getDOMElement("repaymentScheduleInstallmentAmountInstallmentNumber_"+c.installmentNumber);d.html(c.outstandingPrincipal);a.html(c.principal);f.html(c.interestAmount);b.html(c.installmentAmount);
g.showElement(this.getDOMElement("repaymentScheduleInstallmentNumber_"+c.installmentNumber))},updateAndShowRepaymentScheduleTable:function(c,d){for(var a=0;a<d;++a)this.updateRepaymentScheduleRow(c[a])},updateLoanAndRepaymentDetails:function(c,d){var a=this.getDOMElement("loanAmount"),f=this.getDOMElement("interestAmount"),b=this.getDOMElement("totalCost"),g=this.getDOMElement("interestPercentage"),e=this.getDOMElement("tenure"),h=this.getDOMElement("numberOfInstallments"),m=this.getDOMElement("monthlyInstallmentAmount");
a.html(this.getFormattedAmount(c.loanAmount));f.html(this.getTotalInterestDisplayString(c.interestAmount,c.emiDiscount,d));b.html(this.getFormattedAmount(c.totalCost));g.html(this.getInterestRateDisplayString(c.interestRate,c.emiDiscount,d));e.html(this.getTenureDisplayString(d));h.html(d.toString());m.html(this.getFormattedAmount(c.monthlyPayableAmount))},bindToEvents:function(){var c=this;c.widget.on("updateKfsInfo",c,function(c){if(c.instrumentId===this.currentInstrumentId){c=c.installmentPlanId;
var a=this.getEligibleInstallmentPlanDataSequence();c=this.getSelectedInstallmentPlanData(a,c);a=this.getInstallmentsTotals(c);var d=a.interestRate/1200;this.updateLoanAndRepaymentDetails(a,c.numberOfInstallments);this.hideRepaymentScheduleContent();a=this.getRepaymentScheduleTable(a.loanAmount,c.numberOfInstallments,d,a.monthlyPayableAmount);this.updateAndShowRepaymentScheduleTable(a,c.numberOfInstallments)}});c.widget.on("installmentPlanChanged",this,function(d){c.widget.trigger("updateKfsInfo",
{instrumentId:d.instrumentId,installmentPlanId:d.installmentPlanId})});c.getDOMElement("keyFactsLink").click(function(){c.widget.publishSuccessSushiMetrics({ActionValue:"KeyFactsLinkClicked",ActionValueType:"Click"})})}})})})()});
/* ******** */
(function(n){var l=window.AmazonUIPageJS||window.P,m=l._namespace||l.attributeErrors,g=m?m("APXWidgetsAssets@APXWidgets-KYCInfoCollection","APXWidgetsAssets"):l;g.guardFatal?g.guardFatal(n)(g,window):g.execute(function(){n(g,window)})})(function(n,l,m){(function(){var g=PaymentsPortal2.modules.define;g("components/KYCInfoCollectionFormComponent","form-component lang events/form-submitted-event jQuery AUI!P css-utils validation-functions".split(" "),function(g,l,n,e,q,m,b){return g.extend({$submitButton:null,
_formValidationStartEvent:null,_isDynamicRFIWeblabEnabled:null,_requiredArtifacts:null,_isAddressRequired:null,_isDateOfBirthRequired:null,initialize:function(c,a){this._isDynamicRFIWeblabEnabled=a.data.isDynamicRFIWeblabEnabled;this._requiredArtifacts=a.data.requiredArtifacts;this._isAddressRequired=0==this._requiredArtifacts.length||this._requiredArtifacts.includes("Address");this._isDateOfBirthRequired=0==this._requiredArtifacts.length||this._requiredArtifacts.includes("Date");this._createConditionalValidationFunction(a.data);
this._formValidationStartEvent=!this._isDynamicRFIWeblabEnabled||this._isAddressRequired?"AddressValidationSuccess":"KYCFormSubmitStarted"},bindToElements:function(){var c=this;c._isDynamicRFIWeblabEnabled&&!c._isDateOfBirthRequired||c._setupDateOfBirthInput();var a=c.getDOMElement("pmts-info-collection-submit-button");a.click(function(a){a.preventDefault();c.$submitButton.isEnabled()&&c.widget.trigger("KYCFormSubmitStarted")});q.when("a-button").execute(function(d){c.$submitButton=d(a)});this.widget.on("AddressValidationFailed",
this,function(){c.form.validateForm()});this.widget.on(c._formValidationStartEvent,c,function(a){var d={},b=c.form.getFormValues();if(0==c.form.validateForm().length){if(!c._isDynamicRFIWeblabEnabled||0==c._requiredArtifacts.length||c._requiredArtifacts.includes("Date")){var k=b.dateOfBirth.split("/");d.dobDay=k[0];d.dobMonth=k[1];d.dobYear=k[2]}d.firstName=b.firstName;d.middleName=b.middleName||"";d.lastName=b.lastName;d.nationality=b.nationality;this._submitKYCInformation(c,a,d)}})},_setupDateOfBirthInput:function(){var c=
this.getDOMElement("pmts-info-collection-date-of-birth-input");c.bind("input",function(a){if("deleteContentBackward"!==a.originalEvent.inputType){var d=c.val().replace(/[^0-9]/g,""),b=d.length,f=d.substring(0,2);2<b&&(f+="/"+d.substring(2,4));4<b&&(f+="/"+d.substring(4,8));d=f.length;if(2===d||5===d)f+="/";c.val(f);a.stopPropagation()}})},_closePopoverIfPsp:function(){var c=this;q.when("a-modal").execute(function(a){c._closePspPopover(a)});q.when("a-secondary-view").execute(function(a){c._closePspPopover(a)})},
_closePspPopover:function(c){(c=c.get("pmts-gc-kyc-info-collection-popover"))&&c.hide()},_submitKYCInformation:function(c,a,d){c.$submitButton.disable();c.widget.trigger("submitFormAjaxStarted");var b={"ppw-firstName":"","ppw-middleName":"","ppw-lastName":"","ppw-nationality":"","ppw-dobDay":"","ppw-dobMonth":"","ppw-dobYear":"","ppw-addressLine1":"","ppw-addressLine2":"","ppw-addressLine3":"","ppw-city":"","ppw-state":"","ppw-postalCode":"","ppw-countryCode":"","ppw-widgetState":c.widget.options.serializedState,
"ppw-widgetEvent":"SubmitKYCBasicInfoEvent"};c._isDynamicRFIWeblabEnabled&&c._requiredArtifacts.length?(c._requiredArtifacts.includes("FullName")&&(b=e.extend({},b,{"ppw-firstName":d.firstName,"ppw-middleName":d.middleName,"ppw-lastName":d.lastName})),c._isAddressRequired&&(b=e.extend({},b,{"ppw-addressLine1":a.addressLine1,"ppw-addressLine2":a.addressLine2,"ppw-addressLine3":a.addressLine3,"ppw-city":a.city,"ppw-state":a.state,"ppw-postalCode":a.postalCode,"ppw-countryCode":a.countryCode})),c._requiredArtifacts.includes("Country")&&
(b=e.extend({},b,{"ppw-nationality":d.nationality})),c._isDateOfBirthRequired&&(b=e.extend({},b,{"ppw-dobDay":d.dobDay,"ppw-dobMonth":d.dobMonth,"ppw-dobYear":d.dobYear}))):b={"ppw-firstName":d.firstName,"ppw-middleName":d.middleName,"ppw-lastName":d.lastName,"ppw-nationality":d.nationality,"ppw-dobDay":d.dobDay,"ppw-dobMonth":d.dobMonth,"ppw-dobYear":d.dobYear,"ppw-addressLine1":a.addressLine1,"ppw-addressLine2":a.addressLine2,"ppw-addressLine3":a.addressLine3,"ppw-city":a.city,"ppw-state":a.state,
"ppw-postalCode":a.postalCode,"ppw-countryCode":a.countryCode,"ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"SubmitKYCBasicInfoEvent"};c.widget.continueRequest(b,{success:c.widget.createAjaxContinueSuccessHandler(),error:function(a){},complete:function(){c._closePopoverIfPsp();c.$submitButton.enable();c.widget.trigger("submitFormAjaxCompleted")},queryParameters:{sif_profile:"KYC_CAMS_PROFILE"}})},_createConditionalValidationFunction:function(c){b.KYCValidDateConstraint=function(a,
d,h,f){if(!b.RequiredValidDateConstraint(a,d,h,f))return!1;h=d[h.defaultParameterName].split(f.separator);a=parseInt(h[0],10);d=parseInt(h[1],10)-1;h=parseInt(h[2],10);f=new Date;f=new Date(f.getFullYear()-c.minimumAgeOfAdult,f.getMonth(),f.getDate());a=new Date(h,d,a);return h>=c.minimumValidDateOfBirthYear&&a<=f}}})});g("components/KYCAddressComponent",["form-component","lang","jQuery","AUI!P","css-utils"],function(g,l,n,e,q){var m="AT BE DE FR PL SE".split(" ");return g.extend({selectedAddress:null,
selectedAddressId:null,addressNotSelectedAlert:null,stateFormField:null,stateFormFieldInput:null,accordionState:"Saved",initialize:function(b,c){this._formSubmitEvent=c.data.formSubmitEvent;this._savedAddressesMap=c.data.savedAddressesMap},_savedAddressesAccordionSelected:function(b){return function(){b.accordionState="Saved"}},_newAddressAccordionSelected:function(b){return function(){b.accordionState="New";b.addressNotSelectedAlert.hide()}},_initializeAccordionJs:function(){var b=this;e.when("A",
"a-alert").execute(function(c,a){c.on("a:accordion:provide-address-accordion:use-saved-address-accordion-row:select",b._savedAddressesAccordionSelected(b));c.on("a:accordion:provide-address-accordion:add-new-address-accordion-row:select",b._newAddressAccordionSelected(b));b.addressNotSelectedAlert=a(".kyc-address-no-input-alert")})},_initializeCountryDropdownJs:function(){var b=this;e.when("A").execute(function(c){c.on("a:dropdown:add-new-address-country-dropdown-native-id:select",function(a){b._updateStateFieldOnCountrySelection(a.value)});
b.stateFormField=c.$("#state")});b.stateFormFieldInput=b.form.getAUITagHelperForParameter("state")},_updateStateFieldOnCountrySelection:function(b){m.includes(b)?(this.stateFormField.hide(),this.stateFormFieldInput.val("")):this.stateFormField.show()},_validateUserInputAndDisplay:function(b){var c=!1;"New"===b.accordionState?c=0!=b.form.validateForm().length:null===b.selectedAddress&&(c=!0,b.addressNotSelectedAlert.show());return c},bindToEvents:function(){var b=this;b._initializeAccordionJs();b._initializeCountryDropdownJs();
b.getDOMElementsByPrefix("savedAddressCarouselBox-").click(l.bind(b.savedAddressCarouselEventHandler,b));b.widget.on(b._formSubmitEvent,b,function(){if(b._validateUserInputAndDisplay(b))b.widget.trigger("AddressValidationFailed");else{var c={},a=b.form.fields.addressLine1,d=b.form.fields.addressLine2,h=b.form.fields.addressLine3,f=b.form.fields.city,k=b.form.fields.state,e=b.form.fields.postalCode,r=b.form.fields.countryCode;if("New"===b.accordionState){var p=b.form.getFormValues(),g=p[d.defaultParameterName],
l=p[h.defaultParameterName],n=p[f.defaultParameterName],m=p[k.defaultParameterName],q=p[e.defaultParameterName],t=p[r.defaultParameterName];c[a.defaultParameterName]=p[a.defaultParameterName];c[d.defaultParameterName]=g||"";c[h.defaultParameterName]=l||"";c[f.defaultParameterName]=n;c[k.defaultParameterName]=m||"";c[e.defaultParameterName]=q;c[r.defaultParameterName]=t}else c[a.defaultParameterName]=b.selectedAddress.addressLine1||"",c[d.defaultParameterName]=b.selectedAddress.addressLine2||"",c[h.defaultParameterName]=
b.selectedAddress.addressLine3||"",c[f.defaultParameterName]=b.selectedAddress.city,c[k.defaultParameterName]=b.selectedAddress.stateOrRegion||"",c[e.defaultParameterName]=b.selectedAddress.postalCode,c[r.defaultParameterName]=b.selectedAddress.countryCode;b.widget.trigger("AddressValidationSuccess",c)}})},savedAddressCarouselEventHandler:function(b){b=n(b.currentTarget);var c=this.selectedAddressId;c!==b.data("addressid").toString()&&(null!=c&&this._toggleCarouselCardSelection(this.getDOMElement("savedAddressCarouselBox-"+
c),!1),this.addressNotSelectedAlert.hide(),this._toggleCarouselCardSelection(b,!0),this.selectedAddressId=b.data("addressid").toString(),this.selectedAddress=this._savedAddressesMap[this.selectedAddressId])},_toggleCarouselCardSelection:function(b,c){c?b.removeClass("saved-address-carousel-not-selected-card").addClass("saved-address-carousel-selected-card"):b.removeClass("saved-address-carousel-selected-card").addClass("saved-address-carousel-not-selected-card")}})});g("components/KYCDocUploadFormComponent",
"form-component lang events/form-submitted-event jQuery AUI!P css-utils clog".split(" "),function(g,l,n,e,m,u,b){var c=["image/png","image/pjpeg","image/jpeg","image/tiff","application/pdf"];return g.extend({$submitButton:null,$POIDropdown:null,$POIDropdownValidationText:null,$POIFrontFilePicker:null,$POIFrontLabel:null,$POIFrontButton:null,$POIFrontFileValidationText:null,$POIBackFilePicker:null,$POIBackLabel:null,$POIBackButton:null,$POIBackFileValidationText:null,$POADropdown:null,$POADropdownValidationText:null,
$POAFilePicker:null,$POALabel:null,$POAButton:null,$POAFileValidationText:null,$charEncodingHiddenInput:null,$sessionIdHiddenInput:null,$destinationHiddenInput:null,$docDispositionHiddenInput:null,$mandatoryFieldsDocDispositionHiddenInput:null,$signatureHiddenInput:null,$mandatoryFieldsSignatureHiddenInput:null,initialize:function(a,d){this._docTypeToIdMap=d.data.docKindToIdMap},bindToElements:function(){var a=this;a.$charEncodingHiddenInput=a.getDOMElement("pmts-doc-upload-char-encoding-hidden-input");
a.$sessionIdHiddenInput=a.getDOMElement("pmts-doc-upload-session-id-hidden-input");a.$destinationHiddenInput=a.getDOMElement("pmts-doc-upload-destination-hidden-input");a.$docDispositionHiddenInput=a.getDOMElement("pmts-doc-upload-doc-disposition-hidden-input");a.$mandatoryFieldsDocDispositionHiddenInput=a.getDOMElement("pmts-doc-upload-mandatory-fields-doc-disposition-hidden-input");a.$signatureHiddenInput=a.getDOMElement("pmts-doc-upload-signature-hidden-input");a.$mandatoryFieldsSignatureHiddenInput=
a.getDOMElement("pmts-doc-upload-mandatory-fields-signature-hidden-input");a.$POIDropdown=a.getDOMElement("pmts-doc-upload-poi-dropdown");a.$POIDropdownValidationText=a.getDOMElement("pmts-doc-upload-poi-dropdown-validation-text");a.$POIDropdownValidationText.hide();e(a.$POIDropdown).change(function(){a.$POIDropdownValidationText.hide()});a.$POADropdown=a.getDOMElement("pmts-doc-upload-poa-dropdown");a.$POADropdownValidationText=a.getDOMElement("pmts-doc-upload-poa-dropdown-validation-text");a.$POADropdownValidationText.hide();
e(a.$POADropdown).change(function(){a.$POADropdownValidationText.hide()});var d=a.getDOMElement("pmts-doc-upload-poi-front-file-picker");a.$POIFrontFilePicker=d.first()[0];a.$POIFrontLabel=a.getDOMElement("pmts-doc-upload-poi-front-label-description");a.$POIFrontButton=a.getDOMElement("pmts-doc-upload-poi-front-button");a.$POIFrontFileValidationText=a.getDOMElement("pmts-doc-upload-poi-front-validation-text");a.$POIFrontFileValidationText.hide();null!=a.$POIFrontFilePicker&&(e(a.$POIFrontFilePicker).change(function(){a._isInvalidFileSize(d)||
a._isInvalidFileType(d)?(a.$POIFrontFileValidationText.show(),a.$POIFrontFilePicker.value=""):(a._updateFilePickerState(a.$POIFrontFilePicker,a.$POIFrontLabel,a.$POIFrontButton,"apx_kyc_info_collection_document_label_proof_of_identity_frontside_notes"),a._onFileChanged())}),a.$POIFrontButton.click(function(){a.$POIFrontFileValidationText.hide();""==a.$POIFrontFilePicker.value?a.$POIFrontFilePicker.click():a._removeSelectedFile(a.$POIFrontFilePicker,a.$POIFrontLabel,a.$POIFrontButton,"apx_kyc_info_collection_document_label_proof_of_identity_frontside_notes")}));
var b=a.getDOMElement("pmts-doc-upload-poi-back-file-picker");a.$POIBackFilePicker=b.first()[0];a.$POIBackLabel=a.getDOMElement("pmts-doc-upload-poi-back-label-description");a.$POIBackButton=a.getDOMElement("pmts-doc-upload-poi-back-button");a.$POIBackFileValidationText=a.getDOMElement("pmts-doc-upload-poi-back-validation-text");a.$POIBackFileValidationText.hide();null!=a.$POIBackFilePicker&&(e(a.$POIBackFilePicker).change(function(){a._isInvalidFileSize(b)||a._isInvalidFileType(b)?(a.$POIBackFileValidationText.show(),
a.$POIBackFilePicker.value=""):a._updateFilePickerState(a.$POIBackFilePicker,a.$POIBackLabel,a.$POIBackButton,"apx_kyc_info_collection_document_label_proof_of_identity_backside_notes")}),a.$POIBackButton.click(function(){a.$POIBackFileValidationText.hide();""==a.$POIBackFilePicker.value?a.$POIBackFilePicker.click():a._removeSelectedFile(a.$POIBackFilePicker,a.$POIBackLabel,a.$POIBackButton,"apx_kyc_info_collection_document_label_proof_of_identity_backside_notes")}));var c=a.getDOMElement("pmts-doc-upload-poa-file-picker");
a.$POAFilePicker=c.first()[0];a.$POALabel=a.getDOMElement("pmts-doc-upload-poa-label-description");a.$POAButton=a.getDOMElement("pmts-doc-upload-poa-button");a.$POAFileValidationText=a.getDOMElement("pmts-doc-upload-poa-validation-text");a.$POAFileValidationText.hide();null!=a.$POAFilePicker&&(e(a.$POAFilePicker).change(function(){a._isInvalidFileSize(c)||a._isInvalidFileType(c)?(a.$POAFileValidationText.show(),a.$POAFilePicker.value=""):(a._updateFilePickerState(a.$POAFilePicker,a.$POALabel,a.$POAButton,
"apx_kyc_info_collection_document_label_proof_of_address_upload_notes"),a._onFileChanged())}),a.$POAButton.click(function(){a.$POAFileValidationText.hide();""==a.$POAFilePicker.value?a.$POAFilePicker.click():a._removeSelectedFile(a.$POAFilePicker,a.$POALabel,a.$POAButton,"apx_kyc_info_collection_document_label_proof_of_address_upload_notes")}));var k=a.getDOMElement("pmts-doc-upload-submit-button");m.when("a-button").execute(function(b){a.$submitButton=b(k)});k.click(function(h){h.preventDefault();
if(a.$submitButton.isEnabled()&&a._validateDropdowns()){h=null!=b[0]&&null!=b[0].files[0];var f=new FormData;f.append(a.$charEncodingHiddenInput.attr("name"),a.$charEncodingHiddenInput.val());f.append(a.$sessionIdHiddenInput.attr("name"),a.$sessionIdHiddenInput.val());f.append(a.$destinationHiddenInput.attr("name"),a.$destinationHiddenInput.val());h?(f.append(a.$docDispositionHiddenInput.attr("name"),a.$docDispositionHiddenInput.val()),f.append(a.$signatureHiddenInput.attr("name"),a.$signatureHiddenInput.val())):
(f.append(a.$docDispositionHiddenInput.attr("name"),a.$mandatoryFieldsDocDispositionHiddenInput.val()),f.append(a.$signatureHiddenInput.attr("name"),a.$mandatoryFieldsSignatureHiddenInput.val()));if(null!=d[0]){f.append(d.attr("name"),d[0].files[0]);var k=d.attr("name")}if(h){f.append(b.attr("name"),b[0].files[0]);var e=b.attr("name")}if(null!=c[0]){f.append(c.attr("name"),c[0].files[0]);var g=c.attr("name")}a._submitKYCInfo(f,k,e,g)}})},_validateDropdowns:function(){var a=!0;null==this.$POIDropdown[0]||
this.$POIDropdown[0].value||(this.$POIDropdownValidationText.show(),a=!1);null==this.$POADropdown[0]||this.$POADropdown[0].value||(this.$POADropdownValidationText.show(),a=!1);return a},_isInvalidFileSize:function(a){return 15E6<a[0].files[0].size},_isInvalidFileType:function(a){return-1==e.inArray(a[0].files[0].type,c)},_removeSelectedFile:function(a,b,c,f){a.value="";this._updateFilePickerState(a,b,c,f);this._onFileChanged()},_updateFilePickerState:function(a,b,c,f){""==a.value?(e(b).html(this.widget.getLocalizedString(f)),
e(c).find("button").html(this.widget.getLocalizedString("apx_kyc_info_collection_document_button_add"))):(a=a.value.replace(/.*[\/\\]/,""),e(b).html(a),e(c).find("button").html(this.widget.getLocalizedString("apx_kyc_info_collection_document_button_remove")))},_onFileChanged:function(){var a=null==this.$POAFilePicker||""!=this.$POAFilePicker.value;null!=this.$POIFrontFilePicker&&""==this.$POIFrontFilePicker.value||!a?this.$submitButton.disable():this.$submitButton.enable()},_submitKYCInfo:function(a,
c,h,f){var d=this;d.widget.trigger("submitFormAjaxStarted");var g=b.getCurrentTime();e.ajax({type:"POST",enctype:"multipart/form-data",url:"/v2/documents/upload/",data:a,processData:!1,contentType:!1,cache:!1,success:function(a){d._publishDocUploadLatencyMetrics(g);var b={},e={};try{d._parseAlexandriaResponse(a,b,e,c,h,f),d._publishDocUploadSuccessMetrics(),d._continueWidget(b,e)}catch(v){d.widget.trigger("submitFormAjaxCompleted"),d._triggerWidgetDoneWithError()}},error:function(a,b,c){error_message=
"[jqXHR.responseText:"+a.responseText+"],[jqXHR.status:"+a.status+"],[jqXHR.statusText:"+a.statusText+"],[textStatus:"+b+"],[errorThrown:"+c+"]";d._publishDocUploadFailureMetrics("UploadCallFailed",error_message);d.widget.trigger("submitFormAjaxCompleted");d._triggerWidgetDoneWithError()}})},_triggerWidgetDoneWithError:function(){this.widget.trigger("Done",{widgetDone:"true",WidgetResponseStatusCode:"500"})},_publishDocUploadSuccessMetrics:function(){b.logCounterMetric({feature:"KYCAlexandriaDocUpload",
resource:"_SuccessCount"});this.widget.publishSuccessSushiMetrics({ActionType:"KYCAlexandriaDocUpload",ActionValueType:"UploadStatusCode",ActionValue:"UploadSuccess"})},_publishDocUploadFailureMetrics:function(a,c){b.logCounterMetric({feature:"KYCAlexandriaDocUpload",resource:"_ErrorCount"});this.widget.publishFailureSushiMetrics({ActionType:"KYCAlexandriaDocUpload",ActionValueType:"UploadStatusCode",ActionValue:a,ActionErrorCode:c})},_publishDocUploadLatencyMetrics:function(a){b.logLatencyMetric({feature:"KYCAlexandriaDocUpload",
resource:"_Latency",startTime:a})},_parseAlexandriaResponse:function(a,b,c,f,e,g){a=(new DOMParser).parseFromString(a,"text/html").getElementsByTagName("input")[0];if("uploadResponse"!=a.getAttribute("name"))throw error_message="[inputElement.name:"+a.getAttribute("name")+"]",this._publishDocUploadFailureMetrics("MissingUploadResponse",error_message),Error("Missing 'uploadResponse' input tag in Alexandria response");this._parseAlexandriaJsonResponse(a.getAttribute("value"),b,c,f,e,g)},_parseAlexandriaJsonResponse:function(a,
b,c,f,e,g){a=JSON.parse(a);if("REQUEST_SUCCEEDED"==a.type){if(!this._isValidAlexandriaUploadResponse(a,f,e,g))throw error_message="[response.content:"+a.content+"]",this._publishDocUploadFailureMetrics("InvalidUploadResponse",error_message),Error("Invalid Alexandria response.");var d=a.content.documentUploadResponseList[g];if(null!=d)if("SUCCESSFUL"==d.status)c.docId=d.content.documentId,c.contentLength=d.content.contentLength,c.documentFieldName=g;else throw error_message="[requestId:"+a.content.requestId+
"],[errorCode:"+d.content.errorCode+"],[exceptionMessage:"+d.content.exceptionMessage+"]",this._publishDocUploadFailureMetrics("POAFileUploadFailed",error_message),Error("POA file upload failed");c=a.content.documentUploadResponseList[e];if(null!=c)if("SUCCESSFUL"==c.status)b.backSideDocId=c.content.documentId,b.backSideContentLength=c.content.contentLength,b.backSideDocumentFieldName=e;else throw error_message="[requestId:"+a.content.requestId+"],[errorCode:"+c.content.errorCode+"],[exceptionMessage:"+
c.content.exceptionMessage+"]",this._publishDocUploadFailureMetrics("POIBackSideFileUploadFailed",error_message),Error("POI backside file upload failed");e=a.content.documentUploadResponseList[f];if(null!=e)if("SUCCESSFUL"==e.status)b.frontSideDocId=e.content.documentId,b.frontSideContentLength=e.content.contentLength,b.frontSideDocumentFieldName=f;else throw error_message="[requestId:"+a.content.requestId+"],[errorCode:"+e.content.errorCode+"],[exceptionMessage:"+e.content.exceptionMessage+"]",this._publishDocUploadFailureMetrics("POIFrontSideFileUploadFailed",
error_message),Error("POI frontside file upload failed");}else throw error_message="[requestId:"+a.content.requestId+"],[errorCode:"+a.content.errorCode+"],[exceptionMessage:"+a.content.exceptionMessage+"]",this._publishDocUploadFailureMetrics("UploadRequestFailed",error_message),Error("Upload request failed");},_isValidAlexandriaUploadResponse:function(a,b,c,f){return this._isValidResponseForFileField(a,b)&&this._isValidResponseForFileField(a,c)&&this._isValidResponseForFileField(a,f)},_isValidResponseForFileField:function(a,
b){return null!=b&&null==a.content.documentUploadResponseList[b]?!1:!0},_continueWidget:function(a,b){var c=this;c.widget.continueRequest(c._buildContinueWidgetParams({"ppw-poiDocumentFieldName":"","ppw-poiAlexandriaDocumentId":"","ppw-poiDocumentKind":"","ppw-poiArtifactId":"","ppw-poiContentLength":"0","ppw-poiDocumentFieldNameBackside":"","ppw-poiAlexandriaDocumentIdBackside":"","ppw-poiContentLengthBackside":"0","ppw-poaDocumentFieldName":"","ppw-poaAlexandriaDocumentId":"","ppw-poaDocumentKind":"",
"ppw-poaArtifactId":"","ppw-poaContentLength":"0","ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"SubmitKYCDocUploadEvent"},a,b),{success:c.widget.createAjaxContinueSuccessHandler(),error:function(a){},complete:function(){c.widget.trigger("submitFormAjaxCompleted")},queryParameters:{sif_profile:"KYC_CAMS_PROFILE"}})},_buildContinueWidgetParams:function(a,b,c){if(null!=b){if(b.hasOwnProperty("frontSideDocumentFieldName")&&b.hasOwnProperty("frontSideDocId")&&b.hasOwnProperty("frontSideContentLength")){var d=
this.$POIDropdown[0].value;a=e.extend({},a,{"ppw-poiDocumentFieldName":b.frontSideDocumentFieldName,"ppw-poiAlexandriaDocumentId":b.frontSideDocId,"ppw-poiDocumentKind":d,"ppw-poiArtifactId":this._docTypeToIdMap[d],"ppw-poiContentLength":b.frontSideContentLength})}b.hasOwnProperty("backSideDocumentFieldName")&&b.hasOwnProperty("backSideDocId")&&b.hasOwnProperty("backSideContentLength")&&(a=e.extend({},a,{"ppw-poiDocumentFieldNameBackside":b.backSideDocumentFieldName,"ppw-poiAlexandriaDocumentIdBackside":b.backSideDocId,
"ppw-poiContentLengthBackside":b.backSideContentLength}))}null!=c&&c.hasOwnProperty("documentFieldName")&&c.hasOwnProperty("docId")&&c.hasOwnProperty("contentLength")&&(b=this.$POADropdown[0].value,a=e.extend({},a,{"ppw-poaDocumentFieldName":c.documentFieldName,"ppw-poaAlexandriaDocumentId":c.docId,"ppw-poaDocumentKind":b,"ppw-poaArtifactId":this._docTypeToIdMap[b],"ppw-poaContentLength":c.contentLength}));return a}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,e=b._namespace||b.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-BLIK","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,e){(function(){var a=PaymentsPortal2.modules.define;a("components/AddBlikComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,b,f,d,e){return f.extend({_hasErrors:!1,initialize:function(c,a){this._action=a.data.action;this._hasErrors=
a.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("addBlikPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBlikSubmitButton").click(d.bind(this._handleFormSubmission,this))},bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(a){this._initPopoverState()});c.widget.on(a,c,function(a){a.action===c._action&&b(c.getDOMElement("addBlikForm")).submit()})},_handleFormSubmission:function(c){var b=this.form.validateForm(),
d=this.getFormSubmissionParameters("addBlikFormContainer");0===b.length?(this.widget.trigger(a,{event:c,submissionParameters:d,action:this._action}),this.closeAddBlikPopover()):c.preventDefault()},closeAddBlikPopover:function(){e.when("a-modal").execute(function(a){a&&(a=a.get("addBlikPopover"))&&a.hide()})}})});a("components/SelectableBlikListComponent",["form-component"],function(a){return a});a("components/SelectableBlikListItemComponent",["events/InstrumentRowSelectedEvent","components/POAInstrumentListItemComponent"],
function(a,b){return b.extend({bindToEvents:function(){var b=this;b.widget.on(a,b,function(a){b._instrumentRowSelected(a.instrumentId)})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Maple","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/IRSComponent",["component","metrics-helper"],function(a,b){return a.extend({bindToElements:function(){b.publishOnClickSuccessSushiMetrics(this,[{JsBindElementId:"maple-advertisement",MetricsObject:{ActionType:"IRSAdvertisement"}}])}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-UFOComparePlans","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/DefaultComponent",["component"],function(a){return a.extend({initialize:function(){b.alert("DefaultComponent initialize!")}})})})()});
/* ******** */
(function(f){var h=window.AmazonUIPageJS||window.P,g=h._namespace||h.attributeErrors,c=g?g("APXWidgetsAssets@APXWidgets-Bizum","APXWidgetsAssets"):h;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,h,g){(function(){var c=PaymentsPortal2.modules.define;c("components/AddBizumComponent","events/form-submitted-event jQuery form-component lang AUI!P clog mash-helper".split(" "),function(c,d,l,e,f,g,m){return l.extend({_hasErrors:!1,_showPrimaryMobileNumber:!1,initialize:function(a,
b){this._action=b.data.action;this._hasErrors=b.data.hasErrors;this._interstitialPageUrl=b.data.interstitialPageUrl;this._showPrimaryMobileNumber=b.data.showPrimaryMobileNumber;this._device=a.options.deviceType;this._isRequestForMobileApp=b.data.isRequestForMobileApp},bindToElements:function(){var a=this;this.getDOMElement("apx-add-bizum-cancel-button").click(e.bind(this._closeAddBizumDesktopPopover,this));this.getDOMElement("apx-add-bizum-continue-button").click(e.bind(this._handleFormSubmission,
this));this.getDOMElement("apx-add-bizum-button").click(e.bind(this._handleAddBizumAccountButtonClick,this));this.getDOMElement("apx-add-bizum-phone-number-input").keydown(e.bind(this._resetFormError,this));this.getDOMElement("apx-add-bizum-phone-number-input").focus(e.bind(this._handleFocusEvent,this));d("#apx-add-bizum-link-saved-phone-number").click(e.bind(this._handleSavedNumberRadioButtonClick,this));d("#apx-add-bizum-link-new-phone-number").click(e.bind(this._handleNewNumberRadioButtonClick,
this));f.when("A","a-modal").execute(function(b){b.off("a:popover:afterHide:apx-add-bizum-popover-desktop");b.on("a:popover:afterHide:apx-add-bizum-popover-desktop",function(b){a._logClogCounterMetric("addBizumPopoverHidden",["Bizum"])})})},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._initPopoverState();a._interstitialPageUrl&&(a._isRequestForMobileApp?m.setUrlInCurrentWebview(a._interstitialPageUrl):h.location.href=a._interstitialPageUrl)});a.widget.on(c,
a,function(b){b.action===a._action&&d(a.getDOMElement("apx-add-bizum-form")).submit()})},_handleFocusEvent:function(){d("#apx-add-bizum-link-new-phone-number").prop("checked",!0).trigger("click")},_initPopoverState:function(){!0===this._hasErrors&&(d("#apx-add-bizum-alert-container-tag-id").addClass("apx-bizum-remove-alert-container-bullet-point"),this.getDOMElement("apx-add-bizum-button").trigger("click"));this._initFormState()},_resetFormError:function(){var a=d("#apx-add-bizum-inline-alert-container-tag-id"),
b=this.getDOMElement("apx-add-bizum-phone-number-input");a.addClass("a-hidden aok-hidden");b.removeClass("apx-bizum-input-phone-number-error-box-border")},_selectPhoneNumberOption:function(a,b){a.addClass("apx-bizum-phone-box-white-background");b.removeClass("apx-bizum-phone-box-white-background");b.addClass("apx-bizum-phone-box-grey-background")},_handleSavedNumberRadioButtonClick:function(){if(d("#apx-add-bizum-link-saved-phone-number").is(":checked")){var a=this.getDOMElement("apx-add-bizum-link-saved-phone-number"),
b=this.getDOMElement("apx-add-bizum-link-new-phone-number");this._selectPhoneNumberOption(a,b)}},_handleNewNumberRadioButtonClick:function(){if(d("#apx-add-bizum-link-new-phone-number").is(":checked")){var a=this.getDOMElement("apx-add-bizum-link-new-phone-number"),b=this.getDOMElement("apx-add-bizum-link-saved-phone-number");this._selectPhoneNumberOption(a,b)}},_hideUpperAlertContainer:function(){d("#apx-add-bizum-alert-container-tag-id").addClass("a-hidden aok-hidden")},_handleDisplayInlineErrorContainer:function(){this._hideUpperAlertContainer();
var a=d("#apx-add-bizum-inline-alert-container-tag-id"),b=this.getDOMElement("apx-add-bizum-phone-number-input");a.removeClass("a-hidden aok-hidden");a.children().removeClass("a-hidden aok-hidden");b.addClass("apx-bizum-input-phone-number-error-box-border")},_handleFormSubmission:function(a){var b=this.getDOMElement("apx-add-bizum-hidden-form-field"),e=d("#apx-add-bizum-link-saved-phone-number");if(this._showPrimaryMobileNumber&&e.is(":checked"))b.val(e.val());else{e=d("select[name\x3dppw-bizumCountryCode] option").filter(":selected").val();
var k=this.getDOMElement("apx-add-bizum-phone-number-input").val();b.val(e+k)}0===this.form.validateForm().length?(b=this.getFormSubmissionParameters("apx-add-bizum-form","apx-add-bizum-continue-button"),e=this.getDOMElement("apx-add-bizum-form").find("form").andSelf().filter("form"),this.widget.trigger(c,{event:a,submissionParameters:b,formElement:e,action:this._action}),this._closePopover()):(this._handleDisplayInlineErrorContainer(),a.preventDefault());this._logClogCounterMetric("continueToAuthNClicked",
["Bizum",this._getDeviceType()])},_initFormState:function(){this.getDOMElement("apx-add-bizum-link-new-phone-number").addClass("apx-bizum-phone-box-grey-background");d("apx-add-bizum-phone-number-input").length&&(d("apx-add-bizum-phone-number-input").val(""),d("#apx-add-bizum-link-saved-phone-number").prop("checked",!0).trigger("click"));"mobile"!==this._device&&this.getDOMElement("apx-add-bizum-country-code-drop-down").addClass("apx-bizum-country-code")},_logClogCounterMetric:function(a,b){b=b&&
b.filter(Boolean).join(".");g.logCounterMetric({feature:b+"."+a,resource:"_Count"});g.publishMetrics()},_handleAddBizumAccountButtonClick:function(){this._logClogCounterMetric("AddBizumBtnClicked",["Bizum",this._getDeviceType()])},_getDeviceType:function(){return this._isRequestForMobileApp?"mobileapp":this._device},_hidePopoverModal:function(a){a&&a.hide()},_closeAddBizumDesktopPopover:function(){var a=this;a._resetFormError();f.when("a-modal").execute(function(b){b&&a._hidePopoverModal(b.get("apx-add-bizum-popover-desktop"))})},
_closeAddBizumMobilePopover:function(){var a=this;a._resetFormError();f.when("a-secondary-view").execute(function(b){b&&a._hidePopoverModal(b.get("apx-add-bizum-popover-mobile"))})},_closePopover:function(){"mobile"===this._device?this._closeAddBizumMobilePopover():this._closeAddBizumDesktopPopover()}})});c("components/SelectableBizumListComponent",["form-component"],function(c){return c});c("components/SelectableBizumListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],function(c){return c});
c("components/BizumDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(d,c){this._paymentMethodId=c.data.paymentMethodId;this._paymentMethodType=c.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});c("components/BizumEditComponent",["component","EditComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,e){d._initializePopover(c,e,this)},bindToEvents:function(){d._bindPopoverCloseButtonClickedEvent(this)}})});
c("components/BizumSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Selection","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectionComponent",["component"],function(a){return a.extent({})})})()});
/* ******** */
(function(l){var g=window.AmazonUIPageJS||window.P,d=g._namespace||g.attributeErrors,e=d?d("APXWidgetsAssets@APXWidgets-UPIIntent","APXWidgetsAssets"):g;e.guardFatal?e.guardFatal(l)(e,window):e.execute(function(){l(e,window)})})(function(l,g,d){(function(){var e=PaymentsPortal2.modules.define;e("components/SelectableUpiIntentListItemComponent","component continuable events/InstrumentRowSelectedEvent events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/InstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent public-event-registry css-utils components/SimplePaymentOptionListItemComponent lang clog commonUtil p2mIntentUtil AwaitingEventStatusConstants events/SelectablePaymentOptionEvents".split(" "),
function(e,u,p,v,w,x,y,z,m,r,t,h,A,B,n,q){var c={Pending:"CALL_PENDING",Available:"APP_AVAILABLE",Unavailable:"APP_UNAVAILABLE"};Object.freeze(c);var k={Pending:"P2M_INTENT_APPLICATION_SMART_INTENT_CALL_PENDING",Unavailable:"P2M_INTENT_APPLICATION_UNAVAILABLE_ON_DEVICE",Successful:"P2M_INTENT_APPLICATION_SMART_INTENT_CALL_SUCCESSFUL"};Object.freeze(k);return r.extend(u,{deselectAPBMessageContainer:"",intentApplicationName:"",intentApplicationReferenceId:"",instrumentId:"",instrumentType:"",upiPaymentMethodCategory:"",
selectableUpiIntentContainer:"",paymentMethod:"",isAmazonApp:!1,isTurboView:!1,apxSandbox:"",isProd:!0,isIntentAPBMultiTenderEligible:!1,intentAppUnavailableContainer:"",isAPBSelected:!1,intentAppAvailabilityStatus:c.Pending,isAwaitingInstrumentPrepare:!1,errorMessage:"",failureReason:k.Pending,instrumentPreparationStatus:n.Pending,initialize:function(a,b){this.deselectAPBMessageContainer=b.data.deselectAPBMessageContainer;this.intentApplicationName=b.data.intentApplicationName;this.intentApplicationReferenceId=
b.data.intentApplicationReferenceId;this.instrumentId=b.data.instrumentId;this.instrumentType=b.data.instrumentType;this.upiPaymentMethodCategory=b.data.upiPaymentMethodCategory;this.selectableUpiIntentContainer=b.data.selectableUpiIntentContainer;this.paymentMethod=b.data.paymentMethod;this.isAmazonApp=b.data.isAmazonApp;this.isTurboView=b.data.isTurboView;this.apxSandbox=b.data.apxSandbox;this.isProd=b.data.isProd;this.isIntentAPBMultiTenderEligible=b.data.isIntentAPBMultiTenderEligible;this.intentAppUnavailableContainer=
b.data.intentAppUnavailableContainer;z.register(p)},_getInstrumentId:function(){return this.instrumentId},_getInstrumentType:function(){return this.instrumentType},_getPaymentMethodCode:function(){return this.paymentMethod},_getContainerElement:function(){return this.getDOMElement(this.selectableUpiIntentContainer)},_toggleAPBMessageContainer:function(a){var b=this.getDOMElement(this.deselectAPBMessageContainer);b!==d&&0<b.length&&m.toggleElement(b,a)},_isIntentAPBMessageContainerDisplayed:function(){var a=
this.getDOMElement(this.deselectAPBMessageContainer);return a!==d&&0<a.length&&!m.hasAUIHiddenClass(a)},_setAPBSelectionChanged:function(a){this.isIntentAPBMultiTenderEligible||this._isIntentAppUnavailableErrorMessageDisplayed()||(this._isInstrumentSelected()&&a&&(this._onInstrumentDeselected(),this._triggerPaymentPlanNotSelectedEvent()),this._toggleAPBMessageContainer(a),this.setDisabled(a),this._setInstrumentPreparationStatus())},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!0);this._triggerBackingInstrumentSelectedEvent();this.intentAppAvailabilityStatus===c.Unavailable?(this._onInstrumentDeselected(),this._displayIntentAppUnavailableErrorMessage(),this._triggerPaymentPlanNotSelectedEvent()):(this.isAPBSelected&&this._setAPBSelectionChanged(!1),this._setInstrumentPreparationStatus(),this._triggerInstrumentPreparedEvent())},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!1)},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},_checkIfUPIIntentAppAvailable:function(a){if(a.upiIntentEligibleApps!==d&&0<a.upiIntentEligibleApps.length){for(var b=!1,f=0;f<a.upiIntentEligibleApps.length;f++)if(this.intentApplicationReferenceId===a.upiIntentEligibleApps[f].intentAppPackageName){b=!0;break}this.intentAppAvailabilityStatus=b?c.Available:c.Unavailable;this._setInstrumentPreparationStatus();
this._triggerInstrumentPreparedEvent()}},_displayIntentAppUnavailableErrorMessage:function(){var a=this.getDOMElement(this.intentAppUnavailableContainer);a!==d&&0<a.length&&m.toggleElement(a,!0);this.setDisabled(!0)},_isIntentAppUnavailableErrorMessageDisplayed:function(){var a=this.getDOMElement(this.intentAppUnavailableContainer);return a!==d&&0<a.length&&!m.hasAUIHiddenClass(a)},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(p,{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),
paymentMethod:this._getPaymentMethodCode()})},_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:[],paymentMethod:this._getPaymentMethodCode(),isUpiRedirectionRequired:!1,paystationPaymentMethodCategory:this.upiPaymentMethodCategory})},_setInstrumentPreparationStatus:function(){var a=this.widget.getLocalizedString("apx_upi_smart_intent_call_pending_continue_error_message"),
b=this.widget.getLocalizedString("apx_upi_intent_app_not_found_on_device_continue_error_message");switch(this.intentAppAvailabilityStatus){case c.Pending:this.instrumentPreparationStatus=n.Pending;this.failureReason=k.Pending;this.errorMessage=a;break;case c.Unavailable:this.instrumentPreparationStatus=n.Failure;this.failureReason=k.Unavailable;this.errorMessage=b;break;case c.Available:this.instrumentPreparationStatus=n.Success,this.failureReason=k.Successful}},_triggerInstrumentPreparedEvent:function(){this._isInstrumentSelected()&&
this.isAwaitingInstrumentPrepare&&this.widget.trigger(x,{instrumentId:this._getInstrumentId(),instrumentPreparationStatus:this.instrumentPreparationStatus,isUpiRedirectionRequired:!1,failureReason:this.failureReason,errorMessage:this.errorMessage})},_triggerPaymentPlanNotSelectedEvent:function(){var a=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");a={isValid:!1,message:a,notValidReason:a,paymentMethod:null};this.widget.trigger(q.paymentPlanSelectedPrepare,a);this.setContinuable(!1);
this.widget.trigger(q.PaymentPlanSelected,a);this.widget.log({event:q.PaymentPlanSelected,details:a})},_isIntentApplicationEligibleForSelection:function(){return!this._isInstrumentSelected()&&!this._isIntentAppUnavailableErrorMessageDisplayed()&&!this._isIntentAPBMessageContainerDisplayed()},bindToEvents:function(){var a=this;t.bind(r.prototype.bindToEvents,this).apply();a.widget.on("componentsInitialized",a,function(){!a.isProd&&g.location.href.toString().includes(a.apxSandbox)?(a.intentAppAvailabilityStatus=
c.Available,a._setInstrumentPreparationStatus(),a._triggerInstrumentPreparedEvent()):l.when("mash").execute(function(b){var f=A.getDevicePlatform();b={intentFilterUri:"upi://pay",intentAppsList:[a.intentApplicationReferenceId]};h.logCounterMetric({feature:"GetIntentEligibleAppCallInitiated_"+f,resource:"_Count"});B.getIntentEligibleApps(b,function(b){"SUCCESS"===b.status&&"SUCCESS"===b.responseCode?(h.logCounterMetric({feature:"GetIntentEligibleAppsSuccess_"+f,resource:"_SuccessCount"}),a._checkIfUPIIntentAppAvailable(b)):
(h.logCounterMetric({feature:"GetIntentEligibleAppsFailure_"+f,resource:"_ErrorCount"}),h.logCounterMetric({feature:"GetIntentEligibleAppsFailure_"+b.responseCode+"_"+f,resource:"_ErrorCount"}),a.intentAppAvailabilityStatus=c.Unavailable,a._setInstrumentPreparationStatus(),a._triggerInstrumentPreparedEvent())});h.publishMetrics()})});t.forEach(["initializeRecommendedInstrument",p],function(b){a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})});
a._getContainerElement().click(function(){a._isIntentApplicationEligibleForSelection()&&a._triggerInstrumentRowSelectedEvent()});a.widget.on(v,a,function(b){a._isInstrumentSelected()&&(a.intentAppAvailabilityStatus===c.Pending||a.intentAppAvailabilityStatus===c.Unavailable?(a.widget.trigger(w,{errorMessage:this.errorMessage}),a.isAwaitingInstrumentPrepare=!0):(a.isAwaitingInstrumentPrepare=!0,a._triggerInstrumentPreparedEvent(),a.isAwaitingInstrumentPrepare=!1))});a.widget.on("apbSelectionChanged",
a,function(b){a.widget.get("apbCheckboxSelected")!==d&&(a.isAPBSelected=b.isSelected,a._setAPBSelectionChanged(a.isAPBSelected))});a.widget.on(y,a,function(b){a._isInstrumentSelected()&&(a.intentAppAvailabilityStatus===c.Pending?a._onInstrumentDeselected():a.intentAppAvailabilityStatus===c.Unavailable&&(a._onInstrumentDeselected(),a._displayIntentAppUnavailableErrorMessage()))})}})});e("components/CashOnDeliveryListComponent",["component"],function(d){return d.extend({})})})()});
/* ******** */
(function(f){var e=window.AmazonUIPageJS||window.P,d=e._namespace||e.attributeErrors,c=d?d("APXWidgetsAssets@APXWidgets-ElectronicBenefitTransfer","APXWidgetsAssets"):e;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,e,d){(function(){var c=PaymentsPortal2.modules.define;c("components/ElectronicBenefitTransferDetailsSlotComponent",["jQuery","component","PaymentMethodDetailsSlotComponentSupport","css-utils","lang"],function(c,g,d,h,e){c(document).ready(function(){c(".pmts-portal-list-item-ebt-balance-check-last-updated-time-reference").map(function(a,
b){a=(new Date(b.textContent)).toLocaleString("UTC",{timeZoneName:"short"});b.textContent=a})});return g.extend(d,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType},_bindCheckBalanceLink:function(){this.getDOMElement("pmts-portal-list-item-ebt-balance-check-link-reference").click(e.bind(this._checkBalanceLinkClicked,this))},_checkBalanceLinkClicked:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"ViewBalanceEvent","ppw-iid":this._paymentMethodId,"ppw-accountType":this._paymentMethodType})},bindToElements:function(){this._bindEditPMLink();this._bindCheckBalanceLink()}})});c("components/ElectronicBenefitTransferSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})});c("components/EBTAmountInputComponent",["component","jQuery","lang","css-utils"],
function(c,d,e,f,k){return c.extend({initialize:function(a,b){this.instrumentId=b.data.ebtAmountPaymentMethodId;this.inputId=b.data.ebtAmountInputId;this.$inputBox=this.getDOMElement(this.inputId)},_validateAndTriggerValidatedEvent:function(){this.widget.trigger("ebtAmountInputValidated",{instrumentId:this.instrumentId,errors:{}})},bindToElements:function(){var a=this;this.$inputBox.change(function(){a._validateAndTriggerValidatedEvent()})},bindToEvents:function(){var a=this;a.widget.on("ebtInstrumentSelected",
a,function(b){a.instrumentId===b.instrumentId&&a._validateAndTriggerValidatedEvent()})}})});c("components/SelectableEBTListItemComponent",["component","jQuery","events/spinner-events","lang","css-utils"],function(c,g,l,h,k){return c.extend({initialize:function(a,b){this._singleInstrumentId=b.data.singleInstrumentId;this.ebtToggleSwitchId=b.data.ebtToggleSwitchId;this.ebtToggleSwitchNativeId=b.data.ebtToggleSwitchNativeId;this.ebtContentSectionId=b.data.ebtContentSectionId;this.ebtCheckboxId=b.data.ebtCheckboxId;
this.ebtToggleSwitchFormName=b.data.ebtToggleSwitchFormName;this.ebtIsSelected=b.data.ebtIsSelected;this.$toggleSwitch=this.getDOMElement(this.ebtToggleSwitchId);this.$contentBox=this.getDOMElement(this.ebtContentSectionId);this.$checkbox=this.getDOMElement(this.ebtCheckboxId).find("input").first()},_createContinueWidgetRequest:function(a,b){this.widget.trigger(l.showSpinner);g.ajax({type:a.get(0).method,url:a.get(0).action,data:a.serialize(),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",
dataType:"text",success:b,error:b})},_ebtToggled:function(a){k.toggleElement(this.$contentBox,a);a||this.widget.trigger("ebtSelectionOffEvent")},_createInterstitialPageUrlRequest:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"ViewBalanceEvent","ppw-iid":this._singleInstrumentId,"ppw-accountType":"ElectronicBenefitTransfer","ppw-redirectUri":e.location.pathname},{success:function(a){a=a.additionalWidgetResponseData.additionalData;"true"===
a.authorizationRequired&&null!=a.interstitialPageUrl&&(e.location.href=a.interstitialPageUrl)}})},_setStateOnLoad:function(){var a=this;if(1===a.$toggleSwitch.length)f.when("a-switch","jQuery").execute(function(b,c){b!==d&&c!==d&&(b=b.getSwitch(a.$toggleSwitch),a._ebtToggled(b.isOn()))});else{var b=this.$checkbox.is(":checked");a._ebtToggled(b)}},_checkBalanceLinkClicked:function(a){a.preventDefault();a=g(".pmts-select-payment-instrument-form");this._createContinueWidgetRequest(a,h.bind(this._createInterstitialPageUrlRequest,
this))},bindToElements:function(){this.getDOMElement("pmts-portal-list-item-ebt-balance-check-link-reference").click(h.bind(this._checkBalanceLinkClicked,this));var a=this;a.widget.on("componentsInitialized",a,function(){a._setStateOnLoad()});if(1===this.$toggleSwitch.length){var b="a:switch:"+this.ebtToggleSwitchFormName+":flip";this.widget.offAui(b);this.widget.onAui(b,function(b){a._ebtToggled(b.switchState.isOn)})}else a.$checkbox.click(function(b){a._ebtToggled(b.currentTarget.checked);b.stopPropagation()})}})});
c("components/EBTProgramListItemComponent",["component","jQuery","events/spinner-events","lang","css-utils"],function(c,e,l,h,k){return c.extend({initialize:function(a,b){this.ebtToggleSwitchId=b.data.ebtProgramToggleSwitchId;this.ebtToggleSwitchNativeId=b.data.ebtProgramToggleSwitchNativeId;this.ebtToggleSwitchFormName="ppw-"+b.data.ebtProgramToggleSwitchFormName;this.ebtToggleSwitchFormValue=b.data.ebtProgramToggleSwitchFormValue;this.ebtAmountSelectionInputId=b.data.ebtProgramAmountSelectionId;
this.ebtProgramCheckboxId=b.data.ebtProgramCheckboxId;this.instrumentId=b.data.ebtProgramInstrumentId;this.$checkbox=this.getDOMElement(this.ebtProgramCheckboxId).find("input").first();this.$toggleSwitch=this.getDOMElement(this.ebtToggleSwitchId);this.$inputBox=this.getDOMElement(this.ebtAmountSelectionInputId)},_ebtToggled:function(a){k.toggleElement(this.$inputBox,a)},_triggerOptionalInstrumentEvent:function(a,b){this.widget.trigger(a,{instrumentId:this.instrumentId,errors:b,paymentMethodCode:"ElectronicBenefitTransfer"})},
_triggerInstrumentSelectedEvent:function(a){this._triggerOptionalInstrumentEvent(a?"optionalInstrumentSelected":"optionalInstrumentDeselected",{})},_getToggleSwitchAuiElement:function(){var a=this,b=null;f.now("a-switch","jQuery").execute(function(c,e){c!==d&&e!==d&&(b=c.getSwitch(a.$toggleSwitch))});return b},_triggerInputValidationEvent:function(){this.widget.trigger("ebtInstrumentSelected",{instrumentId:this.instrumentId,errors:{}})},_handleSelectionChange:function(a){this._ebtToggled(a);a?this._triggerInputValidationEvent():
this._triggerInstrumentSelectedEvent(!1)},bindToElements:function(){var a=this;if(1===this.$toggleSwitch.length){a.$toggleSwitch.find("#"+a.ebtToggleSwitchNativeId).val(a.ebtToggleSwitchFormValue);var b="a:switch:"+this.ebtToggleSwitchFormName+":flip";this.widget.offAui(b);this.widget.onAui(b,function(b){a._handleSelectionChange(b.switchState.isOn)})}else this.$checkbox.click(function(b){a._handleSelectionChange(b.currentTarget.checked)})},bindToEvents:function(){var a=this;this.widget.on("ebtSelectionOffEvent",
this,function(){a._ebtToggled(!1);1===a.$toggleSwitch.length?a._getToggleSwitchAuiElement().isOn(!1):a.$checkbox.prop("checked",!1)});this.widget.on("ebtAmountInputValidated",a,function(b){a.instrumentId===b.instrumentId&&a._triggerInstrumentSelectedEvent(!0)})}})})})()});
/* ******** */
(function(g){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,d=f?f("APXWidgetsAssets@APXWidgets-CreditCardInstallments","APXWidgetsAssets"):e;d.guardFatal?d.guardFatal(g)(d,window):d.execute(function(){g(d,window)})})(function(g,e,f){(function(){var d=PaymentsPortal2.modules.define;d("components/ILFCreditCardInstallmentsComponent","form-component jQuery aui-helper AUI!P css-utils lang clog".split(" "),function(d,e,g,h,f,k,l){return d.extend({currentInstrumentId:null,initialize:function(a,
b){this.currentInstrumentId=b.data.instrumentId;this.ilfPromptInitialText=b.data.ilfPromptInitialText;this.singlePlanSelectedString=b.data.singlePlanSelectedString;this.multiplePlansSelectedString=b.data.multiplePlansSelectedString;this.financialOfferGroups=b.data.financialOfferGroups;this.isILFMultiTenderDisabledWithGiftCard=b.data.isILFMultiTenderDisabledWithGiftCard;this.isPromoCodeOfferPersistenceEnabled=b.data.isPromoCodeOfferPersistenceEnabled;this.isGiftCardCheckboxSelected=!1;this.deviceType=
a.options.deviceType},_confirmButtonClick:function(a){var b=this,c=this.currentInstrumentId,m=new Set;this.financialOfferGroups.forEach(function(a){a=a.id;var d=b._getDropdownSelectedValue(c,a);b._updateOfferSelectionHiddenInput(c,a,d);b._collapseExpander(c,a);d&&"PayInFull"!==d?(m.add(d),b._logClogCounterMetric("ILFCCI."+a+".InstallmentPlanSelected."+d)):b._logClogCounterMetric("ILFCCI."+a+".PayInFullSelected")});b._logClogCounterMetric("ILFSelectedInstallmentPlanCount");this._refreshILFModalPopoverButtonText(c,
m.size);b._logClogCounterMetric("ILFInstallmentOptionsSelected");this.isPromoCodeOfferPersistenceEnabled&&this.widget.trigger("installmentOfferSelectionChanged");this._closeILFModalPopover(c)},_renderSelectionDetailDisplayString:function(a){var b=a.nativeItemNode.getAttribute("data-installmentoptionselectiondetails"),c=a.nativeItemNode.getAttribute("data-bucketid");a=a.nativeItemNode.getAttribute("data-instrumentId");this._updateSelectedInstallmentOptionDetailsPlaceholder(a,c,b)},_toggleProductImages:function(a,
b){var c=a.expander.$expander;a=c[0].getAttribute("data-bucketid");c=c[0].getAttribute("data-instrumentId");f.toggleElement(this.getDOMElement("ilfUnexpandedProductDetailsPrefix-"+c+"-"+a),b)},_updateSelectedInstallmentOptionDetailsPlaceholder:function(a,b,c){this.getDOMElement("installmentOptionSelectionDetailsDisplay-"+a+"-"+b).html(c)},_collapseExpander:function(a,b){a=this.getDOMElement("ilfProductDetailsExpanderPrefix-"+a+"-"+b);g.getExpanderHelper(a).isExpanded()&&a.find(".a-expander-header").click()},
_cancelButtonClick:function(a){var b=this,c=this.currentInstrumentId;this.financialOfferGroups.forEach(function(a){a=a.id;b._resetDropdown(c,a);b._updateOfferSelectionHiddenInput(c,a,"");b._updateSelectedInstallmentOptionDetailsPlaceholder(c,a,"");b._collapseExpander(c,a)});this._refreshILFModalPopoverButtonText(c,0);b._logClogCounterMetric("ILFInstallmentOptionsCancel");this.isPromoCodeOfferPersistenceEnabled&&this.widget.trigger("installmentOfferSelectionChanged");this._closeILFModalPopover(c)},
_resetDropdown:function(a,b){var c="dropdownNativeId-"+a+"-"+b;h.when("a-dropdown").execute(function(a){a.getSelect(c).setValue("")})},_getDropdownSelectedValue:function(a,b){a=this.getDOMElement("ilfBucketDropdown-"+a+"-"+b)[0].previousSibling;b="";a&&a.options&&0<=a.selectedIndex&&a.selectedIndex<a.options.length&&(b=a.options[a.selectedIndex].value);return b},_updateOfferSelectionHiddenInput:function(a,b,c){this.getDOMElement("ilfBucketOfferSelectionHiddenInput-"+a+"-"+b)[0].value="PayInFull"===
c?"":c},_refreshILFModalPopoverButtonText:function(a,b){a=this.getDOMElement("ilfModalPopoverButtonText-"+a);0===b?a.text(this.ilfPromptInitialText):1===b?a.text(this.singlePlanSelectedString.replace("{numberOfPlansSelected}",b.toString())):a.text(this.multiplePlansSelectedString.replace("{numberOfPlansSelected}",b.toString()))},_toggleILFInstallmentMobileTouchLinkDisplay:function(){var a=new Set;this.getDOMElementsByPrefix("bucketInstallmentsSelectionHiddenInput-"+this.currentInstrumentId).each(function(b,
c){b=c.value;c&&b&&""!==b&&a.add(b)});var b=a.size;this._logClogCounterMetric("ILFSelectedInstallmentPlanCount");var c=this.getDOMElement("bucketPagePopoverButtonText-"+this.currentInstrumentId);0===b?c.text(this.ilfPromptInitialText):1===b?c.text(this.singlePlanSelectedString.replace("{numberOfPlansSelected}",b.toString())):c.text(this.multiplePlansSelectedString.replace("{numberOfPlansSelected}",b.toString()))},_closeILFModalPopover:function(a){h.when("a-modal").execute(function(b){b&&(b=b.get("ilfModalPopover-"+
a))&&b.hide()})},_closeSecondaryViewPopover:function(a){h.when("a-secondary-view").execute(function(b){b&&(b=b.get(a))&&b.hide()})},_bucketInstallmentOptionAccordionContinueButtonClick:function(a){var b=e(a.currentTarget);a=b.find("input").data("bucketid");var c=b.find("input").data("financialofferid");b=b.find("input").data("installmentoptionselectiondetaildisplay");this.getDOMElementsByPrefix("bucketInstallmentsSelectionHiddenInput-"+this.currentInstrumentId+"-"+a).val(c);this.getDOMElement("bucketSelectionSubtitleText-"+
this.currentInstrumentId+"-"+a).text(b);this._toggleILFInstallmentMobileTouchLinkDisplay();this._collapseExpander(this.currentInstrumentId,a);this._closeSecondaryViewPopover("ilfInstallmentPlansSecondaryViewPopover-"+this.currentInstrumentId+"-"+a);this.isPromoCodeOfferPersistenceEnabled&&this.widget.trigger("installmentOfferSelectionChanged");c&&""!==c?this._logClogCounterMetric("ILFCCI."+a+".InstallmentPlanSelected."+c):this._logClogCounterMetric("ILFCCI."+a+".PayInFullSelected")},_singleBucketInstallmentOptionAccordionContinueButtonClick:function(a){var b=
e(a.currentTarget);a=b.find("input").data("bucketid");b=b.find("input").data("financialofferid");this.getDOMElementsByPrefix("bucketInstallmentsSelectionHiddenInput-"+this.currentInstrumentId+"-"+a).val(b);this._logClogCounterMetric("ILFInstallmentOptionsSelected");this._toggleILFInstallmentMobileTouchLinkDisplay();this._closeSecondaryViewPopover("ilfSingleBucketInstallmentPlansSecondaryViewPopover-"+this.currentInstrumentId+"-"+a);this._collapseExpander(this.currentInstrumentId,a);this.isPromoCodeOfferPersistenceEnabled&&
this.widget.trigger("installmentOfferSelectionChanged");b&&""!==b?this._logClogCounterMetric("ILFCCI."+a+".InstallmentPlanSelected."+b):this._logClogCounterMetric("ILFCCI."+a+".PayInFullSelected")},_bucketOfferSelectionTriggerButtonClick:function(a){a=e(a.currentTarget).find("input").data("bucketid");this._logClogCounterMetric("ILFCCI."+a+".BucketOfferSelectionTriggerButtonClick")},_installmentOptionSelectionsContinueButtonClick:function(){this._closeSecondaryViewPopover("ilfBucketsPageSecondaryViewPopover-"+
this.currentInstrumentId);this._logClogCounterMetric("ILFCCI.BucketPageContinueButtonClick")},isInstallmentsEligible:function(){return!(this.isILFMultiTenderDisabledWithGiftCard&&this.isGiftCardCheckboxSelected)},_toggleILFIngressButton:function(a){f.toggleElement(this.getDOMElement("ilfIngressButtonPrefix-"+this.currentInstrumentId),a&&this.isInstallmentsEligible())},_mobileView:function(){return"mobile"===this.widget.options.deviceType},_logClogCounterMetric:function(a){l.logCounterMetric({feature:a+
("mobile"===this.deviceType?".Mobile":".Desktop"),resource:"_Count"});l.publishMetrics()},bindToElements:function(){this._mobileView()&&(this.getDOMElementsByPrefix("chooseBucketInstallmentOfferButton-"+this.currentInstrumentId).click(k.bind(this._bucketInstallmentOptionAccordionContinueButtonClick,this)),this.getDOMElementsByPrefix("chooseSingleBucketInstallmentOfferButton-"+this.currentInstrumentId).click(k.bind(this._singleBucketInstallmentOptionAccordionContinueButtonClick,this)),this.getDOMElementsByPrefix("continueWithSelections-"+
this.currentInstrumentId).click(k.bind(this._installmentOptionSelectionsContinueButtonClick,this)),this.getDOMElementsByPrefix("bucketOfferSelectionTriggerButtonPrefix-"+this.currentInstrumentId).click(k.bind(this._bucketOfferSelectionTriggerButtonClick,this)))},bindToEvents:function(){var a=this,b=this.currentInstrumentId;h.when("A").execute(function(c){c.declarative("modalPopoverConfirmButton-"+b,"click",function(b){a._confirmButtonClick(b.$event)});c.on("a:dropdown:select",function(b){a._renderSelectionDetailDisplayString(b)});
c.on("a:expander:productDetailsExpander:toggle:expand",function(b){a._toggleProductImages(b,!1);a._logClogCounterMetric("ILFCCI.ASINImageExpanderClick")});c.on("a:expander:productDetailsExpander:toggle:collapse",function(b){a._toggleProductImages(b,!0)});c.declarative("modalPopoverCancelButton-"+b,"click",function(b){a._cancelButtonClick(b.$event)})});a.getDOMElement("ilfIngressButtonPrefix-"+b).click(function(b){a._logClogCounterMetric("ILFCCI.IngressButtonClick")});"desktop"===a.deviceType?(a.getDOMElement("ilfLearnMorePopoverPrefix-"+
b).hover(function(){a._logClogCounterMetric("ILFCCI.LearnMoreClick")}),a.getDOMElement("ilfWhyPopover").hover(function(){a._logClogCounterMetric("ILFCCI.WhyClick")})):(a.getDOMElement("ilfLearnMorePopoverPrefix-"+b).click(function(){a._logClogCounterMetric("ILFCCI.LearnMoreClick")}),a.getDOMElement("ilfWhyPopover").click(function(){a._logClogCounterMetric("ILFCCI.WhyClick")}));a.widget.on("optionalInstrumentSelected",a,function(b){a.isILFMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&(a.isGiftCardCheckboxSelected=
!0,a._toggleILFIngressButton(!1),this.widget.trigger("installmentsAvailabilityChanged",{isInstallmentsAvailable:!1}))});a.widget.on("optionalInstrumentDeselected",a,function(b){a.isILFMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&(a.isGiftCardCheckboxSelected=!1,a.isInstallmentsEligible()&&(a._toggleILFIngressButton(!0),this.widget.trigger("installmentsAvailabilityChanged",{isInstallmentsAvailable:!0})))})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Points","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PointsDetailsSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(){})}})});a("components/PointsMetadataSlotComponent",
["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/PointsSleeveItemSlotComponent",["component"],function(a){return a.extend({_triggerFallbackToMPO:!1,initialize:function(a,b){this._triggerFallbackToMPO=b.data.triggerFallbackToMPO},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO")})}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,c=b._namespace||b.attributeErrors,a=c?c("APXWidgetsAssets@APXWidgets-WeChatPay","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,c){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableWeChatListComponent",["css-utils","form-component","jQuery","lang","AUI!P"],function(a,b,d,c,e){return b});a("components/SelectableWeChatListItemComponent",["components/SelectableDPMInstrumentListItemComponent",
"continuable-component","css-utils","jQuery","AUI!P"],function(a,d,c,f,e){return a.extend(d,{initialize:function(a,b){this.isAmazonApp=b.data.isAmazonApp;this.deviceUserAgent=b.data.deviceUserAgent;this.isDetectable=b.data.isDetectable;this.hideWeChatAppNotInstallmentAlert();this.isDetectable&&this.checkWeChatInstallment()},checkWeChatInstallment:function(){var a="WeChatPaymentPlugin";"IPHONE"===this.deviceUserAgent?a="WeChatPaymentPlugin":"ANDROID"===this.deviceUserAgent&&(a="MShopWeChatPayment");
e.when("mash").execute("wechat-contract-detector",function(c){b.cordova.require("cordova/exec")(function(a){a&&!1!==a.isWeChatInstalled?this.hideWeChatAppNotInstallmentAlert():this.showWeChatAppNotInstallmentAlert()},function(a){this.hideWeChatAppNotInstallmentAlert()},a,"isWeChatInstalled",[])})},showWeChatAppNotInstallmentAlert:function(){c.showElement(this.getDOMElement("weChatAppNotInstallContainer"))},hideWeChatAppNotInstallmentAlert:function(){c.hideElement(this.getDOMElement("weChatAppNotInstallContainer"))}})})})()});
/* ******** */
(function(h){var k=window.AmazonUIPageJS||window.P,m=k._namespace||k.attributeErrors,g=m?m("APXWidgetsAssets@APXWidgets-PayLaterAccount","APXWidgetsAssets"):k;g.guardFatal?g.guardFatal(h)(g,window):g.execute(function(){h(g,window)})})(function(h,k,m){(function(){var g=PaymentsPortal2.modules.define;g("components/PayLaterInstallmentOptionsComponent",["events/InstrumentRowSelectedEvent","jQuery","component","lang"],function(f,e,a,n){return a.extend({_payLaterAccountInstrumentId:null,_externalPaymentMethodSourceId:null,
_isCCInstallmentsEmpty:null,initialize:function(d,c){this._payLaterAccountInstrumentId=c.data.payLaterAccountInstrumentIdDataKey;this._externalPaymentMethodSourceId=c.data.payLaterAccountExternalPaymentMethodSourceIdDataKey;this._payLaterAccountInstrumentRowValue=c.data.payLaterAccountInstrumentRowValueDataKey;this._isCCInstallmentsEmpty=c.data.payLaterAccountCCInstallmentsIsEmptyDataKey;this._refreshWidgetButtonId="payLaterAccountRefreshButton-".concat(this._externalPaymentMethodSourceId)},bindToEvents:function(){this.widget.on("installmentOptionChanged",
this,this.instalmentOptionChangeEventHandler);var d=this;d.getDOMElement(this._refreshWidgetButtonId).click(function(c){d._triggerRefreshWidget()});d.widget.on(f,d,function(c){console.log("event.instrumentId from InstrumentRowSelectedEvent: "+c.instrumentId);c.instrumentId!==d._externalPaymentMethodSourceId||this._isCCInstallmentsEmpty||d._updatePayLaterAccountHiddenInputsBasedOnInstallmentSelectedStateForCurrentSelection()})},bindToElements:function(){},_updatePayLaterAccountHiddenInputsBasedOnInstallmentSelectedStateForCurrentSelection:function(){console.log("_updatePayLaterInstallmentSelectedStateForCurrentSelection is called");
"true"===this._getPayLaterAccountSelectedHiddenInputInstallmentStateAttribute()?(console.log("updating all instances of PLA hidden input to the current PLA instrument row value on selection"),this._updateAllInstancesOfPayLaterAccountSelectedHiddenInput(this._payLaterAccountInstrumentRowValue)):(console.log("clearing all instances of PLA hidden inputs' value on selection"),this._updateAllInstancesOfPayLaterAccountSelectedHiddenInput(""))},_triggerRefreshWidget:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"RefreshEvent","ppw-widgetAction":"PayLaterAccountInstallmentOptionsRefreshEvent"})},_updatePayLaterAccountSelectedHiddenInputInstallmentStateAttribute:function(d){var c=this._externalPaymentMethodSourceId.split(".").join("");document.querySelector("#"+"payLaterAccountPreviousSelectedInstallmentStateId-".concat(c)).value=d},_updateAllInstancesOfPayLaterAccountSelectedHiddenInput:function(d){var c=document.querySelectorAll("[id^\x3d'payLaterAccountSelectedInstrumentIdInputJSBindId-']");
c=Array.prototype.slice.call(c);for(var b=0;b<c.length;b++)c[b].value=d},_getPayLaterAccountSelectedHiddenInputInstallmentStateAttribute:function(){var d=this._externalPaymentMethodSourceId.split(".").join("");return document.querySelector("#"+"payLaterAccountPreviousSelectedInstallmentStateId-".concat(d)).value},instalmentOptionChangeEventHandler:function(d){console.log("event.instrumentId from instalmentOptionChangeEventHandler: "+d.instrumentId);d.instrumentId===this._externalPaymentMethodSourceId&&
(console.log("INSTALLMENT_OPTION_CHANGED_EVENT has been fired for the current PLA installment options instance"),d.isInstallmentOfferSelected?(console.log("PLA installment option has been selected for the current instance"),this._updatePayLaterAccountSelectedHiddenInputInstallmentStateAttribute("true"),this._updateAllInstancesOfPayLaterAccountSelectedHiddenInput(this._payLaterAccountInstrumentRowValue)):(this._updateAllInstancesOfPayLaterAccountSelectedHiddenInput(""),this._updatePayLaterAccountSelectedHiddenInputInstallmentStateAttribute("false")))}})});
g("components/SelectableLatitudeCreatableListItemSlotComponent",["jQuery","component","lang","events/ShowAddPaymentInstrumentPage"],function(f,e,a,n){return e.extend({initialize:function(d,c){},bindToEvents:function(){},bindToElements:function(){var d=this;d.getDOMElement("paylateraccount-add-latitude-card").click(function(c){d.widget.trigger(n,{})})}})});g("components/AddPayLaterAccountComponent",["component"],function(f){return f.extend({initialize:function(e,a){}})});g("components/SelectableSplititCreatableListItemSlotComponent",
["jQuery","component","lang"],function(f,e,a){return e.extend({initialize:function(a,d){this._deviceType=a.options.deviceType;this._isDesktop="desktop"===this._deviceType;this._brand=d.data.brand;this._popoverModalName=this._generateBindingJS("apx-paylater-creatable-popover-modal",this._brand,d.data.uniqueId);this._popoverComponent=this._isDesktop?"a-modal":"a-secondary-view";this._popoverLinkTrigger=this._generateBindingJS("apx-paylateraccount-creatable-modal-trigger",this._brand);this._isPaymentOptionSelectedOnPaymentSelectionScreen=
this._popoverActivated=!1},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){h.when("A",a._popoverComponent,"ready").execute(function(d,c){a.getDOMElement(a._popoverLinkTrigger).click(function(){if(c){var b=c.get(a._popoverModalName);b&&b.show()}});d.on("a:popover:show:"+a._popoverModalName,function(b){a._popoverActivated=!0});d.on("a:popover:hide:"+a._popoverModalName,function(b){a._isPaymentOptionSelectedOnPaymentSelectionScreen&&(a._isPaymentOptionSelectedOnPaymentSelectionScreen=
!1,a.getDOMElementsByPrefix("apx-paylateraccount-splitit-payment-selection-box-element").removeClass("splitit-payment-option-selected-css"));a._popoverActivated=!1})})})},bindToElements:function(){this.getDOMElementsByPrefix("apx-paylateraccount-splitit-payment-selection-box-element").click(a.bind(this._paymentMethodOnSelectionScreenClickedAction,this));this.getDOMElement("apx-paylateraccount-splitit-payment-selection-continue-button").click(a.bind(this._paymentSelectionScreenContinueAction,this));
this.getDOMElement("apx-paylateraccount-splitit-payment-selection-cancel-button").click(a.bind(this._paymentSelectionScreenCancelAction,this))},_generateBindingJS:function(){return Array.from(arguments).join("-")},_paymentSelectionScreenContinueAction:function(){},_paymentSelectionScreenCancelAction:function(){this.getDOMElementsByPrefix("apx-paylateraccount-splitit-payment-selection-box-element").removeClass("splitit-payment-option-selected-css");this._closeSplititDesktopPopover()},_closeSplititDesktopPopover:function(){var a=
this;h.when("A",a._popoverComponent,"ready").execute(function(d,c){(d=c.get(a._popoverModalName))&&d.isActive()&&(a._isPaymentOptionSelectedOnPaymentSelectionScreen=!1,d.hide())})},_paymentMethodOnSelectionScreenClickedAction:function(a){a=f(a.currentTarget);this.getDOMElementsByPrefix("apx-paylateraccount-splitit-payment-selection-box-element").removeClass("splitit-payment-option-selected-css");this.getDOMElement(this._generateBindingJS("apx-paylateraccount-splitit-payment-selection-box-element",
a.data("token"))).addClass("splitit-payment-option-selected-css");this._isPaymentOptionSelectedOnPaymentSelectionScreen=!0}})});g("components/PayLaterAccountDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(f,e,a){return f.extend(e,{initialize:function(a,d){this._paymentMethodId=d.data.paymentMethodId;this._paymentMethodType=d.data.paymentMethodType;this._isDefault=d.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});g("components/PayLaterAccountEditComponent",
["component","EditComponentSupport"],function(f,e){return f.extend(e,{initialize:function(a,f){e._initializePopover(a,f,this)},bindToEvents:function(){e._bindPopoverCloseButtonClickedEvent(this)}})});g("components/SelectablePayLaterAvailableListItemComponent","events/InstrumentRowSelectedEvent components/SimplePaymentOptionListItemComponent css-utils jQuery clog mixins/disable-component".split(" "),function(f,e,a,g,d,c){return e.extend({_instrumentId:null,_popoverViewInstance:null,initialize:function(b,
a){this._instrumentId=a.data.instrumentId;this._deviceType=b.options.deviceType;this._isDesktop="desktop"===this._deviceType;this._isMobile="mobile"===this._deviceType;this._popoverComponent=this._isDesktop?"a-modal":"a-secondary-view";this._widgetHasBeenClickedOnce=!1;this._brand=a.data.brand;this._isMultiTenderEnabled=a.data.payLaterAccountIsMultiTenderEnabled;this._giftCardUsageDisabledMessage=a.data.giftCardUsageDisabledMessage;this._isPaymentMethodDisabled=a.data.isPaymentMethodDisabled;this._initializeInstallmentsOffersPopoverView();
this.setDisabled(this._isPaymentMethodDisabled,!0);this._originalPaymentMethodInfoText=this._getOriginalPaymentLevelInfo();this._isFoodVoucherCardSelected=this._isGiftCardSelected=!1;this._isBalanceShownOutsideFinancialOfferSelection=a.data.isBalanceShownOutsideFinancialOfferSelection;this._isPopoverViewFinancialOfferSelectionContinueButtonSuppressed=a.data.isPopoverViewFinancialOfferSelectionContinueButtonSuppressed;this._isTotalInstallmentAmountInFinancialOfferSelectionMenuEnabled=a.data.isTotalInstallmentAmountInFinancialOfferSelectionMenuEnabled;
this._selectedOfferID=null},_onPayLaterSelected:function(){this._isInstrumentSelected()||(this._onInstrumentSelected(),a.showElement(this._getOfferSectionElement()),this._getAccordionSelectedOfferIdValueAndUpdateHiddenSelectedOfferIdInput(this._getInstrumentId()),this._isBalanceShownOutsideFinancialOfferSelection&&a.showElement(this._getBalanceTextShownOutSideFinancialOfferContainer()),this._hidePaymentMethodInfoForBrand(this._brand)&&(a.hideElement(this._getPaymentMethodInfoAttainableDefault()),
a.hideElement(this._getPaymentMethodInfoAttainableWithGC())))},_onPayLaterDeselected:function(){this._isInstrumentSelected()&&(this._onInstrumentDeselected(),a.hideElement(this._getOfferSectionElement()),this._isBalanceShownOutsideFinancialOfferSelection&&a.hideElement(this._getBalanceTextShownOutSideFinancialOfferContainer()),this._showPaymentMethodInfoForBrand(this._brand)&&this._enableAttainableMessage())},bindToEvents:function(){var b=this;b.widget.on(f,b,function(a){a.instrumentId===b._getInstrumentId()?
b._onPayLaterSelected():b._onPayLaterDeselected()});b.widget.on("optionalInstrumentSelected",b,b._optionalInstrumentSelectedHandler);b.widget.on("optionalInstrumentDeselected",b,b._optionalInstrumentDeselectedHandler);b.widget.on("FoodVoucherCardRowClickedEvent",b,function(b){b.paymentMethod="FVC";b.isSelected?this._optionalInstrumentSelectedHandler(b):this._optionalInstrumentDeselectedHandler(b)});b._getContainerElement().click(function(){if(0==b._widgetHasBeenClickedOnce){b._widgetHasBeenClickedOnce=
!0;try{d.logCounterMetric({feature:"PayLaterAccountWidget.AvailableComponentClicked."+b._deviceType+"."+b._brand,resource:"_Count"}),d.publishMetrics()}catch(l){}}})},_enableAttainableMessage:function(){this._isGiftCardSelected?this._isGiftCardSelected&&a.showElement(self._getPaymentMethodInfoAttainableWithGC()):a.showElement(self._getPaymentMethodInfoAttainableDefault())},_disablePayLaterAccount:function(){this._onPayLaterDeselected();this.setDisabled(!0,!0);this._instrumentPayLaterAccountEnableGreyOut()},
_enablePayLaterAccount:function(){this.setDisabled(!1,!0);this._instrumentPayLaterAccountDisableGreyOut()},_getPaymentMethodInfoWithGC:function(){return this.getDOMElement("paymentLevelInfoContainerWithGC-"+this._getInstrumentId())},_getPaymentMethodInfoDefault:function(){return this.getDOMElement("paymentLevelInfoContainer-"+this._getInstrumentId())},_getPaymentMethodInfoAttainableDefault:function(){return this.getDOMElement("paymentLevelInfoAttainableContainer-"+this._getInstrumentId())},_getPaymentMethodInfoAttainableWithGC:function(){return this.getDOMElement("paymentLevelInfoAttainableContainerWithGC-"+
this._getInstrumentId())},_getPaymentMethodInfoWithFVC:function(){return this.getDOMElement("paymentLevelInfoContainerWithFVC-"+this._getInstrumentId())},_getAccordionSectionWithGC:function(){return this.getDOMElement("payLaterAccountMultiOfferSection-WithGC-"+this._brand)},_getAccordionSectionWithoutGC:function(){return this.getDOMElement("payLaterAccountMultiOfferSection-default-"+this._brand)},_getAccordionSectionErrorMessage:function(){return this.getDOMElement("payLaterAccountDropdownSelectPlanError-"+
this._instrumentId)},_updatePaymentMethodLevelHiddenInput:function(b){var a=this._instrumentId.split(".").join("");a=document.querySelector("#payLaterAccountSelectedOfferForPaymentMethod-"+a);null!==a&&(a.value=b);this._isInstrumentSelected()&&this._getAccordionSelectedOfferIdValueAndUpdateHiddenSelectedOfferIdInput(this._getInstrumentId())},_deactivateAllPayLaterAccountSections:function(){a.hideElement(this._getPaymentMethodInfoDefault());a.hideElement(this._getPaymentMethodInfoWithGC());a.hideElement(this._getPaymentMethodInfoWithFVC());
a.hideElement(this._getAccordionSectionWithoutGC());a.hideElement(this._getAccordionSectionWithGC());a.hideElement(this._getPaymentMethodInfoAttainableDefault());a.hideElement(this._getPaymentMethodInfoAttainableWithGC())},_deselectInstrumentIfSelectedOfferConflict:function(){this._isInstrumentSelected()&&this.data.recommendFinancialOfferIDWithGC!==this.data.recommendFinancialOfferIDDefault&&(this.widget.trigger(f,{}),this.widget.trigger("backingInstrumentSelected",{}))},_optionalInstrumentSelectedWithPrecalculationHandler:function(){this._isMultiTenderEnabled&&
(this.data.isPaymentMethodWithGCDisabled?this._disablePayLaterAccount():this._enablePayLaterAccount(),a.showElement(this._getPaymentMethodInfoWithGC()),a.hideElement(this._getPaymentMethodInfoAttainableDefault()),a.hideElement(this._getPaymentMethodInfoDefault()),a.hideElement(this._getAccordionSectionWithoutGC()),a.showElement(this._getPaymentMethodInfoAttainableWithGC()),a.hideElement(this._getPaymentMethodInfoAttainableDefault()),a.showElement(this._getAccordionSectionWithGC()),this.data.isFinancialOfferAutoSwitchDisabled&&
this._deselectInstrumentIfSelectedOfferConflict(),this._updatePaymentMethodLevelHiddenInput(this.data.recommendFinancialOfferIDWithGC))},_optionalInstrumentDeselectedWithPrecalculationHandler:function(){this._isMultiTenderEnabled&&(this._isPaymentMethodDisabled?this._disablePayLaterAccount():this._enablePayLaterAccount(),a.hideElement(this._getPaymentMethodInfoWithGC()),a.showElement(this._getPaymentMethodInfoDefault()),a.showElement(this._getAccordionSectionWithoutGC()),a.showElement(this._getPaymentMethodInfoAttainableDefault()),
a.hideElement(this._getPaymentMethodInfoAttainableWithGC()),a.hideElement(this._getAccordionSectionWithGC()),this.data.isFinancialOfferAutoSwitchDisabled&&this._deselectInstrumentIfSelectedOfferConflict(),this._updatePaymentMethodLevelHiddenInput(this.data.recommendFinancialOfferIDDefault))},_onGiftCardSelectedHandler:function(){this._isMultiTenderEnabled?this._optionalInstrumentSelectedWithPrecalculationHandler():(this._disablePayLaterAccount(),this._showGiftCardDisabledMessage())},_onGiftCardDeselectedHandler:function(){this._isMultiTenderEnabled?
this._optionalInstrumentDeselectedWithPrecalculationHandler():this._isPaymentMethodDisabled||(this._enablePayLaterAccount(),this._hideGiftCardDisabledMessageAndUpdateOriginalPaymentLevelInfo(this._getOriginalPaymentLevelInfo()))},_onFoodVoucherCardSelectedHandler:function(){this._deactivateAllPayLaterAccountSections();a.showElement(this._getPaymentMethodInfoWithFVC());this._disablePayLaterAccount()},_onFoodVoucherCardDeselectedHandler:function(){this._deactivateAllPayLaterAccountSections();this._isGiftCardSelected?
this._onGiftCardSelectedHandler():this._onGiftCardDeselectedHandler()},_optionalInstrumentSelectedHandler:function(b){b=b.paymentMethod;"FVC"==b?(this._isFoodVoucherCardSelected=!0,this._onFoodVoucherCardSelectedHandler()):"GC"==b&&(this._isGiftCardSelected=!0,this._isFoodVoucherCardSelected||this._onGiftCardSelectedHandler())},_optionalInstrumentDeselectedHandler:function(b){b=b.paymentMethod;"FVC"==b?(this._isFoodVoucherCardSelected=!1,this._onFoodVoucherCardDeselectedHandler()):"GC"==b&&(this._isGiftCardSelected=
!1,this._isFoodVoucherCardSelected||this._onGiftCardDeselectedHandler())},_getOriginalPaymentLevelInfo:function(){return this.getDOMElement("paymentLevelInfoContainer-".concat(this._instrumentId)).text()},_showGiftCardDisabledMessage:function(){var b=this.getDOMElement("paymentLevelInfoContainer-".concat(this._instrumentId));0==this._isPaymentMethodDisabled&&b.text(this._giftCardUsageDisabledMessage)},_hideGiftCardDisabledMessageAndUpdateOriginalPaymentLevelInfo:function(b){var a=this.getDOMElement("paymentLevelInfoContainer-".concat(this._instrumentId));
0!=b.length&&a.text(b)},_getContainerElement:function(){var b="payLaterAccountContainer-".concat(this._instrumentId);return this.getDOMElement(b)},_getOfferSectionElement:function(){var b="payLaterAccountOfferContainer-".concat(this._instrumentId);return this.getDOMElement(b)},_initializeInstallmentsOffersPopoverView:function(){var b=this;h.when("A",b._popoverComponent,"ready").execute(function(c,d){var l=b._instrumentId;c.on("a:accordion:payLaterAccountPopoverAccordion-"+l+"-WithGC:select",b._installmentsWithInfoPopoverAccordionRowSelectedHandler(b));
c.on("a:accordion:payLaterAccountPopoverAccordion-"+l+":select",b._installmentsWithInfoPopoverAccordionRowSelectedHandler(b));var e=("payLaterAccountPopover-"+b._instrumentId).replaceAll(".","");c.on("a:popover:show:"+e,function(){b._popoverViewInstance=d.get(e)});b.getDOMElement("selectPlanBtn-"+b._instrumentId).click(function(){b._isBrandWithNoPreSelectedOffer(b._brand)&&null==b._selectedOfferID?a.showElement(b._getAccordionSectionErrorMessage()):b._popoverViewInstance&&b._popoverViewInstance.hide()})})},
_installmentsWithInfoPopoverAccordionRowSelectedHandler:function(b){return function(c){var d=b._instrumentId.split(".").join(""),e=c.selectedRow.accordionName.split(".").join("");e=document.querySelector("#"+e);c=c.selectedRow.rowName.split(".").join("");var f=document.querySelector("#"+c);b._updateDynamicButtonContent(b._instrumentId,f.dataset.primaryoffertext,f.dataset.secondaryoffertext,f.dataset.totalinstallmentamount);c=f.dataset.financialofferid;b._selectedOfferID=c;a.hideElement(b._getAccordionSectionErrorMessage());
e.dataset.selectedfinancialofferid=c;(e=f.dataset.gcheader)&&"WithGC"==e?b.data.recommendFinancialOfferIDWithGC=c:b.data.recommendFinancialOfferIDDefault=c;document.querySelector("#selectedOfferIdHiddenInput").value=c;document.querySelector("#payLaterAccountSelectedOfferForPaymentMethod-"+d).value=c;b._isPopoverViewFinancialOfferSelectionContinueButtonSuppressed&&b._popoverViewInstance&&b._popoverViewInstance.hide()}},_updateDynamicButtonContent:function(b,a,c,d){var e="selectedOfferButtonTextPrefix-".concat(b);
this.getDOMElement(e).text(a);a="selectedOfferButtonSecondaryTextPrefix-".concat(b);this.getDOMElement(a).text(c);this._isTotalInstallmentAmountInFinancialOfferSelectionMenuEnabled&&(b="selectedOfferButtonTotalInstallmentAmountTextPrefix-".concat(b),this.getDOMElement(b).text(d))},_getAccordionSelectedOfferIdValueAndUpdateHiddenSelectedOfferIdInput:function(b){b=b.split(".").join("");g("#selectedOfferIdHiddenInput").val(g("#payLaterAccountSelectedOfferForPaymentMethod-"+b).val())},_instrumentPayLaterAccountEnableGreyOut:function(){this._getContainerElement();
this._getContainerElement().addClass("pmts-payLater-greyed-out-section")},_instrumentPayLaterAccountDisableGreyOut:function(){this._getContainerElement();this._getContainerElement().removeClass("pmts-payLater-greyed-out-section")},_getBalanceTextShownOutSideFinancialOfferContainer:function(){var b="payLaterAccountBalanceOutsideFinancialOfferSelection-".concat(this._instrumentId);return this.getDOMElement(b)},_showPaymentMethodInfoForBrand:function(b){switch(b){case "Invex":return!0;default:return!1}},
_hidePaymentMethodInfoForBrand:function(b){switch(b){case "Invex":return!0;default:return!1}},_isBrandWithNoPreSelectedOffer:function(b){switch(b){case "Invex":return!0;default:return!1}}})});g("components/SelectablePayLaterCreatableListItemComponent",["jQuery","component","css-utils","lang","clog"],function(f,e,a,g,d){return e.extend({initialize:function(a,b){this._deviceType=a.options.deviceType;this._isDesktop="desktop"===this._deviceType;this._isMobile="mobile"===this._deviceType;this._isAmazonApp=
b.data.isAmazonApp;this._widgetAction=b.data.widgetAction;this._brand=b.data.brand;this._iframeSource=b.data.iframeSource;this._popoverComponent=this._isDesktop?"a-modal":"a-secondary-view";this._popoverModalName=this._generateBindingJS("apx-paylater-creatable-popover-modal",this._brand,b.data.uniqueId);this._iframeName=this._generateBindingJS("apx-paylater-iframe",this._brand);this._popoverLinkTrigger=this._generateBindingJS("apx-paylateraccount-creatable-modal-trigger",this._brand);this._shouldRefreshWidgetOnPopoverCloseButton=
this._popoverActivated=!1},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){h.when("A",a._popoverComponent,"ready").execute(function(b,c){a.getDOMElement(a._popoverLinkTrigger).click(function(){if(c){var b=c.get(a._popoverModalName);b&&b.show()}});b.on("a:popover:show:"+a._popoverModalName,function(b){try{d.logCounterMetric({feature:"PayLaterAccountWidget.CreatableComponentClicked."+a._deviceType+"."+a._brand,resource:"_Count"}),d.publishMetrics()}catch(p){}a._popoverActivated=
!0;a.getDOMElement(a._iframeName).attr("src",a._iframeSource)});b.on("a:popover:hide:"+a._popoverModalName,function(b){a._popoverActivated=!1;a.getDOMElement(a._iframeName).attr("src","about:blank");a._shouldRefreshWidgetOnPopoverCloseButton&&a._triggerRefreshWidget()})});this._bindMessageListener()})},bindToElements:function(){},_generateBindingJS:function(){return Array.from(arguments).join("-")},_bindMessageListener:function(){var a=g.bind(this._processBetsyMessage,this);g.addEventListener(k,"message",
a)},_auiCompatibilityClosePopover:function(){f('div[id^\x3d"a-popover-"]').hide()},_closePopoverModal:function(){var a=this;h.when("A",a._popoverComponent,"ready").execute(function(b,c){c?(b=c.get(a._popoverModalName))&&b.isActive()&&b.hide():a._popoverActivated&&a._auiCompatibilityClosePopover()})},_processBetsyMessage:function(a){try{var b=JSON.parse(a.data)}catch(l){return}if(b&&b.linkingStatus)switch(b.linkingStatus){case "MiniBrowserOpened":this._handleMiniBrowerOpened();break;case "LinkingFailed":this._handleLinkingFailed(b.errorCode);
break;case "LinkingSuccess":this._handleLinkingSuccess(b.paymentMethodId);break;case "LinkingCancelled":this._closePopoverModal();break;case "LinkingApproved":this._handleLinkingApproved()}},_handleMiniBrowerOpened:function(){},_showErrorText:function(){var c=this.getDOMElement(this._generateBindingJS("apx-paylateraccount-creatable-error",this._brand));"undefined"!=typeof errorMessage&&(c.textContent=errorMessage);a.showElement(c)},_hideErrorText:function(){var c=this.getDOMElement(this._generateBindingJS("apx-paylateraccount-creatable-error",
this._brand));a.hideElement(c)},_handleLinkingFailed:function(a){var b=this;h.when("A",b._popoverComponent,"ready").execute(function(a,c){c?(a=c.get(b._popoverModalName))&&a.isActive()?(b._closePopoverModal(),b._showErrorText()):b._hideErrorText():b._popoverActivated?(b._showErrorText(),b._closePopoverModal()):b._hideErrorText()})},_triggerRefreshWidget:function(a){"undefined"==typeof a?this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent",
"ppw-widgetAction":this._widgetAction}):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a,"ppw-widgetAction":this._widgetAction})},_handleLinkingSuccess:function(a){var b=this;h.when("A",b._popoverComponent,"ready").execute(function(d,c){c?(d=c.get(b._popoverModalName))&&d.isActive()&&(b._closePopoverModal(),b._triggerRefreshWidget(a)):b._popoverActivated&&(b._closePopoverModal(),b._triggerRefreshWidget(a))})},
_handleLinkingApproved:function(){this._shouldRefreshWidgetOnPopoverCloseButton=!0}})});g("components/SelectablePayLaterListComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(f,e){return e.extend({initialize:function(a,e){},bindToEvents:function(){}})});g("components/PayLaterAccountSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(f,e){var a=e.bindToElements;return f.extend(e,{initialize:function(a,
d){this._instrumentId=d.data.instrumentId;this._isRequestForApp=d.data.isRequestForApp;this._isBrandRequestToMshop=d.data.isBrandRequestToMshop;this._brandName=d.data.brandName},bindToElements:function(){this._isRequestForApp&&this._isBrandRequestToMshop?this._ingressMshopRedirection(this._brandName):a.call(this)},_ingressMshopRedirection:function(a){switch(a){case "Invex":var d="/spa/debit-installment/dashboard?ingressSource\x3dwallet\x26preSelectedPaymentMethodId\x3d"+this._instrumentId}this.getDOMElement("walletSelectablePMTab").click(function(){k.location.href=
d});this.getDOMElement("walletSelectablePMButton").click(function(){k.location.href=d})}})});g("components/PayLaterAccountLearnMoreComponent",["jQuery","component","lang","mixins/disable-component"],function(f,e,a,g){return e.extend(g,{initialize:function(a,c){this._instrumentId=c.data.instrumentId;this._partnerName=c.data.partnerName;this._isMultiTenderEnabledForPayLaterAccount=c.data.isMultiTenderEnabledForPayLaterAccount},bindToElements:function(){this._enableComponentState();this._isMultiTenderEnabledForPayLaterAccount||
(this.widget.on("optionalInstrumentSelected",this,this._enableLearnMoreLink),this.widget.on("optionalInstrumentDeselected",this,this._enableLearnMoreLink));this.getDOMElement("apx-paylateraccount-creatable-learn-more-wrapper-"+this._partnerName).click(function(a){a.stopPropagation()})},_enableLearnMoreLink:function(a){"GC"===a.paymentMethod&&this._enableComponentState()},_enableComponentState:function(){this.setDisabled(!1)}})})})()});
/* ******** */
(function(l){var h=window.AmazonUIPageJS||window.P,m=h._namespace||h.attributeErrors,d=m?m("APXWidgetsAssets@APXWidgets-ZipPay","APXWidgetsAssets"):h;d.guardFatal?d.guardFatal(l)(d,window):d.execute(function(){l(d,window)})})(function(l,h,m){(function(){var d=PaymentsPortal2.modules.define;d("components/SelectableZipPayListComponent",["form-component"],function(c){return c});d("components/ZipPayListItemComponent","components/SelectableDPMInstrumentListItemComponent events/InstrumentRowSelectedEvent lang jQuery css-utils component".split(" "),
function(c,d,h,g,k,m){var f,a,b,e;return c.extend({initialize:function(a,b){this._maybeDisableInstrumentRow()},_maybeDisableInstrumentRow:function(){var a=this._getContainerElement();0<a.find(".pmts-zip-no-balance-text").length&&(a.find("img").each(function(a,b){g(b).css("opacity","0.5")}),a.find(".pmts-zip-balance-instrument-type").each(function(a,b){g(b).addClass("a-color-tertiary")}),a.find("input[type\x3dradio]").each(function(a,b){g(b).prop("disabled",!0)}))},_getContainerElement:function(){return this.getDOMElement("POAInstrumentContainer-"+
this._getInstrumentId())},_triggerIsLineItemIneligibleEvent:function(){this._instrumentZipEnableGreyOut();this._instrumentZipUnclickable()},_instrumentZipEnableGreyOut:function(){this._getContainerElement().addClass("pmts-disabled-section")},_instrumentZipUnclickable:function(){this._getContainerElement().addClass("pmts-pm-disabled")},_instrumentZipDisableGreyOut:function(){this._getContainerElement().removeClass("pmts-disabled-section")},_instrumentZipClickable:function(){this._getContainerElement().removeClass("pmts-pm-disabled")},
_hideZipAlertMessage:function(){this.getDOMElement("pmts-zip-inline-alert-message").addClass("apx-js-hide")},_showZipAlertMessage:function(){this.getDOMElement("pmts-zip-inline-alert-message").removeClass("apx-js-hide")},_setZipPaymentInvalid:function(a){a=[this.widget.getLocalizedString(a)];this._triggerBackingInstrumentSelectedEvent(a)},_canGiftCardBalanceCoverZipBalanceInsufficiency:function(){a=this.data.zipBalance;b=this.data.cartTotalAmount;return a&&b?f?Number(a)+Number(f)>=Number(b):!1:!0},
bindToElements:function(){var a=this;0===a._getContainerElement().find(".pmts-zip-no-balance-text").length&&a.getDOMElementsByPrefix("POAInstrumentContainer").click(function(b){g(b.currentTarget).data("disabled")||a.poaInstrumentClicked(a._instrumentId)});a.getDOMElement("ZipBalanceRefresh").find(".pmts-zip-balance-refresh-link").click(function(){a.widget.trigger("ZipBalanceRefresh")})},bindToEvents:function(){var a=this;a.widget.on("initializeRecommendedInstrument",a,function(b){a.data.isLineItemIneligible?
(a._triggerIsLineItemIneligibleEvent(),b.instrumentId===a._getInstrumentId()&&a._setZipPaymentInvalid("pmts_portal_payselect_empty_instrument_selection")):b.instrumentId===a._getInstrumentId()?(a.widget.trigger(d,{instrumentId:a._getInstrumentId()}),a.data.isMultiTenderEnabledWithZip||a.widget.trigger("deselectGiftCardCheckbox",{paymentMethod:a.data.paymentMethod})):a._onInstrumentDeselected()});a.widget.on(d,a,function(b){e=!1;a._instrumentRowSelected(b.instrumentId);h.isDefined(a.data.instrumentId)&&
-1!==b.instrumentId.indexOf("amzn1.pm.pma.zip")&&(e=!0,a.data.isInsufficientCoverage&&(a.data.isMultiTenderEnabledWithZip&&a._canGiftCardBalanceCoverZipBalanceInsufficiency()?a._hideZipAlertMessage():(a._setZipPaymentInvalid("pmts_portal_zp_error_insufficient_popover"),a._showZipAlertMessage())))});a.widget.on("optionalInstrumentSelected",a,function(b){"GC"===b.paymentMethod&&(f=b.balance,a.data.isMultiTenderEnabledWithZip?a.data.isInsufficientCoverage&&a._canGiftCardBalanceCoverZipBalanceInsufficiency()&&
(e&&a._instrumentRowSelected(a.data.zipPayId),a._hideZipAlertMessage()):(a._instrumentZipEnableGreyOut(),a._instrumentZipUnclickable(),a._showZipAlertMessage()))});a.widget.on("optionalInstrumentDeselected",a,function(b){"GC"===b.paymentMethod&&(f=0,a.data.isMultiTenderEnabledWithZip?a.data.isInsufficientCoverage&&(e&&a._setZipPaymentInvalid("pmts_portal_zp_error_insufficient_popover"),a._showZipAlertMessage()):a.data.isLineItemIneligible||(a._instrumentZipDisableGreyOut(),a._instrumentZipClickable(),
a._hideZipAlertMessage()))});a.widget.on("ZipBalanceRefresh",a,function(b){a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"ZipBalanceRefreshEvent"})})}})});d("components/AddZipPayComponent","css-utils jQuery form-component lang AUI!P aui-helper clog".split(" "),function(c,d,p,g,k,l,f){return p.extend({_authenticationSourceId:"",_authenticationSourceStatus:"",_authenticationSourceIdRedirect:"",_authenticationSourceIdRedirectStatus:"",_AUCountryCodePrefix:"+61",
_resendCodeClickCount:0,_zipAjaxCallInProgress:!1,_zipModalLockLevel:11,_zipApplicationURL:"",_zipApplicationModalVisible:!1,_zipApplicationSecondaryViewVisible:!1,_zipIFrameApplicationLoaded:!1,_isAUIAvailable:!0,_zipModalPopover:"",_isZipSignupPromotion:!1,_emptyMobileNumberErrorMsg:{field:"zip_mobile_number",messageStringId:"pmts_portal_zp_error_no_mobile_number"},_invalidMobileNumberErrorMsg:{field:"zip_mobile_number",messageStringId:"pmts_portal_zp_error_invalid_mobile_number"},_emptyOTPErrorMsg:{field:"zip_one_time_password",
messageStringId:"pmts_portal_zp_error_no_verification_code"},_invalidOTPErrorMsg:{field:"zip_one_time_password",messageStringId:"pmts_portal_zp_error_invalid_verification_code"},_failedInternalCallErrorMsg:{messageStringId:"pmts_portal_zp_error_internal_fail"},initialize:function(a,b){this._isDesktop="desktop"===a.options.deviceType;this._isTablet="tablet"==a.options.deviceType;this._isMobile="mobile"===a.options.deviceType;this._isAmazonApp=b.data.isAmazonApp},bindToElements:function(){this.bindFormSubmissionHandler("getVerificationCodeButton",
"mobileNumber",this.handleSendOTPRequest);this.bindFormSubmissionHandler("resendCodeRequest","mobileNumber",this.handleResendOTPRequest);this.bindFormSubmissionHandler("verifyButton","verificationCode",this.handleVerifyOTPRequest);this._bindCreateZipAccountTrigger();this._bindPromptUserToAddOrCreateZipAccount()},loadModal:function(){"mobile"===this.deviceType&&this.getDOMElement("bottomSheetTrigger").click()},handleSendOTPRequest:function(){var a=this,b=a._validateFormField("zip_mobile_number"),e=
a.getDOMElement("zip_mobile_number").val();b=a._validateMobileNumberInput(e,b);e=a._AUCountryCodePrefix+e;0===b.length?(a._handleValidRequest("getVerificationCodeButton","a-button-disabled","errorMessagesInlineContainer-zip_mobile_number"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPaySendOTPEvent",zip_mobile_number:e,"ppw-widgetState":a.widget.options.serializedState},{complete:function(){a.getDOMElement("getVerificationCodeButton").removeClass("a-button-disabled")},success:g.bind(function(b){a._checkMobileNumberRegistrationStatus(b.additionalWidgetResponseData.additionalData)},
this),error:g.bind(function(){},this),queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dZIP_SIF_Profile")})):(c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),a._renderErrorMessages(a.form._getLocalizedErrorMessages(b)));return!1},handleResendOTPRequest:function(){var a=this,b=a._validateFormField("zip_mobile_number"),e=a.getDOMElement("zip_mobile_number").val();b=a._validateMobileNumberInput(e,b);0===b.length&&a._validateResendOtpFrequencyCheck();e=a._AUCountryCodePrefix+
e;0===b.length?(a._handleValidRequest(null,null,"errorMessagesInlineContainer-zip_mobile_number"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPayResendOTPEvent",zip_mobile_number:e,"ppw-authenticationSourceId":a._authenticationSourceId,"ppw-widgetState":a.widget.options.serializedState},{success:g.bind(function(b){b=b.additionalWidgetResponseData.additionalData;a._authenticationSourceStatus=b.authenticationSourceStatus;a._checkMobileNumberRegistrationStatus(b)},this),error:g.bind(function(){},
this),queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dZIP_SIF_Profile")})):(c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),a._renderErrorMessages(a.form._getLocalizedErrorMessages(b)));return!1},handleVerifyOTPRequest:function(){var a=this,b=a._validateFormField("zip_one_time_password"),e=a.getDOMElement("zip_one_time_password").val();b=a._validateOTPInput(e,b);0===b.length?(a._handleValidRequest("verifyButton","a-button-disabled","errorMessagesInlineContainer-zip_one_time_password"),
a.widget.trigger("submitFormAjaxStarted"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPayVerifyOTPEvent",zip_one_time_password:e,"ppw-authenticationSourceId":a._authenticationSourceId,"ppw-widgetState":a.widget.options.serializedState},{complete:function(){a.getDOMElement("verifyButton").removeClass("a-button-disabled");a.widget.trigger("submitFormAjaxCompleted")},success:g.bind(function(b){var e=b.additionalWidgetResponseData.additionalData;"APPROVED"===e.authenticationSourceStatus?(a.widget._onAJAXContinueSuccess(b),
a.closeAddZipPayPopover()):e.errors?(b=JSON.parse(e.errors),a.form.renderErrorMessages(b)):(b=[],b.push(a._failedInternalCallErrorMsg),a.form.renderErrorMessages(a.form._getLocalizedErrorMessages(b)))},this),error:g.bind(function(){},this),queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dZIP_SIF_Profile")})):(c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),a._renderErrorMessages(a.form._getLocalizedErrorMessages(b)));return!1},verificationCodeFormDisplay:function(a){c.toggleElement(this.getDOMElement("verificationCodeForm"),
a)},hideGetVerificationCodeButtonAndShowResendCodeRequest:function(){c.hideElement(this.getDOMElement("getVerificationCodeButton"));c.showElement(this.getDOMElement("resendCodeRequest"))},closeAddZipPayPopover:function(){k.when("a-modal").execute(function(a){a&&(a=a.get("addZipPayPopover"))&&a.hide()})},_bindPromptUserToAddOrCreateZipAccount:function(){var a=this;k.when("A","a-modal","ready").execute(function(b,e){if(a._isDesktop||a._isTablet)e=b.$(h.location).attr("hash"),"#ZipPromoteSignup"===e&&
1===b.$("#zip-application-create-zip-account-button").length?(a._isZipSignupPromotion=!0,f.logCounterMetric({feature:"ZipApplicationSignupPromotionClickCount",resource:"_Count"}),f.publishMetrics(),a._expandAddZipAccountSection(b),b.$("#zip-application-create-zip-account-button").trigger("click")):"#ZipPromoteLinking"===e&&1===b.$("#zip-application-mobile-number-text-input").length&&(f.logCounterMetric({feature:"ZipApplicationAccountLinkingPromotionClickCount",resource:"_Count"}),f.publishMetrics(),
a._expandAddZipAccountSection(b),b.$("#zip-application-mobile-number-text-input").focus())})},_expandAddZipAccountSection:function(a){a.$(".pmts-add-your-zip-account-expander .a-expander-prompt").trigger("click")},_bindCreateZipAccountTrigger:function(){var a=this;a._bindCrossDomainMessaging();k.when("A","a-modal").execute(function(b,e){b.on("a:popover:beforeShow:ZipApplicationModal",function(b){a._zipModalPopover=b.popover;a._zipApplicationModalVisible=!0;a._showZipApplicationSection("leavingAmazonSection");
a.lockZipApplicationModal();f.logCounterMetric({feature:"ZipApplicationCreateZipAccountClickCount",resource:"_Count"});f.publishMetrics()});b.on("a:popover:show:ZipApplicationModal",function(b){a._zipModalPopover.updatePosition();a._zipModalPopover.$popover.find(".a-popover-header").addClass("aok-hidden");a._zipModalPopover.$popover.find(".a-popover-inner").addClass("a-padding-none")});b.on("a:popover:hide:ZipApplicationModal",function(b){a._zipApplicationModalVisible=!1;a._zipIFrameApplicationLoaded=
!1});b.declarative("pmts-zp-application-continue-button","click",function(){a._showZipApplicationSection("zipApplicationLoader");a._generateRedirectURL()});b.declarative("pmts-zp-application-close-icon","click",function(){a.closeZipApplicationModal()});b.declarative("pmts-zp-application-try-again-button","click",function(){a._showZipApplicationSection("zipApplicationLoader");a._generateRedirectURL()});b.declarative("pmts-zp-application-choose-another-pm-button","click",function(){a._isMobile?a.closeZipApplicationSecondaryView():
a.closeZipApplicationModal()})});k.when("A","a-secondary-view","a-sheet").execute(function(b,e,c){b.on("a:popover:beforeShow:ZipApplicationSecondaryView",function(b){a._zipApplicationSecondaryViewVisible=!0;a._showZipApplicationSection("zipApplicationLoader");a._generateRedirectURL()});b.on("a:sheet:afterShow:zipApplicationBottomSheet",function(a){f.logCounterMetric({feature:"ZipApplicationCreateZipAccountButtonPressedCount",resource:"_Count"});f.publishMetrics()});b.on("a:popover:hide:ZipApplicationSecondaryView",
function(b){a._zipApplicationSecondaryViewVisible=!1;a._zipIFrameApplicationLoaded=!1;c&&c.get("zipApplicationBottomSheet")&&c.get("zipApplicationBottomSheet").hide()})})},_showZipApplicationSection:function(a){c.hideElement(this.getDOMElement("iFrameSection"));c.hideElement(this.getDOMElement("leavingAmazonSection"));c.hideElement(this.getDOMElement("zipApplicationLoader"));c.hideElement(this.getDOMElement("zipApplicationSomethingWentWrong"));c.hideElement(this.getDOMElement("zipApplicationUnableToProcess"));
c.showElement(this.getDOMElement(a))},_generateRedirectURL:function(){var a=this;a._zipAjaxCallInProgress||(a._zipAjaxCallInProgress=!0,a._toggleCreateZipAccountButton(!1),a._isAUIAvailable||a.widget.trigger("submitFormAjaxStarted"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPayGenerateRedirectURLEvent","ppw-widgetState":a.widget.options.serializedState},{complete:function(){a._isAUIAvailable||a.widget.trigger("submitFormAjaxCompleted");a._toggleCreateZipAccountButton(!0);a._zipAjaxCallInProgress=
!1},success:g.bind(function(b){b=b.additionalWidgetResponseData.additionalData;"PENDING"===b.authenticationSourceStatus?(a._zipApplicationURL=b.zipApplicationURL,a._authenticationSourceIdRedirect=b.authenticationSourceId,a._handleGenerateRedirectURLSuccess()):(a._authenticationSourceIdRedirectStatus=b.authenticationSourceStatus,a._handleGenerateRedirectURLFailure())},this),error:g.bind(function(){a._authenticationSourceIdRedirectStatus="ERROR";a._handleGenerateRedirectURLFailure()},this)}))},_toggleCreateZipAccountButton:function(a){a?
(this.getDOMElement("createZipAccountButton").removeClass("a-button-disabled"),this.getDOMElement("createZipAccountButtonWrapper").addClass("a-declarative"),this.getDOMElement("createZipAccountButton").attr("disabled",!1)):(this.getDOMElement("createZipAccountButton").addClass("a-button-disabled"),this.getDOMElement("createZipAccountButtonWrapper").removeClass("a-declarative"),this.getDOMElement("createZipAccountButton").attr("disabled",!0))},_handleGenerateRedirectURLSuccess:function(){if(this._zipApplicationModalVisible||
this._zipApplicationSecondaryViewVisible)this._isAmazonApp?this._openInEmbeddedBrowser():this._addIFrameSource()},_openInEmbeddedBrowser:function(){var a=this;k.when("mash").execute(function(b){b.showEmbeddedBrowser({targetURL:a._zipApplicationURL,successCallback:function(){a.lastWillReappear=h.app.willReappear;delete h.app.willReappear;h.app.willReappear=function(){h.app.willReappear=a.lastWillReappear;a._handleThirdPartyRedirectResponse()}}})})},_handleGenerateRedirectURLFailure:function(){this._showZipApplicationSection("zipApplicationSomethingWentWrong")},
closeZipApplicationModal:function(){var a=this;k.when("a-modal").execute(function(b){b?b.get("ZipApplicationModal").unlock(a._zipModalLockLevel).hide():a._zipModalPopover.$popover.find("button[data-action]\x3da-popover-close").trigger("click")})},lockZipApplicationModal:function(a){var b=this;k.when("a-modal").execute(function(a){a?a.get("ZipApplicationModal").lock(b._zipModalLockLevel):b._isAUIAvailable=!1})},closeZipApplicationSecondaryView:function(){k.when("a-secondary-view").execute(function(a){a&&
a.get("ZipApplicationSecondaryView").hide()})},_addIFrameSource:function(){var a=this,b=a.getDOMElement("zipApplicationIFrame");b.attr("src",a._zipApplicationURL);a.startTime=(new Date).getTime();b.load(function(){b.attr("src")!==a._zipApplicationURL||!a._zipApplicationSecondaryViewVisible&&!a._zipApplicationModalVisible||a._zipIFrameApplicationLoaded||(a._showZipApplicationSection("iFrameSection"),a._zipIFrameApplicationLoaded=!0,f.logLatencyMetric({feature:"ZipApplicationPageLoadTime",resource:"_Latency",
startTime:a.startTime}),f.publishMetrics(),a.startTime=(new Date).getTime())})},_bindCrossDomainMessaging:function(){var a=g.bind(this._processCrossDomainMessage,this);g.addEventListener(h,"message",a)},_processCrossDomainMessage:function(a){if(a&&a.origin&&a.data&&(this._zipApplicationSecondaryViewVisible||this._zipApplicationModalVisible)){this._isZipSignupPromotion&&this._emitZipSignupPromotionCSM(a.data.message_type);switch(a.data.message_type){case "user_journey_started":f.logCounterMetric({feature:"ZipApplicationJourneyStartedCount",
resource:"_Count"});break;case "user_journey_completed":f.logCounterMetric({feature:"ZipApplicationJourneyCompletedCount",resource:"_Count"});f.logLatencyMetric({feature:"ZipApplicationJourneyCompletedTime",resource:"_Latency",startTime:this.startTime});this._handleThirdPartyRedirectResponse();break;case "user_journey_expired":f.logCounterMetric({feature:"ZipApplicationJourneyExpiredCount",resource:"_Count"});this._handleFailureZipRegistration();break;default:f.logCounterMetric({feature:"ZipApplicationJourneyInvalidMessageCount",
resource:"_Count"})}f.publishMetrics()}},_emitZipSignupPromotionCSM:function(a){switch(a){case "user_journey_started":f.logCounterMetric({feature:"ZipApplicationPromotionJourneyStartedCount",resource:"_Count"});break;case "user_journey_completed":f.logCounterMetric({feature:"ZipApplicationPromotionJourneyCompletedCount",resource:"_Count"});break;case "user_journey_expired":f.logCounterMetric({feature:"ZipApplicationPromotionJourneyExpiredCount",resource:"_Count"});break;default:f.logCounterMetric({feature:"ZipApplicationPromotionJourneyInvalidMessageCount",
resource:"_Count"})}f.publishMetrics()},_handleThirdPartyRedirectResponse:function(){var a=this;a._showZipApplicationSection("zipApplicationLoader");a._zipIFrameApplicationLoaded=!1;a._isAUIAvailable||a.widget.trigger("submitFormAjaxStarted");a.widget.continueRequest({"ppw-widgetEvent":"ZipPayThirdPartyResponseEvent","ppw-authenticationSourceId":a._authenticationSourceIdRedirect,"ppw-widgetState":a.widget.options.serializedState},{complete:function(){a._isAUIAvailable||a.widget.trigger("submitFormAjaxCompleted")},
success:g.bind(function(b){"APPROVED"===b.additionalWidgetResponseData.additionalData.authenticationSourceStatus?a._handleSuccessfulZipRegistration(b):a._handleFailureZipRegistration()},this),error:g.bind(function(){a._handleFailureZipRegistration()},this)})},_handleFailureZipRegistration:function(){this._zipIFrameApplicationLoaded=!1;this._showZipApplicationSection("zipApplicationUnableToProcess")},_handleSuccessfulZipRegistration:function(a){this._isMobile?(this.widget._onAJAXContinueSuccess(a),
this.closeZipApplicationSecondaryView()):(this.widget._onAJAXContinueSuccess(a),this.closeZipApplicationModal())},_handleValidRequest:function(a,b,e){this.form.resetErrors();null!=a&&null!=b&&this.getDOMElement(a).addClass(b);c.hideElement(this.getDOMElement(e))},_validateFormField:function(a){return g.filter(this.form.validateForm(),function(b){return b.field===a})},_validateMobileNumberInput:function(a,b){0!==a.length?/^\d+$/.test(a)?(9>a.length||9===a.length&&"4"!==a.charAt(0)||10===a.length&&
"04"!==a.substring(0,2))&&b.push(this._invalidMobileNumberErrorMsg):b.push(this._invalidMobileNumberErrorMsg):b.push(this._emptyMobileNumberErrorMsg);return b},_validateOTPInput:function(a,b){0!==a.length?/^\d+$/.test(a)?6!==a.length&&b.push(this._invalidOTPErrorMsg):b.push(this._invalidOTPErrorMsg):b.push(this._emptyOTPErrorMsg);return b},_validateResendOtpFrequencyCheck:function(){var a=this;a._resendCodeClickCount++;3>a._resendCodeClickCount?(a.getDOMElement("resendCodeRequest").addClass("apx-zipPay-link-disabled"),
h.setTimeout(function(){a.getDOMElement("resendCodeRequest").removeClass("apx-zipPay-link-disabled")},3E4)):a.getDOMElement("resendCodeRequest").addClass("apx-zipPay-link-disabled")},_checkMobileNumberRegistrationStatus:function(a){this._authenticationSourceId=a.authenticationSourceId;this._authenticationSourceStatus=a.authenticationSourceStatus;"PENDING"===this._authenticationSourceStatus?(this.form.clearValidationErrors(),this.hideGetVerificationCodeButtonAndShowResendCodeRequest(),this.verificationCodeFormDisplay(!0),
c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),c.hideElement(this.getDOMElement("errorMessagesInlineContainer-verificationCode"))):a.errors?(a=JSON.parse(a.errors),this.form.renderErrorMessages(a)):(a=[],a.push(this._failedInternalCallErrorMsg),this.form.renderErrorMessages(a))},_renderErrorMessages:function(a){var b=this,c=[],f=[],d=[],h={};g.forEach(a,function(a){a.field&&(h[a.field]||(h[a.field]=[]),h[a.field].push(a),b.form.blameFormField(a.field,!0));a.validation&&a.fieldMetricValueType&&
a.fieldValue&&(c.push(a.validation),f.push(a.fieldMetricValueType),d.push(a.fieldValue))});if(b._isDesktop){var k=b.form._getFormAlertsContainer();k.domElement!==m&&l.getFormAlertsContainerHelper(k.messageDisplayType,k.domElement).render(a)}else{var n=b.form._getFormFieldAlertContainers();g.forEach(g.keys(n),function(a){l.getFormAlertsContainerHelper("inline",n[a]).render(h[a])})}}})});d("components/ZipPayDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(c,
d,h){return c.extend(d,{initialize:function(c,d){this._paymentMethodId=d.data.paymentMethodId;this._paymentMethodType=d.data.paymentMethodType;this._isDefault=d.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});d("components/ZipPayEditComponent",["component","EditComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,g){d._initializePopover(c,g,this)},bindToEvents:function(){d._bindPopoverCloseButtonClickedEvent(this)}})});d("components/ZipPayMetadataSlotComponent",
["component"],function(c){return c.extend({initialize:function(c,d){}})});d("components/ZipPaySleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(q){var f=window.AmazonUIPageJS||window.P,l=f._namespace||f.attributeErrors,k=l?l("APXWidgetsAssets@APXWidgets-BancomatPay","APXWidgetsAssets"):f;k.guardFatal?k.guardFatal(q)(k,window):k.execute(function(){q(k,window)})})(function(q,f,l){(function(){var k=PaymentsPortal2.modules.define;k("components/AddBancomatPayComponent","events/form-submitted-event jQuery form-component css-utils lang AUI!P clog".split(" "),function(n,c,m,h,d,g,p){return m.extend({_hasErrors:!1,_showSavedMobileNumber:!1,
_clientProfile:"YA:MPO",_deviceType:"desktop",_shouldOpenAddPaymentInstrumentView:!1,initialize:function(a,b){this._action=b.data.action;this._hasErrors=b.data.hasErrors;this._widgetState=b.data.widgetState;this._widgetComplete=!1;this._showSavedMobileNumber=b.data.showSavedMobileNumber;this._clientProfile=b.data.clientProfile;this._deviceType=b.data.deviceType;this.$toggleSwitch=this.getDOMElement("apxSetAsDefaultJsBinding");this._paymentMethodId=this._addBancomatPayData=l;this._shouldOpenAddPaymentInstrumentView=
b.data.shouldOpenAddPaymentInstrumentView;this._bankSelectorDelay=0;this._selectedBank=l;"mobile"===this._deviceType&&(this._bankSelectorDelay=20);this._allBanksList=this.getDOMElementsByPrefix("bancomatPayBankSelectorButton");this._noResultContent=this.getDOMElement("bancomatPayBankSelectorNoResult");this._bankSelectorSearchBar=this.getDOMElement("bancomatPayBankSelectorSearchBox");this._bankSelectorStartRow=this.getDOMElement("bancomatPayBankSelectorStartRow")},initPopoverState:function(){"true"===
String(this._hasErrors)&&(this.getDOMElement("addBancomatPayJSOpenPopOverButtonId").trigger("click"),this.getDOMElement("addBancomatPayCompactPopOverLink").trigger("click"));this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").length?(this.getDOMElement("addBancomatPayLinkNewNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length?this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",
!0):(h.hideElement(this.getDOMElement("addBancomatPayRedirectButton")),h.showElement(this.getDOMElement("addBancomatPaySubmitButton")))):this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length&&this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",!1);var a=f.location.hash,b=new URLSearchParams(f.location.search),e=b.get("successCodes");a.includes("successCodes\x3dSUCCESS_CHANGE_MOBILE_PHONE")?(this.publishMetrics("BancomatPayHighFrictionCX.RedirectBack.ToPSP"),this.triggerPopOver()):
null!==e&&"SUCCESS_CHANGE_MOBILE_PHONE"===e&&(this.publishMetrics("BancomatPayHighFrictionCX.RedirectBack.ToMPO"),this.triggerPopOver(),this._shouldOpenAddPaymentInstrumentView&&(b.delete("successCodes"),f.history.replaceState({},"",f.location.protocol+"//"+f.location.host+f.location.pathname+"?"+b.toString())))},triggerPopOver:function(){this.getDOMElement("addBancomatPayJSOpenPopOverButtonId").trigger("click");this.getDOMElement("addBancomatPayCompactPopOverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBancomatPayCancelButton").click(d.bind(this.closeAddBancomatPayDesktopPopover,
this));this.getDOMElement("addBancomatPayCancelButtonOnPAGE").click(d.bind(this.redirectBack,this));this.getDOMElement("addBancomatPayJsCompactCancelButtonId").click(d.bind(this.closeAddBancomatPayCompactPopover,this));c("#addBancomatPayLinkSavedNumberId").click(d.bind(this.handleSavedNumberRadioButtonClick,this));c("#addBancomatPayLinkNewNumberId").click(d.bind(this.handleNewNumberRadioButtonClick,this));this.getDOMElement("addBancomatPaySubmitButton").click(d.bind(this.handleFormSubmission,this));
this.getDOMElement("addBancomatPayRedirectButton").click(d.bind(this.handleRedirection,this));this.getDOMElement("setPreferenceBancomatPayJsButtonId").click(d.bind(this.handleContinueButton,this));this.getDOMElement("BancomatPayActivatedJsButton").click(d.bind(this.handleBancomatPayActivatedClick,this));this.getDOMElement("BancomatPayActivateLaterJsButton").click(d.bind(this.handleBancomatPayActivateLaterClick,this));this.getDOMElementsByPrefix("bancomatPayBankSelectorButton").click(d.bind(this.handleBankClick,
this));this.getDOMElement("bancomatPayBankSelectorSearchBox").keyup(d.bind(this.handleBankSelectorSearch,this));this.getDOMElement("bancomatPayBankSelectorAddOtherPMId").click(d.bind(this.addAnotherPaymentMethod,this));this.getDOMElement("bancomatPayBankSelectorActivateInstallButtonId").click(d.bind(this.publishInstallationMetrics,this))},bindToEvents:function(){var a=this;a.widget.on(n,a,function(b){if(b.action===a._action)b.event.preventDefault(),h.showElement(a.getDOMElement("addBancomatPayJsSpinnerId")),
this.pollPaymentMethodVerificationStatus(b);else if("setPreferenceBancomatPay"===b.action){b.event.preventDefault();var e=this._getToggleSwitchAuiElement();e&&e.isOn()?(a.publishMetrics("BancomatPay.SetAsDefault.FormSubmitted.ToggleOn"),h.showElement(a.getDOMElement("setPreferenceBancomatPayJsSpinnerId")),this.setPreferenceBancomatPay(b)):a._addBancomatPayData&&(a.publishMetrics("BancomatPay.SetAsDefault.FormSubmitted.ToggleOff"),a.switchPopoverWidth(),a.closeAllPopovers(),a.formActivityCompleteRefresh(a._addBancomatPayData),
a._addBancomatPayData=l)}});a.widget.on("componentsInitialized",a,function(b){a.initPopoverState()});g.when("A").execute(function(b){b.on("a:popover:dismiss:addBancomatPayPopOverDesktopName",function(b){a.form.resetErrors();a.resetBpayForm();a._addBancomatPayData&&(a.publishMetrics("BancomatPay.SetAsDefault.CustomerAbandonAfterRegistration"),a.switchPopoverWidth(),a.closeAllPopovers(),a.formActivityCompleteRefresh(a._addBancomatPayData),a._addBancomatPayData=l)})});g.when("A").execute(function(b){b.on("a:popover:dismiss:addBancomatPayCompactPopoverName",
function(b){a.form.resetErrors();a.resetBpayForm();a._addBancomatPayData&&(a.publishMetrics("BancomatPay.SetAsDefault.CustomerAbandonAfterRegistration"),a.switchPopoverWidth(),a.closeAllPopovers(),a.formActivityCompleteRefresh(a._addBancomatPayData),a._addBancomatPayData=l)})});a.getDOMElement("addBancomatPayJsPhoneNumberInputId").keypress(function(a){if(!(48<=a.which&&57>=a.which||8===a.which||46===a.which))return!1});a.getDOMElement("bancomatPayBankSelectorSearchBox").keypress(function(b){if(!(65<=
b.which&&90>=b.which||97<=b.which&&122>=b.which||8===b.which||46===b.which||127===b.which||32===b.which&&""!==a._bankSelectorSearchBar.val()))return!1});a.getDOMElement("addBancomatPayJsPhoneNumberInputId").bind("paste",function(a){a.preventDefault()});g.when("A").execute(function(b){b.on("a:popover:afterHide:bancomatPayBankSelectorPopOverDesktopName",function(){a.resetBankSelectorPopover()})});g.when("A").execute(function(b){b.on("a:popover:afterHide:bancomatPayBankSelectorPopOverMobileName",function(){a.resetBankSelectorPopover()})})},
getForm:function(a){return this.getDOMElement(a).find("form").andSelf().filter("form")},handleContinueButton:function(a){self=this;this.getDOMElement("setPreferenceBancomatPayPMHiddenFormJSBinding").val(self._paymentMethodId);var b=self.getFormSubmissionParameters("setPreferenceBancomatPayPopOverContainerId","setPreferenceBancomatPayJsButtonId"),e=self.getForm("setPreferenceBancomatPayPopOverContainerId");self.widget.trigger(n,{event:a,submissionParameters:b,formElement:e,action:"setPreferenceBancomatPay"})},
handleFormSubmission:function(a){self=this;if(self._showSavedMobileNumber&&c("#addBancomatPayLinkSavedNumberId").is(":checked"))this.publishMetrics("BancomatPay.PrimaryPhoneNumberSelectedForPMCreation"),this.getDOMElement("addBancomatPayHiddenField").val(c("#addBancomatPayLinkSavedNumberId").val());else{var b=c("select[name\x3dppw-bancomatPayCountryCode] option").filter(":selected").val(),e=self.getDOMElement("addBancomatPayJsPhoneNumberInputId").val();this.publishMetrics("BancomatPay.CustomerAddedPhoneNumberSelectedForPMCreation");
this.getDOMElement("addBancomatPayHiddenField").val(b+e)}b=this.getDOMElement("addBancomatPayHiddenField").val().slice(-4);this.getDOMElement("addBancomatPayTailHiddenField").html(" "+b+" ");b=self.form.validateForm();e=self.getFormSubmissionParameters("addBancomatPayPopOverContainer","addBancomatPaySubmitButton");var d=self.getForm("addBancomatPayPopOverContainer");0===b.length?self.widget.trigger(n,{event:a,submissionParameters:e,formElement:d,action:self._action}):a.preventDefault()},handleRedirection:function(a){a.preventDefault();
this._showSavedMobileNumber?this.publishMetrics("BancomatPayHighFrictionCX.Redirect.ChangeMobileNumber.Policy1"):this.publishMetrics("BancomatPayHighFrictionCX.Redirect.AddMobileNumber.Policy1");this.handleRedirectionToDevicesURLBuild()},handleRedirectionToDevicesURLBuild:function(){"mobile"===this._deviceType?this.handleRedirectUrlsBuilder("https://amazon.it/ap/profile/mobilephone?openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26orig_return_to\x3d"):
this.handleRedirectUrlsBuilder("https://amazon.it/ap/profile/mobilephone?openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26orig_return_to\x3d")},publishMetrics:function(a){p.logCounterMetric({feature:a,
resource:"_Count"});p.publishMetrics()},handleRedirectUrlsBuilder:function(a){var b=encodeURIComponent(f.location.href);f.location.href="AmazonRetail"===this._clientProfile?a+b+"%23":a+b},switchPopovertoSAD:function(a){var b=this;b.resetBpayForm();b.form.resetErrors();this.getDOMElement("addBancomatPayPopOverContainer").hide();var e=b.getDOMElement("setPreferenceBancomatPayPopOverContainerId");0<e.length?(g.when("a-modal").execute(function(a){if(a){var e=a.get("addBancomatPayPopOverDesktopName");
a=a.get("addBancomatPayCompactPopoverName");e&&e.isActive()?b.changeWidth(e,"350px"):a&&a.isActive()&&b.changeWidth(a,"350px")}}),e.show()):(b.closeAllPopovers(),b.formActivityCompleteRefresh(a))},switchPopoverWidth:function(){var a=this;a.resetBpayForm();a.form.resetErrors();g.when("a-modal").execute(function(b){if(b){var e=b.get("addBancomatPayPopOverDesktopName");b=b.get("addBancomatPayCompactPopoverName");e&&e.isActive()?a.changeWidth(e,"550px"):b&&b.isActive()&&a.changeWidth(b,"550px")}})},closeAllPopovers:function(){this.closeAddBancomatPayDesktopPopover();
this.closeAddBancomatPayCompactPopover();this.closeAddBancomatPayMobilePopover()},formActivityCompleteRefresh:function(a){this.widget.createAjaxContinueSuccessHandler(null)(a)},closeAddBancomatPayDesktopPopover:function(){var a=this;a.resetBpayForm();a.form.resetErrors();g.when("a-modal").execute(function(b){b&&a.hideBancomatPayPopOver(b.get("addBancomatPayPopOverDesktopName"))})},redirectBack:function(){var a=new URLSearchParams(f.location.search);this.publishMetrics("BancomatPay.Pcw.Page.CustomerAbandon");
a.has("redirectURL")?(a=decodeURIComponent(a.get("redirectURL")),f.location.href=a):f.location.href="https://www.amazon.it/gp/cart/view.html"},closeAddBancomatPayMobilePopover:function(){var a=this;a.resetBpayForm();a.form.resetErrors();g.when("a-secondary-view").execute(function(b){b&&a.hideBancomatPayPopOver(b.get("addBancomatPayPopOverMobileName"))})},closeAddBancomatPayCompactPopover:function(){var a=this;a.resetBpayForm();a.form.resetErrors();g.when("a-modal").execute(function(b){b&&a.hideBancomatPayPopOver(b.get("addBancomatPayCompactPopoverName"))})},
hideBancomatPayPopOver:function(a){a&&(a.unlock(20),a.hide())},changeWidth:function(a,b){a&&a.update({width:b}).lock(20).show()},resetBpayForm:function(){c("addBancomatPayJsPhoneNumberInputId").length&&c("addBancomatPayJsPhoneNumberInputId").val("");c("#addBancomatPayLinkSavedNumberId").prop("checked",!0).trigger("click")},lockPopover:function(){g.when("a-modal").execute(function(a){if(a){var b=a.get("addBancomatPayPopOverDesktopName");a=a.get("addBancomatPayCompactPopoverName");b?b.lock(20).show():
a&&a.lock(20).show()}});g.when("a-secondary-view").execute(function(a){a&&(a=a.get("addBancomatPayPopOverMobileName"))&&a.lock(20).show()})},handleSavedNumberRadioButtonClick:function(){c("#addBancomatPayLinkSavedNumberId").is(":checked")&&(this.getDOMElement("addBancomatPayLinkNewNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length?this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",
!0):(h.hideElement(this.getDOMElement("addBancomatPayRedirectButton")),h.showElement(this.getDOMElement("addBancomatPaySubmitButton"))))},handleNewNumberRadioButtonClick:function(){c("#addBancomatPayLinkNewNumberId").is(":checked")&&(this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayLinkNewNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length?this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",
!1):(h.showElement(this.getDOMElement("addBancomatPayRedirectButton")),h.hideElement(this.getDOMElement("addBancomatPaySubmitButton"))))},verificationSuccessHandler:function(a){h.hideElement(this.getDOMElement("addBancomatPayJsSpinnerId"))},setPreferenceHandler:function(a){h.hideElement(this.getDOMElement("setPreferenceBancomatPayJsSpinnerId"));this.switchPopoverWidth();this.closeAllPopovers();this._addBancomatPayData?(this.formActivityCompleteRefresh(this._addBancomatPayData),this._addBancomatPayData=
l):this.formActivityCompleteRefresh(a)},serializeObject:function(a){return d.reduce(a,function(a,e){a[e.name]=e.value;return a},{})},_getToggleSwitchAuiElement:function(){var a=this,b=null;g.now("a-switch","jQuery").execute(function(e,d){e!==l&&d!==l&&(b=e.getSwitch(a.$toggleSwitch))});return b},pollPaymentMethodVerificationStatus:function(a){var b=this,e=b.serializeObject(a.submissionParameters),c={};b.lockPopover();c.queryParameters=b.widget._whitelistedQueryParameters(a.formElement.get(0).action);
b._widgetState&&(e["ppw-widgetState"]=b._widgetState);b.widget.continueRequest(e,d.extend({},c,{success:function(e){var c=e.additionalWidgetResponseData.additionalData;b._widgetState=c.serializedState;c&&"true"===String(c.widgetComplete)?(f.setTimeout(d.bind(b.verificationSuccessHandler,b,e),2E3),"true"===c.enableSetAsDefaultPopover?(b.publishMetrics("BancomatPay.SetAsDefault.FormEnabled"),b._paymentMethodId=c.paymentInstrumentId,b._addBancomatPayData=e,b.switchPopovertoSAD(e)):(b.closeAllPopovers(),
f.setTimeout(d.bind(b.formActivityCompleteRefresh,b,e),2E3))):f.setTimeout(d.bind(b.pollPaymentMethodVerificationStatus,b,a),100)},error:function(a){h.hideElement(b.getDOMElement("addBancomatPayJsSpinnerId"))}}))},setPreferenceBancomatPay:function(a){var b=this;a=b.serializeObject(a.submissionParameters);b._widgetState&&(a["ppw-widgetState"]=b._widgetState);b.widget.continueRequest(a,d.extend({success:function(a){f.setTimeout(d.bind(b.setPreferenceHandler,b,a),1E3)},error:function(a){b.setPreferenceHandler(a)}}))},
handleBancomatPayActivatedClick:function(){this.publishMetrics("BancomatPay.BankSelector."+this._selectedBank+".Activated");this.closeBancomatPayActivatedPopover();f.setTimeout(d.bind(this.triggerPopOver,this),this._bankSelectorDelay)},handleBancomatPayActivateLaterClick:function(a){a.preventDefault();this.publishMetrics("BancomatPay.BankSelector."+this._selectedBank+".ActivateLater");this.closeBancomatPayActivatedPopover()},closeBancomatPayActivatedPopover:function(){this.closePopover("BancomatPayActivatedPopOverDesktopName",
"BancomatPayActivatedPopOverMobileName")},handleBankSelectorSearch:function(){var a=this,b=0,e,c=a._bankSelectorSearchBar.val();c&&(c=a.sanitizeString(c));d.forEach(a._allBanksList,function(d){d.classList.add("aok-offscreen");e=a.sanitizeString(d.innerText);e.includes(c)&&(d.classList.remove("aok-offscreen"),b++)});0===b?a._noResultContent.get(0).classList.remove("aok-offscreen"):a._noResultContent.get(0).classList.contains("aok-offscreen")||a._noResultContent.get(0).classList.add("aok-offscreen")},
handleBankClick:function(a){var b=c(a.currentTarget);a=b&&b.get(0)&&b.get(0).innerText?b.get(0).innerText:"";a=this.sanitizeString(a);var e=b&&b.data("bancomatpay-bank-selector-supported-app")?b.data("bancomatpay-bank-selector-supported-app"):"";e=this.sanitizeString(e);b=b&&b.data("bancomatpay-bank-selector-bank-type")?b.data("bancomatpay-bank-selector-bank-type"):"";this.closeBankSelectorPopover();"otherapp"===e?f.setTimeout(d.bind(this.triggerPopOver,this),this._bankSelectorDelay):f.setTimeout(d.bind(this.triggerBancomatPayActivatePopOver,
this),this._bankSelectorDelay);this._selectedBank="TopBank"===b?this.convertStringToTitleCase(a):"OtherBank";this.publishMetrics("BancomatPay.BankSelector."+this._selectedBank+".Total")},sanitizeString:function(a){return a.toLowerCase().replace(/[^a-zA-Z0-9]/g,"")},convertStringToTitleCase:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},closePopover:function(a,b){var e=this;g.when("a-modal").execute(function(b){b&&e.hideBancomatPayPopOver(b.get(a))});g.when("a-secondary-view").execute(function(a){a&&
e.hideBancomatPayPopOver(a.get(b))})},closeBankSelectorPopover:function(){this.closePopover("bancomatPayBankSelectorPopOverDesktopName","bancomatPayBankSelectorPopOverMobileName")},resetBankSelectorPopover:function(){this._bankSelectorSearchBar.val("");this._noResultContent.get(0).classList.add("aok-offscreen");d.forEach(this._allBanksList,function(a){a.classList.remove("aok-offscreen")});c(this._bankSelectorStartRow).focus()},triggerBancomatPayActivatePopOver:function(){this.getDOMElement("bancomatPayBankSelectorActivateButtonId").trigger("click");
this.getDOMElement("bancomatPayBankSelectorActivateLinkId").trigger("click")},addAnotherPaymentMethod:function(a){a.preventDefault();this.publishMetrics("BancomatPay.BankSelector..AddAnotherPM");this.closeBankSelectorPopover()},publishInstallationMetrics:function(){this.publishMetrics("BancomatPay.BankSelector."+this._selectedBank+".Install")}})});k("components/AddBancomatPayInputFormComponent","events/form-submitted-event jQuery form-component css-utils lang events/CloseBancomatPayPopoverEvent clog".split(" "),
function(n,c,m,h,d,g,p){return m.extend({initialize:function(a,b){this.bancomatPayInputFormTextBox=this.getDOMElement("addBancomatPayInputFormJsPhoneNumberInputId")},bindToElements:function(){var a=this;c("#addBancomatPayInputFormLinkSavedNumberId").click(d.bind(this.handleSavedNumberRadioButtonClick,this));c("#addBancomatPayInputFormLinkNewNumberId").click(d.bind(this.handleNewNumberRadioButtonClick,this));this.getDOMElement("addBancomatPayInputFormJsSubmitButtonId").click(d.bind(this.handleFormSubmission,
this));this.getDOMElement("addBancomatPayInputFormJsCancelButtonId").click(d.bind(function(){a.widget.trigger(g)},this))},initInputFormState:function(){this.getDOMElement("addBancomatPayInputFormLinkSavedNumberIdBox").length?(this.getDOMElement("addBancomatPayInputFormLinkNewNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayInputFormLinkSavedNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayInputFormJsPhoneNumberInputId").prop("disabled",
!0)):this.getDOMElement("addBancomatPayInputFormJsPhoneNumberInputId").prop("disabled",!1)},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(b){a.initInputFormState()});a.widget.on(n,a,function(b){"inputFormSubmission"===b.action&&(a.widget.trigger("submitFormAjaxStarted"),b.event.preventDefault(),this.pollPaymentMethodVerificationStatus(b))});a.widget.on(g,a,function(){a.resetBpayForm();a.form.resetErrors()});a.bancomatPayInputFormTextBox.keypress(function(a){if(!(48<=
a.which&&57>=a.which||8===a.which||13===a.which))return!1});a.bancomatPayInputFormTextBox.bind("paste",function(b){b.preventDefault();var e=a.bancomatPayInputFormTextBox.val();b=b.clipboardData?b.clipboardData.getData("text/plain"):b.originalEvent.clipboardData.getData("text/plain");e+=b;/^[0-9]*$/.test(e)&&a.bancomatPayInputFormTextBox.val(e)})},handleSavedNumberRadioButtonClick:function(){c("#addBancomatPayInputFormLinkSavedNumberId").is(":checked")&&(this.getDOMElement("addBancomatPayInputFormLinkNewNumberIdBox").css({"background-color":"#F0F2F2"}),
this.getDOMElement("addBancomatPayInputFormLinkSavedNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayInputFormJsPhoneNumberInputId").prop("disabled",!0))},resetBpayForm:function(){c("addBancomatPayInputFormJsPhoneNumberInputId").length&&c("addBancomatPayInputFormJsPhoneNumberInputId").val("");c("#addBancomatPayInputFormLinkSavedNumberId").prop("checked",!0).trigger("click")},handleNewNumberRadioButtonClick:function(){c("#addBancomatPayInputFormLinkNewNumberId").is(":checked")&&
(this.getDOMElement("addBancomatPayInputFormLinkSavedNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayInputFormLinkNewNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayInputFormJsPhoneNumberInputId").prop("disabled",!1))},handleFormSubmission:function(a){self=this;if(c("#addBancomatPayInputFormLinkSavedNumberId").is(":checked"))this.publishMetrics("BancomatPay.PrimaryPhoneNumberSelectedForPMCreation"),this.getDOMElement("addBancomatPayInputFormHiddenFormFieldJSBinding").val(c("#addBancomatPayInputFormLinkSavedNumberId").val()),
this.getDOMElement("addBancomatPayIsPrimaryNumberChosenJSBinding").val((!0).toString());else{var b=c("select[name\x3dppw-bancomatPayCountryCode] option").filter(":selected").val(),e=self.getDOMElement("addBancomatPayInputFormJsPhoneNumberInputId").val();this.publishMetrics("BancomatPay.CustomerAddedPhoneNumberSelectedForPMCreation");this.getDOMElement("addBancomatPayInputFormHiddenFormFieldJSBinding").val(b+e);this.getDOMElement("addBancomatPayIsPrimaryNumberChosenJSBinding").val((!1).toString())}b=
this.getDOMElement("addBancomatPayInputFormHiddenFormFieldJSBinding").val().slice(-4);this.getDOMElement("addBancomatPayMobileNoTailFieldJSBinding").val(b);b=self.form.validateForm();e=self.getFormSubmissionParameters("addBancomatPayInputFormJsPopOverContainerId","addBancomatPayInputFormJsSubmitButtonId");var d=self.getForm("addBancomatPayInputFormJsPopOverContainerId");0===b.length?self.widget.trigger(n,{event:a,submissionParameters:e,formElement:d,action:"inputFormSubmission"}):a.preventDefault()},
getForm:function(a){return this.getDOMElement(a).find("form").andSelf().filter("form")},pollPaymentMethodVerificationStatus:function(a){var b=this,e=b.serializeObject(a.submissionParameters),c={};c.queryParameters=b.widget._whitelistedQueryParameters(a.formElement.get(0).action);b._widgetState&&(e["ppw-widgetState"]=b._widgetState);b.widget.continueRequest(e,d.extend({},c,{success:function(e){var c=e.additionalWidgetResponseData.additionalData;b._widgetState=c.serializedState;c&&"true"===String(c.addBancomatPayVerificationComplete)?
b.formActivityCompleteRefresh(e):f.setTimeout(d.bind(b.pollPaymentMethodVerificationStatus,b,a),100)},error:function(a){}}))},formActivityCompleteRefresh:function(a){this.widget.trigger("submitFormAjaxCompleted");this.widget.createAjaxContinueSuccessHandler(null)(a)},publishMetrics:function(a){p.logCounterMetric({feature:a,resource:"_Count"});p.publishMetrics()},serializeObject:function(a){return d.reduce(a,function(a,e){a[e.name]=e.value;return a},{})}})});k("components/AddBancomatPaySetPreferenceComponent",
["events/form-submitted-event","jQuery","form-component","css-utils","lang"],function(f,c,m,h,d){return m.extend({bindToElements:function(){this.getDOMElement("bancomatPaySetPreferenceButtonJsBinding").click(d.bind(this.handleContinueButton,this))},bindToEvents:function(){var c=this;c.widget.on(f,c,function(d){"setPreferenceBancomatPay"===d.action&&c.getDOMElement("bancomatPaySetPreferenceFormJsBinding").submit()})},handleContinueButton:function(c){var d=this.getFormSubmissionParameters("bancomatPaySetPreferenceContainerJsBinding");
this.widget.trigger(f,{event:c,submissionParameters:d,action:"setPreferenceBancomatPay"})}})});k("events/CloseBancomatPayPopoverEvent",["public-event-registry"],function(f){f.register("CloseBancomatPayPopoverEvent");return"CloseBancomatPayPopoverEvent"});k("components/AddBancomatPayWorkflowComponent",["component","AUI!P","events/CloseBancomatPayPopoverEvent"],function(f,c,m){var h=[{name:"a-modal",jsBinding:"addBancomatPayWorkflowPopOverDesktopName"},{name:"a-secondary-view",jsBinding:"addBancomatPayWorkflowPopOverMobileName"},
{name:"a-modal",jsBinding:"addBancomatPayWorkflowCompactPopoverName"}];return f.extend({initialize:function(c,g){this._closePopover=g.data.addBpayWorkflowComplete},bindToEvents:function(){var d=this;d.widget.on("componentsInitialized",d,function(){d.checkWorkflowCompletion();h.forEach(function(c){d.refreshPopover(c.name,c.jsBinding)})});d.widget.on(m,d,function(){h.forEach(function(c){d.closePopover(c.name,c.jsBinding)})});c.when("A").execute(function(c){c.on("a:popover:dismiss:addBancomatPayWorkflowPopOverDesktopName",
function(c){d.widget.trigger(m)})});c.when("A").execute(function(c){c.on("a:popover:dismiss:addBancomatPayWorkflowCompactPopoverName",function(c){d.widget.trigger(m)})})},refreshPopover:function(d,f){c.when(d).execute(function(c){c&&(c=c.get(f))&&c.refresh()})},closePopover:function(d,f){c.when(d).execute(function(c){c&&(c=c.get(f))&&c.hide()})},checkWorkflowCompletion:function(){this._closePopover&&this.widget.trigger(m)}})});k("components/BancomatPayDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],
function(f,c){return f.extend(c,{initialize:function(c,f){this._paymentMethodId=f.data.paymentMethodId;this._paymentMethodType=f.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});k("components/BancomatPayEditComponent",["component","EditComponentSupport"],function(f,c){return f.extend(c,{initialize:function(f,h){c._initializePopover(f,h,this)},bindToEvents:function(){c._bindPopoverCloseButtonClickedEvent(this)}})});k("components/SelectableBancomatPayListComponent",["form-component"],
function(f){return f});k("components/SelectableBancomatPayListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(f,c){return f.extend({bindToEvents:function(){var f=this;if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(c,{instrumentId:this._instrumentId})});f.widget.on(c,f,function(c){f._instrumentRowSelected(c.instrumentId)})}})});k("components/BancomatPaySleeveItemSlotComponent",["component",
"PaymentMethodSleeveItemSlotComponentSupport"],function(f,c){return f.extend(c,{initialize:function(c,f){this._instrumentId=f.data.instrumentId}})})})()});
/* ******** */
(function(f){var g=window.AmazonUIPageJS||window.P,e=g._namespace||g.attributeErrors,c=e?e("APXWidgetsAssets@APXWidgets-ShopWithPoints","APXWidgetsAssets"):g;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,g,e){(function(){var c=PaymentsPortal2.modules.define;c("components/EligibleRewardsAccountComponent",["component","AUI!P","css-utils","jQuery"],function(c,k,b,g){var f=!1,h;return c.extend({toggleSpinner:function(a){b.toggleElement(this.getDOMElement("EligibleRewardsAccountSpinner"),
a)},showRegistrationPopover:function(){function a(a){a&&(a=a.get(b.data.popoverName))&&a.show()}var b=this;k.when("a-modal").execute(function(d){a(d)});k.when("a-secondary-view").execute(function(d){a(d)})},closeRegistrationPopover:function(){function a(a){b.isUsingOldAUI(b)&&h?h.$popover.find("button[data-action]\x3da-popover-close").trigger("click"):a&&(a=a.get(b.data.popoverName))&&a.hide()}var b=this;k.when("a-modal").execute(function(d){a(d)});k.when("a-secondary-view").execute(function(d){a(d)})},
showRegistrationFailureView:function(a){"mobile"===this.widget.options.deviceType&&this.getDOMElement("RegistrationHeader").addClass("a-color-tertiary");b.showElement(this.getDOMElement("RegistrationFailureContinue"));b.showElement(this.getDOMElement(a));b.showElement(this.getDOMElement("RegisterRewardsAccountFailureSection"));b.hideElement(this.getDOMElement("RewardsAccountRegistrationForm"))},resetRegistrationFormView:function(){"mobile"===this.widget.options.deviceType&&this.getDOMElement("RegistrationHeader").removeClass("a-color-tertiary");
b.hideElement(this.getDOMElement("RegistrationFailureContinue"));b.hideElement(this.getDOMElement("RegistrationErrorMessages").children());b.hideElement(this.getDOMElement("RegisterRewardsAccountFailureSection"));b.showElement(this.getDOMElement("RewardsAccountRegistrationForm"))},showValidationErrorMessage:function(a){b.showElement(this.getDOMElement(a));b.hideElement(this.getDOMElement("EligibleRewardsAccountSpinner"))},isRegistrationPostDataValid:function(a){return a["ppw-maybePostalCode"]===e||
(b.hideElement(this.getDOMElement(this.data.rewardsPostalCodeValidationErrorJsBindingKey)),this.isValidPostalCode(a["ppw-maybePostalCode"]))?a["ppw-maybeDobMonth"]===e||(b.hideElement(this.getDOMElement(this.data.rewardsMonthValidationErrorJsBindingKey)),this.isValidRange(a["ppw-maybeDobMonth"],1,12))?a["ppw-maybeDobDay"]!==e&&(b.hideElement(this.getDOMElement(this.data.rewardsDayValidationErrorJsBindingKey)),!this.isValidRange(a["ppw-maybeDobDay"],1,31))||a["ppw-maybeDobDay"]!==e&&a["ppw-maybeDobMonth"]!==
e&&(b.hideElement(this.getDOMElement(this.data.rewardsDayValidationErrorJsBindingKey)),!this.isValidMonthDayCombination(a["ppw-maybeDobMonth"],a["ppw-maybeDobDay"]))?(this.showValidationErrorMessage(this.data.rewardsDayValidationErrorJsBindingKey),!1):!0:(this.showValidationErrorMessage(this.data.rewardsMonthValidationErrorJsBindingKey),!1):(this.showValidationErrorMessage(this.data.rewardsPostalCodeValidationErrorJsBindingKey),!1)},isValidRange:function(a,b,d){return!!a&&!isNaN(a)&&a>=b&&a<=d},isValidMonthDayCombination:function(a,
b){var d=[31,29,31,30,31,30,31,31,30,31,30,31];return 0<b&&b<=d[a-1]},isValidPostalCode:function(a){return/^[a-zA-Z0-9 -]{3,20}$/.test(a)},populatePostData:function(){var a={"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"RewardsAccountRegisterEvent","ppw-piid":this.data.parentInstrumentId,"ppw-isApplyByDefault":this.getDOMElement("RewardsAccountApplyByDefaultCheckbox").find("input").prop("checked")};1===this.getDOMElement("RewardsAccountPostalCodeField").length&&(a["ppw-maybePostalCode"]=
this.getDOMElement("RewardsAccountPostalCodeField").val());1===this.getDOMElement("RewardsAccountDOBMonth").length&&(this.isUsingOldAUI(this)?a["ppw-maybeDobMonth"]=this.getDOMElement("RewardsAccountDOBMonth").val():a["ppw-maybeDobMonth"]=this.getDOMElement("RewardsAccountDOBMonth").find("option:selected").text());1===this.getDOMElement("RewardsAccountDOBDay").length&&(this.isUsingOldAUI(this)?a["ppw-maybeDobDay"]=this.getDOMElement("RewardsAccountDOBDay").val():a["ppw-maybeDobDay"]=this.getDOMElement("RewardsAccountDOBDay").find("option:selected").text());
return a},handleRegistrationFailure:function(a){switch(a.registrationStatus){case "INVALID_CREDENTIALS":if(a.maybeValidationFailureFieldName)if("BILLING_POSTAL_CODE"===a.maybeValidationFailureFieldName){this.showRegistrationFailureView("rewards_BadZip");break}else if("DATE_OF_BIRTH"===a.maybeValidationFailureFieldName){this.showRegistrationFailureView("rewards_BadDateOfBirth");break}this.showRegistrationFailureView("rewards_InvalidCredentials");break;case "NOT_ELIGIBLE":this.showRegistrationFailureView("rewards_CardNotEligible");
break;case "NOT_AUTHORIZED":this.showRegistrationFailureView("rewards_UnauthorizedRedeemer");break;case "LOCKED_OUT":this.showRegistrationFailureView("rewards_CardLocked");break;case "ACCOUNT_CLOSED":this.showRegistrationFailureView("rewards_AccountClosed");break;case "EXTERNAL_ACTION_REQUIRED":this.showRegistrationFailureView("rewards_ExternalActionRequired");break;default:this.showRegistrationFailureView("rewards_SystemUnavailable")}},isUsingOldAUI:function(a){return"desktop"===a.widget.options.deviceType&&
("Checkout"===a.widget.options.clientId||"ABCheckout"===a.widget.options.clientId||"ABCheckoutSharedPay"===a.widget.options.clientId)&&!a.data.isCompact},bindToElements:function(){var a=this;a.getDOMElement("DismissPopover").click(function(){a.closeRegistrationPopover()});a.getDOMElement("RegistrationFailureContinue").click(function(){a.closeRegistrationPopover()});a.getDOMElement("RewardsAccountRegistrationCall").click(function(c){b.showElement(a.getDOMElement("EligibleRewardsAccountSpinner"));c=
a.populatePostData();if(!a.isRegistrationPostDataValid(c))return!1;a.widget.continueRequest(c,{complete:function(){b.hideElement(a.getDOMElement("EligibleRewardsAccountSpinner"))},success:function(b){b=b.additionalWidgetResponseData.additionalData;b.registrationOutput?(b=JSON.parse(b.registrationOutput),"REGISTERED"===b.registrationStatus?(f=!0,a.closeRegistrationPopover()):a.handleRegistrationFailure(b)):b.validationError?a.showValidationErrorMessage(b.validationError):a.showRegistrationFailureView("rewards_SystemUnavailable")},
error:function(){a.showRegistrationFailureView("rewards_SystemUnavailable")}})})},bindToEvents:function(){var a=this;a.widget.on("addressChallengePassed",a,function(c){c.instrumentId===a.data.parentInstrumentId&&b.showElement(a.getDOMElement("MobileEligibleRewardsAccountSection"))});k.when("A").execute(function(c){c.on("a:popover:hide:"+a.data.popoverName,function(b){f&&(a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent"}),f=!1)});c.on("a:popover:show:"+
a.data.popoverName,function(c){a.resetRegistrationFormView();a.isUsingOldAUI(a)&&(h=c.popover,c=h.$popover.find(".a-popover-inner"),a.getDOMElement("CheckoutDesktopPopoverContent").parent("div.a-popover-inner").length||c.html(""),g("#"+h.name).appendTo(c),b.showElement(g("#"+h.name)),h.updatePosition())})})}})})})()});
/* ******** */
(function(t){var u=window.AmazonUIPageJS||window.P,x=u._namespace||u.attributeErrors,m=x?x("APXWidgetsAssets@APXWidgets-PayWithBankAccount","APXWidgetsAssets"):u;m.guardFatal?m.guardFatal(t)(m,window):m.execute(function(){t(m,window)})})(function(t,u,x){(function(){var m=PaymentsPortal2.modules.define;m("components/PayWithBankAccountComponent","events/InstrumentRowSelectedEvent components/SimplePaymentOptionListItemComponent lang jQuery css-utils AUI!P ExecutionsWidgetUtils upi-redirection-util events/spinner-events clog events/SelectablePaymentOptionEvents sdkUtil upiEvents AwaitingEventStatusConstants events/InstrumentPreparedEvent events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent upiEnums p2mIntentUtil eagerInitUtil commonUtil".split(" "),
function(m,u,g,d,c,t,F,z,A,e,v,N,p,n,G,H,I,J,h,K,L,M){var B,C,q,r,D=!1,E=!1,y,l;return u.extend({instrumentId:"",isDeviceSignatureValid:null,isUpiSavedHandleUsable:null,isPermanentDisabled:null,isUpiRegistrationEnabled:null,sdkCallStatus:null,instrumentPreparationStatus:null,isAwaitingInstrumentPrepare:null,continueClickTime:null,failureReason:null,errorMessage:null,isAIPSRedirectRequired:null,upiSavedHandleSelectedIndex:-1,upiP2MIntentSelectedAppName:"",upiP2MIntentSelectedAppPackageName:"",isUpiSavedHandleOriginallySelectable:null,
noOfSavedHandles:0,isPWBASelected:!1,_selectedPaymentMethod:"",isUpiIssuanceAPBMultiTenderEnabled:null,isAPBSelected:!1,isApxReloadEnabled:!1,isUpiSavedHandleAPBMultiTenderEligible:null,isUpiAIPSRedirectionWithMTEnabled:!1,enableUPIAPBMultiTender:!0,$topBankAvailable:0,$allBankAvailable:0,$topBankList:"",$allBankList:"",$topBanksHeader:"",$allBanksHeader:"",$noBankFound:"",bottomSheetOpenTime:null,isUpiP2MIntentEnabled:!1,isStaticP2MIntentEnabled:!1,eagerInitNpciClWeblabTreatment:"",upiIntentApplicationMap:"",
isUpiAcceptanceComponentDisplayable:!1,isNomenclatureWave2Enabled:!1,isUpiIntentOptionPmSegregated:!1,upiP2MIntentInstrumentRowSelectionValuesMap:{},enableCallbackRedirectionBehavior:!1,returnUrlPostParams:"",enableGetReturnHttpMethod:!1,initialize:function(a,b){this.isNomenclatureWave2Enabled=b.data.isNomenclatureWave2Enabled;this.instrumentId=b.data.instrumentId;this.paymentMethod=b.data.paymentMethod;this.savedHandleInstrumentType=b.data.savedHandleInstrumentType;this.isUpiSavedHandlePresent=b.data.isUpiSavedHandlePresent;
this.$form=d(".pmts-select-payment-instrument-form");this.netBankingInstrumentRowSelectionValue=b.data.netBankingInstrumentRowSelectionValue;this.upiOtherPMInstrumentRowSelectionValue=b.data.upiOtherPMInstrumentRowSelectionValue;this.upiP2MIntentInstrumentRowSelectionValue=b.data.upiP2MIntentInstrumentRowSelectionValue;this.upiSavedHandleInstrumentRowSelectionValue=b.data.upiSavedHandleInstrumentRowSelectionValue;this.upiRegistrationAction=b.data.upiRegistrationAction;this.upiAcceptanceAction=b.data.upiAcceptanceAction;
this.upiRegistrationRedirectUrl=b.data.upiRegistrationRedirectUrl;this.upiRegistrationReturnUrl=b.data.upiRegistrationReturnUrl;this.upiRegistrationFailureReturnUrl=b.data.upiRegistrationFailureReturnUrl;this.areReturnUrlsSentByClient=b.data.areReturnUrlsSentByClient;this.clientId=b.data.clientId;this.httpMethod=b.data.httpMethod;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.isSavedHandleUsable=b.data.isSavedHandleUsable;
this.savedHandlesData=b.data.savedHandlesData;this.isUpiRegistrationEnabled=b.data.isUpiRegistrationEnabled;this.isSavedHandleOriginallySelectable=b.data.isSavedHandleOriginallySelectable;this.handleSavedHandleContinueError=b.data.handleSavedHandleContinueError;this.noOfSavedHandles=Object.keys(this.savedHandlesData).length;this.failureReason=Array(this.noOfSavedHandles).fill(null);this.sdkCallStatus=Array(this.noOfSavedHandles).fill(h.SdkCallStatusEnum.Pending);this.instrumentPreparationStatus=Array(this.noOfSavedHandles).fill(n.Pending);
this.errorMessage=Array(this.noOfSavedHandles).fill([this._buildErrorMessage()]);this.isAIPSRedirectRequired=Array(this.noOfSavedHandles).fill(!1);this.isDeviceSignatureValid=Array(this.noOfSavedHandles).fill(!1);this.isUpiSavedHandleUsable=Array(this.noOfSavedHandles).fill(!1);this.isPermanentDisabled=Array(this.noOfSavedHandles).fill(!0);this.isAwaitingInstrumentPrepare=Array(this.noOfSavedHandles).fill(!1);this.isUpiIssuanceAPBMultiTenderEnabled=b.data.isUpiIssuanceAPBMultiTenderEnabled;this.isUpiSavedHandleAPBMultiTenderEligible=
Array(this.noOfSavedHandles).fill(!1);this.isApxReloadEnabled=b.data.isApxReloadEnabled;this.purchaseId=b.data.purchaseId;this.enableUPIAPBMultiTender=b.data.enableUPIAPBMultiTender;this.isPurchaseIdRequired=b.data.isPurchaseIdRequired;this.isUpiP2MIntentEnabled=b.data.isUpiP2MIntentEnabled;this.isStaticP2MIntentEnabled=b.data.isStaticP2MIntentEnabled;this.enableGetReturnHttpMethod=b.data.enableGetReturnHttpMethod;this.eagerInitNpciClWeblabTreatment=b.data.eagerInitNpciClWeblabTreatment;this.upiIntentApplicationMap=
b.data.upiIntentApplicationMap;this.isUpiAcceptanceComponentDisplayable=b.data.isUpiAcceptanceComponentDisplayable;C=b.data.JsBindingRecurringInlineTextSectionUpi3P;E=b.data.isRecurringInlineMessageDisplayableUpi3P;B=b.data.JsBindingRecurringInlineTextSectionUpi1P;D=b.data.isRecurringInlineMessageDisplayableUpi1P;this.isUpiAIPSRedirectionWithMTEnabled=b.data.isUpiAIPSRedirectionWithMTEnabled;this.isUpiIntentOptionPmSegregated=b.data.isUpiIntentOptionPmSegregated;this.upiP2MIntentInstrumentRowSelectionValuesMap=
b.data.upiP2MIntentInstrumentRowSelectionValuesMap;this.enableCallbackRedirectionBehavior=b.data.enableCallbackRedirectionBehavior;this.returnUrlPostParams=b.data.returnUrlPostParams;y=this.upiIntentApplicationMap;if(this.isSavedHandleOriginallySelectable&&this.isSavedHandleUsable){this.isPermanentDisabled.fill(!1);this.isUpiSavedHandleAPBMultiTenderEligible.fill(this.isUpiIssuanceAPBMultiTenderEnabled);for(var c in g.keys(this.savedHandlesData))this.isUpiSavedHandleUsable[c]=this.savedHandlesData[c][2],
this.isUpiSavedHandleUsable[c]||this.setUPISavedHandleDisabled(!0,c)}else this.setUPISavedHandleDisabled(!0);this._selectedPaymentMethod="EMPTY_SELECTION";l=this.isNomenclatureWave2Enabled?d(".apx-pay-with-bank-bottom-sheet-selected-element-display-nomenclature"):d(".apx-pay-with-bank-bottom-sheet-selected-element-display")},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a.isUpiP2MIntentEnabled&&a.isStaticP2MIntentEnabled?a._displayStaticUPIIntentApps():t.when("mash").execute(function(b){var c=
M.getDevicePlatform();a.isUpiP2MIntentEnabled&&(b={intentFilterUri:"upi://pay",intentAppsList:Array.from(g.keys(y))},e.logCounterMetric({feature:"PWBA_GetIntentEligibleAppCallInitiated_"+c,resource:"_Count"}),K.getIntentEligibleApps(b,function(b){"SUCCESS"===b.status&&"SUCCESS"===b.responseCode?(e.logCounterMetric({feature:"PWBA_GetIntentEligibleAppsSuccess_"+c,resource:"_SuccessCount"}),a._displayUPIIntentApps(b)):(e.logCounterMetric({feature:"PWBA_GetIntentEligibleAppsFailure_"+c,resource:"_ErrorCount"}),
e.logCounterMetric({feature:"PWBA_GetIntentEligibleAppsFailure_"+b.responseCode+"_"+c,resource:"_ErrorCount"}),a._checkAndDisplayNoP2MIntentAppsAvailable())}),e.publishMetrics())})});a.widget.on(m,a,function(b){b.instrumentId===this.instrumentId?((this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&a._resetOrderTotalComputation(),a.isPWBASelected=!0,a._deselectInstrumentRowSelectionRadioButtons()):(a._getContainerElement().find("input[type\x3dradio]")&&a._getContainerElement().find("input[type\x3dradio]")[0]&&
(a._getContainerElement().find("input[type\x3dradio]")[0].checked=!1,this.isNomenclatureWave2Enabled&&a._getContainerElement().removeClass("pmts-selected")),this._toggleSelectedOption(!1),c.showElement(d(".apx-get-started-with-upi-message")),a.upiSavedHandleSelectedIndex=-1,a.isPWBASelected=!1,this._clearPwbaSavedHandleRadioButtons(),this._clearPwbaP2MIntentRadioButtons(),a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName),a._toggleUpiP2MIntentSubMessage(!0),a.isUpiP2MIntentEnabled?c.showElement(d(".apx-pwba-gif-css")):
c.showElement(d(".apx-pwba-upi-acceptance-logo-css")),a._selectedPaymentMethod="EMPTY_SELECTION",c.hideElement(q),c.hideElement(r))});a.widget.on("submitFormAjaxStarted",a,function(b){a.isPWBASelected&&(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-content").addClass("apx-pwba-bottom-sheet-disabled"),c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-spinner")))});a.widget.on("submitFormAjaxCompleted",a,function(a){this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-content").removeClass("apx-pwba-bottom-sheet-disabled");
c.hideElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-spinner"))});a.widget.on(p.UpiIdValidateSuccessEvent,a,function(b){l&&l[0]&&(l[0].innerHTML=b.validatedUpiId,this._toggleSelectedOption(!0),c.hideElement(d(".apx-get-started-with-upi-message")),a._selectedPaymentMethod="UPI_3P",a._clearPwbaSavedHandleRadioButtons(),a._clearPwbaP2MIntentRadioButtons(),a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName),a._toggleUpiP2MIntentSubMessage(!1),c.showElement(d(".apx-pwba-upi-acceptance-logo-css")),
b.isUpiRecurringEligible&&E?c.showElement(r):c.hideElement(r),b.shouldAutoCloseBottomSheet&&a._closeBottomSheet(!1),a._setInstrumentRowSelectionValue(a.upiOtherPMInstrumentRowSelectionValue),a._setHiddenInputInForm("__sif_encryptedVPA_collect",b.validatedUpiId),a._setHiddenInputInForm("upiSelectedAction",a.upiAcceptanceAction),a._setHiddenInputInForm("ppw-vpaToken",b.vpaToken),a._setHiddenInputInForm("ppw-paymentMethodId",b.paymentMethodId),a._selectRadioButton(),a._triggerPaymentPlanSelectedEvent(!0,
null,null,a.paymentMethod))});a.widget.on("apbSelectionChanged",a,function(b){b.isSelected?(c.showElement(d(".apx_pay_with_bank_apb_deselection_message")),this.enableUPIAPBMultiTender||this._disablePWBABottomSheet()):(c.hideElement(d(".apx_pay_with_bank_apb_deselection_message")),this._enablePWBABottomSheet());a.isAPBSelected=b.isSelected;for(var f in g.keys(this.savedHandlesData))a._setAPBSelectionChanged(a.isAPBSelected,f)});a.widget.on(p.UPIIssuanceSupportedEventName,a,function(){a._toggleUPISavedHandleHeading(!0);
a._toggleUPISavedHandle(!0)});a.widget.on(p.UPIIssuanceNotSupportedEventName,a,function(){a._toggleUPISavedHandleHeading(!1);a._toggleUPISavedHandle(!1)});a.widget.on(p.NoDevicePermissionsEventName,a,function(){if(a.isSavedHandleUsable)for(var b in g.keys(this.savedHandlesData))a.isUpiSavedHandleUsable[b]&&(a.sdkCallStatus[b]=h.SdkCallStatusEnum.Completed,a.isAIPSRedirectRequired[b]=!0,a._updateFlagsAndWidgetStateOnTerminalSdkResponse(b))});a.widget.on(p.ErrorEventName,a,function(){for(var b in g.keys(this.savedHandlesData))a.sdkCallStatus[b]=
h.SdkCallStatusEnum.Error,a.isAIPSRedirectRequired[b]=!1,a._updateFlagsAndWidgetStateOnTerminalSdkResponse(b);a._deselectAndDisableUPISavedHandle()});a.widget.on(p.DeviceSignatureMatchesEventName,a,function(b,c){for(var f in g.keys(this.savedHandlesData))a.isSavedHandleUsable&&f===b&&a.isUpiSavedHandleUsable[f]&&(a.sdkCallStatus[f]=h.SdkCallStatusEnum.Completed,a.isDeviceSignatureValid[f]=a.savedHandlesData[f][0]===c,a.isAIPSRedirectRequired[f]=!(a.isDeviceSignatureValid[f]&&a.savedHandlesData[f][1]),
a._updateFlagsAndWidgetStateOnTerminalSdkResponse(f))});a.widget.on(p.DeviceSignatureDoesNotMatchEventName,a,function(b){for(var c in g.keys(this.savedHandlesData))a.isSavedHandleUsable&&c===b&&a.isUpiSavedHandleUsable[c]&&(a.sdkCallStatus[c]=h.SdkCallStatusEnum.Completed,a.isDeviceSignatureValid[c]=!1,a.isAIPSRedirectRequired[c]=!0,a._updateFlagsAndWidgetStateOnTerminalSdkResponse(c))});a.widget.on(H,a,function(b){a.isSavedHandleOriginallySelectable&&a.isPWBASelected&&-1!==a.upiSavedHandleSelectedIndex&&
(a.instrumentPreparationStatus[a.upiSavedHandleSelectedIndex]===n.Pending?(a.widget.trigger(I,{errorMessage:a.errorMessage[a.upiSavedHandleSelectedIndex]}),a.isAwaitingInstrumentPrepare[a.upiSavedHandleSelectedIndex]=!0):(a.isAwaitingInstrumentPrepare[a.upiSavedHandleSelectedIndex]=!0,a._triggerInstrumentPreparedEvent(a.upiSavedHandleSelectedIndex),a.isAwaitingInstrumentPrepare[a.upiSavedHandleSelectedIndex]=!1))});a.widget.on(J,a,function(b){a.handleSavedHandleContinueError&&a.isPWBASelected&&-1!==
a.upiSavedHandleSelectedIndex&&a._handlePreparedInstrumentContinueError(b.reason?b.reason:n.UnknownFailure)});g.forEach(["ContinueButtonClicked","SecondaryContinueButtonClicked","CompleteWidget"],function(b){a.widget.on(b,a,function(b){a.isSavedHandleOriginallySelectable&&a.isPWBASelected&&-1!==a.upiSavedHandleSelectedIndex?(a.continueClickTime=e.getCurrentTime(),e.logCounterMetric({feature:"PWBA_SavedHandleSelectedAtContinueClick",resource:"_Count"}),e.logCounterMetric({feature:"PWBA_SavedHandleSelectedAtContinueClick_Index"+
a.upiSavedHandleSelectedIndex,resource:"_Count"}),e.publishMetrics()):a.continueClickTime=null;"UPI_P2M_INTENT"===a._selectedPaymentMethod&&(b="PWBA_UpiP2MIntentAppSelectedAtContinueClick_"+a.upiP2MIntentSelectedAppName,e.logCounterMetric({feature:"PWBA_UpiP2MIntentSelectedAtContinueClick",resource:"_Count"}),e.logCounterMetric({feature:b,resource:"_Count"}),e.publishMetrics());a._invokeEagerInitModule(!0)})});a.widget.on(p.UpiRedirectionContinueEventName,a,function(){var b=e.getCurrentTime();if(a.isPWBASelected&&
-1!==a.upiSavedHandleSelectedIndex){a.widget.trigger(A.showSpinner);e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirection",resource:"_Count"});e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirection_Index"+a.upiSavedHandleSelectedIndex,resource:"_Count"});var c=a._getUPIRedirectionData();this.isDeviceSignatureValid[this.upiSavedHandleSelectedIndex]?this.savedHandlesData[this.upiSavedHandleSelectedIndex][1]||(e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",
resource:"_Count"}),z.upiPinNotSet(a._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),c.upiRequiredUrls,a.purchaseId,a.clientId,a.httpMethod,c.upiConditionalArguments)?(e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionPinNotSet",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})):(e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",
resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionPinNotSet",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})),e.logLatencyMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",resource:"_Latency",startTime:b})):(e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Count"}),z.upiDeviceFingerprintDoesNotMatch(a._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),
c.upiRequiredUrls,a.purchaseId,a.clientId,a.httpMethod,c.upiConditionalArguments)?(e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})):(e.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",
ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})),e.logLatencyMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Latency",startTime:b}));e.publishMetrics()}return!1})},_displayUPIIntentApps:function(a){if(a.upiIntentEligibleApps!==x&&0<a.upiIntentEligibleApps.length){for(var b=!1,f=0,k=new Set,w=0;w<a.upiIntentEligibleApps.length;w++)k.add(a.upiIntentEligibleApps[w].intentAppPackageName);g.forEachKeyValue(y,function(a,w){k.has(a)&&5>
f&&(f++,e.logCounterMetric({feature:"PWBA_UPIP2MIntentAppCount_"+a,resource:"_Count"}),b=!0,c.showElement(d(".apx-pwba-p2m-indivisual-app-css-"+w)))});e.publishMetrics();b?(c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-other-upi-apps-heading")),c.hideElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-enter-upi-id-heading")),this.isUpiSavedHandlePresent?c.showElement(d(".apx-pwba-p2m-intent-heading-registered-customer")):c.showElement(d(".apx-pwba-p2m-intent-heading-non-registered-customer"))):
this._checkAndDisplayNoP2MIntentAppsAvailable()}},_displayStaticUPIIntentApps:function(){var a=!1;g.forEachKeyValue(y,function(b,f){c.showElement(d(".apx-pwba-p2m-indivisual-app-css-"+f));a=!0});a&&(c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-other-upi-apps-heading")),c.hideElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-enter-upi-id-heading")))},_checkAndDisplayNoP2MIntentAppsAvailable:function(){this.isUpiAcceptanceComponentDisplayable||(c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-other-upi-apps-heading")),
c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-no-apps-available")))},_getUPIRedirectionData:function(){return{upiRequiredUrls:{redirectUrl:this.upiRegistrationRedirectUrl,returnUrl:this.upiRegistrationReturnUrl,failureReturnUrl:this.upiRegistrationFailureReturnUrl},upiConditionalArguments:{areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,isPurchaseIdRequired:this.isPurchaseIdRequired,enableCallbackRedirectionBehavior:this.enableCallbackRedirectionBehavior,returnUrlPostParams:this.returnUrlPostParams,
enableGetReturnHttpMethod:this.enableGetReturnHttpMethod}}},_toggleSelectedOption:function(a){a?this.isNomenclatureWave2Enabled?c.showElement(d(".apx-pay-with-bank-bottom-sheet-selected-element-container-nomenclature")):c.showElement(d(".apx-pay-with-bank-bottom-sheet-selected-element-container")):this.isNomenclatureWave2Enabled?c.hideElement(d(".apx-pay-with-bank-bottom-sheet-selected-element-container-nomenclature")):c.hideElement(d(".apx-pay-with-bank-bottom-sheet-selected-element-container"))},
_toggleUpiP2MIntentSubMessage:function(a){a?c.showElement(d(".apx-pwba-p2m-intent-sub-message")):c.hideElement(d(".apx-pwba-p2m-intent-sub-message"))},_toggleUncheckAPBtoEnableUPIMessage:function(a,b){if(-1<b&&b<this.noOfSavedHandles)a?c.showElement(d(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+b)):c.hideElement(d(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+b));else for(var f in g.keys(this.savedHandlesData))a?c.showElement(d(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+
f)):c.hideElement(d(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+f))},_setAPBSelectionChanged:function(a,b){this._isActionNeededPostAPBSelectionChange(b)&&(this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex&&a&&this._invalidatePaymentPlan(),this.setUPISavedHandleDisabled(a,b),a&&this.upiSavedHandleSelectedIndex==b&&(this._deselectAndDisableUPISavedHandle(),this.isUpiP2MIntentEnabled?c.showElement(d(".apx-pwba-gif-css")):c.showElement(d(".apx-pwba-upi-acceptance-logo-css"))),
this._toggleUncheckAPBtoEnableUPIMessage(a,b));this._setInstrumentPreparationStatus(b)},_isActionNeededPostAPBSelectionChange:function(a){return this.isUpiSavedHandleUsable[a]&&!this.isPermanentDisabled[a]&&!this.isUpiSavedHandleAPBMultiTenderEligible[a]},_deselectAndDisableUPISavedHandle:function(){this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex&&(this._toggleSelectedOption(!1),this._selectedPaymentMethod="EMPTY_SELECTION",this._getContainerElement().find("input[type\x3dradio]")[0].checked=
!1,this.upiSavedHandleSelectedIndex=-1,this.isPWBASelected=!1,this._clearPwbaSavedHandleRadioButtons())},_getSavedHandleInstrumentId:function(a){return this.savedHandlesData[a][3].split("\x26")[0].split("\x3d")[1]},_getOrElse:function(a,b){return a?a:b},_updateFlagsAndWidgetStateOnTerminalSdkResponse:function(a){this.isAIPSRedirectRequired[this._getOrElse(a,0)]?this.isUpiSavedHandleAPBMultiTenderEligible[a]=this.isUpiIssuanceAPBMultiTenderEnabled&&this.isUpiRegistrationEnabled&&(this.isApxReloadEnabled||
this.isUpiAIPSRedirectionWithMTEnabled):this.isUpiSavedHandleAPBMultiTenderEligible[a]=this.isUpiIssuanceAPBMultiTenderEnabled;this._setInstrumentPreparationStatus(a);this._publishMetricsOnSdkCallCompletion(a);this._invokeEagerInitModule(!0===this.isAwaitingInstrumentPrepare[a]);this._triggerInstrumentPreparedEvent(a);if(this.sdkCallStatus[this._getOrElse(a,0)]===h.SdkCallStatusEnum.Error||this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&!this.isUpiRegistrationEnabled){var b=this.isAIPSRedirectRequired[this._getOrElse(a,
0)]&&!this.isUpiRegistrationEnabled;this._setUPISavedHandleDisabled(b,a)}else this._setUPISavedHandleEnabled(a);this._setAPBSelectionChanged(this.isAPBSelected,a)},_setInstrumentPreparationStatus:function(a){this.sdkCallStatus[this._getOrElse(a,0)]===h.SdkCallStatusEnum.Error?(this.instrumentPreparationStatus[this._getOrElse(a,0)]=n.Failure,this.failureReason[this._getOrElse(a,0)]=h.FailureReasonEnum.SdkError):this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&!this.isUpiRegistrationEnabled?(this.instrumentPreparationStatus[this._getOrElse(a,
0)]=n.Failure,this.failureReason[this._getOrElse(a,0)]=h.FailureReasonEnum.AIPSRedirectionNotEnabled):this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex&&this.isAPBSelected&&!this.isUpiSavedHandleAPBMultiTenderEligible[a]?(this.instrumentPreparationStatus[this._getOrElse(a,0)]=n.Failure,this.failureReason[this._getOrElse(a,0)]=h.FailureReasonEnum.MultitenderNotSupported):(this.sdkCallStatus[this._getOrElse(a,0)]===h.SdkCallStatusEnum.Pending?this.instrumentPreparationStatus[this._getOrElse(a,
0)]=n.Pending:this.instrumentPreparationStatus[this._getOrElse(a,0)]=n.Success,this.failureReason[this._getOrElse(a,0)]=null);this.errorMessage[this._getOrElse(a,0)]=[this._buildErrorMessage(a)]},_buildErrorMessage:function(a){return this.handleSavedHandleContinueError&&this.instrumentPreparationStatus[this._getOrElse(a,0)]!==n.Success?this.failureReason[this._getOrElse(a,0)]===h.FailureReasonEnum.SdkError?this.widget.getLocalizedString("apx_upi_savedHandle_continue_sdk_error"):this.failureReason[this._getOrElse(a,
0)]===h.FailureReasonEnum.AIPSRedirectionNotEnabled?this.widget.getLocalizedString("apx_upi_savedHandle_continue_redirection_error"):this.failureReason[this._getOrElse(a,0)]===h.FailureReasonEnum.MultitenderNotSupported?this.widget.getLocalizedString("apx_upi_savedHandle_continue_multi_tender_error"):this.widget.getLocalizedString("apx_upi_savedHandle_continue_error"):null},_publishMetricsOnSdkCallCompletion:function(a){if(this.isSavedHandleOriginallySelectable){var b=this.continueClickTime?"AfterContinue":
"BeforeContinue";this.sdkCallStatus[this._getOrElse(a,0)]!==h.SdkCallStatusEnum.Completed||this.isAIPSRedirectRequired[this._getOrElse(a,0)]||e.logCounterMetric({feature:"PWBA_SavedHandleHappyCase_"+b,resource:"_Count"});this.sdkCallStatus[this._getOrElse(a,0)]===h.SdkCallStatusEnum.Completed&&this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&e.logCounterMetric({feature:"PWBA_SavedHandleUnhappyCase_"+b,resource:"_Count"});this.sdkCallStatus[this._getOrElse(a,0)]===h.SdkCallStatusEnum.Error&&e.logCounterMetric({feature:"PWBA_SavedHandleSdkError_"+
b,resource:"_Count"});this.continueClickTime&&(this.sdkCallStatus[this._getOrElse(a,0)]===h.SdkCallStatusEnum.Error?e.logLatencyMetric({feature:"PWBA_SavedHandleSdkCallError_"+b,resource:"_Latency",startTime:this.continueClickTime}):e.logLatencyMetric({feature:"PWBA_SavedHandleSdkCallSuccess_"+b,resource:"_Latency",startTime:this.continueClickTime}));e.publishMetrics()}},_triggerInstrumentPreparedEvent:function(a){this.isSavedHandleOriginallySelectable&&-1!==this.upiSavedHandleSelectedIndex&&this.isAwaitingInstrumentPrepare[this._getOrElse(a,
0)]&&this.widget.trigger(G,{instrumentId:this._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),instrumentPreparationStatus:this.instrumentPreparationStatus[this._getOrElse(a,0)],isUpiRedirectionRequired:this._isUpiRedirectionRequired(this._getOrElse(a,0)),failureReason:this.failureReason[this._getOrElse(a,0)],errorMessage:this.errorMessage[this._getOrElse(a,0)]})},_isUpiRedirectionRequired:function(a){return!1!==this.isAIPSRedirectRequired[a]},_invokeEagerInitModule:function(a){var b=
this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex;if(0<=this.upiSavedHandleSelectedIndex){var c=this.sdkCallStatus[this.upiSavedHandleSelectedIndex];var d=this.isAIPSRedirectRequired[this.upiSavedHandleSelectedIndex];var e=this.savedHandlesData[this.upiSavedHandleSelectedIndex][5]}L.performNpciClEagerInit(this.eagerInitNpciClWeblabTreatment,b,c,d,a,this._getMetadata(e))},_setUPISavedHandleDisabled:function(a,b){-1!==this.upiSavedHandleSelectedIndex&&this._invalidatePaymentPlan();-1<b&&b<
this.noOfSavedHandles?this.isPermanentDisabled[b]=!0:this.isPermanentDisabled.fill(!0);this.setUPISavedHandleDisabled(!0,b);this._toggleUPIPermanentDisabledMessage(a,b)},_toggleUPIPermanentDisableMessageForSavedHandleIndex:function(a,b){a?c.showElement(this.getDOMElement("upiPermanentDisabledMessageContainer_pwba_sh_"+b)):c.hideElement(this.getDOMElement("upiPermanentDisabledMessageContainer_pwba_sh_"+b))},_toggleUPIPermanentDisabledMessage:function(a,b){if(-1<b&&b<this.noOfSavedHandles)this._toggleUPIPermanentDisableMessageForSavedHandleIndex(a,
b);else for(var c in g.keys(this.savedHandlesData))this._toggleUPIPermanentDisableMessageForSavedHandleIndex(a,c)},_setUPISavedHandleEnabled:function(a){this.isSavedHandleOriginallySelectable||(-1<a&&a<this.noOfSavedHandles?this.isPermanentDisabled[a]=!1:this.isPermanentDisabled.fill(!1),this.setUPISavedHandleDisabled(!1,a))},setUPISavedHandleDisabledWithIndex:function(a,b){a?(this._getUPISavedHandleContainerElement(b).addClass("apx-disabled-bottom-sheet-line-item"),d(".apx-pwba-bottom-sheet-upi-tag-logo-t2").eq(b).addClass("apx-pwba-bottom-sheet-disabled"),
d(".in-apx-psp-upi-ma-pwba-bank-logo-sprite-t3").eq(b).addClass("apx-pwba-bottom-sheet-disabled")):(this._getUPISavedHandleContainerElement(b).removeClass("apx-disabled-bottom-sheet-line-item"),d(".apx-pwba-bottom-sheet-upi-tag-logo-t2").eq(b).removeClass("apx-pwba-bottom-sheet-disabled"),d(".in-apx-psp-upi-ma-pwba-bank-logo-sprite-t3").eq(b).removeClass("apx-pwba-bottom-sheet-disabled"))},setUPISavedHandleDisabled:function(a,b){if(-1<b&&b<this.noOfSavedHandles)this.setUPISavedHandleDisabledWithIndex(a,
b);else for(var c in g.keys(this.savedHandlesData))this.setUPISavedHandleDisabledWithIndex(a,c)},_getUPISavedHandleContainerElement:function(a){return this.getDOMElement("savedHandle-list-item-"+a)},_invalidatePaymentPlan:function(){this.setContinuable(!1);this.widget.trigger(v.PaymentPlanSelected,{isValid:!1})},_toggleUPISavedHandleHeading:function(a){a?c.showElement(this.getDOMElement("apx-pay-with-bank-registered-account-header-text")):c.hideElement(this.getDOMElement("apx-pay-with-bank-registered-account-header-text"))},
_toggleUPISavedHandle:function(a){for(var b in g.keys(this.savedHandlesData))a?c.showElement(this._getUPISavedHandleContainerElement(b)):c.hideElement(this._getUPISavedHandleContainerElement(b))},_handlePreparedInstrumentContinueError:function(a){a===n.TimedOut&&(e.logCounterMetric({feature:"PWBA_SavedHandleSdkCallTimedOut",resource:"_Count"}),e.publishMetrics());this.failureReason[this.upiSavedHandleSelectedIndex]===h.FailureReasonEnum.MultitenderNotSupported?this._setAPBSelectionChanged(this.isAPBSelected,
this.upiSavedHandleSelectedIndex):this._setUPISavedHandleDisabled(!1,this.upiSavedHandleSelectedIndex);this.isAwaitingInstrumentPrepare[this.upiSavedHandleSelectedIndex]=!1;this._getContainerElement().find("input[type\x3dradio]")[0].checked=!1;this._deselectAndDisableUPISavedHandle()},bindToElements:function(){var a=this;a.$topBanksList=this.getDOMElementsByPrefix("upiTopBanks-list-item-");a.$allBanksList=this.getDOMElementsByPrefix("upiAllBanks-list-item-");a.$topBanksHeader=this.getDOMElement("upiTopBanks-title");
a.$allBanksHeader=this.getDOMElement("upiAllBanks-title");a.$noBankFoundText=this.getDOMElement("no-bank-found");var b=!1;q=this.getDOMElement(B);r=this.getDOMElement(C);t.when("A","a-sheet","ready").execute("bottom-sheet-events",function(d,k){1<document.querySelectorAll("#apx-pay-with-bank-account-bottom-sheet-content-id").length&&(k=k.get("apx-pay-with-bank-account-bottom-sheet"))&&k.destroy();d.on("a:sheet:beforeShow:apx-pay-with-bank-account-bottom-sheet",function(b){c.hideElement(a.getDOMElement("upiBanksListContent"));
c.hideElement(a.getDOMElement("netBankingContent"));c.hideElement(a.getDOMElement("upi3PContent"));a._loadUPIViewInBottomSheet();a._scrollToTopOfBottomSheet();a.bottomSheetOpenTime=e.getCurrentTime();a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankStart",ActionValueType:"UpiSearchBank",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"})});d.declarative("bankSearchDeclarativeAction","keyup",function(){b=!0;a.$topBankAvailable=0;a.$allBankAvailable=0;
var f,k=a.getDOMElement("search-bank-text-box-input").val().toUpperCase();g.forEach(a.$topBanksList,function(b){f=b.getElementsByClassName("apx-net-banking-element-name-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");d.contains(f,k)&&(b.classList.remove("aok-offscreen"),a.$topBankAvailable++)});g.forEach(a.$allBanksList,function(b){f=b.getElementsByClassName("apx-net-banking-element-name-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");d.contains(f,k)&&(b.classList.remove("aok-offscreen"),
a.$allBankAvailable++)});0===a.$topBankAvailable?a.$topBanksHeader.addClass("aok-offscreen"):a.$topBanksHeader.removeClass("aok-offscreen");0===a.$allBankAvailable?a.$allBanksHeader.addClass("aok-offscreen"):a.$allBanksHeader.removeClass("aok-offscreen");0===a.$topBankAvailable&&0===a.$allBankAvailable?(c.showElement(a.$noBankFoundText),e.logCounterMetric({feature:"PWBA_NoBankFoundWhenSearchBoxUsed",resource:"_ErrorCount"}),e.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"UpiSearchBankInProgress",
ActionValueType:"UpiSearchBank",ActionValue:"BankNotFoundInList",ActionErrorCode:"NO_BANK_FOUND",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"})):c.hideElement(a.$noBankFoundText)});d.on("a:sheet:beforeHide:apx-pay-with-bank-account-bottom-sheet",function(b){"EMPTY_SELECTION"===a._selectedPaymentMethod?(b=a.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"),a._triggerPaymentPlanSelectedEvent(!1,b,b,null),a._getContainerElement().find("input[type\x3dradio]")&&
a._getContainerElement().find("input[type\x3dradio]")[0]&&(a._getContainerElement().find("input[type\x3dradio]")[0].checked=!1,a._getContainerElement().find("input[type\x3dradio]")[0].blur(),this.isNomenclatureWave2Enabled&&a._getContainerElement().removeClass("pmts-selected"))):a._selectRadioButton()})});a._getContainerElement().click(function(b){a._triggerInstrumentRowSelectedEvent()});g.forEach(["upiTopBanks-list-item-","upiAllBanks-list-item-"],function(f){a.getDOMElementsByPrefix(f).click(function(f){e.logLatencyMetric({feature:"PayWithBankAccountBottomSheet",
resource:"_Latency",startTime:this.bottomSheetOpenTime});b?e.logCounterMetric({feature:"PWBA_BankSelectCompletedUsingSearchBox",resource:"_SuccessCount"}):e.logCounterMetric({feature:"PWBA_BankSelectCompletedWithoutUsingSearchBox",resource:"_SuccessCount"});e.publishMetrics();if(l&&l[0]){l[0].innerHTML=f.srcElement.innerText;a._toggleSelectedOption(!0);c.showElement(d(".apx-get-started-with-upi-message"));a._selectedPaymentMethod="UPI_REGISTRATION";a._clearPwbaSavedHandleRadioButtons();a._clearPwbaP2MIntentRadioButtons();
a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName);a._toggleUpiP2MIntentSubMessage(!1);a._closeBottomSheet(!1);a.upiSavedHandleSelectedIndex=-1;var k=d(f.currentTarget);f=k&&k.data("bank-code")?k.data("bank-code"):"";k=k&&k[0].innerText?k[0].innerText:"";if(a.getDOMElement("search-bank-text-box-input").val())var g=a.getDOMElement("search-bank-text-box-input").val().length;b?a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionUsingSearchBox",
ActionErrorCode:k+" inputSize "+g,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"}):a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionWithoutUsingSearchBox",ActionErrorCode:k,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"});b=!1;a._setInstrumentRowSelectionValue(a.upiOtherPMInstrumentRowSelectionValue);a._setHiddenInputInForm("upiSelectedAction",
a.upiRegistrationAction);a._setHiddenInputInForm("ppw-upiRegistrationSelectedBank",f);a._selectRadioButton();a._handleUPIRedirectionForRegistration(f)}})});a.getDOMElement("moreOptionsToPay-list-item-NetBanking").click(function(b){c.hideElement(a.getDOMElement("upiUnregisteredContent"));c.hideElement(a.getDOMElement("upiRegisteredContent"));c.showElement(a.getDOMElement("netBankingContent"));a._scrollToTopOfBottomSheet();a.upiSavedHandleSelectedIndex=-1});a.getDOMElement("moreOptionsToPay-list-item-3PUPI").click(function(b){c.hideElement(a.getDOMElement("upiUnregisteredContent"));
c.hideElement(a.getDOMElement("upiRegisteredContent"));c.showElement(a.getDOMElement("upi3PContent"));(b=d(".validate-upi-component-container").find("input[name\x3d__sif_encryptedVPA_collect]"))&&b.focus();a.upiSavedHandleSelectedIndex=-1});a.getDOMElement("apx-pay-with-bank-bottom-sheet-net-banking-header-back-btn").click(function(b){c.hideElement(a.getDOMElement("netBankingContent"));a._loadUPIViewInBottomSheet()});a.getDOMElement("apx-pay-with-bank-bottom-sheet-upi-3p-header-back-btn").click(function(b){c.hideElement(a.getDOMElement("upi3PContent"));
a._loadUPIViewInBottomSheet()});a.getDOMElement("apx-pay-with-bank-bottom-sheet-upi-bank-list-header-back-btn").click(function(b){c.hideElement(a.getDOMElement("upiBanksListContent"));a._loadUPIViewInBottomSheet()});d(".apx-pwba-bottom-sheet-tab-heading").click(function(b){a._scrollToTopOfBottomSheet()});a.getDOMElementsByPrefix("apx-bottom-sheet-scroll-to-top-button-").click(function(b){a._scrollToTopOfBottomSheet()});a.getDOMElementsByPrefix("apx-bottom-sheet-link-bank-account-and-pay-button").click(function(b){c.hideElement(a.getDOMElement("upiUnregisteredContent"));
c.showElement(a.getDOMElement("upiBanksListContent"))});g.forEach(["netBankingTopBanks-list-item-","netBankingAllBanks-list-item-"],function(b){a.getDOMElementsByPrefix(b).click(function(b){l&&l[0]&&(l[0].innerHTML=b.srcElement.innerText+" - Netbanking",a._toggleSelectedOption(!0),c.hideElement(d(".apx-get-started-with-upi-message")),a._selectedPaymentMethod="NET_BANKING",a._clearPwbaSavedHandleRadioButtons(),a._clearPwbaP2MIntentRadioButtons(),a._closeBottomSheet(!1),a.upiSavedHandleSelectedIndex=
-1,b=(b=d(b.currentTarget))&&b.data("bank-code")?b.data("bank-code"):"",a._setInstrumentRowSelectionValue(a.netBankingInstrumentRowSelectionValue),a._setHiddenInputInForm("ppw-bankSelection_dropdown",b),a._selectRadioButton(),a._triggerPaymentPlanSelectedEvent(!0,null,null,a.paymentMethod))})});a.getDOMElementsByPrefix("savedHandle-list-item-").click(function(b){var e=d(b.currentTarget);a.upiSavedHandleSelectedIndex=parseInt(e&&(e.data("saved-handle-index")||0===e.data("saved-handle-index"))?e.data("saved-handle-index"):
"-1",10);!a.isSavedHandleUsable||-1===a.upiSavedHandleSelectedIndex||a.isPermanentDisabled[a.upiSavedHandleSelectedIndex]||!a.isUpiSavedHandleUsable[a.upiSavedHandleSelectedIndex]||a.isAPBSelected&&!a.isUpiSavedHandleAPBMultiTenderEligible[a.upiSavedHandleSelectedIndex]||(l&&l[0]&&(a._clearPwbaSavedHandleRadioButtons(),a._clearPwbaP2MIntentRadioButtons(),a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName),l[0].innerHTML=b.srcElement.querySelector(".apx-pwba-saved-handle-banking-details").innerText,
b.srcElement.querySelector("#apx-pwba-input-id-saved-handle-radio-button").checked=!0,a._toggleSelectedOption(!0)),c.showElement(d(".apx-pwba-upi-saved-handle-logo-css")),a._toggleUpiP2MIntentSubMessage(!1),a._selectedPaymentMethod="UPI_SAVED_HANDLE",a.savedHandlesData[a.upiSavedHandleSelectedIndex][4]&&D?c.showElement(q):c.hideElement(q),a._closeBottomSheet(!1),a._setInstrumentRowSelectionValue(a.savedHandlesData[a.upiSavedHandleSelectedIndex][3]),a._selectRadioButton(),a._triggerBackingInstrumentSelectedEvent(),
a._invokeEagerInitModule(!1))});a.isUpiP2MIntentEnabled&&a.getDOMElementsByPrefix("upiIntentApp-list-item-").click(function(b){var e=d(b.currentTarget);a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName);a.upiP2MIntentSelectedAppName=e&&e.data("upi-intent-app-name")?e.data("upi-intent-app-name"):"";a.upiP2MIntentSelectedAppPackageName=e&&e.data("upi-intent-app-package-name")?e.data("upi-intent-app-package-name"):"";c.showElement(d(".apx-pwba-p2m-intent-app-selection-logo-css"+a.upiP2MIntentSelectedAppName));
l&&l[0]&&(a._clearPwbaP2MIntentRadioButtons(),a._clearPwbaSavedHandleRadioButtons(),l[0].innerHTML=b.target.querySelector(".apx-pwba-p2m-intent-app-details").innerText,b.target.querySelector("#apx-pwba-input-id-intent-app-radio-button").checked=!0);a._toggleSelectedOption(!0);a._toggleUpiP2MIntentSubMessage(!1);c.hideElement(d(".apx-get-started-with-upi-message"));a._selectedPaymentMethod="UPI_P2M_INTENT";a.upiSavedHandleSelectedIndex=-1;a._closeBottomSheet(!1);a.isUpiIntentOptionPmSegregated&&0!==
Object.keys(a.upiP2MIntentInstrumentRowSelectionValuesMap).length?a._setInstrumentRowSelectionValue(a.upiP2MIntentInstrumentRowSelectionValuesMap[a.upiP2MIntentSelectedAppName]):a._setInstrumentRowSelectionValue(a.upiP2MIntentInstrumentRowSelectionValue);a._setHiddenInputInForm("ppw-upiIntentAppName",a.upiP2MIntentSelectedAppName);a._setHiddenInputInForm("ppw-upiIntentAppPackageName",a.upiP2MIntentSelectedAppPackageName);a._selectRadioButton();a._triggerPaymentPlanSelectedEvent(!0,null,null,a.paymentMethod)})},
_hidePWBAExistingSelectedLogo:function(a){c.hideElement(d(".apx-pwba-gif-css"));c.hideElement(d(".apx-pwba-p2m-intent-app-selection-logo-css"+a));c.hideElement(d(".apx-pwba-upi-acceptance-logo-css"));c.hideElement(d(".apx-pwba-upi-saved-handle-logo-css"))},_clearPwbaSavedHandleRadioButtons:function(){for(var a=document.querySelectorAll(".apx-pwba-radio-button-cx-align #apx-pwba-input-id-saved-handle-radio-button"),b=0;b<a.length;b++)a[b].checked=!1},_clearPwbaP2MIntentRadioButtons:function(){for(var a=
document.querySelectorAll(".apx-pwba-radio-button-cx-align #apx-pwba-input-id-intent-app-radio-button"),b=0;b<a.length;b++)a[b].checked=!1},_deselectInstrumentRowSelectionRadioButtons:function(){g.forEach(d("input[type\x3dradio][name\x3dppw-instrumentRowSelection]"),function(a){a.checked=!1})},_triggerPaymentPlanSelectedEvent:function(a,b,c,d){b={isValid:a,message:b,notValidReason:c,paymentMethod:d};this.widget.trigger(v.paymentPlanSelectedPrepare,b);this.setContinuable(a);this.widget.trigger(v.PaymentPlanSelected,
b);this.widget.log({event:v.PaymentPlanSelected,details:b});b={isValid:a,paymentMethod:"PayWithBankAccount"};self.widget.log({event:v.PaymentPlanSelected,details:b})},_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),instrumentType:this.savedHandleInstrumentType,errors:[],paymentMethod:this.paymentMethod,isUpiRedirectionRequired:this._isUpiRedirectionRequired(this.upiSavedHandleSelectedIndex)})},
_setInstrumentRowSelectionValue:function(a){var b=this._getContainerElement().find("input[name\x3dppw-instrumentRowSelection]");b&&b[0]&&(b[0].value=a)},_setHiddenInputInForm:function(a,b){var c=this._getContainerElement().closest("form");if(c&&c[0]){var d=c[0].elements[a];d?d.value=b:c.append(F.buildHiddenInput(a,b))}},_getContainerElement:function(){return d(".pay-with-bank-account-container")},_getPWBAGif:function(){return d(".apx-pwba-gif-css")},_handleUPIRedirectionForRegistration:function(a){var b=
e.getCurrentTime();this.widget.trigger(A.showSpinner);e.logCounterMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_Count"});var c=this._getUPIRedirectionData();z.upiRegistration(a,c.upiRequiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.upiConditionalArguments)?(e.logCounterMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"PWBA_UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())})):
(e.logCounterMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"PWBA_UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())}));e.logLatencyMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_Latency",startTime:b});e.publishMetrics()},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(m,{instrumentId:this.instrumentId,paymentMethod:this.paymentMethod})},
_scrollToTopOfBottomSheet:function(){var a=this.getDOMElement("apx-pay-with-bank-bottom-sheet-top-marker");a&&a[0]&&a[0].scrollIntoView({behavior:"smooth"})},_closeBottomSheet:function(a){a||(c.hideElement(this.getDOMElement("upiBanksListContent")),c.hideElement(this.getDOMElement("netBankingContent")),c.hideElement(this.getDOMElement("upi3PContent")),this._loadUPIViewInBottomSheet());d(".a-sheet-close").click();if("NET_BANKING"===this._selectedPaymentMethod||"UPI_3P"===this._selectedPaymentMethod||
"UPI_P2M_INTENT"===this._selectedPaymentMethod||"EMPTY_SELECTION"===this._selectedPaymentMethod)c.hideElement(d(".apx_pay_with_bank_selected_element_apb_deselection_message")),this.setDisabled(!1);"UPI_SAVED_HANDLE"!==this._selectedPaymentMethod&&"UPI_3P"!==this._selectedPaymentMethod?(c.hideElement(q),c.hideElement(r)):"UPI_SAVED_HANDLE"===this._selectedPaymentMethod?c.hideElement(r):c.hideElement(q)},_enablePWBABottomSheet:function(){this._getPWBAGif().removeClass("pmts-logo-disabled");c.hideElement(d(".apx_pay_with_bank_selected_element_apb_deselection_message"));
c.showElement(d(".apx-get-started-with-upi-message"));this._toggleUpiP2MIntentSubMessage(!0);this._getContainerElement().removeClass("apx-disabled-bottom-sheet-line-item")},_disablePWBABottomSheet:function(){c.showElement(d(".apx_pay_with_bank_selected_element_apb_deselection_message"));this._getPWBAGif().addClass("pmts-logo-disabled");this._getContainerElement().addClass("apx-disabled-bottom-sheet-line-item");this._getContainerElement().find("input[type\x3dradio]")&&this._getContainerElement().find("input[type\x3dradio]")[0]&&
(this._getContainerElement().find("input[type\x3dradio]")[0].checked=!1,this.isNomenclatureWave2Enabled&&this._getContainerElement().removeClass("pmts-selected"));this._toggleSelectedOption(!1);c.hideElement(d(".apx-get-started-with-upi-message"));this.upiSavedHandleSelectedIndex=-1;this.isPWBASelected=!1;this._clearPwbaSavedHandleRadioButtons();this._clearPwbaP2MIntentRadioButtons();this._hidePWBAExistingSelectedLogo(this.upiP2MIntentSelectedAppName);this._toggleUpiP2MIntentSubMessage(!1);this.isUpiP2MIntentEnabled?
c.showElement(d(".apx-pwba-gif-css")):c.showElement(d(".apx-pwba-upi-acceptance-logo-css"));this._selectedPaymentMethod="EMPTY_SELECTION";c.hideElement(q);c.hideElement(r)},_loadUPIViewInBottomSheet:function(){this.isUpiSavedHandlePresent?c.showElement(this.getDOMElement("upiRegisteredContent")):c.showElement(this.getDOMElement("upiUnregisteredContent"))},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",
{noCostEMIValue:0})},_selectRadioButton:function(){this._getContainerElement().find("input[type\x3dradio]")&&this._getContainerElement().find("input[type\x3dradio]")[0]&&(this._getContainerElement().find("input[type\x3dradio]")[0].checked=!0);this.isNomenclatureWave2Enabled&&this._getContainerElement().addClass("pmts-selected")},_getMetadata:function(a){return{clientName:"APX PWBA",clientId:this.clientId,merchantCustomerId:a}}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-HealthBenefitsCard","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/HealthBenefitsCardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/HealthBenefitsCardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
